function ZS(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var KS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function XS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ey={exports:{}},l0={},Ty={exports:{}},ht={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Du=Symbol.for("react.element"),qS=Symbol.for("react.portal"),YS=Symbol.for("react.fragment"),JS=Symbol.for("react.strict_mode"),QS=Symbol.for("react.profiler"),eI=Symbol.for("react.provider"),tI=Symbol.for("react.context"),rI=Symbol.for("react.forward_ref"),nI=Symbol.for("react.suspense"),iI=Symbol.for("react.memo"),sI=Symbol.for("react.lazy"),t1=Symbol.iterator;function aI(e){return e===null||typeof e!="object"?null:(e=t1&&e[t1]||e["@@iterator"],typeof e=="function"?e:null)}var wy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ay=Object.assign,Sy={};function Rl(e,t,r){this.props=e,this.context=t,this.refs=Sy,this.updater=r||wy}Rl.prototype.isReactComponent={};Rl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Rl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Iy(){}Iy.prototype=Rl.prototype;function Pm(e,t,r){this.props=e,this.context=t,this.refs=Sy,this.updater=r||wy}var Nm=Pm.prototype=new Iy;Nm.constructor=Pm;Ay(Nm,Rl.prototype);Nm.isPureReactComponent=!0;var r1=Array.isArray,Cy=Object.prototype.hasOwnProperty,Om={current:null},ky={key:!0,ref:!0,__self:!0,__source:!0};function Ry(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Cy.call(t,n)&&!ky.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];i.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:Du,type:e,key:s,ref:o,props:i,_owner:Om.current}}function oI(e,t){return{$$typeof:Du,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Lm(e){return typeof e=="object"&&e!==null&&e.$$typeof===Du}function lI(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var n1=/\/+/g;function id(e,t){return typeof e=="object"&&e!==null&&e.key!=null?lI(""+e.key):t.toString(36)}function qf(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Du:case qS:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+id(o,0):n,r1(i)?(r="",e!=null&&(r=e.replace(n1,"$&/")+"/"),qf(i,t,r,"",function(h){return h})):i!=null&&(Lm(i)&&(i=oI(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(n1,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",r1(e))for(var l=0;l<e.length;l++){s=e[l];var u=n+id(s,l);o+=qf(s,t,r,u,i)}else if(u=aI(e),typeof u=="function")for(e=u.call(e),l=0;!(s=e.next()).done;)s=s.value,u=n+id(s,l++),o+=qf(s,t,r,u,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function yf(e,t,r){if(e==null)return e;var n=[],i=0;return qf(e,n,"","",function(s){return t.call(r,s,i++)}),n}function cI(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var _n={current:null},Yf={transition:null},uI={ReactCurrentDispatcher:_n,ReactCurrentBatchConfig:Yf,ReactCurrentOwner:Om};function Py(){throw Error("act(...) is not supported in production builds of React.")}ht.Children={map:yf,forEach:function(e,t,r){yf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return yf(e,function(){t++}),t},toArray:function(e){return yf(e,function(t){return t})||[]},only:function(e){if(!Lm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ht.Component=Rl;ht.Fragment=YS;ht.Profiler=QS;ht.PureComponent=Pm;ht.StrictMode=JS;ht.Suspense=nI;ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uI;ht.act=Py;ht.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ay({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Om.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)Cy.call(t,u)&&!ky.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];n.children=l}return{$$typeof:Du,type:e.type,key:i,ref:s,props:n,_owner:o}};ht.createContext=function(e){return e={$$typeof:tI,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:eI,_context:e},e.Consumer=e};ht.createElement=Ry;ht.createFactory=function(e){var t=Ry.bind(null,e);return t.type=e,t};ht.createRef=function(){return{current:null}};ht.forwardRef=function(e){return{$$typeof:rI,render:e}};ht.isValidElement=Lm;ht.lazy=function(e){return{$$typeof:sI,_payload:{_status:-1,_result:e},_init:cI}};ht.memo=function(e,t){return{$$typeof:iI,type:e,compare:t===void 0?null:t}};ht.startTransition=function(e){var t=Yf.transition;Yf.transition={};try{e()}finally{Yf.transition=t}};ht.unstable_act=Py;ht.useCallback=function(e,t){return _n.current.useCallback(e,t)};ht.useContext=function(e){return _n.current.useContext(e)};ht.useDebugValue=function(){};ht.useDeferredValue=function(e){return _n.current.useDeferredValue(e)};ht.useEffect=function(e,t){return _n.current.useEffect(e,t)};ht.useId=function(){return _n.current.useId()};ht.useImperativeHandle=function(e,t,r){return _n.current.useImperativeHandle(e,t,r)};ht.useInsertionEffect=function(e,t){return _n.current.useInsertionEffect(e,t)};ht.useLayoutEffect=function(e,t){return _n.current.useLayoutEffect(e,t)};ht.useMemo=function(e,t){return _n.current.useMemo(e,t)};ht.useReducer=function(e,t,r){return _n.current.useReducer(e,t,r)};ht.useRef=function(e){return _n.current.useRef(e)};ht.useState=function(e){return _n.current.useState(e)};ht.useSyncExternalStore=function(e,t,r){return _n.current.useSyncExternalStore(e,t,r)};ht.useTransition=function(){return _n.current.useTransition()};ht.version="18.3.1";Ty.exports=ht;var _e=Ty.exports;const Wa=XS(_e),fI=ZS({__proto__:null,default:Wa},[_e]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hI=_e,dI=Symbol.for("react.element"),pI=Symbol.for("react.fragment"),mI=Object.prototype.hasOwnProperty,gI=hI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_I={key:!0,ref:!0,__self:!0,__source:!0};function Ny(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)mI.call(t,n)&&!_I.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:dI,type:e,key:s,ref:o,props:i,_owner:gI.current}}l0.Fragment=pI;l0.jsx=Ny;l0.jsxs=Ny;Ey.exports=l0;var Z=Ey.exports,Qd={},Oy={exports:{}},Zn={},Ly={exports:{}},Dy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ue,te){var de=ue.length;ue.push(te);e:for(;0<de;){var Ae=de-1>>>1,j=ue[Ae];if(0<i(j,te))ue[Ae]=te,ue[de]=j,de=Ae;else break e}}function r(ue){return ue.length===0?null:ue[0]}function n(ue){if(ue.length===0)return null;var te=ue[0],de=ue.pop();if(de!==te){ue[0]=de;e:for(var Ae=0,j=ue.length,H=j>>>1;Ae<H;){var J=2*(Ae+1)-1,q=ue[J],re=J+1,ge=ue[re];if(0>i(q,de))re<j&&0>i(ge,q)?(ue[Ae]=ge,ue[re]=de,Ae=re):(ue[Ae]=q,ue[J]=de,Ae=J);else if(re<j&&0>i(ge,de))ue[Ae]=ge,ue[re]=de,Ae=re;else break e}}return te}function i(ue,te){var de=ue.sortIndex-te.sortIndex;return de!==0?de:ue.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],h=[],p=1,m=null,_=3,x=!1,E=!1,y=!1,A=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(ue){for(var te=r(h);te!==null;){if(te.callback===null)n(h);else if(te.startTime<=ue)n(h),te.sortIndex=te.expirationTime,t(u,te);else break;te=r(h)}}function V(ue){if(y=!1,w(ue),!E)if(r(u)!==null)E=!0,Ne(Q);else{var te=r(h);te!==null&&Oe(V,te.startTime-ue)}}function Q(ue,te){E=!1,y&&(y=!1,C(R),R=-1),x=!0;var de=_;try{for(w(te),m=r(u);m!==null&&(!(m.expirationTime>te)||ue&&!F());){var Ae=m.callback;if(typeof Ae=="function"){m.callback=null,_=m.priorityLevel;var j=Ae(m.expirationTime<=te);te=e.unstable_now(),typeof j=="function"?m.callback=j:m===r(u)&&n(u),w(te)}else n(u);m=r(u)}if(m!==null)var H=!0;else{var J=r(h);J!==null&&Oe(V,J.startTime-te),H=!1}return H}finally{m=null,_=de,x=!1}}var X=!1,S=null,R=-1,P=5,D=-1;function F(){return!(e.unstable_now()-D<P)}function b(){if(S!==null){var ue=e.unstable_now();D=ue;var te=!0;try{te=S(!0,ue)}finally{te?M():(X=!1,S=null)}}else X=!1}var M;if(typeof k=="function")M=function(){k(b)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,ke=Pe.port2;Pe.port1.onmessage=b,M=function(){ke.postMessage(null)}}else M=function(){A(b,0)};function Ne(ue){S=ue,X||(X=!0,M())}function Oe(ue,te){R=A(function(){ue(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ue){ue.callback=null},e.unstable_continueExecution=function(){E||x||(E=!0,Ne(Q))},e.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ue?Math.floor(1e3/ue):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(ue){switch(_){case 1:case 2:case 3:var te=3;break;default:te=_}var de=_;_=te;try{return ue()}finally{_=de}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ue,te){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var de=_;_=ue;try{return te()}finally{_=de}},e.unstable_scheduleCallback=function(ue,te,de){var Ae=e.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?Ae+de:Ae):de=Ae,ue){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=de+j,ue={id:p++,callback:te,priorityLevel:ue,startTime:de,expirationTime:j,sortIndex:-1},de>Ae?(ue.sortIndex=de,t(h,ue),r(u)===null&&ue===r(h)&&(y?(C(R),R=-1):y=!0,Oe(V,de-Ae))):(ue.sortIndex=j,t(u,ue),E||x||(E=!0,Ne(Q))),ue},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(ue){var te=_;return function(){var de=_;_=te;try{return ue.apply(this,arguments)}finally{_=de}}}})(Dy);Ly.exports=Dy;var vI=Ly.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xI=_e,Gn=vI;function Ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Fy=new Set,Jc={};function ro(e,t){dl(e,t),dl(e+"Capture",t)}function dl(e,t){for(Jc[e]=t,e=0;e<t.length;e++)Fy.add(t[e])}var Es=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ep=Object.prototype.hasOwnProperty,yI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,i1={},s1={};function EI(e){return ep.call(s1,e)?!0:ep.call(i1,e)?!1:yI.test(e)?s1[e]=!0:(i1[e]=!0,!1)}function TI(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function wI(e,t,r,n){if(t===null||typeof t>"u"||TI(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function vn(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Hr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Hr[e]=new vn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Hr[t]=new vn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Hr[e]=new vn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Hr[e]=new vn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Hr[e]=new vn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Hr[e]=new vn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Hr[e]=new vn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Hr[e]=new vn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Hr[e]=new vn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Dm=/[\-:]([a-z])/g;function Fm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Dm,Fm);Hr[t]=new vn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Dm,Fm);Hr[t]=new vn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Dm,Fm);Hr[t]=new vn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Hr[e]=new vn(e,1,!1,e.toLowerCase(),null,!1,!1)});Hr.xlinkHref=new vn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Hr[e]=new vn(e,1,!1,e.toLowerCase(),null,!0,!0)});function bm(e,t,r,n){var i=Hr.hasOwnProperty(t)?Hr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(wI(t,r,i,n)&&(r=null),n||i===null?EI(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ps=xI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ef=Symbol.for("react.element"),zo=Symbol.for("react.portal"),jo=Symbol.for("react.fragment"),Mm=Symbol.for("react.strict_mode"),tp=Symbol.for("react.profiler"),by=Symbol.for("react.provider"),My=Symbol.for("react.context"),Bm=Symbol.for("react.forward_ref"),rp=Symbol.for("react.suspense"),np=Symbol.for("react.suspense_list"),Um=Symbol.for("react.memo"),Ws=Symbol.for("react.lazy"),By=Symbol.for("react.offscreen"),a1=Symbol.iterator;function oc(e){return e===null||typeof e!="object"?null:(e=a1&&e[a1]||e["@@iterator"],typeof e=="function"?e:null)}var Yt=Object.assign,sd;function _c(e){if(sd===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);sd=t&&t[1]||""}return`
`+sd+e}var ad=!1;function od(e,t){if(!e||ad)return"";ad=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var n=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){n=h}e.call(t.prototype)}else{try{throw Error()}catch(h){n=h}e()}}catch(h){if(h&&n&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var u=`
`+i[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{ad=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?_c(e):""}function AI(e){switch(e.tag){case 5:return _c(e.type);case 16:return _c("Lazy");case 13:return _c("Suspense");case 19:return _c("SuspenseList");case 0:case 2:case 15:return e=od(e.type,!1),e;case 11:return e=od(e.type.render,!1),e;case 1:return e=od(e.type,!0),e;default:return""}}function ip(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case jo:return"Fragment";case zo:return"Portal";case tp:return"Profiler";case Mm:return"StrictMode";case rp:return"Suspense";case np:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case My:return(e.displayName||"Context")+".Consumer";case by:return(e._context.displayName||"Context")+".Provider";case Bm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Um:return t=e.displayName||null,t!==null?t:ip(e.type)||"Memo";case Ws:t=e._payload,e=e._init;try{return ip(e(t))}catch{}}return null}function SI(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ip(t);case 8:return t===Mm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function da(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Uy(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function II(e){var t=Uy(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Tf(e){e._valueTracker||(e._valueTracker=II(e))}function Vy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Uy(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ph(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sp(e,t){var r=t.checked;return Yt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function o1(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=da(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function zy(e,t){t=t.checked,t!=null&&bm(e,"checked",t,!1)}function ap(e,t){zy(e,t);var r=da(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?op(e,t.type,r):t.hasOwnProperty("defaultValue")&&op(e,t.type,da(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function l1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function op(e,t,r){(t!=="number"||ph(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var vc=Array.isArray;function tl(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+da(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function lp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ce(91));return Yt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function c1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ce(92));if(vc(r)){if(1<r.length)throw Error(Ce(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:da(r)}}function jy(e,t){var r=da(t.value),n=da(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function u1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Hy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Hy(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var wf,Wy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(wf=wf||document.createElement("div"),wf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=wf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Qc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Rc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CI=["Webkit","ms","Moz","O"];Object.keys(Rc).forEach(function(e){CI.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Rc[t]=Rc[e]})});function Gy(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Rc.hasOwnProperty(e)&&Rc[e]?(""+t).trim():t+"px"}function $y(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Gy(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var kI=Yt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function up(e,t){if(t){if(kI[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ce(62))}}function fp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hp=null;function Vm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var dp=null,rl=null,nl=null;function f1(e){if(e=Mu(e)){if(typeof dp!="function")throw Error(Ce(280));var t=e.stateNode;t&&(t=d0(t),dp(e.stateNode,e.type,t))}}function Zy(e){rl?nl?nl.push(e):nl=[e]:rl=e}function Ky(){if(rl){var e=rl,t=nl;if(nl=rl=null,f1(e),t)for(e=0;e<t.length;e++)f1(t[e])}}function Xy(e,t){return e(t)}function qy(){}var ld=!1;function Yy(e,t,r){if(ld)return e(t,r);ld=!0;try{return Xy(e,t,r)}finally{ld=!1,(rl!==null||nl!==null)&&(qy(),Ky())}}function eu(e,t){var r=e.stateNode;if(r===null)return null;var n=d0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ce(231,t,typeof r));return r}var pp=!1;if(Es)try{var lc={};Object.defineProperty(lc,"passive",{get:function(){pp=!0}}),window.addEventListener("test",lc,lc),window.removeEventListener("test",lc,lc)}catch{pp=!1}function RI(e,t,r,n,i,s,o,l,u){var h=Array.prototype.slice.call(arguments,3);try{t.apply(r,h)}catch(p){this.onError(p)}}var Pc=!1,mh=null,gh=!1,mp=null,PI={onError:function(e){Pc=!0,mh=e}};function NI(e,t,r,n,i,s,o,l,u){Pc=!1,mh=null,RI.apply(PI,arguments)}function OI(e,t,r,n,i,s,o,l,u){if(NI.apply(this,arguments),Pc){if(Pc){var h=mh;Pc=!1,mh=null}else throw Error(Ce(198));gh||(gh=!0,mp=h)}}function no(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Jy(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function h1(e){if(no(e)!==e)throw Error(Ce(188))}function LI(e){var t=e.alternate;if(!t){if(t=no(e),t===null)throw Error(Ce(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return h1(i),e;if(s===n)return h1(i),t;s=s.sibling}throw Error(Ce(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(Ce(189))}}if(r.alternate!==n)throw Error(Ce(190))}if(r.tag!==3)throw Error(Ce(188));return r.stateNode.current===r?e:t}function Qy(e){return e=LI(e),e!==null?eE(e):null}function eE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=eE(e);if(t!==null)return t;e=e.sibling}return null}var tE=Gn.unstable_scheduleCallback,d1=Gn.unstable_cancelCallback,DI=Gn.unstable_shouldYield,FI=Gn.unstable_requestPaint,lr=Gn.unstable_now,bI=Gn.unstable_getCurrentPriorityLevel,zm=Gn.unstable_ImmediatePriority,rE=Gn.unstable_UserBlockingPriority,_h=Gn.unstable_NormalPriority,MI=Gn.unstable_LowPriority,nE=Gn.unstable_IdlePriority,c0=null,$i=null;function BI(e){if($i&&typeof $i.onCommitFiberRoot=="function")try{$i.onCommitFiberRoot(c0,e,void 0,(e.current.flags&128)===128)}catch{}}var Pi=Math.clz32?Math.clz32:zI,UI=Math.log,VI=Math.LN2;function zI(e){return e>>>=0,e===0?32:31-(UI(e)/VI|0)|0}var Af=64,Sf=4194304;function xc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function vh(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=xc(l):(s&=o,s!==0&&(n=xc(s)))}else o=r&~i,o!==0?n=xc(o):s!==0&&(n=xc(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Pi(t),i=1<<r,n|=e[r],t&=~i;return n}function jI(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function HI(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Pi(s),l=1<<o,u=i[o];u===-1?(!(l&r)||l&n)&&(i[o]=jI(l,t)):u<=t&&(e.expiredLanes|=l),s&=~l}}function gp(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function iE(){var e=Af;return Af<<=1,!(Af&4194240)&&(Af=64),e}function cd(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Fu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pi(t),e[t]=r}function WI(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Pi(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function jm(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Pi(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Rt=0;function sE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var aE,Hm,oE,lE,cE,_p=!1,If=[],ta=null,ra=null,na=null,tu=new Map,ru=new Map,$s=[],GI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function p1(e,t){switch(e){case"focusin":case"focusout":ta=null;break;case"dragenter":case"dragleave":ra=null;break;case"mouseover":case"mouseout":na=null;break;case"pointerover":case"pointerout":tu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ru.delete(t.pointerId)}}function cc(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Mu(t),t!==null&&Hm(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function $I(e,t,r,n,i){switch(t){case"focusin":return ta=cc(ta,e,t,r,n,i),!0;case"dragenter":return ra=cc(ra,e,t,r,n,i),!0;case"mouseover":return na=cc(na,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return tu.set(s,cc(tu.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,ru.set(s,cc(ru.get(s)||null,e,t,r,n,i)),!0}return!1}function uE(e){var t=La(e.target);if(t!==null){var r=no(t);if(r!==null){if(t=r.tag,t===13){if(t=Jy(r),t!==null){e.blockedOn=t,cE(e.priority,function(){oE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Jf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=vp(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);hp=n,r.target.dispatchEvent(n),hp=null}else return t=Mu(r),t!==null&&Hm(t),e.blockedOn=r,!1;t.shift()}return!0}function m1(e,t,r){Jf(e)&&r.delete(t)}function ZI(){_p=!1,ta!==null&&Jf(ta)&&(ta=null),ra!==null&&Jf(ra)&&(ra=null),na!==null&&Jf(na)&&(na=null),tu.forEach(m1),ru.forEach(m1)}function uc(e,t){e.blockedOn===t&&(e.blockedOn=null,_p||(_p=!0,Gn.unstable_scheduleCallback(Gn.unstable_NormalPriority,ZI)))}function nu(e){function t(i){return uc(i,e)}if(0<If.length){uc(If[0],e);for(var r=1;r<If.length;r++){var n=If[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ta!==null&&uc(ta,e),ra!==null&&uc(ra,e),na!==null&&uc(na,e),tu.forEach(t),ru.forEach(t),r=0;r<$s.length;r++)n=$s[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<$s.length&&(r=$s[0],r.blockedOn===null);)uE(r),r.blockedOn===null&&$s.shift()}var il=Ps.ReactCurrentBatchConfig,xh=!0;function KI(e,t,r,n){var i=Rt,s=il.transition;il.transition=null;try{Rt=1,Wm(e,t,r,n)}finally{Rt=i,il.transition=s}}function XI(e,t,r,n){var i=Rt,s=il.transition;il.transition=null;try{Rt=4,Wm(e,t,r,n)}finally{Rt=i,il.transition=s}}function Wm(e,t,r,n){if(xh){var i=vp(e,t,r,n);if(i===null)xd(e,t,n,yh,r),p1(e,n);else if($I(i,e,t,r,n))n.stopPropagation();else if(p1(e,n),t&4&&-1<GI.indexOf(e)){for(;i!==null;){var s=Mu(i);if(s!==null&&aE(s),s=vp(e,t,r,n),s===null&&xd(e,t,n,yh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else xd(e,t,n,null,r)}}var yh=null;function vp(e,t,r,n){if(yh=null,e=Vm(n),e=La(e),e!==null)if(t=no(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Jy(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return yh=e,null}function fE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bI()){case zm:return 1;case rE:return 4;case _h:case MI:return 16;case nE:return 536870912;default:return 16}default:return 16}}var Xs=null,Gm=null,Qf=null;function hE(){if(Qf)return Qf;var e,t=Gm,r=t.length,n,i="value"in Xs?Xs.value:Xs.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return Qf=i.slice(e,1<n?1-n:void 0)}function eh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Cf(){return!0}function g1(){return!1}function Kn(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Cf:g1,this.isPropagationStopped=g1,this}return Yt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Cf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Cf)},persist:function(){},isPersistent:Cf}),t}var Pl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$m=Kn(Pl),bu=Yt({},Pl,{view:0,detail:0}),qI=Kn(bu),ud,fd,fc,u0=Yt({},bu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fc&&(fc&&e.type==="mousemove"?(ud=e.screenX-fc.screenX,fd=e.screenY-fc.screenY):fd=ud=0,fc=e),ud)},movementY:function(e){return"movementY"in e?e.movementY:fd}}),_1=Kn(u0),YI=Yt({},u0,{dataTransfer:0}),JI=Kn(YI),QI=Yt({},bu,{relatedTarget:0}),hd=Kn(QI),eC=Yt({},Pl,{animationName:0,elapsedTime:0,pseudoElement:0}),tC=Kn(eC),rC=Yt({},Pl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),nC=Kn(rC),iC=Yt({},Pl,{data:0}),v1=Kn(iC),sC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lC(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=oC[e])?!!t[e]:!1}function Zm(){return lC}var cC=Yt({},bu,{key:function(e){if(e.key){var t=sC[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=eh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?aC[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zm,charCode:function(e){return e.type==="keypress"?eh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?eh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),uC=Kn(cC),fC=Yt({},u0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),x1=Kn(fC),hC=Yt({},bu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zm}),dC=Kn(hC),pC=Yt({},Pl,{propertyName:0,elapsedTime:0,pseudoElement:0}),mC=Kn(pC),gC=Yt({},u0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),_C=Kn(gC),vC=[9,13,27,32],Km=Es&&"CompositionEvent"in window,Nc=null;Es&&"documentMode"in document&&(Nc=document.documentMode);var xC=Es&&"TextEvent"in window&&!Nc,dE=Es&&(!Km||Nc&&8<Nc&&11>=Nc),y1=" ",E1=!1;function pE(e,t){switch(e){case"keyup":return vC.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ho=!1;function yC(e,t){switch(e){case"compositionend":return mE(t);case"keypress":return t.which!==32?null:(E1=!0,y1);case"textInput":return e=t.data,e===y1&&E1?null:e;default:return null}}function EC(e,t){if(Ho)return e==="compositionend"||!Km&&pE(e,t)?(e=hE(),Qf=Gm=Xs=null,Ho=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dE&&t.locale!=="ko"?null:t.data;default:return null}}var TC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function T1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!TC[e.type]:t==="textarea"}function gE(e,t,r,n){Zy(n),t=Eh(t,"onChange"),0<t.length&&(r=new $m("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Oc=null,iu=null;function wC(e){CE(e,0)}function f0(e){var t=$o(e);if(Vy(t))return e}function AC(e,t){if(e==="change")return t}var _E=!1;if(Es){var dd;if(Es){var pd="oninput"in document;if(!pd){var w1=document.createElement("div");w1.setAttribute("oninput","return;"),pd=typeof w1.oninput=="function"}dd=pd}else dd=!1;_E=dd&&(!document.documentMode||9<document.documentMode)}function A1(){Oc&&(Oc.detachEvent("onpropertychange",vE),iu=Oc=null)}function vE(e){if(e.propertyName==="value"&&f0(iu)){var t=[];gE(t,iu,e,Vm(e)),Yy(wC,t)}}function SC(e,t,r){e==="focusin"?(A1(),Oc=t,iu=r,Oc.attachEvent("onpropertychange",vE)):e==="focusout"&&A1()}function IC(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return f0(iu)}function CC(e,t){if(e==="click")return f0(t)}function kC(e,t){if(e==="input"||e==="change")return f0(t)}function RC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Li=typeof Object.is=="function"?Object.is:RC;function su(e,t){if(Li(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ep.call(t,i)||!Li(e[i],t[i]))return!1}return!0}function S1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function I1(e,t){var r=S1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=S1(r)}}function xE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?xE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function yE(){for(var e=window,t=ph();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ph(e.document)}return t}function Xm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function PC(e){var t=yE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&xE(r.ownerDocument.documentElement,r)){if(n!==null&&Xm(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=I1(r,s);var o=I1(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var NC=Es&&"documentMode"in document&&11>=document.documentMode,Wo=null,xp=null,Lc=null,yp=!1;function C1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;yp||Wo==null||Wo!==ph(n)||(n=Wo,"selectionStart"in n&&Xm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Lc&&su(Lc,n)||(Lc=n,n=Eh(xp,"onSelect"),0<n.length&&(t=new $m("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Wo)))}function kf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Go={animationend:kf("Animation","AnimationEnd"),animationiteration:kf("Animation","AnimationIteration"),animationstart:kf("Animation","AnimationStart"),transitionend:kf("Transition","TransitionEnd")},md={},EE={};Es&&(EE=document.createElement("div").style,"AnimationEvent"in window||(delete Go.animationend.animation,delete Go.animationiteration.animation,delete Go.animationstart.animation),"TransitionEvent"in window||delete Go.transitionend.transition);function h0(e){if(md[e])return md[e];if(!Go[e])return e;var t=Go[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in EE)return md[e]=t[r];return e}var TE=h0("animationend"),wE=h0("animationiteration"),AE=h0("animationstart"),SE=h0("transitionend"),IE=new Map,k1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ea(e,t){IE.set(e,t),ro(t,[e])}for(var gd=0;gd<k1.length;gd++){var _d=k1[gd],OC=_d.toLowerCase(),LC=_d[0].toUpperCase()+_d.slice(1);Ea(OC,"on"+LC)}Ea(TE,"onAnimationEnd");Ea(wE,"onAnimationIteration");Ea(AE,"onAnimationStart");Ea("dblclick","onDoubleClick");Ea("focusin","onFocus");Ea("focusout","onBlur");Ea(SE,"onTransitionEnd");dl("onMouseEnter",["mouseout","mouseover"]);dl("onMouseLeave",["mouseout","mouseover"]);dl("onPointerEnter",["pointerout","pointerover"]);dl("onPointerLeave",["pointerout","pointerover"]);ro("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ro("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ro("onBeforeInput",["compositionend","keypress","textInput","paste"]);ro("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DC=new Set("cancel close invalid load scroll toggle".split(" ").concat(yc));function R1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,OI(n,t,void 0,e),e.currentTarget=null}function CE(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==s&&i.isPropagationStopped())break e;R1(i,l,h),s=u}else for(o=0;o<n.length;o++){if(l=n[o],u=l.instance,h=l.currentTarget,l=l.listener,u!==s&&i.isPropagationStopped())break e;R1(i,l,h),s=u}}}if(gh)throw e=mp,gh=!1,mp=null,e}function Vt(e,t){var r=t[Sp];r===void 0&&(r=t[Sp]=new Set);var n=e+"__bubble";r.has(n)||(kE(t,e,2,!1),r.add(n))}function vd(e,t,r){var n=0;t&&(n|=4),kE(r,e,n,t)}var Rf="_reactListening"+Math.random().toString(36).slice(2);function au(e){if(!e[Rf]){e[Rf]=!0,Fy.forEach(function(r){r!=="selectionchange"&&(DC.has(r)||vd(r,!1,e),vd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Rf]||(t[Rf]=!0,vd("selectionchange",!1,t))}}function kE(e,t,r,n){switch(fE(t)){case 1:var i=KI;break;case 4:i=XI;break;default:i=Wm}r=i.bind(null,t,r,e),i=void 0,!pp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function xd(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;l!==null;){if(o=La(l),o===null)return;if(u=o.tag,u===5||u===6){n=s=o;continue e}l=l.parentNode}}n=n.return}Yy(function(){var h=s,p=Vm(r),m=[];e:{var _=IE.get(e);if(_!==void 0){var x=$m,E=e;switch(e){case"keypress":if(eh(r)===0)break e;case"keydown":case"keyup":x=uC;break;case"focusin":E="focus",x=hd;break;case"focusout":E="blur",x=hd;break;case"beforeblur":case"afterblur":x=hd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=_1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=JI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=dC;break;case TE:case wE:case AE:x=tC;break;case SE:x=mC;break;case"scroll":x=qI;break;case"wheel":x=_C;break;case"copy":case"cut":case"paste":x=nC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=x1}var y=(t&4)!==0,A=!y&&e==="scroll",C=y?_!==null?_+"Capture":null:_;y=[];for(var k=h,w;k!==null;){w=k;var V=w.stateNode;if(w.tag===5&&V!==null&&(w=V,C!==null&&(V=eu(k,C),V!=null&&y.push(ou(k,V,w)))),A)break;k=k.return}0<y.length&&(_=new x(_,E,null,r,p),m.push({event:_,listeners:y}))}}if(!(t&7)){e:{if(_=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",_&&r!==hp&&(E=r.relatedTarget||r.fromElement)&&(La(E)||E[Ts]))break e;if((x||_)&&(_=p.window===p?p:(_=p.ownerDocument)?_.defaultView||_.parentWindow:window,x?(E=r.relatedTarget||r.toElement,x=h,E=E?La(E):null,E!==null&&(A=no(E),E!==A||E.tag!==5&&E.tag!==6)&&(E=null)):(x=null,E=h),x!==E)){if(y=_1,V="onMouseLeave",C="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(y=x1,V="onPointerLeave",C="onPointerEnter",k="pointer"),A=x==null?_:$o(x),w=E==null?_:$o(E),_=new y(V,k+"leave",x,r,p),_.target=A,_.relatedTarget=w,V=null,La(p)===h&&(y=new y(C,k+"enter",E,r,p),y.target=w,y.relatedTarget=A,V=y),A=V,x&&E)t:{for(y=x,C=E,k=0,w=y;w;w=Do(w))k++;for(w=0,V=C;V;V=Do(V))w++;for(;0<k-w;)y=Do(y),k--;for(;0<w-k;)C=Do(C),w--;for(;k--;){if(y===C||C!==null&&y===C.alternate)break t;y=Do(y),C=Do(C)}y=null}else y=null;x!==null&&P1(m,_,x,y,!1),E!==null&&A!==null&&P1(m,A,E,y,!0)}}e:{if(_=h?$o(h):window,x=_.nodeName&&_.nodeName.toLowerCase(),x==="select"||x==="input"&&_.type==="file")var Q=AC;else if(T1(_))if(_E)Q=kC;else{Q=IC;var X=SC}else(x=_.nodeName)&&x.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(Q=CC);if(Q&&(Q=Q(e,h))){gE(m,Q,r,p);break e}X&&X(e,_,h),e==="focusout"&&(X=_._wrapperState)&&X.controlled&&_.type==="number"&&op(_,"number",_.value)}switch(X=h?$o(h):window,e){case"focusin":(T1(X)||X.contentEditable==="true")&&(Wo=X,xp=h,Lc=null);break;case"focusout":Lc=xp=Wo=null;break;case"mousedown":yp=!0;break;case"contextmenu":case"mouseup":case"dragend":yp=!1,C1(m,r,p);break;case"selectionchange":if(NC)break;case"keydown":case"keyup":C1(m,r,p)}var S;if(Km)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Ho?pE(e,r)&&(R="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(R="onCompositionStart");R&&(dE&&r.locale!=="ko"&&(Ho||R!=="onCompositionStart"?R==="onCompositionEnd"&&Ho&&(S=hE()):(Xs=p,Gm="value"in Xs?Xs.value:Xs.textContent,Ho=!0)),X=Eh(h,R),0<X.length&&(R=new v1(R,e,null,r,p),m.push({event:R,listeners:X}),S?R.data=S:(S=mE(r),S!==null&&(R.data=S)))),(S=xC?yC(e,r):EC(e,r))&&(h=Eh(h,"onBeforeInput"),0<h.length&&(p=new v1("onBeforeInput","beforeinput",null,r,p),m.push({event:p,listeners:h}),p.data=S))}CE(m,t)})}function ou(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Eh(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=eu(e,r),s!=null&&n.unshift(ou(e,s,i)),s=eu(e,t),s!=null&&n.push(ou(e,s,i))),e=e.return}return n}function Do(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function P1(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,u=l.alternate,h=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&h!==null&&(l=h,i?(u=eu(r,s),u!=null&&o.unshift(ou(r,u,l))):i||(u=eu(r,s),u!=null&&o.push(ou(r,u,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var FC=/\r\n?/g,bC=/\u0000|\uFFFD/g;function N1(e){return(typeof e=="string"?e:""+e).replace(FC,`
`).replace(bC,"")}function Pf(e,t,r){if(t=N1(t),N1(e)!==t&&r)throw Error(Ce(425))}function Th(){}var Ep=null,Tp=null;function wp(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ap=typeof setTimeout=="function"?setTimeout:void 0,MC=typeof clearTimeout=="function"?clearTimeout:void 0,O1=typeof Promise=="function"?Promise:void 0,BC=typeof queueMicrotask=="function"?queueMicrotask:typeof O1<"u"?function(e){return O1.resolve(null).then(e).catch(UC)}:Ap;function UC(e){setTimeout(function(){throw e})}function yd(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),nu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);nu(t)}function ia(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function L1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Nl=Math.random().toString(36).slice(2),Gi="__reactFiber$"+Nl,lu="__reactProps$"+Nl,Ts="__reactContainer$"+Nl,Sp="__reactEvents$"+Nl,VC="__reactListeners$"+Nl,zC="__reactHandles$"+Nl;function La(e){var t=e[Gi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ts]||r[Gi]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=L1(e);e!==null;){if(r=e[Gi])return r;e=L1(e)}return t}e=r,r=e.parentNode}return null}function Mu(e){return e=e[Gi]||e[Ts],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function $o(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ce(33))}function d0(e){return e[lu]||null}var Ip=[],Zo=-1;function Ta(e){return{current:e}}function zt(e){0>Zo||(e.current=Ip[Zo],Ip[Zo]=null,Zo--)}function Bt(e,t){Zo++,Ip[Zo]=e.current,e.current=t}var pa={},rn=Ta(pa),Cn=Ta(!1),Ga=pa;function pl(e,t){var r=e.type.contextTypes;if(!r)return pa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function kn(e){return e=e.childContextTypes,e!=null}function wh(){zt(Cn),zt(rn)}function D1(e,t,r){if(rn.current!==pa)throw Error(Ce(168));Bt(rn,t),Bt(Cn,r)}function RE(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Ce(108,SI(e)||"Unknown",i));return Yt({},r,n)}function Ah(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||pa,Ga=rn.current,Bt(rn,e),Bt(Cn,Cn.current),!0}function F1(e,t,r){var n=e.stateNode;if(!n)throw Error(Ce(169));r?(e=RE(e,t,Ga),n.__reactInternalMemoizedMergedChildContext=e,zt(Cn),zt(rn),Bt(rn,e)):zt(Cn),Bt(Cn,r)}var hs=null,p0=!1,Ed=!1;function PE(e){hs===null?hs=[e]:hs.push(e)}function jC(e){p0=!0,PE(e)}function wa(){if(!Ed&&hs!==null){Ed=!0;var e=0,t=Rt;try{var r=hs;for(Rt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}hs=null,p0=!1}catch(i){throw hs!==null&&(hs=hs.slice(e+1)),tE(zm,wa),i}finally{Rt=t,Ed=!1}}return null}var Ko=[],Xo=0,Sh=null,Ih=0,ai=[],oi=0,$a=null,ps=1,ms="";function Ra(e,t){Ko[Xo++]=Ih,Ko[Xo++]=Sh,Sh=e,Ih=t}function NE(e,t,r){ai[oi++]=ps,ai[oi++]=ms,ai[oi++]=$a,$a=e;var n=ps;e=ms;var i=32-Pi(n)-1;n&=~(1<<i),r+=1;var s=32-Pi(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,ps=1<<32-Pi(t)+i|r<<i|n,ms=s+e}else ps=1<<s|r<<i|n,ms=e}function qm(e){e.return!==null&&(Ra(e,1),NE(e,1,0))}function Ym(e){for(;e===Sh;)Sh=Ko[--Xo],Ko[Xo]=null,Ih=Ko[--Xo],Ko[Xo]=null;for(;e===$a;)$a=ai[--oi],ai[oi]=null,ms=ai[--oi],ai[oi]=null,ps=ai[--oi],ai[oi]=null}var Hn=null,zn=null,Gt=!1,Ii=null;function OE(e,t){var r=li(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function b1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Hn=e,zn=ia(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Hn=e,zn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=$a!==null?{id:ps,overflow:ms}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=li(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Hn=e,zn=null,!0):!1;default:return!1}}function Cp(e){return(e.mode&1)!==0&&(e.flags&128)===0}function kp(e){if(Gt){var t=zn;if(t){var r=t;if(!b1(e,t)){if(Cp(e))throw Error(Ce(418));t=ia(r.nextSibling);var n=Hn;t&&b1(e,t)?OE(n,r):(e.flags=e.flags&-4097|2,Gt=!1,Hn=e)}}else{if(Cp(e))throw Error(Ce(418));e.flags=e.flags&-4097|2,Gt=!1,Hn=e}}}function M1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Hn=e}function Nf(e){if(e!==Hn)return!1;if(!Gt)return M1(e),Gt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!wp(e.type,e.memoizedProps)),t&&(t=zn)){if(Cp(e))throw LE(),Error(Ce(418));for(;t;)OE(e,t),t=ia(t.nextSibling)}if(M1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){zn=ia(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}zn=null}}else zn=Hn?ia(e.stateNode.nextSibling):null;return!0}function LE(){for(var e=zn;e;)e=ia(e.nextSibling)}function ml(){zn=Hn=null,Gt=!1}function Jm(e){Ii===null?Ii=[e]:Ii.push(e)}var HC=Ps.ReactCurrentBatchConfig;function hc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ce(309));var n=r.stateNode}if(!n)throw Error(Ce(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Ce(284));if(!r._owner)throw Error(Ce(290,e))}return e}function Of(e,t){throw e=Object.prototype.toString.call(t),Error(Ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function B1(e){var t=e._init;return t(e._payload)}function DE(e){function t(C,k){if(e){var w=C.deletions;w===null?(C.deletions=[k],C.flags|=16):w.push(k)}}function r(C,k){if(!e)return null;for(;k!==null;)t(C,k),k=k.sibling;return null}function n(C,k){for(C=new Map;k!==null;)k.key!==null?C.set(k.key,k):C.set(k.index,k),k=k.sibling;return C}function i(C,k){return C=la(C,k),C.index=0,C.sibling=null,C}function s(C,k,w){return C.index=w,e?(w=C.alternate,w!==null?(w=w.index,w<k?(C.flags|=2,k):w):(C.flags|=2,k)):(C.flags|=1048576,k)}function o(C){return e&&C.alternate===null&&(C.flags|=2),C}function l(C,k,w,V){return k===null||k.tag!==6?(k=kd(w,C.mode,V),k.return=C,k):(k=i(k,w),k.return=C,k)}function u(C,k,w,V){var Q=w.type;return Q===jo?p(C,k,w.props.children,V,w.key):k!==null&&(k.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===Ws&&B1(Q)===k.type)?(V=i(k,w.props),V.ref=hc(C,k,w),V.return=C,V):(V=oh(w.type,w.key,w.props,null,C.mode,V),V.ref=hc(C,k,w),V.return=C,V)}function h(C,k,w,V){return k===null||k.tag!==4||k.stateNode.containerInfo!==w.containerInfo||k.stateNode.implementation!==w.implementation?(k=Rd(w,C.mode,V),k.return=C,k):(k=i(k,w.children||[]),k.return=C,k)}function p(C,k,w,V,Q){return k===null||k.tag!==7?(k=Ua(w,C.mode,V,Q),k.return=C,k):(k=i(k,w),k.return=C,k)}function m(C,k,w){if(typeof k=="string"&&k!==""||typeof k=="number")return k=kd(""+k,C.mode,w),k.return=C,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Ef:return w=oh(k.type,k.key,k.props,null,C.mode,w),w.ref=hc(C,null,k),w.return=C,w;case zo:return k=Rd(k,C.mode,w),k.return=C,k;case Ws:var V=k._init;return m(C,V(k._payload),w)}if(vc(k)||oc(k))return k=Ua(k,C.mode,w,null),k.return=C,k;Of(C,k)}return null}function _(C,k,w,V){var Q=k!==null?k.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return Q!==null?null:l(C,k,""+w,V);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ef:return w.key===Q?u(C,k,w,V):null;case zo:return w.key===Q?h(C,k,w,V):null;case Ws:return Q=w._init,_(C,k,Q(w._payload),V)}if(vc(w)||oc(w))return Q!==null?null:p(C,k,w,V,null);Of(C,w)}return null}function x(C,k,w,V,Q){if(typeof V=="string"&&V!==""||typeof V=="number")return C=C.get(w)||null,l(k,C,""+V,Q);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Ef:return C=C.get(V.key===null?w:V.key)||null,u(k,C,V,Q);case zo:return C=C.get(V.key===null?w:V.key)||null,h(k,C,V,Q);case Ws:var X=V._init;return x(C,k,w,X(V._payload),Q)}if(vc(V)||oc(V))return C=C.get(w)||null,p(k,C,V,Q,null);Of(k,V)}return null}function E(C,k,w,V){for(var Q=null,X=null,S=k,R=k=0,P=null;S!==null&&R<w.length;R++){S.index>R?(P=S,S=null):P=S.sibling;var D=_(C,S,w[R],V);if(D===null){S===null&&(S=P);break}e&&S&&D.alternate===null&&t(C,S),k=s(D,k,R),X===null?Q=D:X.sibling=D,X=D,S=P}if(R===w.length)return r(C,S),Gt&&Ra(C,R),Q;if(S===null){for(;R<w.length;R++)S=m(C,w[R],V),S!==null&&(k=s(S,k,R),X===null?Q=S:X.sibling=S,X=S);return Gt&&Ra(C,R),Q}for(S=n(C,S);R<w.length;R++)P=x(S,C,R,w[R],V),P!==null&&(e&&P.alternate!==null&&S.delete(P.key===null?R:P.key),k=s(P,k,R),X===null?Q=P:X.sibling=P,X=P);return e&&S.forEach(function(F){return t(C,F)}),Gt&&Ra(C,R),Q}function y(C,k,w,V){var Q=oc(w);if(typeof Q!="function")throw Error(Ce(150));if(w=Q.call(w),w==null)throw Error(Ce(151));for(var X=Q=null,S=k,R=k=0,P=null,D=w.next();S!==null&&!D.done;R++,D=w.next()){S.index>R?(P=S,S=null):P=S.sibling;var F=_(C,S,D.value,V);if(F===null){S===null&&(S=P);break}e&&S&&F.alternate===null&&t(C,S),k=s(F,k,R),X===null?Q=F:X.sibling=F,X=F,S=P}if(D.done)return r(C,S),Gt&&Ra(C,R),Q;if(S===null){for(;!D.done;R++,D=w.next())D=m(C,D.value,V),D!==null&&(k=s(D,k,R),X===null?Q=D:X.sibling=D,X=D);return Gt&&Ra(C,R),Q}for(S=n(C,S);!D.done;R++,D=w.next())D=x(S,C,R,D.value,V),D!==null&&(e&&D.alternate!==null&&S.delete(D.key===null?R:D.key),k=s(D,k,R),X===null?Q=D:X.sibling=D,X=D);return e&&S.forEach(function(b){return t(C,b)}),Gt&&Ra(C,R),Q}function A(C,k,w,V){if(typeof w=="object"&&w!==null&&w.type===jo&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Ef:e:{for(var Q=w.key,X=k;X!==null;){if(X.key===Q){if(Q=w.type,Q===jo){if(X.tag===7){r(C,X.sibling),k=i(X,w.props.children),k.return=C,C=k;break e}}else if(X.elementType===Q||typeof Q=="object"&&Q!==null&&Q.$$typeof===Ws&&B1(Q)===X.type){r(C,X.sibling),k=i(X,w.props),k.ref=hc(C,X,w),k.return=C,C=k;break e}r(C,X);break}else t(C,X);X=X.sibling}w.type===jo?(k=Ua(w.props.children,C.mode,V,w.key),k.return=C,C=k):(V=oh(w.type,w.key,w.props,null,C.mode,V),V.ref=hc(C,k,w),V.return=C,C=V)}return o(C);case zo:e:{for(X=w.key;k!==null;){if(k.key===X)if(k.tag===4&&k.stateNode.containerInfo===w.containerInfo&&k.stateNode.implementation===w.implementation){r(C,k.sibling),k=i(k,w.children||[]),k.return=C,C=k;break e}else{r(C,k);break}else t(C,k);k=k.sibling}k=Rd(w,C.mode,V),k.return=C,C=k}return o(C);case Ws:return X=w._init,A(C,k,X(w._payload),V)}if(vc(w))return E(C,k,w,V);if(oc(w))return y(C,k,w,V);Of(C,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,k!==null&&k.tag===6?(r(C,k.sibling),k=i(k,w),k.return=C,C=k):(r(C,k),k=kd(w,C.mode,V),k.return=C,C=k),o(C)):r(C,k)}return A}var gl=DE(!0),FE=DE(!1),Ch=Ta(null),kh=null,qo=null,Qm=null;function eg(){Qm=qo=kh=null}function tg(e){var t=Ch.current;zt(Ch),e._currentValue=t}function Rp(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function sl(e,t){kh=e,Qm=qo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(In=!0),e.firstContext=null)}function fi(e){var t=e._currentValue;if(Qm!==e)if(e={context:e,memoizedValue:t,next:null},qo===null){if(kh===null)throw Error(Ce(308));qo=e,kh.dependencies={lanes:0,firstContext:e}}else qo=qo.next=e;return t}var Da=null;function rg(e){Da===null?Da=[e]:Da.push(e)}function bE(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,rg(t)):(r.next=i.next,i.next=r),t.interleaved=r,ws(e,n)}function ws(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Gs=!1;function ng(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ME(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function _s(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function sa(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Tt&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,ws(e,r)}return i=n.interleaved,i===null?(t.next=t,rg(n)):(t.next=i.next,i.next=t),n.interleaved=t,ws(e,r)}function th(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,jm(e,r)}}function U1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Rh(e,t,r,n){var i=e.updateQueue;Gs=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,h=u.next;u.next=null,o===null?s=h:o.next=h,o=u;var p=e.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==o&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(s!==null){var m=i.baseState;o=0,p=h=u=null,l=s;do{var _=l.lane,x=l.eventTime;if((n&_)===_){p!==null&&(p=p.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var E=e,y=l;switch(_=t,x=r,y.tag){case 1:if(E=y.payload,typeof E=="function"){m=E.call(x,m,_);break e}m=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=y.payload,_=typeof E=="function"?E.call(x,m,_):E,_==null)break e;m=Yt({},m,_);break e;case 2:Gs=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,_=i.effects,_===null?i.effects=[l]:_.push(l))}else x={eventTime:x,lane:_,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=x,u=m):p=p.next=x,o|=_;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;_=l,l=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(p===null&&(u=m),i.baseState=u,i.firstBaseUpdate=h,i.lastBaseUpdate=p,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Ka|=o,e.lanes=o,e.memoizedState=m}}function V1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Ce(191,i));i.call(n)}}}var Bu={},Zi=Ta(Bu),cu=Ta(Bu),uu=Ta(Bu);function Fa(e){if(e===Bu)throw Error(Ce(174));return e}function ig(e,t){switch(Bt(uu,t),Bt(cu,e),Bt(Zi,Bu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:cp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=cp(t,e)}zt(Zi),Bt(Zi,t)}function _l(){zt(Zi),zt(cu),zt(uu)}function BE(e){Fa(uu.current);var t=Fa(Zi.current),r=cp(t,e.type);t!==r&&(Bt(cu,e),Bt(Zi,r))}function sg(e){cu.current===e&&(zt(Zi),zt(cu))}var Xt=Ta(0);function Ph(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Td=[];function ag(){for(var e=0;e<Td.length;e++)Td[e]._workInProgressVersionPrimary=null;Td.length=0}var rh=Ps.ReactCurrentDispatcher,wd=Ps.ReactCurrentBatchConfig,Za=0,qt=null,xr=null,Nr=null,Nh=!1,Dc=!1,fu=0,WC=0;function Gr(){throw Error(Ce(321))}function og(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Li(e[r],t[r]))return!1;return!0}function lg(e,t,r,n,i,s){if(Za=s,qt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rh.current=e===null||e.memoizedState===null?KC:XC,e=r(n,i),Dc){s=0;do{if(Dc=!1,fu=0,25<=s)throw Error(Ce(301));s+=1,Nr=xr=null,t.updateQueue=null,rh.current=qC,e=r(n,i)}while(Dc)}if(rh.current=Oh,t=xr!==null&&xr.next!==null,Za=0,Nr=xr=qt=null,Nh=!1,t)throw Error(Ce(300));return e}function cg(){var e=fu!==0;return fu=0,e}function Wi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nr===null?qt.memoizedState=Nr=e:Nr=Nr.next=e,Nr}function hi(){if(xr===null){var e=qt.alternate;e=e!==null?e.memoizedState:null}else e=xr.next;var t=Nr===null?qt.memoizedState:Nr.next;if(t!==null)Nr=t,xr=e;else{if(e===null)throw Error(Ce(310));xr=e,e={memoizedState:xr.memoizedState,baseState:xr.baseState,baseQueue:xr.baseQueue,queue:xr.queue,next:null},Nr===null?qt.memoizedState=Nr=e:Nr=Nr.next=e}return Nr}function hu(e,t){return typeof t=="function"?t(e):t}function Ad(e){var t=hi(),r=t.queue;if(r===null)throw Error(Ce(311));r.lastRenderedReducer=e;var n=xr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,u=null,h=s;do{var p=h.lane;if((Za&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),n=h.hasEagerState?h.eagerState:e(n,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=m,o=n):u=u.next=m,qt.lanes|=p,Ka|=p}h=h.next}while(h!==null&&h!==s);u===null?o=n:u.next=l,Li(n,t.memoizedState)||(In=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,qt.lanes|=s,Ka|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Sd(e){var t=hi(),r=t.queue;if(r===null)throw Error(Ce(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Li(s,t.memoizedState)||(In=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function UE(){}function VE(e,t){var r=qt,n=hi(),i=t(),s=!Li(n.memoizedState,i);if(s&&(n.memoizedState=i,In=!0),n=n.queue,ug(HE.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Nr!==null&&Nr.memoizedState.tag&1){if(r.flags|=2048,du(9,jE.bind(null,r,n,i,t),void 0,null),Or===null)throw Error(Ce(349));Za&30||zE(r,t,i)}return i}function zE(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=qt.updateQueue,t===null?(t={lastEffect:null,stores:null},qt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function jE(e,t,r,n){t.value=r,t.getSnapshot=n,WE(t)&&GE(e)}function HE(e,t,r){return r(function(){WE(t)&&GE(e)})}function WE(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Li(e,r)}catch{return!0}}function GE(e){var t=ws(e,1);t!==null&&Ni(t,e,1,-1)}function z1(e){var t=Wi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hu,lastRenderedState:e},t.queue=e,e=e.dispatch=ZC.bind(null,qt,e),[t.memoizedState,e]}function du(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=qt.updateQueue,t===null?(t={lastEffect:null,stores:null},qt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function $E(){return hi().memoizedState}function nh(e,t,r,n){var i=Wi();qt.flags|=e,i.memoizedState=du(1|t,r,void 0,n===void 0?null:n)}function m0(e,t,r,n){var i=hi();n=n===void 0?null:n;var s=void 0;if(xr!==null){var o=xr.memoizedState;if(s=o.destroy,n!==null&&og(n,o.deps)){i.memoizedState=du(t,r,s,n);return}}qt.flags|=e,i.memoizedState=du(1|t,r,s,n)}function j1(e,t){return nh(8390656,8,e,t)}function ug(e,t){return m0(2048,8,e,t)}function ZE(e,t){return m0(4,2,e,t)}function KE(e,t){return m0(4,4,e,t)}function XE(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function qE(e,t,r){return r=r!=null?r.concat([e]):null,m0(4,4,XE.bind(null,t,e),r)}function fg(){}function YE(e,t){var r=hi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&og(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function JE(e,t){var r=hi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&og(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function QE(e,t,r){return Za&21?(Li(r,t)||(r=iE(),qt.lanes|=r,Ka|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,In=!0),e.memoizedState=r)}function GC(e,t){var r=Rt;Rt=r!==0&&4>r?r:4,e(!0);var n=wd.transition;wd.transition={};try{e(!1),t()}finally{Rt=r,wd.transition=n}}function e2(){return hi().memoizedState}function $C(e,t,r){var n=oa(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},t2(e))r2(t,r);else if(r=bE(e,t,r,n),r!==null){var i=pn();Ni(r,e,n,i),n2(r,t,n)}}function ZC(e,t,r){var n=oa(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(t2(e))r2(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,Li(l,o)){var u=t.interleaved;u===null?(i.next=i,rg(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}r=bE(e,t,i,n),r!==null&&(i=pn(),Ni(r,e,n,i),n2(r,t,n))}}function t2(e){var t=e.alternate;return e===qt||t!==null&&t===qt}function r2(e,t){Dc=Nh=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function n2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,jm(e,r)}}var Oh={readContext:fi,useCallback:Gr,useContext:Gr,useEffect:Gr,useImperativeHandle:Gr,useInsertionEffect:Gr,useLayoutEffect:Gr,useMemo:Gr,useReducer:Gr,useRef:Gr,useState:Gr,useDebugValue:Gr,useDeferredValue:Gr,useTransition:Gr,useMutableSource:Gr,useSyncExternalStore:Gr,useId:Gr,unstable_isNewReconciler:!1},KC={readContext:fi,useCallback:function(e,t){return Wi().memoizedState=[e,t===void 0?null:t],e},useContext:fi,useEffect:j1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,nh(4194308,4,XE.bind(null,t,e),r)},useLayoutEffect:function(e,t){return nh(4194308,4,e,t)},useInsertionEffect:function(e,t){return nh(4,2,e,t)},useMemo:function(e,t){var r=Wi();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Wi();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=$C.bind(null,qt,e),[n.memoizedState,e]},useRef:function(e){var t=Wi();return e={current:e},t.memoizedState=e},useState:z1,useDebugValue:fg,useDeferredValue:function(e){return Wi().memoizedState=e},useTransition:function(){var e=z1(!1),t=e[0];return e=GC.bind(null,e[1]),Wi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=qt,i=Wi();if(Gt){if(r===void 0)throw Error(Ce(407));r=r()}else{if(r=t(),Or===null)throw Error(Ce(349));Za&30||zE(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,j1(HE.bind(null,n,s,e),[e]),n.flags|=2048,du(9,jE.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Wi(),t=Or.identifierPrefix;if(Gt){var r=ms,n=ps;r=(n&~(1<<32-Pi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=fu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=WC++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},XC={readContext:fi,useCallback:YE,useContext:fi,useEffect:ug,useImperativeHandle:qE,useInsertionEffect:ZE,useLayoutEffect:KE,useMemo:JE,useReducer:Ad,useRef:$E,useState:function(){return Ad(hu)},useDebugValue:fg,useDeferredValue:function(e){var t=hi();return QE(t,xr.memoizedState,e)},useTransition:function(){var e=Ad(hu)[0],t=hi().memoizedState;return[e,t]},useMutableSource:UE,useSyncExternalStore:VE,useId:e2,unstable_isNewReconciler:!1},qC={readContext:fi,useCallback:YE,useContext:fi,useEffect:ug,useImperativeHandle:qE,useInsertionEffect:ZE,useLayoutEffect:KE,useMemo:JE,useReducer:Sd,useRef:$E,useState:function(){return Sd(hu)},useDebugValue:fg,useDeferredValue:function(e){var t=hi();return xr===null?t.memoizedState=e:QE(t,xr.memoizedState,e)},useTransition:function(){var e=Sd(hu)[0],t=hi().memoizedState;return[e,t]},useMutableSource:UE,useSyncExternalStore:VE,useId:e2,unstable_isNewReconciler:!1};function Ai(e,t){if(e&&e.defaultProps){t=Yt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Pp(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Yt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var g0={isMounted:function(e){return(e=e._reactInternals)?no(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=pn(),i=oa(e),s=_s(n,i);s.payload=t,r!=null&&(s.callback=r),t=sa(e,s,i),t!==null&&(Ni(t,e,i,n),th(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=pn(),i=oa(e),s=_s(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=sa(e,s,i),t!==null&&(Ni(t,e,i,n),th(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=pn(),n=oa(e),i=_s(r,n);i.tag=2,t!=null&&(i.callback=t),t=sa(e,i,n),t!==null&&(Ni(t,e,n,r),th(t,e,n))}};function H1(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!su(r,n)||!su(i,s):!0}function i2(e,t,r){var n=!1,i=pa,s=t.contextType;return typeof s=="object"&&s!==null?s=fi(s):(i=kn(t)?Ga:rn.current,n=t.contextTypes,s=(n=n!=null)?pl(e,i):pa),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=g0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function W1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&g0.enqueueReplaceState(t,t.state,null)}function Np(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},ng(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=fi(s):(s=kn(t)?Ga:rn.current,i.context=pl(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Pp(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&g0.enqueueReplaceState(i,i.state,null),Rh(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function vl(e,t){try{var r="",n=t;do r+=AI(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Id(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Op(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var YC=typeof WeakMap=="function"?WeakMap:Map;function s2(e,t,r){r=_s(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Dh||(Dh=!0,jp=n),Op(e,t)},r}function a2(e,t,r){r=_s(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Op(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Op(e,t),typeof n!="function"&&(aa===null?aa=new Set([this]):aa.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function G1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new YC;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=fk.bind(null,e,t,r),t.then(e,e))}function $1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Z1(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=_s(-1,1),t.tag=2,sa(r,t,1))),r.lanes|=1),e)}var JC=Ps.ReactCurrentOwner,In=!1;function un(e,t,r,n){t.child=e===null?FE(t,null,r,n):gl(t,e.child,r,n)}function K1(e,t,r,n,i){r=r.render;var s=t.ref;return sl(t,i),n=lg(e,t,r,n,s,i),r=cg(),e!==null&&!In?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,As(e,t,i)):(Gt&&r&&qm(t),t.flags|=1,un(e,t,n,i),t.child)}function X1(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!xg(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,o2(e,t,s,n,i)):(e=oh(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:su,r(o,n)&&e.ref===t.ref)return As(e,t,i)}return t.flags|=1,e=la(s,n),e.ref=t.ref,e.return=t,t.child=e}function o2(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(su(s,n)&&e.ref===t.ref)if(In=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(In=!0);else return t.lanes=e.lanes,As(e,t,i)}return Lp(e,t,r,n,i)}function l2(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bt(Jo,Bn),Bn|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Bt(Jo,Bn),Bn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Bt(Jo,Bn),Bn|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Bt(Jo,Bn),Bn|=n;return un(e,t,i,r),t.child}function c2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Lp(e,t,r,n,i){var s=kn(r)?Ga:rn.current;return s=pl(t,s),sl(t,i),r=lg(e,t,r,n,s,i),n=cg(),e!==null&&!In?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,As(e,t,i)):(Gt&&n&&qm(t),t.flags|=1,un(e,t,r,i),t.child)}function q1(e,t,r,n,i){if(kn(r)){var s=!0;Ah(t)}else s=!1;if(sl(t,i),t.stateNode===null)ih(e,t),i2(t,r,n),Np(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,h=r.contextType;typeof h=="object"&&h!==null?h=fi(h):(h=kn(r)?Ga:rn.current,h=pl(t,h));var p=r.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||u!==h)&&W1(t,o,n,h),Gs=!1;var _=t.memoizedState;o.state=_,Rh(t,n,o,i),u=t.memoizedState,l!==n||_!==u||Cn.current||Gs?(typeof p=="function"&&(Pp(t,r,p,n),u=t.memoizedState),(l=Gs||H1(t,r,l,n,_,u,h))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),o.props=n,o.state=u,o.context=h,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,ME(e,t),l=t.memoizedProps,h=t.type===t.elementType?l:Ai(t.type,l),o.props=h,m=t.pendingProps,_=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=fi(u):(u=kn(r)?Ga:rn.current,u=pl(t,u));var x=r.getDerivedStateFromProps;(p=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||_!==u)&&W1(t,o,n,u),Gs=!1,_=t.memoizedState,o.state=_,Rh(t,n,o,i);var E=t.memoizedState;l!==m||_!==E||Cn.current||Gs?(typeof x=="function"&&(Pp(t,r,x,n),E=t.memoizedState),(h=Gs||H1(t,r,h,n,_,E,u)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,E,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,E,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=E),o.props=n,o.state=E,o.context=u,n=h):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),n=!1)}return Dp(e,t,r,n,s,i)}function Dp(e,t,r,n,i,s){c2(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&F1(t,r,!1),As(e,t,s);n=t.stateNode,JC.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=gl(t,e.child,null,s),t.child=gl(t,null,l,s)):un(e,t,l,s),t.memoizedState=n.state,i&&F1(t,r,!0),t.child}function u2(e){var t=e.stateNode;t.pendingContext?D1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&D1(e,t.context,!1),ig(e,t.containerInfo)}function Y1(e,t,r,n,i){return ml(),Jm(i),t.flags|=256,un(e,t,r,n),t.child}var Fp={dehydrated:null,treeContext:null,retryLane:0};function bp(e){return{baseLanes:e,cachePool:null,transitions:null}}function f2(e,t,r){var n=t.pendingProps,i=Xt.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Bt(Xt,i&1),e===null)return kp(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=x0(o,n,0,null),e=Ua(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=bp(r),t.memoizedState=Fp,e):hg(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return QC(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=la(i,u),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=la(l,s):(s=Ua(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?bp(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=Fp,n}return s=e.child,e=s.sibling,n=la(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function hg(e,t){return t=x0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Lf(e,t,r,n){return n!==null&&Jm(n),gl(t,e.child,null,r),e=hg(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function QC(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=Id(Error(Ce(422))),Lf(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=x0({mode:"visible",children:n.children},i,0,null),s=Ua(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&gl(t,e.child,null,o),t.child.memoizedState=bp(o),t.memoizedState=Fp,s);if(!(t.mode&1))return Lf(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Ce(419)),n=Id(s,n,void 0),Lf(e,t,o,n)}if(l=(o&e.childLanes)!==0,In||l){if(n=Or,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ws(e,i),Ni(n,e,i,-1))}return vg(),n=Id(Error(Ce(421))),Lf(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=hk.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,zn=ia(i.nextSibling),Hn=t,Gt=!0,Ii=null,e!==null&&(ai[oi++]=ps,ai[oi++]=ms,ai[oi++]=$a,ps=e.id,ms=e.overflow,$a=t),t=hg(t,n.children),t.flags|=4096,t)}function J1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Rp(e.return,t,r)}function Cd(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function h2(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(un(e,t,n.children,r),n=Xt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&J1(e,r,t);else if(e.tag===19)J1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Bt(Xt,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Ph(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Cd(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Ph(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Cd(t,!0,r,null,s);break;case"together":Cd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ih(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function As(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ka|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ce(153));if(t.child!==null){for(e=t.child,r=la(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=la(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function ek(e,t,r){switch(t.tag){case 3:u2(t),ml();break;case 5:BE(t);break;case 1:kn(t.type)&&Ah(t);break;case 4:ig(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Bt(Ch,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Bt(Xt,Xt.current&1),t.flags|=128,null):r&t.child.childLanes?f2(e,t,r):(Bt(Xt,Xt.current&1),e=As(e,t,r),e!==null?e.sibling:null);Bt(Xt,Xt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return h2(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Bt(Xt,Xt.current),n)break;return null;case 22:case 23:return t.lanes=0,l2(e,t,r)}return As(e,t,r)}var d2,Mp,p2,m2;d2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Mp=function(){};p2=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Fa(Zi.current);var s=null;switch(r){case"input":i=sp(e,i),n=sp(e,n),s=[];break;case"select":i=Yt({},i,{value:void 0}),n=Yt({},n,{value:void 0}),s=[];break;case"textarea":i=lp(e,i),n=lp(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Th)}up(r,n);var o;r=null;for(h in i)if(!n.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var l=i[h];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Jc.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in n){var u=n[h];if(l=i!=null?i[h]:void 0,n.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(s||(s=[]),s.push(h,r)),r=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Jc.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&Vt("scroll",e),s||l===u||(s=[])):(s=s||[]).push(h,u))}r&&(s=s||[]).push("style",r);var h=s;(t.updateQueue=h)&&(t.flags|=4)}};m2=function(e,t,r,n){r!==n&&(t.flags|=4)};function dc(e,t){if(!Gt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function $r(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function tk(e,t,r){var n=t.pendingProps;switch(Ym(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $r(t),null;case 1:return kn(t.type)&&wh(),$r(t),null;case 3:return n=t.stateNode,_l(),zt(Cn),zt(rn),ag(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Nf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ii!==null&&(Gp(Ii),Ii=null))),Mp(e,t),$r(t),null;case 5:sg(t);var i=Fa(uu.current);if(r=t.type,e!==null&&t.stateNode!=null)p2(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ce(166));return $r(t),null}if(e=Fa(Zi.current),Nf(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Gi]=t,n[lu]=s,e=(t.mode&1)!==0,r){case"dialog":Vt("cancel",n),Vt("close",n);break;case"iframe":case"object":case"embed":Vt("load",n);break;case"video":case"audio":for(i=0;i<yc.length;i++)Vt(yc[i],n);break;case"source":Vt("error",n);break;case"img":case"image":case"link":Vt("error",n),Vt("load",n);break;case"details":Vt("toggle",n);break;case"input":o1(n,s),Vt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Vt("invalid",n);break;case"textarea":c1(n,s),Vt("invalid",n)}up(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&Pf(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Pf(n.textContent,l,e),i=["children",""+l]):Jc.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Vt("scroll",n)}switch(r){case"input":Tf(n),l1(n,s,!0);break;case"textarea":Tf(n),u1(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Th)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Hy(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Gi]=t,e[lu]=n,d2(e,t,!1,!1),t.stateNode=e;e:{switch(o=fp(r,n),r){case"dialog":Vt("cancel",e),Vt("close",e),i=n;break;case"iframe":case"object":case"embed":Vt("load",e),i=n;break;case"video":case"audio":for(i=0;i<yc.length;i++)Vt(yc[i],e);i=n;break;case"source":Vt("error",e),i=n;break;case"img":case"image":case"link":Vt("error",e),Vt("load",e),i=n;break;case"details":Vt("toggle",e),i=n;break;case"input":o1(e,n),i=sp(e,n),Vt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Yt({},n,{value:void 0}),Vt("invalid",e);break;case"textarea":c1(e,n),i=lp(e,n),Vt("invalid",e);break;default:i=n}up(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?$y(e,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Wy(e,u)):s==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Qc(e,u):typeof u=="number"&&Qc(e,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Jc.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Vt("scroll",e):u!=null&&bm(e,s,u,o))}switch(r){case"input":Tf(e),l1(e,n,!1);break;case"textarea":Tf(e),u1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+da(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?tl(e,!!n.multiple,s,!1):n.defaultValue!=null&&tl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Th)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return $r(t),null;case 6:if(e&&t.stateNode!=null)m2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ce(166));if(r=Fa(uu.current),Fa(Zi.current),Nf(t)){if(n=t.stateNode,r=t.memoizedProps,n[Gi]=t,(s=n.nodeValue!==r)&&(e=Hn,e!==null))switch(e.tag){case 3:Pf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Pf(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Gi]=t,t.stateNode=n}return $r(t),null;case 13:if(zt(Xt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Gt&&zn!==null&&t.mode&1&&!(t.flags&128))LE(),ml(),t.flags|=98560,s=!1;else if(s=Nf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Ce(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ce(317));s[Gi]=t}else ml(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;$r(t),s=!1}else Ii!==null&&(Gp(Ii),Ii=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Xt.current&1?Er===0&&(Er=3):vg())),t.updateQueue!==null&&(t.flags|=4),$r(t),null);case 4:return _l(),Mp(e,t),e===null&&au(t.stateNode.containerInfo),$r(t),null;case 10:return tg(t.type._context),$r(t),null;case 17:return kn(t.type)&&wh(),$r(t),null;case 19:if(zt(Xt),s=t.memoizedState,s===null)return $r(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)dc(s,!1);else{if(Er!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ph(e),o!==null){for(t.flags|=128,dc(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Bt(Xt,Xt.current&1|2),t.child}e=e.sibling}s.tail!==null&&lr()>xl&&(t.flags|=128,n=!0,dc(s,!1),t.lanes=4194304)}else{if(!n)if(e=Ph(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),dc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Gt)return $r(t),null}else 2*lr()-s.renderingStartTime>xl&&r!==1073741824&&(t.flags|=128,n=!0,dc(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=lr(),t.sibling=null,r=Xt.current,Bt(Xt,n?r&1|2:r&1),t):($r(t),null);case 22:case 23:return _g(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Bn&1073741824&&($r(t),t.subtreeFlags&6&&(t.flags|=8192)):$r(t),null;case 24:return null;case 25:return null}throw Error(Ce(156,t.tag))}function rk(e,t){switch(Ym(t),t.tag){case 1:return kn(t.type)&&wh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _l(),zt(Cn),zt(rn),ag(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return sg(t),null;case 13:if(zt(Xt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ce(340));ml()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return zt(Xt),null;case 4:return _l(),null;case 10:return tg(t.type._context),null;case 22:case 23:return _g(),null;case 24:return null;default:return null}}var Df=!1,Yr=!1,nk=typeof WeakSet=="function"?WeakSet:Set,Ue=null;function Yo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){tr(e,t,n)}else r.current=null}function Bp(e,t,r){try{r()}catch(n){tr(e,t,n)}}var Q1=!1;function ik(e,t){if(Ep=xh,e=yE(),Xm(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,u=-1,h=0,p=0,m=e,_=null;t:for(;;){for(var x;m!==r||i!==0&&m.nodeType!==3||(l=o+i),m!==s||n!==0&&m.nodeType!==3||(u=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(x=m.firstChild)!==null;)_=m,m=x;for(;;){if(m===e)break t;if(_===r&&++h===i&&(l=o),_===s&&++p===n&&(u=o),(x=m.nextSibling)!==null)break;m=_,_=m.parentNode}m=x}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Tp={focusedElem:e,selectionRange:r},xh=!1,Ue=t;Ue!==null;)if(t=Ue,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ue=e;else for(;Ue!==null;){t=Ue;try{var E=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var y=E.memoizedProps,A=E.memoizedState,C=t.stateNode,k=C.getSnapshotBeforeUpdate(t.elementType===t.type?y:Ai(t.type,y),A);C.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ce(163))}}catch(V){tr(t,t.return,V)}if(e=t.sibling,e!==null){e.return=t.return,Ue=e;break}Ue=t.return}return E=Q1,Q1=!1,E}function Fc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Bp(t,r,s)}i=i.next}while(i!==n)}}function _0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Up(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function g2(e){var t=e.alternate;t!==null&&(e.alternate=null,g2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gi],delete t[lu],delete t[Sp],delete t[VC],delete t[zC])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _2(e){return e.tag===5||e.tag===3||e.tag===4}function ev(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||_2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Th));else if(n!==4&&(e=e.child,e!==null))for(Vp(e,t,r),e=e.sibling;e!==null;)Vp(e,t,r),e=e.sibling}function zp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(zp(e,t,r),e=e.sibling;e!==null;)zp(e,t,r),e=e.sibling}var Fr=null,Si=!1;function js(e,t,r){for(r=r.child;r!==null;)v2(e,t,r),r=r.sibling}function v2(e,t,r){if($i&&typeof $i.onCommitFiberUnmount=="function")try{$i.onCommitFiberUnmount(c0,r)}catch{}switch(r.tag){case 5:Yr||Yo(r,t);case 6:var n=Fr,i=Si;Fr=null,js(e,t,r),Fr=n,Si=i,Fr!==null&&(Si?(e=Fr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Fr.removeChild(r.stateNode));break;case 18:Fr!==null&&(Si?(e=Fr,r=r.stateNode,e.nodeType===8?yd(e.parentNode,r):e.nodeType===1&&yd(e,r),nu(e)):yd(Fr,r.stateNode));break;case 4:n=Fr,i=Si,Fr=r.stateNode.containerInfo,Si=!0,js(e,t,r),Fr=n,Si=i;break;case 0:case 11:case 14:case 15:if(!Yr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Bp(r,t,o),i=i.next}while(i!==n)}js(e,t,r);break;case 1:if(!Yr&&(Yo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){tr(r,t,l)}js(e,t,r);break;case 21:js(e,t,r);break;case 22:r.mode&1?(Yr=(n=Yr)||r.memoizedState!==null,js(e,t,r),Yr=n):js(e,t,r);break;default:js(e,t,r)}}function tv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new nk),t.forEach(function(n){var i=dk.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ei(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Fr=l.stateNode,Si=!1;break e;case 3:Fr=l.stateNode.containerInfo,Si=!0;break e;case 4:Fr=l.stateNode.containerInfo,Si=!0;break e}l=l.return}if(Fr===null)throw Error(Ce(160));v2(s,o,i),Fr=null,Si=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(h){tr(i,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)x2(t,e),t=t.sibling}function x2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ei(t,e),zi(e),n&4){try{Fc(3,e,e.return),_0(3,e)}catch(y){tr(e,e.return,y)}try{Fc(5,e,e.return)}catch(y){tr(e,e.return,y)}}break;case 1:Ei(t,e),zi(e),n&512&&r!==null&&Yo(r,r.return);break;case 5:if(Ei(t,e),zi(e),n&512&&r!==null&&Yo(r,r.return),e.flags&32){var i=e.stateNode;try{Qc(i,"")}catch(y){tr(e,e.return,y)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&zy(i,s),fp(l,o);var h=fp(l,s);for(o=0;o<u.length;o+=2){var p=u[o],m=u[o+1];p==="style"?$y(i,m):p==="dangerouslySetInnerHTML"?Wy(i,m):p==="children"?Qc(i,m):bm(i,p,m,h)}switch(l){case"input":ap(i,s);break;case"textarea":jy(i,s);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var x=s.value;x!=null?tl(i,!!s.multiple,x,!1):_!==!!s.multiple&&(s.defaultValue!=null?tl(i,!!s.multiple,s.defaultValue,!0):tl(i,!!s.multiple,s.multiple?[]:"",!1))}i[lu]=s}catch(y){tr(e,e.return,y)}}break;case 6:if(Ei(t,e),zi(e),n&4){if(e.stateNode===null)throw Error(Ce(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(y){tr(e,e.return,y)}}break;case 3:if(Ei(t,e),zi(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{nu(t.containerInfo)}catch(y){tr(e,e.return,y)}break;case 4:Ei(t,e),zi(e);break;case 13:Ei(t,e),zi(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(mg=lr())),n&4&&tv(e);break;case 22:if(p=r!==null&&r.memoizedState!==null,e.mode&1?(Yr=(h=Yr)||p,Ei(t,e),Yr=h):Ei(t,e),zi(e),n&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!p&&e.mode&1)for(Ue=e,p=e.child;p!==null;){for(m=Ue=p;Ue!==null;){switch(_=Ue,x=_.child,_.tag){case 0:case 11:case 14:case 15:Fc(4,_,_.return);break;case 1:Yo(_,_.return);var E=_.stateNode;if(typeof E.componentWillUnmount=="function"){n=_,r=_.return;try{t=n,E.props=t.memoizedProps,E.state=t.memoizedState,E.componentWillUnmount()}catch(y){tr(n,r,y)}}break;case 5:Yo(_,_.return);break;case 22:if(_.memoizedState!==null){nv(m);continue}}x!==null?(x.return=_,Ue=x):nv(m)}p=p.sibling}e:for(p=null,m=e;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Gy("display",o))}catch(y){tr(e,e.return,y)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(y){tr(e,e.return,y)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Ei(t,e),zi(e),n&4&&tv(e);break;case 21:break;default:Ei(t,e),zi(e)}}function zi(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(_2(r)){var n=r;break e}r=r.return}throw Error(Ce(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Qc(i,""),n.flags&=-33);var s=ev(e);zp(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=ev(e);Vp(e,l,o);break;default:throw Error(Ce(161))}}catch(u){tr(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sk(e,t,r){Ue=e,y2(e)}function y2(e,t,r){for(var n=(e.mode&1)!==0;Ue!==null;){var i=Ue,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Df;if(!o){var l=i.alternate,u=l!==null&&l.memoizedState!==null||Yr;l=Df;var h=Yr;if(Df=o,(Yr=u)&&!h)for(Ue=i;Ue!==null;)o=Ue,u=o.child,o.tag===22&&o.memoizedState!==null?iv(i):u!==null?(u.return=o,Ue=u):iv(i);for(;s!==null;)Ue=s,y2(s),s=s.sibling;Ue=i,Df=l,Yr=h}rv(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ue=s):rv(e)}}function rv(e){for(;Ue!==null;){var t=Ue;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Yr||_0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Yr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Ai(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&V1(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}V1(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&nu(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ce(163))}Yr||t.flags&512&&Up(t)}catch(_){tr(t,t.return,_)}}if(t===e){Ue=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ue=r;break}Ue=t.return}}function nv(e){for(;Ue!==null;){var t=Ue;if(t===e){Ue=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ue=r;break}Ue=t.return}}function iv(e){for(;Ue!==null;){var t=Ue;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{_0(4,t)}catch(u){tr(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(u){tr(t,i,u)}}var s=t.return;try{Up(t)}catch(u){tr(t,s,u)}break;case 5:var o=t.return;try{Up(t)}catch(u){tr(t,o,u)}}}catch(u){tr(t,t.return,u)}if(t===e){Ue=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Ue=l;break}Ue=t.return}}var ak=Math.ceil,Lh=Ps.ReactCurrentDispatcher,dg=Ps.ReactCurrentOwner,ci=Ps.ReactCurrentBatchConfig,Tt=0,Or=null,gr=null,Ur=0,Bn=0,Jo=Ta(0),Er=0,pu=null,Ka=0,v0=0,pg=0,bc=null,An=null,mg=0,xl=1/0,fs=null,Dh=!1,jp=null,aa=null,Ff=!1,qs=null,Fh=0,Mc=0,Hp=null,sh=-1,ah=0;function pn(){return Tt&6?lr():sh!==-1?sh:sh=lr()}function oa(e){return e.mode&1?Tt&2&&Ur!==0?Ur&-Ur:HC.transition!==null?(ah===0&&(ah=iE()),ah):(e=Rt,e!==0||(e=window.event,e=e===void 0?16:fE(e.type)),e):1}function Ni(e,t,r,n){if(50<Mc)throw Mc=0,Hp=null,Error(Ce(185));Fu(e,r,n),(!(Tt&2)||e!==Or)&&(e===Or&&(!(Tt&2)&&(v0|=r),Er===4&&Zs(e,Ur)),Rn(e,n),r===1&&Tt===0&&!(t.mode&1)&&(xl=lr()+500,p0&&wa()))}function Rn(e,t){var r=e.callbackNode;HI(e,t);var n=vh(e,e===Or?Ur:0);if(n===0)r!==null&&d1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&d1(r),t===1)e.tag===0?jC(sv.bind(null,e)):PE(sv.bind(null,e)),BC(function(){!(Tt&6)&&wa()}),r=null;else{switch(sE(n)){case 1:r=zm;break;case 4:r=rE;break;case 16:r=_h;break;case 536870912:r=nE;break;default:r=_h}r=k2(r,E2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function E2(e,t){if(sh=-1,ah=0,Tt&6)throw Error(Ce(327));var r=e.callbackNode;if(al()&&e.callbackNode!==r)return null;var n=vh(e,e===Or?Ur:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=bh(e,n);else{t=n;var i=Tt;Tt|=2;var s=w2();(Or!==e||Ur!==t)&&(fs=null,xl=lr()+500,Ba(e,t));do try{ck();break}catch(l){T2(e,l)}while(!0);eg(),Lh.current=s,Tt=i,gr!==null?t=0:(Or=null,Ur=0,t=Er)}if(t!==0){if(t===2&&(i=gp(e),i!==0&&(n=i,t=Wp(e,i))),t===1)throw r=pu,Ba(e,0),Zs(e,n),Rn(e,lr()),r;if(t===6)Zs(e,n);else{if(i=e.current.alternate,!(n&30)&&!ok(i)&&(t=bh(e,n),t===2&&(s=gp(e),s!==0&&(n=s,t=Wp(e,s))),t===1))throw r=pu,Ba(e,0),Zs(e,n),Rn(e,lr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Ce(345));case 2:Pa(e,An,fs);break;case 3:if(Zs(e,n),(n&130023424)===n&&(t=mg+500-lr(),10<t)){if(vh(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){pn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ap(Pa.bind(null,e,An,fs),t);break}Pa(e,An,fs);break;case 4:if(Zs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Pi(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=lr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ak(n/1960))-n,10<n){e.timeoutHandle=Ap(Pa.bind(null,e,An,fs),n);break}Pa(e,An,fs);break;case 5:Pa(e,An,fs);break;default:throw Error(Ce(329))}}}return Rn(e,lr()),e.callbackNode===r?E2.bind(null,e):null}function Wp(e,t){var r=bc;return e.current.memoizedState.isDehydrated&&(Ba(e,t).flags|=256),e=bh(e,t),e!==2&&(t=An,An=r,t!==null&&Gp(t)),e}function Gp(e){An===null?An=e:An.push.apply(An,e)}function ok(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Li(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zs(e,t){for(t&=~pg,t&=~v0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Pi(t),n=1<<r;e[r]=-1,t&=~n}}function sv(e){if(Tt&6)throw Error(Ce(327));al();var t=vh(e,0);if(!(t&1))return Rn(e,lr()),null;var r=bh(e,t);if(e.tag!==0&&r===2){var n=gp(e);n!==0&&(t=n,r=Wp(e,n))}if(r===1)throw r=pu,Ba(e,0),Zs(e,t),Rn(e,lr()),r;if(r===6)throw Error(Ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Pa(e,An,fs),Rn(e,lr()),null}function gg(e,t){var r=Tt;Tt|=1;try{return e(t)}finally{Tt=r,Tt===0&&(xl=lr()+500,p0&&wa())}}function Xa(e){qs!==null&&qs.tag===0&&!(Tt&6)&&al();var t=Tt;Tt|=1;var r=ci.transition,n=Rt;try{if(ci.transition=null,Rt=1,e)return e()}finally{Rt=n,ci.transition=r,Tt=t,!(Tt&6)&&wa()}}function _g(){Bn=Jo.current,zt(Jo)}function Ba(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,MC(r)),gr!==null)for(r=gr.return;r!==null;){var n=r;switch(Ym(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&wh();break;case 3:_l(),zt(Cn),zt(rn),ag();break;case 5:sg(n);break;case 4:_l();break;case 13:zt(Xt);break;case 19:zt(Xt);break;case 10:tg(n.type._context);break;case 22:case 23:_g()}r=r.return}if(Or=e,gr=e=la(e.current,null),Ur=Bn=t,Er=0,pu=null,pg=v0=Ka=0,An=bc=null,Da!==null){for(t=0;t<Da.length;t++)if(r=Da[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Da=null}return e}function T2(e,t){do{var r=gr;try{if(eg(),rh.current=Oh,Nh){for(var n=qt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Nh=!1}if(Za=0,Nr=xr=qt=null,Dc=!1,fu=0,dg.current=null,r===null||r.return===null){Er=1,pu=t,gr=null;break}e:{var s=e,o=r.return,l=r,u=t;if(t=Ur,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var _=p.alternate;_?(p.updateQueue=_.updateQueue,p.memoizedState=_.memoizedState,p.lanes=_.lanes):(p.updateQueue=null,p.memoizedState=null)}var x=$1(o);if(x!==null){x.flags&=-257,Z1(x,o,l,s,t),x.mode&1&&G1(s,h,t),t=x,u=h;var E=t.updateQueue;if(E===null){var y=new Set;y.add(u),t.updateQueue=y}else E.add(u);break e}else{if(!(t&1)){G1(s,h,t),vg();break e}u=Error(Ce(426))}}else if(Gt&&l.mode&1){var A=$1(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),Z1(A,o,l,s,t),Jm(vl(u,l));break e}}s=u=vl(u,l),Er!==4&&(Er=2),bc===null?bc=[s]:bc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var C=s2(s,u,t);U1(s,C);break e;case 1:l=u;var k=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(aa===null||!aa.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var V=a2(s,l,t);U1(s,V);break e}}s=s.return}while(s!==null)}S2(r)}catch(Q){t=Q,gr===r&&r!==null&&(gr=r=r.return);continue}break}while(!0)}function w2(){var e=Lh.current;return Lh.current=Oh,e===null?Oh:e}function vg(){(Er===0||Er===3||Er===2)&&(Er=4),Or===null||!(Ka&268435455)&&!(v0&268435455)||Zs(Or,Ur)}function bh(e,t){var r=Tt;Tt|=2;var n=w2();(Or!==e||Ur!==t)&&(fs=null,Ba(e,t));do try{lk();break}catch(i){T2(e,i)}while(!0);if(eg(),Tt=r,Lh.current=n,gr!==null)throw Error(Ce(261));return Or=null,Ur=0,Er}function lk(){for(;gr!==null;)A2(gr)}function ck(){for(;gr!==null&&!DI();)A2(gr)}function A2(e){var t=C2(e.alternate,e,Bn);e.memoizedProps=e.pendingProps,t===null?S2(e):gr=t,dg.current=null}function S2(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=rk(r,t),r!==null){r.flags&=32767,gr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Er=6,gr=null;return}}else if(r=tk(r,t,Bn),r!==null){gr=r;return}if(t=t.sibling,t!==null){gr=t;return}gr=t=e}while(t!==null);Er===0&&(Er=5)}function Pa(e,t,r){var n=Rt,i=ci.transition;try{ci.transition=null,Rt=1,uk(e,t,r,n)}finally{ci.transition=i,Rt=n}return null}function uk(e,t,r,n){do al();while(qs!==null);if(Tt&6)throw Error(Ce(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ce(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(WI(e,s),e===Or&&(gr=Or=null,Ur=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ff||(Ff=!0,k2(_h,function(){return al(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ci.transition,ci.transition=null;var o=Rt;Rt=1;var l=Tt;Tt|=4,dg.current=null,ik(e,r),x2(r,e),PC(Tp),xh=!!Ep,Tp=Ep=null,e.current=r,sk(r),FI(),Tt=l,Rt=o,ci.transition=s}else e.current=r;if(Ff&&(Ff=!1,qs=e,Fh=i),s=e.pendingLanes,s===0&&(aa=null),BI(r.stateNode),Rn(e,lr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Dh)throw Dh=!1,e=jp,jp=null,e;return Fh&1&&e.tag!==0&&al(),s=e.pendingLanes,s&1?e===Hp?Mc++:(Mc=0,Hp=e):Mc=0,wa(),null}function al(){if(qs!==null){var e=sE(Fh),t=ci.transition,r=Rt;try{if(ci.transition=null,Rt=16>e?16:e,qs===null)var n=!1;else{if(e=qs,qs=null,Fh=0,Tt&6)throw Error(Ce(331));var i=Tt;for(Tt|=4,Ue=e.current;Ue!==null;){var s=Ue,o=s.child;if(Ue.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(Ue=h;Ue!==null;){var p=Ue;switch(p.tag){case 0:case 11:case 15:Fc(8,p,s)}var m=p.child;if(m!==null)m.return=p,Ue=m;else for(;Ue!==null;){p=Ue;var _=p.sibling,x=p.return;if(g2(p),p===h){Ue=null;break}if(_!==null){_.return=x,Ue=_;break}Ue=x}}}var E=s.alternate;if(E!==null){var y=E.child;if(y!==null){E.child=null;do{var A=y.sibling;y.sibling=null,y=A}while(y!==null)}}Ue=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Ue=o;else e:for(;Ue!==null;){if(s=Ue,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Fc(9,s,s.return)}var C=s.sibling;if(C!==null){C.return=s.return,Ue=C;break e}Ue=s.return}}var k=e.current;for(Ue=k;Ue!==null;){o=Ue;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Ue=w;else e:for(o=k;Ue!==null;){if(l=Ue,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:_0(9,l)}}catch(Q){tr(l,l.return,Q)}if(l===o){Ue=null;break e}var V=l.sibling;if(V!==null){V.return=l.return,Ue=V;break e}Ue=l.return}}if(Tt=i,wa(),$i&&typeof $i.onPostCommitFiberRoot=="function")try{$i.onPostCommitFiberRoot(c0,e)}catch{}n=!0}return n}finally{Rt=r,ci.transition=t}}return!1}function av(e,t,r){t=vl(r,t),t=s2(e,t,1),e=sa(e,t,1),t=pn(),e!==null&&(Fu(e,1,t),Rn(e,t))}function tr(e,t,r){if(e.tag===3)av(e,e,r);else for(;t!==null;){if(t.tag===3){av(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(aa===null||!aa.has(n))){e=vl(r,e),e=a2(t,e,1),t=sa(t,e,1),e=pn(),t!==null&&(Fu(t,1,e),Rn(t,e));break}}t=t.return}}function fk(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=pn(),e.pingedLanes|=e.suspendedLanes&r,Or===e&&(Ur&r)===r&&(Er===4||Er===3&&(Ur&130023424)===Ur&&500>lr()-mg?Ba(e,0):pg|=r),Rn(e,t)}function I2(e,t){t===0&&(e.mode&1?(t=Sf,Sf<<=1,!(Sf&130023424)&&(Sf=4194304)):t=1);var r=pn();e=ws(e,t),e!==null&&(Fu(e,t,r),Rn(e,r))}function hk(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),I2(e,r)}function dk(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ce(314))}n!==null&&n.delete(t),I2(e,r)}var C2;C2=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Cn.current)In=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return In=!1,ek(e,t,r);In=!!(e.flags&131072)}else In=!1,Gt&&t.flags&1048576&&NE(t,Ih,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;ih(e,t),e=t.pendingProps;var i=pl(t,rn.current);sl(t,r),i=lg(null,t,n,e,i,r);var s=cg();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,kn(n)?(s=!0,Ah(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ng(t),i.updater=g0,t.stateNode=i,i._reactInternals=t,Np(t,n,e,r),t=Dp(null,t,n,!0,s,r)):(t.tag=0,Gt&&s&&qm(t),un(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(ih(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=mk(n),e=Ai(n,e),i){case 0:t=Lp(null,t,n,e,r);break e;case 1:t=q1(null,t,n,e,r);break e;case 11:t=K1(null,t,n,e,r);break e;case 14:t=X1(null,t,n,Ai(n.type,e),r);break e}throw Error(Ce(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ai(n,i),Lp(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ai(n,i),q1(e,t,n,i,r);case 3:e:{if(u2(t),e===null)throw Error(Ce(387));n=t.pendingProps,s=t.memoizedState,i=s.element,ME(e,t),Rh(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=vl(Error(Ce(423)),t),t=Y1(e,t,n,r,i);break e}else if(n!==i){i=vl(Error(Ce(424)),t),t=Y1(e,t,n,r,i);break e}else for(zn=ia(t.stateNode.containerInfo.firstChild),Hn=t,Gt=!0,Ii=null,r=FE(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ml(),n===i){t=As(e,t,r);break e}un(e,t,n,r)}t=t.child}return t;case 5:return BE(t),e===null&&kp(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,wp(n,i)?o=null:s!==null&&wp(n,s)&&(t.flags|=32),c2(e,t),un(e,t,o,r),t.child;case 6:return e===null&&kp(t),null;case 13:return f2(e,t,r);case 4:return ig(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=gl(t,null,n,r):un(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ai(n,i),K1(e,t,n,i,r);case 7:return un(e,t,t.pendingProps,r),t.child;case 8:return un(e,t,t.pendingProps.children,r),t.child;case 12:return un(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Bt(Ch,n._currentValue),n._currentValue=o,s!==null)if(Li(s.value,o)){if(s.children===i.children&&!Cn.current){t=As(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(s.tag===1){u=_s(-1,r&-r),u.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}s.lanes|=r,u=s.alternate,u!==null&&(u.lanes|=r),Rp(s.return,r,t),l.lanes|=r;break}u=u.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Ce(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Rp(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}un(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,sl(t,r),i=fi(i),n=n(i),t.flags|=1,un(e,t,n,r),t.child;case 14:return n=t.type,i=Ai(n,t.pendingProps),i=Ai(n.type,i),X1(e,t,n,i,r);case 15:return o2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ai(n,i),ih(e,t),t.tag=1,kn(n)?(e=!0,Ah(t)):e=!1,sl(t,r),i2(t,n,i),Np(t,n,i,r),Dp(null,t,n,!0,e,r);case 19:return h2(e,t,r);case 22:return l2(e,t,r)}throw Error(Ce(156,t.tag))};function k2(e,t){return tE(e,t)}function pk(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function li(e,t,r,n){return new pk(e,t,r,n)}function xg(e){return e=e.prototype,!(!e||!e.isReactComponent)}function mk(e){if(typeof e=="function")return xg(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Bm)return 11;if(e===Um)return 14}return 2}function la(e,t){var r=e.alternate;return r===null?(r=li(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function oh(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")xg(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case jo:return Ua(r.children,i,s,t);case Mm:o=8,i|=8;break;case tp:return e=li(12,r,t,i|2),e.elementType=tp,e.lanes=s,e;case rp:return e=li(13,r,t,i),e.elementType=rp,e.lanes=s,e;case np:return e=li(19,r,t,i),e.elementType=np,e.lanes=s,e;case By:return x0(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case by:o=10;break e;case My:o=9;break e;case Bm:o=11;break e;case Um:o=14;break e;case Ws:o=16,n=null;break e}throw Error(Ce(130,e==null?e:typeof e,""))}return t=li(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Ua(e,t,r,n){return e=li(7,e,n,t),e.lanes=r,e}function x0(e,t,r,n){return e=li(22,e,n,t),e.elementType=By,e.lanes=r,e.stateNode={isHidden:!1},e}function kd(e,t,r){return e=li(6,e,null,t),e.lanes=r,e}function Rd(e,t,r){return t=li(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function gk(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=cd(0),this.expirationTimes=cd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cd(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function yg(e,t,r,n,i,s,o,l,u){return e=new gk(e,t,r,l,u),t===1?(t=1,s===!0&&(t|=8)):t=0,s=li(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ng(s),e}function _k(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function R2(e){if(!e)return pa;e=e._reactInternals;e:{if(no(e)!==e||e.tag!==1)throw Error(Ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(kn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ce(171))}if(e.tag===1){var r=e.type;if(kn(r))return RE(e,r,t)}return t}function P2(e,t,r,n,i,s,o,l,u){return e=yg(r,n,!0,e,i,s,o,l,u),e.context=R2(null),r=e.current,n=pn(),i=oa(r),s=_s(n,i),s.callback=t??null,sa(r,s,i),e.current.lanes=i,Fu(e,i,n),Rn(e,n),e}function y0(e,t,r,n){var i=t.current,s=pn(),o=oa(i);return r=R2(r),t.context===null?t.context=r:t.pendingContext=r,t=_s(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=sa(i,t,o),e!==null&&(Ni(e,i,o,s),th(e,i,o)),o}function Mh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ov(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Eg(e,t){ov(e,t),(e=e.alternate)&&ov(e,t)}function vk(){return null}var N2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Tg(e){this._internalRoot=e}E0.prototype.render=Tg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ce(409));y0(e,t,null,null)};E0.prototype.unmount=Tg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Xa(function(){y0(null,e,null,null)}),t[Ts]=null}};function E0(e){this._internalRoot=e}E0.prototype.unstable_scheduleHydration=function(e){if(e){var t=lE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<$s.length&&t!==0&&t<$s[r].priority;r++);$s.splice(r,0,e),r===0&&uE(e)}};function wg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function T0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function lv(){}function xk(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var h=Mh(o);s.call(h)}}var o=P2(t,n,e,0,null,!1,!1,"",lv);return e._reactRootContainer=o,e[Ts]=o.current,au(e.nodeType===8?e.parentNode:e),Xa(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var h=Mh(u);l.call(h)}}var u=yg(e,0,!1,null,null,!1,!1,"",lv);return e._reactRootContainer=u,e[Ts]=u.current,au(e.nodeType===8?e.parentNode:e),Xa(function(){y0(t,u,r,n)}),u}function w0(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var u=Mh(o);l.call(u)}}y0(t,o,e,i)}else o=xk(r,t,e,i,n);return Mh(o)}aE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=xc(t.pendingLanes);r!==0&&(jm(t,r|1),Rn(t,lr()),!(Tt&6)&&(xl=lr()+500,wa()))}break;case 13:Xa(function(){var n=ws(e,1);if(n!==null){var i=pn();Ni(n,e,1,i)}}),Eg(e,1)}};Hm=function(e){if(e.tag===13){var t=ws(e,134217728);if(t!==null){var r=pn();Ni(t,e,134217728,r)}Eg(e,134217728)}};oE=function(e){if(e.tag===13){var t=oa(e),r=ws(e,t);if(r!==null){var n=pn();Ni(r,e,t,n)}Eg(e,t)}};lE=function(){return Rt};cE=function(e,t){var r=Rt;try{return Rt=e,t()}finally{Rt=r}};dp=function(e,t,r){switch(t){case"input":if(ap(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=d0(n);if(!i)throw Error(Ce(90));Vy(n),ap(n,i)}}}break;case"textarea":jy(e,r);break;case"select":t=r.value,t!=null&&tl(e,!!r.multiple,t,!1)}};Xy=gg;qy=Xa;var yk={usingClientEntryPoint:!1,Events:[Mu,$o,d0,Zy,Ky,gg]},pc={findFiberByHostInstance:La,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ek={bundleType:pc.bundleType,version:pc.version,rendererPackageName:pc.rendererPackageName,rendererConfig:pc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ps.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Qy(e),e===null?null:e.stateNode},findFiberByHostInstance:pc.findFiberByHostInstance||vk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bf.isDisabled&&bf.supportsFiber)try{c0=bf.inject(Ek),$i=bf}catch{}}Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yk;Zn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wg(t))throw Error(Ce(200));return _k(e,t,null,r)};Zn.createRoot=function(e,t){if(!wg(e))throw Error(Ce(299));var r=!1,n="",i=N2;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=yg(e,1,!1,null,null,r,!1,n,i),e[Ts]=t.current,au(e.nodeType===8?e.parentNode:e),new Tg(t)};Zn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ce(188)):(e=Object.keys(e).join(","),Error(Ce(268,e)));return e=Qy(t),e=e===null?null:e.stateNode,e};Zn.flushSync=function(e){return Xa(e)};Zn.hydrate=function(e,t,r){if(!T0(t))throw Error(Ce(200));return w0(null,e,t,!0,r)};Zn.hydrateRoot=function(e,t,r){if(!wg(e))throw Error(Ce(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=N2;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=P2(t,null,e,1,r??null,i,!1,s,o),e[Ts]=t.current,au(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new E0(t)};Zn.render=function(e,t,r){if(!T0(t))throw Error(Ce(200));return w0(null,e,t,!1,r)};Zn.unmountComponentAtNode=function(e){if(!T0(e))throw Error(Ce(40));return e._reactRootContainer?(Xa(function(){w0(null,null,e,!1,function(){e._reactRootContainer=null,e[Ts]=null})}),!0):!1};Zn.unstable_batchedUpdates=gg;Zn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!T0(r))throw Error(Ce(200));if(e==null||e._reactInternals===void 0)throw Error(Ce(38));return w0(e,t,r,!1,n)};Zn.version="18.3.1-next-f1338f8080-20240426";function O2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(O2)}catch(e){console.error(e)}}O2(),Oy.exports=Zn;var L2=Oy.exports,cv=L2;Qd.createRoot=cv.createRoot,Qd.hydrateRoot=cv.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mu(){return mu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mu.apply(this,arguments)}var Ys;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ys||(Ys={}));const uv="popstate";function Tk(e){e===void 0&&(e={});function t(i,s){let{pathname:o="/",search:l="",hash:u=""}=io(i.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),$p("",{pathname:o,search:l,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(i,s){let o=i.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let u=i.location.href,h=u.indexOf("#");l=h===-1?u:u.slice(0,h)}return l+"#"+(typeof s=="string"?s:D2(s))}function n(i,s){A0(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return Ak(t,r,n,e)}function wr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function A0(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function wk(){return Math.random().toString(36).substr(2,8)}function fv(e,t){return{usr:e.state,key:e.key,idx:t}}function $p(e,t,r,n){return r===void 0&&(r=null),mu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?io(t):t,{state:r,key:t&&t.key||n||wk()})}function D2(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function io(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Ak(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,l=Ys.Pop,u=null,h=p();h==null&&(h=0,o.replaceState(mu({},o.state,{idx:h}),""));function p(){return(o.state||{idx:null}).idx}function m(){l=Ys.Pop;let A=p(),C=A==null?null:A-h;h=A,u&&u({action:l,location:y.location,delta:C})}function _(A,C){l=Ys.Push;let k=$p(y.location,A,C);r&&r(k,A),h=p()+1;let w=fv(k,h),V=y.createHref(k);try{o.pushState(w,"",V)}catch(Q){if(Q instanceof DOMException&&Q.name==="DataCloneError")throw Q;i.location.assign(V)}s&&u&&u({action:l,location:y.location,delta:1})}function x(A,C){l=Ys.Replace;let k=$p(y.location,A,C);r&&r(k,A),h=p();let w=fv(k,h),V=y.createHref(k);o.replaceState(w,"",V),s&&u&&u({action:l,location:y.location,delta:0})}function E(A){let C=i.location.origin!=="null"?i.location.origin:i.location.href,k=typeof A=="string"?A:D2(A);return k=k.replace(/ $/,"%20"),wr(C,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,C)}let y={get action(){return l},get location(){return e(i,o)},listen(A){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(uv,m),u=A,()=>{i.removeEventListener(uv,m),u=null}},createHref(A){return t(i,A)},createURL:E,encodeLocation(A){let C=E(A);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:_,replace:x,go(A){return o.go(A)}};return y}var hv;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(hv||(hv={}));function Sk(e,t,r){return r===void 0&&(r="/"),Ik(e,t,r)}function Ik(e,t,r,n){let i=typeof t=="string"?io(t):t,s=M2(i.pathname||"/",r);if(s==null)return null;let o=F2(e);Ck(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let h=Uk(s);l=bk(o[u],h)}return l}function F2(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,l)=>{let u={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};u.relativePath.startsWith("/")&&(wr(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let h=Va([n,u.relativePath]),p=r.concat(u);s.children&&s.children.length>0&&(wr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),F2(s.children,t,p,h)),!(s.path==null&&!s.index)&&t.push({path:h,score:Dk(h,s.index),routesMeta:p})};return e.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let u of b2(s.path))i(s,o,u)}),t}function b2(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=b2(n.join("/")),l=[];return l.push(...o.map(u=>u===""?s:[s,u].join("/"))),i&&l.push(...o),l.map(u=>e.startsWith("/")&&u===""?"/":u)}function Ck(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Fk(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const kk=/^:[\w-]+$/,Rk=3,Pk=2,Nk=1,Ok=10,Lk=-2,dv=e=>e==="*";function Dk(e,t){let r=e.split("/"),n=r.length;return r.some(dv)&&(n+=Lk),t&&(n+=Pk),r.filter(i=>!dv(i)).reduce((i,s)=>i+(kk.test(s)?Rk:s===""?Nk:Ok),n)}function Fk(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function bk(e,t,r){let{routesMeta:n}=e,i={},s="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],h=l===n.length-1,p=s==="/"?t:t.slice(s.length)||"/",m=Mk({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},p),_=u.route;if(!m)return null;Object.assign(i,m.params),o.push({params:i,pathname:Va([s,m.pathname]),pathnameBase:$k(Va([s,m.pathnameBase])),route:_}),m.pathnameBase!=="/"&&(s=Va([s,m.pathnameBase]))}return o}function Mk(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Bk(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((h,p,m)=>{let{paramName:_,isOptional:x}=p;if(_==="*"){let y=l[m]||"";o=s.slice(0,s.length-y.length).replace(/(.)\/+$/,"$1")}const E=l[m];return x&&!E?h[_]=void 0:h[_]=(E||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:o,pattern:e}}function Bk(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),A0(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function Uk(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return A0(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function M2(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const Vk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zk=e=>Vk.test(e);function jk(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?io(e):e,s;if(r)if(zk(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),A0(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=pv(r.substring(1),"/"):s=pv(r,t)}else s=t;return{pathname:s,search:Zk(n),hash:Kk(i)}}function pv(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Pd(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Hk(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Wk(e,t){let r=Hk(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Gk(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=io(e):(i=mu({},e),wr(!i.pathname||!i.pathname.includes("?"),Pd("?","pathname","search",i)),wr(!i.pathname||!i.pathname.includes("#"),Pd("#","pathname","hash",i)),wr(!i.search||!i.search.includes("#"),Pd("#","search","hash",i)));let s=e===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=r;else{let m=t.length-1;if(!n&&o.startsWith("..")){let _=o.split("/");for(;_[0]==="..";)_.shift(),m-=1;i.pathname=_.join("/")}l=m>=0?t[m]:"/"}let u=jk(i,l),h=o&&o!=="/"&&o.endsWith("/"),p=(s||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(h||p)&&(u.pathname+="/"),u}const Va=e=>e.join("/").replace(/\/\/+/g,"/"),$k=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Zk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Kk=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Xk(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const B2=["post","put","patch","delete"];new Set(B2);const qk=["get",...B2];new Set(qk);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gu(){return gu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gu.apply(this,arguments)}const Ag=_e.createContext(null),Yk=_e.createContext(null),S0=_e.createContext(null),I0=_e.createContext(null),Ol=_e.createContext({outlet:null,matches:[],isDataRoute:!1}),U2=_e.createContext(null);function C0(){return _e.useContext(I0)!=null}function V2(){return C0()||wr(!1),_e.useContext(I0).location}function z2(e){_e.useContext(S0).static||_e.useLayoutEffect(e)}function j2(){let{isDataRoute:e}=_e.useContext(Ol);return e?uR():Jk()}function Jk(){C0()||wr(!1);let e=_e.useContext(Ag),{basename:t,future:r,navigator:n}=_e.useContext(S0),{matches:i}=_e.useContext(Ol),{pathname:s}=V2(),o=JSON.stringify(Wk(i,r.v7_relativeSplatPath)),l=_e.useRef(!1);return z2(()=>{l.current=!0}),_e.useCallback(function(h,p){if(p===void 0&&(p={}),!l.current)return;if(typeof h=="number"){n.go(h);return}let m=Gk(h,JSON.parse(o),s,p.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Va([t,m.pathname])),(p.replace?n.replace:n.push)(m,p.state,p)},[t,n,o,s,e])}function Qk(e,t){return eR(e,t)}function eR(e,t,r,n){C0()||wr(!1);let{navigator:i}=_e.useContext(S0),{matches:s}=_e.useContext(Ol),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let h=V2(),p;if(t){var m;let A=typeof t=="string"?io(t):t;u==="/"||(m=A.pathname)!=null&&m.startsWith(u)||wr(!1),p=A}else p=h;let _=p.pathname||"/",x=_;if(u!=="/"){let A=u.replace(/^\//,"").split("/");x="/"+_.replace(/^\//,"").split("/").slice(A.length).join("/")}let E=Sk(e,{pathname:x}),y=sR(E&&E.map(A=>Object.assign({},A,{params:Object.assign({},l,A.params),pathname:Va([u,i.encodeLocation?i.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?u:Va([u,i.encodeLocation?i.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),s,r,n);return t&&y?_e.createElement(I0.Provider,{value:{location:gu({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:Ys.Pop}},y):y}function tR(){let e=cR(),t=Xk(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _e.createElement(_e.Fragment,null,_e.createElement("h2",null,"Unexpected Application Error!"),_e.createElement("h3",{style:{fontStyle:"italic"}},t),r?_e.createElement("pre",{style:i},r):null,null)}const rR=_e.createElement(tR,null);class nR extends _e.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?_e.createElement(Ol.Provider,{value:this.props.routeContext},_e.createElement(U2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function iR(e){let{routeContext:t,match:r,children:n}=e,i=_e.useContext(Ag);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),_e.createElement(Ol.Provider,{value:t},n)}function sR(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(i=r)==null?void 0:i.errors;if(l!=null){let p=o.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);p>=0||wr(!1),o=o.slice(0,Math.min(o.length,p+1))}let u=!1,h=-1;if(r&&n&&n.v7_partialHydration)for(let p=0;p<o.length;p++){let m=o[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=p),m.route.id){let{loaderData:_,errors:x}=r,E=m.route.loader&&_[m.route.id]===void 0&&(!x||x[m.route.id]===void 0);if(m.route.lazy||E){u=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}return o.reduceRight((p,m,_)=>{let x,E=!1,y=null,A=null;r&&(x=l&&m.route.id?l[m.route.id]:void 0,y=m.route.errorElement||rR,u&&(h<0&&_===0?(fR("route-fallback"),E=!0,A=null):h===_&&(E=!0,A=m.route.hydrateFallbackElement||null)));let C=t.concat(o.slice(0,_+1)),k=()=>{let w;return x?w=y:E?w=A:m.route.Component?w=_e.createElement(m.route.Component,null):m.route.element?w=m.route.element:w=p,_e.createElement(iR,{match:m,routeContext:{outlet:p,matches:C,isDataRoute:r!=null},children:w})};return r&&(m.route.ErrorBoundary||m.route.errorElement||_===0)?_e.createElement(nR,{location:r.location,revalidation:r.revalidation,component:y,error:x,children:k(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):k()},null)}var H2=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(H2||{}),W2=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(W2||{});function aR(e){let t=_e.useContext(Ag);return t||wr(!1),t}function oR(e){let t=_e.useContext(Yk);return t||wr(!1),t}function lR(e){let t=_e.useContext(Ol);return t||wr(!1),t}function G2(e){let t=lR(),r=t.matches[t.matches.length-1];return r.route.id||wr(!1),r.route.id}function cR(){var e;let t=_e.useContext(U2),r=oR(),n=G2();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function uR(){let{router:e}=aR(H2.UseNavigateStable),t=G2(W2.UseNavigateStable),r=_e.useRef(!1);return z2(()=>{r.current=!0}),_e.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,gu({fromRouteId:t},s)))},[e,t])}const mv={};function fR(e,t,r){mv[e]||(mv[e]=!0)}function hR(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Zp(e){wr(!1)}function dR(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Ys.Pop,navigator:s,static:o=!1,future:l}=e;C0()&&wr(!1);let u=t.replace(/^\/*/,"/"),h=_e.useMemo(()=>({basename:u,navigator:s,static:o,future:gu({v7_relativeSplatPath:!1},l)}),[u,l,s,o]);typeof n=="string"&&(n=io(n));let{pathname:p="/",search:m="",hash:_="",state:x=null,key:E="default"}=n,y=_e.useMemo(()=>{let A=M2(p,u);return A==null?null:{location:{pathname:A,search:m,hash:_,state:x,key:E},navigationType:i}},[u,p,m,_,x,E,i]);return y==null?null:_e.createElement(S0.Provider,{value:h},_e.createElement(I0.Provider,{children:r,value:y}))}function pR(e){let{children:t,location:r}=e;return Qk(Kp(t),r)}new Promise(()=>{});function Kp(e,t){t===void 0&&(t=[]);let r=[];return _e.Children.forEach(e,(n,i)=>{if(!_e.isValidElement(n))return;let s=[...t,i];if(n.type===_e.Fragment){r.push.apply(r,Kp(n.props.children,s));return}n.type!==Zp&&wr(!1),!n.props.index||!n.props.children||wr(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Kp(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const mR="6";try{window.__reactRouterVersion=mR}catch{}const gR="startTransition",gv=fI[gR];function _R(e){let{basename:t,children:r,future:n,window:i}=e,s=_e.useRef();s.current==null&&(s.current=Tk({window:i,v5Compat:!0}));let o=s.current,[l,u]=_e.useState({action:o.action,location:o.location}),{v7_startTransition:h}=n||{},p=_e.useCallback(m=>{h&&gv?gv(()=>u(m)):u(m)},[u,h]);return _e.useLayoutEffect(()=>o.listen(p),[o,p]),_e.useEffect(()=>hR(n),[n]),_e.createElement(dR,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}var _v;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(_v||(_v={}));var vv;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(vv||(vv={}));function $2(e,t){const r=_e.useRef(t);_e.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}function vR(e,t,r){t.center!==r.center&&e.setLatLng(t.center),t.radius!=null&&t.radius!==r.radius&&e.setRadius(t.radius)}const xR=1;function yR(e){return Object.freeze({__version:xR,map:e})}function Z2(e,t){return Object.freeze({...e,...t})}const K2=_e.createContext(null),X2=K2.Provider;function k0(){const e=_e.useContext(K2);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function ER(e){function t(r,n){const{instance:i,context:s}=e(r).current;return _e.useImperativeHandle(n,()=>i),r.children==null?null:Wa.createElement(X2,{value:s},r.children)}return _e.forwardRef(t)}function TR(e){function t(r,n){const[i,s]=_e.useState(!1),{instance:o}=e(r,s).current;_e.useImperativeHandle(n,()=>o),_e.useEffect(function(){i&&o.update()},[o,i,r.children]);const l=o._contentNode;return l?L2.createPortal(r.children,l):null}return _e.forwardRef(t)}function wR(e){function t(r,n){const{instance:i}=e(r).current;return _e.useImperativeHandle(n,()=>i),null}return _e.forwardRef(t)}function Sg(e,t){const r=_e.useRef();_e.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function R0(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}function AR(e,t){return function(n,i){const s=k0(),o=e(R0(n,s),s);return $2(s.map,n.attribution),Sg(o.current,n.eventHandlers),t(o.current,s,n,i),o}}var Xp={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(KS,function(r){var n="1.9.4";function i(a){var c,d,g,T;for(d=1,g=arguments.length;d<g;d++){T=arguments[d];for(c in T)a[c]=T[c]}return a}var s=Object.create||function(){function a(){}return function(c){return a.prototype=c,new a}}();function o(a,c){var d=Array.prototype.slice;if(a.bind)return a.bind.apply(a,d.call(arguments,1));var g=d.call(arguments,2);return function(){return a.apply(c,g.length?g.concat(d.call(arguments)):arguments)}}var l=0;function u(a){return"_leaflet_id"in a||(a._leaflet_id=++l),a._leaflet_id}function h(a,c,d){var g,T,O,ee;return ee=function(){g=!1,T&&(O.apply(d,T),T=!1)},O=function(){g?T=arguments:(a.apply(d,arguments),setTimeout(ee,c),g=!0)},O}function p(a,c,d){var g=c[1],T=c[0],O=g-T;return a===g&&d?a:((a-T)%O+O)%O+T}function m(){return!1}function _(a,c){if(c===!1)return a;var d=Math.pow(10,c===void 0?6:c);return Math.round(a*d)/d}function x(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function E(a){return x(a).split(/\s+/)}function y(a,c){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?s(a.options):{});for(var d in c)a.options[d]=c[d];return a.options}function A(a,c,d){var g=[];for(var T in a)g.push(encodeURIComponent(d?T.toUpperCase():T)+"="+encodeURIComponent(a[T]));return(!c||c.indexOf("?")===-1?"?":"&")+g.join("&")}var C=/\{ *([\w_ -]+) *\}/g;function k(a,c){return a.replace(C,function(d,g){var T=c[g];if(T===void 0)throw new Error("No value provided for variable "+d);return typeof T=="function"&&(T=T(c)),T})}var w=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function V(a,c){for(var d=0;d<a.length;d++)if(a[d]===c)return d;return-1}var Q="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function X(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var S=0;function R(a){var c=+new Date,d=Math.max(0,16-(c-S));return S=c+d,window.setTimeout(a,d)}var P=window.requestAnimationFrame||X("RequestAnimationFrame")||R,D=window.cancelAnimationFrame||X("CancelAnimationFrame")||X("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function F(a,c,d){if(d&&P===R)a.call(c);else return P.call(window,o(a,c))}function b(a){a&&D.call(window,a)}var M={__proto__:null,extend:i,create:s,bind:o,get lastId(){return l},stamp:u,throttle:h,wrapNum:p,falseFn:m,formatNum:_,trim:x,splitWords:E,setOptions:y,getParamString:A,template:k,isArray:w,indexOf:V,emptyImageUrl:Q,requestFn:P,cancelFn:D,requestAnimFrame:F,cancelAnimFrame:b};function Pe(){}Pe.extend=function(a){var c=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=c.__super__=this.prototype,g=s(d);g.constructor=c,c.prototype=g;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(c[T]=this[T]);return a.statics&&i(c,a.statics),a.includes&&(ke(a.includes),i.apply(null,[g].concat(a.includes))),i(g,a),delete g.statics,delete g.includes,g.options&&(g.options=d.options?s(d.options):{},i(g.options,a.options)),g._initHooks=[],g.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var O=0,ee=g._initHooks.length;O<ee;O++)g._initHooks[O].call(this)}},c},Pe.include=function(a){var c=this.prototype.options;return i(this.prototype,a),a.options&&(this.prototype.options=c,this.mergeOptions(a.options)),this},Pe.mergeOptions=function(a){return i(this.prototype.options,a),this},Pe.addInitHook=function(a){var c=Array.prototype.slice.call(arguments,1),d=typeof a=="function"?a:function(){this[a].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function ke(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=w(a)?a:[a];for(var c=0;c<a.length;c++)a[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Ne={on:function(a,c,d){if(typeof a=="object")for(var g in a)this._on(g,a[g],c);else{a=E(a);for(var T=0,O=a.length;T<O;T++)this._on(a[T],c,d)}return this},off:function(a,c,d){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var g in a)this._off(g,a[g],c);else{a=E(a);for(var T=arguments.length===1,O=0,ee=a.length;O<ee;O++)T?this._off(a[O]):this._off(a[O],c,d)}return this},_on:function(a,c,d,g){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(a,c,d)===!1){d===this&&(d=void 0);var T={fn:c,ctx:d};g&&(T.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(T)}},_off:function(a,c,d){var g,T,O;if(this._events&&(g=this._events[a],!!g)){if(arguments.length===1){if(this._firingCount)for(T=0,O=g.length;T<O;T++)g[T].fn=m;delete this._events[a];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var ee=this._listens(a,c,d);if(ee!==!1){var ae=g[ee];this._firingCount&&(ae.fn=m,this._events[a]=g=g.slice()),g.splice(ee,1)}}},fire:function(a,c,d){if(!this.listens(a,d))return this;var g=i({},c,{type:a,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var T=this._events[a];if(T){this._firingCount=this._firingCount+1||1;for(var O=0,ee=T.length;O<ee;O++){var ae=T[O],he=ae.fn;ae.once&&this.off(a,he,ae.ctx),he.call(ae.ctx||this,g)}this._firingCount--}}return d&&this._propagateEvent(g),this},listens:function(a,c,d,g){typeof a!="string"&&console.warn('"string" type argument expected');var T=c;typeof c!="function"&&(g=!!c,T=void 0,d=void 0);var O=this._events&&this._events[a];if(O&&O.length&&this._listens(a,T,d)!==!1)return!0;if(g){for(var ee in this._eventParents)if(this._eventParents[ee].listens(a,c,d,g))return!0}return!1},_listens:function(a,c,d){if(!this._events)return!1;var g=this._events[a]||[];if(!c)return!!g.length;d===this&&(d=void 0);for(var T=0,O=g.length;T<O;T++)if(g[T].fn===c&&g[T].ctx===d)return T;return!1},once:function(a,c,d){if(typeof a=="object")for(var g in a)this._on(g,a[g],c,!0);else{a=E(a);for(var T=0,O=a.length;T<O;T++)this._on(a[T],c,d,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[u(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[u(a)],this},_propagateEvent:function(a){for(var c in this._eventParents)this._eventParents[c].fire(a.type,i({layer:a.target,propagatedFrom:a.target},a),!0)}};Ne.addEventListener=Ne.on,Ne.removeEventListener=Ne.clearAllEventListeners=Ne.off,Ne.addOneTimeEventListener=Ne.once,Ne.fireEvent=Ne.fire,Ne.hasEventListeners=Ne.listens;var Oe=Pe.extend(Ne);function ue(a,c,d){this.x=d?Math.round(a):a,this.y=d?Math.round(c):c}var te=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};ue.prototype={clone:function(){return new ue(this.x,this.y)},add:function(a){return this.clone()._add(de(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(de(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new ue(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new ue(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=te(this.x),this.y=te(this.y),this},distanceTo:function(a){a=de(a);var c=a.x-this.x,d=a.y-this.y;return Math.sqrt(c*c+d*d)},equals:function(a){return a=de(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=de(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+_(this.x)+", "+_(this.y)+")"}};function de(a,c,d){return a instanceof ue?a:w(a)?new ue(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new ue(a.x,a.y):new ue(a,c,d)}function Ae(a,c){if(a)for(var d=c?[a,c]:a,g=0,T=d.length;g<T;g++)this.extend(d[g])}Ae.prototype={extend:function(a){var c,d;if(!a)return this;if(a instanceof ue||typeof a[0]=="number"||"x"in a)c=d=de(a);else if(a=j(a),c=a.min,d=a.max,!c||!d)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=d.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(a){return de((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return de(this.min.x,this.max.y)},getTopRight:function(){return de(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var c,d;return typeof a[0]=="number"||a instanceof ue?a=de(a):a=j(a),a instanceof Ae?(c=a.min,d=a.max):c=d=a,c.x>=this.min.x&&d.x<=this.max.x&&c.y>=this.min.y&&d.y<=this.max.y},intersects:function(a){a=j(a);var c=this.min,d=this.max,g=a.min,T=a.max,O=T.x>=c.x&&g.x<=d.x,ee=T.y>=c.y&&g.y<=d.y;return O&&ee},overlaps:function(a){a=j(a);var c=this.min,d=this.max,g=a.min,T=a.max,O=T.x>c.x&&g.x<d.x,ee=T.y>c.y&&g.y<d.y;return O&&ee},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var c=this.min,d=this.max,g=Math.abs(c.x-d.x)*a,T=Math.abs(c.y-d.y)*a;return j(de(c.x-g,c.y-T),de(d.x+g,d.y+T))},equals:function(a){return a?(a=j(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function j(a,c){return!a||a instanceof Ae?a:new Ae(a,c)}function H(a,c){if(a)for(var d=c?[a,c]:a,g=0,T=d.length;g<T;g++)this.extend(d[g])}H.prototype={extend:function(a){var c=this._southWest,d=this._northEast,g,T;if(a instanceof q)g=a,T=a;else if(a instanceof H){if(g=a._southWest,T=a._northEast,!g||!T)return this}else return a?this.extend(re(a)||J(a)):this;return!c&&!d?(this._southWest=new q(g.lat,g.lng),this._northEast=new q(T.lat,T.lng)):(c.lat=Math.min(g.lat,c.lat),c.lng=Math.min(g.lng,c.lng),d.lat=Math.max(T.lat,d.lat),d.lng=Math.max(T.lng,d.lng)),this},pad:function(a){var c=this._southWest,d=this._northEast,g=Math.abs(c.lat-d.lat)*a,T=Math.abs(c.lng-d.lng)*a;return new H(new q(c.lat-g,c.lng-T),new q(d.lat+g,d.lng+T))},getCenter:function(){return new q((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new q(this.getNorth(),this.getWest())},getSouthEast:function(){return new q(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof q||"lat"in a?a=re(a):a=J(a);var c=this._southWest,d=this._northEast,g,T;return a instanceof H?(g=a.getSouthWest(),T=a.getNorthEast()):g=T=a,g.lat>=c.lat&&T.lat<=d.lat&&g.lng>=c.lng&&T.lng<=d.lng},intersects:function(a){a=J(a);var c=this._southWest,d=this._northEast,g=a.getSouthWest(),T=a.getNorthEast(),O=T.lat>=c.lat&&g.lat<=d.lat,ee=T.lng>=c.lng&&g.lng<=d.lng;return O&&ee},overlaps:function(a){a=J(a);var c=this._southWest,d=this._northEast,g=a.getSouthWest(),T=a.getNorthEast(),O=T.lat>c.lat&&g.lat<d.lat,ee=T.lng>c.lng&&g.lng<d.lng;return O&&ee},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,c){return a?(a=J(a),this._southWest.equals(a.getSouthWest(),c)&&this._northEast.equals(a.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function J(a,c){return a instanceof H?a:new H(a,c)}function q(a,c,d){if(isNaN(a)||isNaN(c))throw new Error("Invalid LatLng object: ("+a+", "+c+")");this.lat=+a,this.lng=+c,d!==void 0&&(this.alt=+d)}q.prototype={equals:function(a,c){if(!a)return!1;a=re(a);var d=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return d<=(c===void 0?1e-9:c)},toString:function(a){return"LatLng("+_(this.lat,a)+", "+_(this.lng,a)+")"},distanceTo:function(a){return ye.distance(this,re(a))},wrap:function(){return ye.wrapLatLng(this)},toBounds:function(a){var c=180*a/40075017,d=c/Math.cos(Math.PI/180*this.lat);return J([this.lat-c,this.lng-d],[this.lat+c,this.lng+d])},clone:function(){return new q(this.lat,this.lng,this.alt)}};function re(a,c,d){return a instanceof q?a:w(a)&&typeof a[0]!="object"?a.length===3?new q(a[0],a[1],a[2]):a.length===2?new q(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new q(a.lat,"lng"in a?a.lng:a.lon,a.alt):c===void 0?null:new q(a,c,d)}var ge={latLngToPoint:function(a,c){var d=this.projection.project(a),g=this.scale(c);return this.transformation._transform(d,g)},pointToLatLng:function(a,c){var d=this.scale(c),g=this.transformation.untransform(a,d);return this.projection.unproject(g)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var c=this.projection.bounds,d=this.scale(a),g=this.transformation.transform(c.min,d),T=this.transformation.transform(c.max,d);return new Ae(g,T)},infinite:!1,wrapLatLng:function(a){var c=this.wrapLng?p(a.lng,this.wrapLng,!0):a.lng,d=this.wrapLat?p(a.lat,this.wrapLat,!0):a.lat,g=a.alt;return new q(d,c,g)},wrapLatLngBounds:function(a){var c=a.getCenter(),d=this.wrapLatLng(c),g=c.lat-d.lat,T=c.lng-d.lng;if(g===0&&T===0)return a;var O=a.getSouthWest(),ee=a.getNorthEast(),ae=new q(O.lat-g,O.lng-T),he=new q(ee.lat-g,ee.lng-T);return new H(ae,he)}},ye=i({},ge,{wrapLng:[-180,180],R:6371e3,distance:function(a,c){var d=Math.PI/180,g=a.lat*d,T=c.lat*d,O=Math.sin((c.lat-a.lat)*d/2),ee=Math.sin((c.lng-a.lng)*d/2),ae=O*O+Math.cos(g)*Math.cos(T)*ee*ee,he=2*Math.atan2(Math.sqrt(ae),Math.sqrt(1-ae));return this.R*he}}),Se=6378137,ve={R:Se,MAX_LATITUDE:85.0511287798,project:function(a){var c=Math.PI/180,d=this.MAX_LATITUDE,g=Math.max(Math.min(d,a.lat),-d),T=Math.sin(g*c);return new ue(this.R*a.lng*c,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(a){var c=180/Math.PI;return new q((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*c,a.x*c/this.R)},bounds:function(){var a=Se*Math.PI;return new Ae([-a,-a],[a,a])}()};function Ye(a,c,d,g){if(w(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=c,this._c=d,this._d=g}Ye.prototype={transform:function(a,c){return this._transform(a.clone(),c)},_transform:function(a,c){return c=c||1,a.x=c*(this._a*a.x+this._b),a.y=c*(this._c*a.y+this._d),a},untransform:function(a,c){return c=c||1,new ue((a.x/c-this._b)/this._a,(a.y/c-this._d)/this._c)}};function Y(a,c,d,g){return new Ye(a,c,d,g)}var yt=i({},ye,{code:"EPSG:3857",projection:ve,transformation:function(){var a=.5/(Math.PI*ve.R);return Y(a,.5,-a,.5)}()}),He=i({},yt,{code:"EPSG:900913"});function ot(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function ne(a,c){var d="",g,T,O,ee,ae,he;for(g=0,O=a.length;g<O;g++){for(ae=a[g],T=0,ee=ae.length;T<ee;T++)he=ae[T],d+=(T?"L":"M")+he.x+" "+he.y;d+=c?ze.svg?"z":"x":""}return d||"M0 0"}var fe=document.documentElement.style,be="ActiveXObject"in window,Xe=be&&!document.addEventListener,qe="msLaunchUri"in navigator&&!("documentMode"in document),mt=yn("webkit"),Lt=yn("android"),ir=yn("android 2")||yn("android 3"),Qt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Dr=Lt&&yn("Google")&&Qt<537&&!("AudioNode"in window),ct=!!window.opera,Dt=!qe&&yn("chrome"),bt=yn("gecko")&&!mt&&!ct&&!be,Ir=!Dt&&yn("safari"),Re=yn("phantom"),it="OTransition"in fe,At=navigator.platform.indexOf("Win")===0,lt=be&&"transition"in fe,cr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ir,xn="MozPerspective"in fe,an=!window.L_DISABLE_3D&&(lt||cr||xn)&&!it&&!Re,on=typeof orientation<"u"||yn("mobile"),Pn=on&&mt,Nn=on&&cr,Di=!window.PointerEvent&&window.MSPointerEvent,Fi=!!(window.PointerEvent||Di),Os="ontouchstart"in window||!!window.TouchEvent,bi=!window.L_NO_TOUCH&&(Os||Fi),mi=on&&ct,po=on&&bt,Ls=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,mo=function(){var a=!1;try{var c=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",m,c),window.removeEventListener("testPassiveEventSupport",m,c)}catch{}return a}(),ts=function(){return!!document.createElement("canvas").getContext}(),Ds=!!(document.createElementNS&&ot("svg").createSVGRect),_r=!!Ds&&function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),go=!Ds&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var c=a.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),gi=navigator.platform.indexOf("Mac")===0,rs=navigator.platform.indexOf("Linux")===0;function yn(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var ze={ie:be,ielt9:Xe,edge:qe,webkit:mt,android:Lt,android23:ir,androidStock:Dr,opera:ct,chrome:Dt,gecko:bt,safari:Ir,phantom:Re,opera12:it,win:At,ie3d:lt,webkit3d:cr,gecko3d:xn,any3d:an,mobile:on,mobileWebkit:Pn,mobileWebkit3d:Nn,msPointer:Di,pointer:Fi,touch:bi,touchNative:Os,mobileOpera:mi,mobileGecko:po,retina:Ls,passiveEvents:mo,canvas:ts,svg:Ds,vml:go,inlineSvg:_r,mac:gi,linux:rs},N=ze.msPointer?"MSPointerDown":"pointerdown",W=ze.msPointer?"MSPointerMove":"pointermove",U=ze.msPointer?"MSPointerUp":"pointerup",z=ze.msPointer?"MSPointerCancel":"pointercancel",G={touchstart:N,touchmove:W,touchend:U,touchcancel:z},K={touchstart:Fe,touchmove:Ie,touchend:Ie,touchcancel:Ie},se={},me=!1;function oe(a,c,d){return c==="touchstart"&&Me(),K[c]?(d=K[c].bind(this,d),a.addEventListener(G[c],d,!1),d):(console.warn("wrong event specified:",c),m)}function le(a,c,d){if(!G[c]){console.warn("wrong event specified:",c);return}a.removeEventListener(G[c],d,!1)}function ce(a){se[a.pointerId]=a}function Te(a){se[a.pointerId]&&(se[a.pointerId]=a)}function Le(a){delete se[a.pointerId]}function Me(){me||(document.addEventListener(N,ce,!0),document.addEventListener(W,Te,!0),document.addEventListener(U,Le,!0),document.addEventListener(z,Le,!0),me=!0)}function Ie(a,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var d in se)c.touches.push(se[d]);c.changedTouches=[c],a(c)}}function Fe(a,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Zt(c),Ie(a,c)}function Ze(a){var c={},d,g;for(g in a)d=a[g],c[g]=d&&d.bind?d.bind(a):d;return a=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Ct=200;function It(a,c){a.addEventListener("dblclick",c);var d=0,g;function T(O){if(O.detail!==1){g=O.detail;return}if(!(O.pointerType==="mouse"||O.sourceCapabilities&&!O.sourceCapabilities.firesTouchEvents)){var ee=Xl(O);if(!(ee.some(function(he){return he instanceof HTMLLabelElement&&he.attributes.for})&&!ee.some(function(he){return he instanceof HTMLInputElement||he instanceof HTMLSelectElement}))){var ae=Date.now();ae-d<=Ct?(g++,g===2&&c(Ze(O))):g=1,d=ae}}}return a.addEventListener("click",T),{dblclick:c,simDblclick:T}}function Mt(a,c){a.removeEventListener("dblclick",c.dblclick),a.removeEventListener("click",c.simDblclick)}var On=is(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ln=is(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),_i=Ln==="webkitTransition"||Ln==="OTransition"?Ln+"End":"transitionend";function Dn(a){return typeof a=="string"?document.getElementById(a):a}function Xn(a,c){var d=a.style[c]||a.currentStyle&&a.currentStyle[c];if((!d||d==="auto")&&document.defaultView){var g=document.defaultView.getComputedStyle(a,null);d=g?g[c]:null}return d==="auto"?null:d}function Je(a,c,d){var g=document.createElement(a);return g.className=c||"",d&&d.appendChild(g),g}function Ft(a){var c=a.parentNode;c&&c.removeChild(a)}function Ia(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function ns(a){var c=a.parentNode;c&&c.lastChild!==a&&c.appendChild(a)}function Fs(a){var c=a.parentNode;c&&c.firstChild!==a&&c.insertBefore(a,c.firstChild)}function Vl(a,c){if(a.classList!==void 0)return a.classList.contains(c);var d=qn(a);return d.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(d)}function st(a,c){if(a.classList!==void 0)for(var d=E(c),g=0,T=d.length;g<T;g++)a.classList.add(d[g]);else if(!Vl(a,c)){var O=qn(a);zl(a,(O?O+" ":"")+c)}}function jt(a,c){a.classList!==void 0?a.classList.remove(c):zl(a,x((" "+qn(a)+" ").replace(" "+c+" "," ")))}function zl(a,c){a.className.baseVal===void 0?a.className=c:a.className.baseVal=c}function qn(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function er(a,c){"opacity"in a.style?a.style.opacity=c:"filter"in a.style&&_o(a,c)}function _o(a,c){var d=!1,g="DXImageTransform.Microsoft.Alpha";try{d=a.filters.item(g)}catch{if(c===1)return}c=Math.round(c*100),d?(d.Enabled=c!==100,d.Opacity=c):a.style.filter+=" progid:"+g+"(opacity="+c+")"}function is(a){for(var c=document.documentElement.style,d=0;d<a.length;d++)if(a[d]in c)return a[d];return!1}function Mi(a,c,d){var g=c||new ue(0,0);a.style[On]=(ze.ie3d?"translate("+g.x+"px,"+g.y+"px)":"translate3d("+g.x+"px,"+g.y+"px,0)")+(d?" scale("+d+")":"")}function Qe(a,c){a._leaflet_pos=c,ze.any3d?Mi(a,c):(a.style.left=c.x+"px",a.style.top=c.y+"px")}function Yn(a){return a._leaflet_pos||new ue(0,0)}var vi,xi,jl;if("onselectstart"in document)vi=function(){Ge(window,"selectstart",Zt)},xi=function(){Nt(window,"selectstart",Zt)};else{var bs=is(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);vi=function(){if(bs){var a=document.documentElement.style;jl=a[bs],a[bs]="none"}},xi=function(){bs&&(document.documentElement.style[bs]=jl,jl=void 0)}}function Hl(){Ge(window,"dragstart",Zt)}function Wl(){Nt(window,"dragstart",Zt)}var vo,Gl;function ss(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(Fn(),vo=a,Gl=a.style.outlineStyle,a.style.outlineStyle="none",Ge(window,"keydown",Fn))}function Fn(){vo&&(vo.style.outlineStyle=Gl,vo=void 0,Gl=void 0,Nt(window,"keydown",Fn))}function $l(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function xo(a){var c=a.getBoundingClientRect();return{x:c.width/a.offsetWidth||1,y:c.height/a.offsetHeight||1,boundingClientRect:c}}var Qu={__proto__:null,TRANSFORM:On,TRANSITION:Ln,TRANSITION_END:_i,get:Dn,getStyle:Xn,create:Je,remove:Ft,empty:Ia,toFront:ns,toBack:Fs,hasClass:Vl,addClass:st,removeClass:jt,setClass:zl,getClass:qn,setOpacity:er,testProp:is,setTransform:Mi,setPosition:Qe,getPosition:Yn,get disableTextSelection(){return vi},get enableTextSelection(){return xi},disableImageDrag:Hl,enableImageDrag:Wl,preventOutline:ss,restoreOutline:Fn,getSizedParentNode:$l,getScale:xo};function Ge(a,c,d,g){if(c&&typeof c=="object")for(var T in c)Zl(a,T,c[T],d);else{c=E(c);for(var O=0,ee=c.length;O<ee;O++)Zl(a,c[O],d,g)}return this}var Jn="_leaflet_events";function Nt(a,c,d,g){if(arguments.length===1)ef(a),delete a[Jn];else if(c&&typeof c=="object")for(var T in c)Kl(a,T,c[T],d);else if(c=E(c),arguments.length===2)ef(a,function(ae){return V(c,ae)!==-1});else for(var O=0,ee=c.length;O<ee;O++)Kl(a,c[O],d,g);return this}function ef(a,c){for(var d in a[Jn]){var g=d.split(/\d/)[0];(!c||c(g))&&Kl(a,g,null,null,d)}}var Qn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Zl(a,c,d,g){var T=c+u(d)+(g?"_"+u(g):"");if(a[Jn]&&a[Jn][T])return this;var O=function(ae){return d.call(g||a,ae||window.event)},ee=O;!ze.touchNative&&ze.pointer&&c.indexOf("touch")===0?O=oe(a,c,O):ze.touch&&c==="dblclick"?O=It(a,O):"addEventListener"in a?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?a.addEventListener(Qn[c]||c,O,ze.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(O=function(ae){ae=ae||window.event,ql(a,ae)&&ee(ae)},a.addEventListener(Qn[c],O,!1)):a.addEventListener(c,ee,!1):a.attachEvent("on"+c,O),a[Jn]=a[Jn]||{},a[Jn][T]=O}function Kl(a,c,d,g,T){T=T||c+u(d)+(g?"_"+u(g):"");var O=a[Jn]&&a[Jn][T];if(!O)return this;!ze.touchNative&&ze.pointer&&c.indexOf("touch")===0?le(a,c,O):ze.touch&&c==="dblclick"?Mt(a,O):"removeEventListener"in a?a.removeEventListener(Qn[c]||c,O,!1):a.detachEvent("on"+c,O),a[Jn][T]=null}function ei(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function Ms(a){return Zl(a,"wheel",ei),this}function Bs(a){return Ge(a,"mousedown touchstart dblclick contextmenu",ei),a._leaflet_disable_click=!0,this}function Zt(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function bn(a){return Zt(a),ei(a),this}function Xl(a){if(a.composedPath)return a.composedPath();for(var c=[],d=a.target;d;)c.push(d),d=d.parentNode;return c}function yo(a,c){if(!c)return new ue(a.clientX,a.clientY);var d=xo(c),g=d.boundingClientRect;return new ue((a.clientX-g.left)/d.x-c.clientLeft,(a.clientY-g.top)/d.y-c.clientTop)}var Ht=ze.linux&&ze.chrome?window.devicePixelRatio:ze.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function tf(a){return ze.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/Ht:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function ql(a,c){var d=c.relatedTarget;if(!d)return!0;try{for(;d&&d!==a;)d=d.parentNode}catch{return!1}return d!==a}var rf={__proto__:null,on:Ge,off:Nt,stopPropagation:ei,disableScrollPropagation:Ms,disableClickPropagation:Bs,preventDefault:Zt,stop:bn,getPropagationPath:Xl,getMousePosition:yo,getWheelDelta:tf,isExternalTarget:ql,addListener:Ge,removeListener:Nt},Yl=Oe.extend({run:function(a,c,d,g){this.stop(),this._el=a,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(g||.5,.2),this._startPos=Yn(a),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(a){var c=+new Date-this._startTime,d=this._duration*1e3;c<d?this._runFrame(this._easeOut(c/d),a):(this._runFrame(1),this._complete())},_runFrame:function(a,c){var d=this._startPos.add(this._offset.multiplyBy(a));c&&d._round(),Qe(this._el,d),this.fire("step")},_complete:function(){b(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),ft=Oe.extend({options:{crs:yt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,c){c=y(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(re(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ln&&ze.any3d&&!ze.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ge(this._proxy,_i,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,c,d){if(c=c===void 0?this._zoom:this._limitZoom(c),a=this._limitCenter(re(a),c,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=i({animate:d.animate},d.zoom),d.pan=i({animate:d.animate,duration:d.duration},d.pan));var g=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,c,d.zoom):this._tryAnimatedPan(a,d.pan);if(g)return clearTimeout(this._sizeTimer),this}return this._resetView(a,c,d.pan&&d.pan.noMoveStart),this},setZoom:function(a,c){return this._loaded?this.setView(this.getCenter(),a,{zoom:c}):(this._zoom=a,this)},zoomIn:function(a,c){return a=a||(ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,c)},zoomOut:function(a,c){return a=a||(ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,c)},setZoomAround:function(a,c,d){var g=this.getZoomScale(c),T=this.getSize().divideBy(2),O=a instanceof ue?a:this.latLngToContainerPoint(a),ee=O.subtract(T).multiplyBy(1-1/g),ae=this.containerPointToLatLng(T.add(ee));return this.setView(ae,c,{zoom:d})},_getBoundsCenterZoom:function(a,c){c=c||{},a=a.getBounds?a.getBounds():J(a);var d=de(c.paddingTopLeft||c.padding||[0,0]),g=de(c.paddingBottomRight||c.padding||[0,0]),T=this.getBoundsZoom(a,!1,d.add(g));if(T=typeof c.maxZoom=="number"?Math.min(c.maxZoom,T):T,T===1/0)return{center:a.getCenter(),zoom:T};var O=g.subtract(d).divideBy(2),ee=this.project(a.getSouthWest(),T),ae=this.project(a.getNorthEast(),T),he=this.unproject(ee.add(ae).divideBy(2).add(O),T);return{center:he,zoom:T}},fitBounds:function(a,c){if(a=J(a),!a.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(a,c);return this.setView(d.center,d.zoom,c)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,c){return this.setView(a,this._zoom,{pan:c})},panBy:function(a,c){if(a=de(a).round(),c=c||{},!a.x&&!a.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Yl,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){st(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,d,c.duration||.25,c.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,c,d){if(d=d||{},d.animate===!1||!ze.any3d)return this.setView(a,c,d);this._stop();var g=this.project(this.getCenter()),T=this.project(a),O=this.getSize(),ee=this._zoom;a=re(a),c=c===void 0?ee:c;var ae=Math.max(O.x,O.y),he=ae*this.getZoomScale(ee,c),xe=T.distanceTo(g)||1,Be=1.42,$e=Be*Be;function ut(fr){var xf=fr?-1:1,HS=fr?he:ae,WS=he*he-ae*ae+xf*$e*$e*xe*xe,GS=2*HS*$e*xe,nd=WS/GS,e1=Math.sqrt(nd*nd+1)-nd,$S=e1<1e-9?-18:Math.log(e1);return $S}function cn(fr){return(Math.exp(fr)-Math.exp(-fr))/2}function kr(fr){return(Math.exp(fr)+Math.exp(-fr))/2}function ri(fr){return cn(fr)/kr(fr)}var Tn=ut(0);function Lo(fr){return ae*(kr(Tn)/kr(Tn+Be*fr))}function US(fr){return ae*(kr(Tn)*ri(Tn+Be*fr)-cn(Tn))/$e}function VS(fr){return 1-Math.pow(1-fr,1.5)}var zS=Date.now(),J_=(ut(1)-Tn)/Be,jS=d.duration?1e3*d.duration:1e3*J_*.8;function Q_(){var fr=(Date.now()-zS)/jS,xf=VS(fr)*J_;fr<=1?(this._flyToFrame=F(Q_,this),this._move(this.unproject(g.add(T.subtract(g).multiplyBy(US(xf)/xe)),ee),this.getScaleZoom(ae/Lo(xf),ee),{flyTo:!0})):this._move(a,c)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),Q_.call(this),this},flyToBounds:function(a,c){var d=this._getBoundsCenterZoom(a,c);return this.flyTo(d.center,d.zoom,c)},setMaxBounds:function(a){return a=J(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var c=this.options.minZoom;return this.options.minZoom=a,this._loaded&&c!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var c=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&c!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,c){this._enforcingBounds=!0;var d=this.getCenter(),g=this._limitCenter(d,this._zoom,J(a));return d.equals(g)||this.panTo(g,c),this._enforcingBounds=!1,this},panInside:function(a,c){c=c||{};var d=de(c.paddingTopLeft||c.padding||[0,0]),g=de(c.paddingBottomRight||c.padding||[0,0]),T=this.project(this.getCenter()),O=this.project(a),ee=this.getPixelBounds(),ae=j([ee.min.add(d),ee.max.subtract(g)]),he=ae.getSize();if(!ae.contains(O)){this._enforcingBounds=!0;var xe=O.subtract(ae.getCenter()),Be=ae.extend(O).getSize().subtract(he);T.x+=xe.x<0?-Be.x:Be.x,T.y+=xe.y<0?-Be.y:Be.y,this.panTo(this.unproject(T),c),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=i({animate:!1,pan:!0},a===!0?{animate:!0}:a);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),g=c.divideBy(2).round(),T=d.divideBy(2).round(),O=g.subtract(T);return!O.x&&!O.y?this:(a.animate&&a.pan?this.panBy(O):(a.pan&&this._rawPanBy(O),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=i({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=o(this._handleGeolocationResponse,this),d=o(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,d,a):navigator.geolocation.getCurrentPosition(c,d,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var c=a.code,d=a.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var c=a.coords.latitude,d=a.coords.longitude,g=new q(c,d),T=g.toBounds(a.coords.accuracy*2),O=this._locateOptions;if(O.setView){var ee=this.getBoundsZoom(T);this.setView(g,O.maxZoom?Math.min(ee,O.maxZoom):ee)}var ae={latlng:g,bounds:T,timestamp:a.timestamp};for(var he in a.coords)typeof a.coords[he]=="number"&&(ae[he]=a.coords[he]);this.fire("locationfound",ae)}},addHandler:function(a,c){if(!c)return this;var d=this[a]=new c(this);return this._handlers.push(d),this.options[a]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Ft(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(b(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)Ft(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,c){var d="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),g=Je("div",d,c||this._mapPane);return a&&(this._panes[a]=g),g},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),c=this.unproject(a.getBottomLeft()),d=this.unproject(a.getTopRight());return new H(c,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,c,d){a=J(a),d=de(d||[0,0]);var g=this.getZoom()||0,T=this.getMinZoom(),O=this.getMaxZoom(),ee=a.getNorthWest(),ae=a.getSouthEast(),he=this.getSize().subtract(d),xe=j(this.project(ae,g),this.project(ee,g)).getSize(),Be=ze.any3d?this.options.zoomSnap:1,$e=he.x/xe.x,ut=he.y/xe.y,cn=c?Math.max($e,ut):Math.min($e,ut);return g=this.getScaleZoom(cn,g),Be&&(g=Math.round(g/(Be/100))*(Be/100),g=c?Math.ceil(g/Be)*Be:Math.floor(g/Be)*Be),Math.max(T,Math.min(O,g))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ue(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,c){var d=this._getTopLeftPoint(a,c);return new Ae(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,c){var d=this.options.crs;return c=c===void 0?this._zoom:c,d.scale(a)/d.scale(c)},getScaleZoom:function(a,c){var d=this.options.crs;c=c===void 0?this._zoom:c;var g=d.zoom(a*d.scale(c));return isNaN(g)?1/0:g},project:function(a,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(re(a),c)},unproject:function(a,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(de(a),c)},layerPointToLatLng:function(a){var c=de(a).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(a){var c=this.project(re(a))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(re(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(J(a))},distance:function(a,c){return this.options.crs.distance(re(a),re(c))},containerPointToLayerPoint:function(a){return de(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return de(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var c=this.containerPointToLayerPoint(de(a));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(re(a)))},mouseEventToContainerPoint:function(a){return yo(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var c=this._container=Dn(a);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ge(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&ze.any3d,st(a,"leaflet-container"+(ze.touch?" leaflet-touch":"")+(ze.retina?" leaflet-retina":"")+(ze.ielt9?" leaflet-oldie":"")+(ze.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=Xn(a,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Qe(this._mapPane,new ue(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(st(a.markerPane,"leaflet-zoom-hide"),st(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,c,d){Qe(this._mapPane,new ue(0,0));var g=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var T=this._zoom!==c;this._moveStart(T,d)._move(a,c)._moveEnd(T),this.fire("viewreset"),g&&this.fire("load")},_moveStart:function(a,c){return a&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(a,c,d,g){c===void 0&&(c=this._zoom);var T=this._zoom!==c;return this._zoom=c,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),g?d&&d.pinch&&this.fire("zoom",d):((T||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return b(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){Qe(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[u(this._container)]=this;var c=a?Nt:Ge;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),ze.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){b(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,c){for(var d=[],g,T=c==="mouseout"||c==="mouseover",O=a.target||a.srcElement,ee=!1;O;){if(g=this._targets[u(O)],g&&(c==="click"||c==="preclick")&&this._draggableMoved(g)){ee=!0;break}if(g&&g.listens(c,!0)&&(T&&!ql(O,a)||(d.push(g),T))||O===this._container)break;O=O.parentNode}return!d.length&&!ee&&!T&&this.listens(c,!0)&&(d=[this]),d},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var c=a.target||a.srcElement;if(!(!this._loaded||c._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(c))){var d=a.type;d==="mousedown"&&ss(c),this._fireDOMEvent(a,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,c,d){if(a.type==="click"){var g=i({},a);g.type="preclick",this._fireDOMEvent(g,g.type,d)}var T=this._findEventTargets(a,c);if(d){for(var O=[],ee=0;ee<d.length;ee++)d[ee].listens(c,!0)&&O.push(d[ee]);T=O.concat(T)}if(T.length){c==="contextmenu"&&Zt(a);var ae=T[0],he={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var xe=ae.getLatLng&&(!ae._radius||ae._radius<=10);he.containerPoint=xe?this.latLngToContainerPoint(ae.getLatLng()):this.mouseEventToContainerPoint(a),he.layerPoint=this.containerPointToLayerPoint(he.containerPoint),he.latlng=xe?ae.getLatLng():this.layerPointToLatLng(he.layerPoint)}for(ee=0;ee<T.length;ee++)if(T[ee].fire(c,he,!0),he.originalEvent._stopped||T[ee].options.bubblingMouseEvents===!1&&V(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,c=this._handlers.length;a<c;a++)this._handlers[a].disable()},whenReady:function(a,c){return this._loaded?a.call(c||this,{target:this}):this.on("load",a,c),this},_getMapPanePos:function(){return Yn(this._mapPane)||new ue(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,c){var d=a&&c!==void 0?this._getNewPixelOrigin(a,c):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,c){var d=this.getSize()._divideBy(2);return this.project(a,c)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,c,d){var g=this._getNewPixelOrigin(d,c);return this.project(a,c)._subtract(g)},_latLngBoundsToNewLayerBounds:function(a,c,d){var g=this._getNewPixelOrigin(d,c);return j([this.project(a.getSouthWest(),c)._subtract(g),this.project(a.getNorthWest(),c)._subtract(g),this.project(a.getSouthEast(),c)._subtract(g),this.project(a.getNorthEast(),c)._subtract(g)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,c,d){if(!d)return a;var g=this.project(a,c),T=this.getSize().divideBy(2),O=new Ae(g.subtract(T),g.add(T)),ee=this._getBoundsOffset(O,d,c);return Math.abs(ee.x)<=1&&Math.abs(ee.y)<=1?a:this.unproject(g.add(ee),c)},_limitOffset:function(a,c){if(!c)return a;var d=this.getPixelBounds(),g=new Ae(d.min.add(a),d.max.add(a));return a.add(this._getBoundsOffset(g,c))},_getBoundsOffset:function(a,c,d){var g=j(this.project(c.getNorthEast(),d),this.project(c.getSouthWest(),d)),T=g.min.subtract(a.min),O=g.max.subtract(a.max),ee=this._rebound(T.x,-O.x),ae=this._rebound(T.y,-O.y);return new ue(ee,ae)},_rebound:function(a,c){return a+c>0?Math.round(a-c)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(c))},_limitZoom:function(a){var c=this.getMinZoom(),d=this.getMaxZoom(),g=ze.any3d?this.options.zoomSnap:1;return g&&(a=Math.round(a/g)*g),Math.max(c,Math.min(d,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){jt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,c){var d=this._getCenterOffset(a)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,c),!0)},_createAnimProxy:function(){var a=this._proxy=Je("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(c){var d=On,g=this._proxy.style[d];Mi(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),g===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ft(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),c=this.getZoom();Mi(this._proxy,this.project(a,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,c,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var g=this.getZoomScale(c),T=this._getCenterOffset(a)._divideBy(1-1/g);return d.animate!==!0&&!this.getSize().contains(T)?!1:(F(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(a,c,!0)},this),!0)},_animateZoom:function(a,c,d,g){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=c,st(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:c,noUpdate:g}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&jt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Eo(a,c){return new ft(a,c)}var En=Pe.extend({options:{position:"topright"},initialize:function(a){y(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var c=this._map;return c&&c.removeControl(this),this.options.position=a,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var c=this._container=this.onAdd(a),d=this.getPosition(),g=a._controlCorners[d];return st(c,"leaflet-control"),d.indexOf("bottom")!==-1?g.insertBefore(c,g.firstChild):g.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Ft(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),ln=function(a){return new En(a)};ft.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},c="leaflet-",d=this._controlContainer=Je("div",c+"control-container",this._container);function g(T,O){var ee=c+T+" "+c+O;a[T+O]=Je("div",ee,d)}g("top","left"),g("top","right"),g("bottom","left"),g("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)Ft(this._controlCorners[a]);Ft(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Jl=En.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,c,d,g){return d<g?-1:g<d?1:0}},initialize:function(a,c,d){y(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var g in a)this._addLayer(a[g],g);for(g in c)this._addLayer(c[g],g,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return En.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,c){return this._addLayer(a,c),this._map?this._update():this},addOverlay:function(a,c){return this._addLayer(a,c,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(a));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){st(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(st(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):jt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return jt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",c=this._container=Je("div",a),d=this.options.collapsed;c.setAttribute("aria-haspopup",!0),Bs(c),Ms(c);var g=this._section=Je("section",a+"-list");d&&(this._map.on("click",this.collapse,this),Ge(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=Je("a",a+"-toggle",c);T.href="#",T.title="Layers",T.setAttribute("role","button"),Ge(T,{keydown:function(O){O.keyCode===13&&this._expandSafely()},click:function(O){Zt(O),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=Je("div",a+"-base",g),this._separator=Je("div",a+"-separator",g),this._overlaysList=Je("div",a+"-overlays",g),c.appendChild(g)},_getLayer:function(a){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===a)return this._layers[c]},_addLayer:function(a,c,d){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:c,overlay:d}),this.options.sortLayers&&this._layers.sort(o(function(g,T){return this.options.sortFunction(g.layer,T.layer,g.name,T.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ia(this._baseLayersList),Ia(this._overlaysList),this._layerControlInputs=[];var a,c,d,g,T=0;for(d=0;d<this._layers.length;d++)g=this._layers[d],this._addItem(g),c=c||g.overlay,a=a||!g.overlay,T+=g.overlay?0:1;return this.options.hideSingleBase&&(a=a&&T>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=c&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var c=this._getLayer(u(a.target)),d=c.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;d&&this._map.fire(d,c)},_createRadioElement:function(a,c){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(c?' checked="checked"':"")+"/>",g=document.createElement("div");return g.innerHTML=d,g.firstChild},_addItem:function(a){var c=document.createElement("label"),d=this._map.hasLayer(a.layer),g;a.overlay?(g=document.createElement("input"),g.type="checkbox",g.className="leaflet-control-layers-selector",g.defaultChecked=d):g=this._createRadioElement("leaflet-base-layers_"+u(this),d),this._layerControlInputs.push(g),g.layerId=u(a.layer),Ge(g,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+a.name;var O=document.createElement("span");c.appendChild(O),O.appendChild(g),O.appendChild(T);var ee=a.overlay?this._overlaysList:this._baseLayersList;return ee.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,c,d,g=[],T=[];this._handlingClick=!0;for(var O=a.length-1;O>=0;O--)c=a[O],d=this._getLayer(c.layerId).layer,c.checked?g.push(d):c.checked||T.push(d);for(O=0;O<T.length;O++)this._map.hasLayer(T[O])&&this._map.removeLayer(T[O]);for(O=0;O<g.length;O++)this._map.hasLayer(g[O])||this._map.addLayer(g[O]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,c,d,g=this._map.getZoom(),T=a.length-1;T>=0;T--)c=a[T],d=this._getLayer(c.layerId).layer,c.disabled=d.options.minZoom!==void 0&&g<d.options.minZoom||d.options.maxZoom!==void 0&&g>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,Ge(a,"click",Zt),this.expand();var c=this;setTimeout(function(){Nt(a,"click",Zt),c._preventClick=!1})}}),Y0=function(a,c,d){return new Jl(a,c,d)},as=En.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var c="leaflet-control-zoom",d=Je("div",c+" leaflet-bar"),g=this.options;return this._zoomInButton=this._createButton(g.zoomInText,g.zoomInTitle,c+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(g.zoomOutText,g.zoomOutTitle,c+"-out",d,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,c,d,g,T){var O=Je("a",d,g);return O.innerHTML=a,O.href="#",O.title=c,O.setAttribute("role","button"),O.setAttribute("aria-label",c),Bs(O),Ge(O,"click",bn),Ge(O,"click",T,this),Ge(O,"click",this._refocusOnMap,this),O},_updateDisabled:function(){var a=this._map,c="leaflet-disabled";jt(this._zoomInButton,c),jt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(st(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(st(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});ft.mergeOptions({zoomControl:!0}),ft.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new as,this.addControl(this.zoomControl))});var nf=function(a){return new as(a)},To=En.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var c="leaflet-control-scale",d=Je("div",c),g=this.options;return this._addScales(g,c+"-line",d),a.on(g.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),d},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,c,d){a.metric&&(this._mScale=Je("div",c,d)),a.imperial&&(this._iScale=Je("div",c,d))},_update:function(){var a=this._map,c=a.getSize().y/2,d=a.distance(a.containerPointToLatLng([0,c]),a.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(d)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var c=this._getRoundNum(a),d=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,d,c/a)},_updateImperial:function(a){var c=a*3.2808399,d,g,T;c>5280?(d=c/5280,g=this._getRoundNum(d),this._updateScale(this._iScale,g+" mi",g/d)):(T=this._getRoundNum(c),this._updateScale(this._iScale,T+" ft",T/c))},_updateScale:function(a,c,d){a.style.width=Math.round(this.options.maxWidth*d)+"px",a.innerHTML=c},_getRoundNum:function(a){var c=Math.pow(10,(Math.floor(a)+"").length-1),d=a/c;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,c*d}}),wo=function(a){return new To(a)},sf='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Us=En.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ze.inlineSvg?sf+" ":"")+"Leaflet</a>"},initialize:function(a){y(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=Je("div","leaflet-control-attribution"),Bs(this._container);for(var c in a._layers)a._layers[c].getAttribution&&this.addAttribution(a._layers[c].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var c in this._attributions)this._attributions[c]&&a.push(c);var d=[];this.options.prefix&&d.push(this.options.prefix),a.length&&d.push(a.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});ft.mergeOptions({attributionControl:!0}),ft.addInitHook(function(){this.options.attributionControl&&new Us().addTo(this)});var J0=function(a){return new Us(a)};En.Layers=Jl,En.Zoom=as,En.Scale=To,En.Attribution=Us,ln.layers=Y0,ln.zoom=nf,ln.scale=wo,ln.attribution=J0;var Mn=Pe.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Mn.addTo=function(a,c){return a.addHandler(c,this),this};var Ca={Events:Ne},Ql=ze.touch?"touchstart mousedown":"mousedown",yi=Oe.extend({options:{clickTolerance:3},initialize:function(a,c,d,g){y(this,g),this._element=a,this._dragStartTarget=c||a,this._preventOutline=d},enable:function(){this._enabled||(Ge(this._dragStartTarget,Ql,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(yi._dragging===this&&this.finishDrag(!0),Nt(this._dragStartTarget,Ql,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!Vl(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){yi._dragging===this&&this.finishDrag();return}if(!(yi._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(yi._dragging=this,this._preventOutline&&ss(this._element),Hl(),vi(),!this._moving)){this.fire("down");var c=a.touches?a.touches[0]:a,d=$l(this._element);this._startPoint=new ue(c.clientX,c.clientY),this._startPos=Yn(this._element),this._parentScale=xo(d);var g=a.type==="mousedown";Ge(document,g?"mousemove":"touchmove",this._onMove,this),Ge(document,g?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var c=a.touches&&a.touches.length===1?a.touches[0]:a,d=new ue(c.clientX,c.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,Zt(a),this._moved||(this.fire("dragstart"),this._moved=!0,st(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),st(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),Qe(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){jt(document.body,"leaflet-dragging"),this._lastTarget&&(jt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Nt(document,"mousemove touchmove",this._onMove,this),Nt(document,"mouseup touchend touchcancel",this._onUp,this),Wl(),xi();var c=this._moved&&this._moving;this._moving=!1,yi._dragging=!1,c&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function Ao(a,c,d){var g,T=[1,4,2,8],O,ee,ae,he,xe,Be,$e,ut;for(O=0,Be=a.length;O<Be;O++)a[O]._code=Bi(a[O],c);for(ae=0;ae<4;ae++){for($e=T[ae],g=[],O=0,Be=a.length,ee=Be-1;O<Be;ee=O++)he=a[O],xe=a[ee],he._code&$e?xe._code&$e||(ut=Cr(xe,he,$e,c,d),ut._code=Bi(ut,c),g.push(ut)):(xe._code&$e&&(ut=Cr(xe,he,$e,c,d),ut._code=Bi(ut,c),g.push(ut)),g.push(he));a=g}return a}function So(a,c){var d,g,T,O,ee,ae,he,xe,Be;if(!a||a.length===0)throw new Error("latlngs not passed");f(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var $e=re([0,0]),ut=J(a),cn=ut.getNorthWest().distanceTo(ut.getSouthWest())*ut.getNorthEast().distanceTo(ut.getNorthWest());cn<1700&&($e=Io(a));var kr=a.length,ri=[];for(d=0;d<kr;d++){var Tn=re(a[d]);ri.push(c.project(re([Tn.lat-$e.lat,Tn.lng-$e.lng])))}for(ae=he=xe=0,d=0,g=kr-1;d<kr;g=d++)T=ri[d],O=ri[g],ee=T.y*O.x-O.y*T.x,he+=(T.x+O.x)*ee,xe+=(T.y+O.y)*ee,ae+=ee*3;ae===0?Be=ri[0]:Be=[he/ae,xe/ae];var Lo=c.unproject(de(Be));return re([Lo.lat+$e.lat,Lo.lng+$e.lng])}function Io(a){for(var c=0,d=0,g=0,T=0;T<a.length;T++){var O=re(a[T]);c+=O.lat,d+=O.lng,g++}return re([c/g,d/g])}var Co={__proto__:null,clipPolygon:Ao,polygonCenter:So,centroid:Io};function ec(a,c){if(!c||!a.length)return a.slice();var d=c*c;return a=of(a,d),a=af(a,d),a}function tc(a,c,d){return Math.sqrt(ti(a,c,d,!0))}function os(a,c,d){return ti(a,c,d)}function af(a,c){var d=a.length,g=typeof Uint8Array<"u"?Uint8Array:Array,T=new g(d);T[0]=T[d-1]=1,ko(a,T,c,0,d-1);var O,ee=[];for(O=0;O<d;O++)T[O]&&ee.push(a[O]);return ee}function ko(a,c,d,g,T){var O=0,ee,ae,he;for(ae=g+1;ae<=T-1;ae++)he=ti(a[ae],a[g],a[T],!0),he>O&&(ee=ae,O=he);O>d&&(c[ee]=1,ko(a,c,d,g,ee),ko(a,c,d,ee,T))}function of(a,c){for(var d=[a[0]],g=1,T=0,O=a.length;g<O;g++)lf(a[g],a[T])>c&&(d.push(a[g]),T=g);return T<O-1&&d.push(a[O-1]),d}var rc;function ka(a,c,d,g,T){var O=g?rc:Bi(a,d),ee=Bi(c,d),ae,he,xe;for(rc=ee;;){if(!(O|ee))return[a,c];if(O&ee)return!1;ae=O||ee,he=Cr(a,c,ae,d,T),xe=Bi(he,d),ae===O?(a=he,O=xe):(c=he,ee=xe)}}function Cr(a,c,d,g,T){var O=c.x-a.x,ee=c.y-a.y,ae=g.min,he=g.max,xe,Be;return d&8?(xe=a.x+O*(he.y-a.y)/ee,Be=he.y):d&4?(xe=a.x+O*(ae.y-a.y)/ee,Be=ae.y):d&2?(xe=he.x,Be=a.y+ee*(he.x-a.x)/O):d&1&&(xe=ae.x,Be=a.y+ee*(ae.x-a.x)/O),new ue(xe,Be,T)}function Bi(a,c){var d=0;return a.x<c.min.x?d|=1:a.x>c.max.x&&(d|=2),a.y<c.min.y?d|=4:a.y>c.max.y&&(d|=8),d}function lf(a,c){var d=c.x-a.x,g=c.y-a.y;return d*d+g*g}function ti(a,c,d,g){var T=c.x,O=c.y,ee=d.x-T,ae=d.y-O,he=ee*ee+ae*ae,xe;return he>0&&(xe=((a.x-T)*ee+(a.y-O)*ae)/he,xe>1?(T=d.x,O=d.y):xe>0&&(T+=ee*xe,O+=ae*xe)),ee=a.x-T,ae=a.y-O,g?ee*ee+ae*ae:new ue(T,O)}function f(a){return!w(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function v(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),f(a)}function I(a,c){var d,g,T,O,ee,ae,he,xe;if(!a||a.length===0)throw new Error("latlngs not passed");f(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var Be=re([0,0]),$e=J(a),ut=$e.getNorthWest().distanceTo($e.getSouthWest())*$e.getNorthEast().distanceTo($e.getNorthWest());ut<1700&&(Be=Io(a));var cn=a.length,kr=[];for(d=0;d<cn;d++){var ri=re(a[d]);kr.push(c.project(re([ri.lat-Be.lat,ri.lng-Be.lng])))}for(d=0,g=0;d<cn-1;d++)g+=kr[d].distanceTo(kr[d+1])/2;if(g===0)xe=kr[0];else for(d=0,O=0;d<cn-1;d++)if(ee=kr[d],ae=kr[d+1],T=ee.distanceTo(ae),O+=T,O>g){he=(O-g)/T,xe=[ae.x-he*(ae.x-ee.x),ae.y-he*(ae.y-ee.y)];break}var Tn=c.unproject(de(xe));return re([Tn.lat+Be.lat,Tn.lng+Be.lng])}var B={__proto__:null,simplify:ec,pointToSegmentDistance:tc,closestPointOnSegment:os,clipSegment:ka,_getEdgeIntersection:Cr,_getBitCode:Bi,_sqClosestPointOnSegment:ti,isFlat:f,_flat:v,polylineCenter:I},ie={project:function(a){return new ue(a.lng,a.lat)},unproject:function(a){return new q(a.y,a.x)},bounds:new Ae([-180,-90],[180,90])},pe={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Ae([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var c=Math.PI/180,d=this.R,g=a.lat*c,T=this.R_MINOR/d,O=Math.sqrt(1-T*T),ee=O*Math.sin(g),ae=Math.tan(Math.PI/4-g/2)/Math.pow((1-ee)/(1+ee),O/2);return g=-d*Math.log(Math.max(ae,1e-10)),new ue(a.lng*c*d,g)},unproject:function(a){for(var c=180/Math.PI,d=this.R,g=this.R_MINOR/d,T=Math.sqrt(1-g*g),O=Math.exp(-a.y/d),ee=Math.PI/2-2*Math.atan(O),ae=0,he=.1,xe;ae<15&&Math.abs(he)>1e-7;ae++)xe=T*Math.sin(ee),xe=Math.pow((1-xe)/(1+xe),T/2),he=Math.PI/2-2*Math.atan(O*xe)-ee,ee+=he;return new q(ee*c,a.x*c/d)}},De={__proto__:null,LonLat:ie,Mercator:pe,SphericalMercator:ve},kt=i({},ye,{code:"EPSG:3395",projection:pe,transformation:function(){var a=.5/(Math.PI*pe.R);return Y(a,.5,-a,.5)}()}),ur=i({},ye,{code:"EPSG:4326",projection:ie,transformation:Y(1/180,1,-1/180,.5)}),gt=i({},ge,{projection:ie,transformation:Y(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,c){var d=c.lng-a.lng,g=c.lat-a.lat;return Math.sqrt(d*d+g*g)},infinite:!0});ge.Earth=ye,ge.EPSG3395=kt,ge.EPSG3857=yt,ge.EPSG900913=He,ge.EPSG4326=ur,ge.Simple=gt;var Ot=Oe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[u(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[u(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var c=a.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var d=this.getEvents();c.on(d,this),this.once("remove",function(){c.off(d,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});ft.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(a);return this._layers[c]?this:(this._layers[c]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var c=u(a);return this._layers[c]?(this._loaded&&a.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return u(a)in this._layers},eachLayer:function(a,c){for(var d in this._layers)a.call(c,this._layers[d]);return this},_addLayers:function(a){a=a?w(a)?a:[a]:[];for(var c=0,d=a.length;c<d;c++)this.addLayer(a[c])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[u(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var c=u(a);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,c=-1/0,d=this._getZoomSpan();for(var g in this._zoomBoundLayers){var T=this._zoomBoundLayers[g].options;a=T.minZoom===void 0?a:Math.min(a,T.minZoom),c=T.maxZoom===void 0?c:Math.max(c,T.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=a===1/0?void 0:a,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Kt=Ot.extend({initialize:function(a,c){y(this,c),this._layers={};var d,g;if(a)for(d=0,g=a.length;d<g;d++)this.addLayer(a[d])},addLayer:function(a){var c=this.getLayerId(a);return this._layers[c]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var c=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(a){var c=typeof a=="number"?a:this.getLayerId(a);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var c=Array.prototype.slice.call(arguments,1),d,g;for(d in this._layers)g=this._layers[d],g[a]&&g[a].apply(g,c);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,c){for(var d in this._layers)a.call(c,this._layers[d]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return u(a)}}),Vs=function(a,c){return new Kt(a,c)},sr=Kt.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),Kt.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),Kt.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new H;for(var c in this._layers){var d=this._layers[c];a.extend(d.getBounds?d.getBounds():d.getLatLng())}return a}}),Ro=function(a,c){return new sr(a,c)},Ui=Pe.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){y(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,c){var d=this._getIconUrl(a);if(!d){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var g=this._createImg(d,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(g,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),g},_setIconStyles:function(a,c){var d=this.options,g=d[c+"Size"];typeof g=="number"&&(g=[g,g]);var T=de(g),O=de(c==="shadow"&&d.shadowAnchor||d.iconAnchor||T&&T.divideBy(2,!0));a.className="leaflet-marker-"+c+" "+(d.className||""),O&&(a.style.marginLeft=-O.x+"px",a.style.marginTop=-O.y+"px"),T&&(a.style.width=T.x+"px",a.style.height=T.y+"px")},_createImg:function(a,c){return c=c||document.createElement("img"),c.src=a,c},_getIconUrl:function(a){return ze.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function yS(a){return new Ui(a)}var nc=Ui.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof nc.imagePath!="string"&&(nc.imagePath=this._detectIconPath()),(this.options.imagePath||nc.imagePath)+Ui.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var c=function(d,g,T){var O=g.exec(d);return O&&O[T]};return a=c(a,/^url\((['"])?(.+)\1\)$/,2),a&&c(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=Je("div","leaflet-default-icon-path",document.body),c=Xn(a,"background-image")||Xn(a,"backgroundImage");if(document.body.removeChild(a),c=this._stripUrl(c),c)return c;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),L_=Mn.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new yi(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),st(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&jt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var c=this._marker,d=c._map,g=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,O=Yn(c._icon),ee=d.getPixelBounds(),ae=d.getPixelOrigin(),he=j(ee.min._subtract(ae).add(T),ee.max._subtract(ae).subtract(T));if(!he.contains(O)){var xe=de((Math.max(he.max.x,O.x)-he.max.x)/(ee.max.x-he.max.x)-(Math.min(he.min.x,O.x)-he.min.x)/(ee.min.x-he.min.x),(Math.max(he.max.y,O.y)-he.max.y)/(ee.max.y-he.max.y)-(Math.min(he.min.y,O.y)-he.min.y)/(ee.min.y-he.min.y)).multiplyBy(g);d.panBy(xe,{animate:!1}),this._draggable._newPos._add(xe),this._draggable._startPos._add(xe),Qe(c._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=F(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(b(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,a)))},_onDrag:function(a){var c=this._marker,d=c._shadow,g=Yn(c._icon),T=c._map.layerPointToLatLng(g);d&&Qe(d,g),c._latlng=T,a.latlng=T,a.oldLatLng=this._oldLatLng,c.fire("move",a).fire("drag",a)},_onDragEnd:function(a){b(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),cf=Ot.extend({options:{icon:new nc,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,c){y(this,c),this._latlng=re(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var c=this._latlng;return this._latlng=re(a),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=a.icon.createIcon(this._icon),g=!1;d!==this._icon&&(this._icon&&this._removeIcon(),g=!0,a.title&&(d.title=a.title),d.tagName==="IMG"&&(d.alt=a.alt||"")),st(d,c),a.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ge(d,"focus",this._panOnFocus,this);var T=a.icon.createShadow(this._shadow),O=!1;T!==this._shadow&&(this._removeShadow(),O=!0),T&&(st(T,c),T.alt=""),this._shadow=T,a.opacity<1&&this._updateOpacity(),g&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&O&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Nt(this._icon,"focus",this._panOnFocus,this),Ft(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ft(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&Qe(this._icon,a),this._shadow&&Qe(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var c=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(st(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),L_)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new L_(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&er(this._icon,a),this._shadow&&er(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var c=this.options.icon.options,d=c.iconSize?de(c.iconSize):de(0,0),g=c.iconAnchor?de(c.iconAnchor):de(0,0);a.panInside(this._latlng,{paddingTopLeft:g,paddingBottomRight:d.subtract(g)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ES(a,c){return new cf(a,c)}var zs=Ot.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return y(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),uf=zs.extend({options:{fill:!0,radius:10},initialize:function(a,c){y(this,c),this._latlng=re(a),this._radius=this.options.radius},setLatLng:function(a){var c=this._latlng;return this._latlng=re(a),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var c=a&&a.radius||this._radius;return zs.prototype.setStyle.call(this,a),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,c=this._radiusY||a,d=this._clickTolerance(),g=[a+d,c+d];this._pxBounds=new Ae(this._point.subtract(g),this._point.add(g))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function TS(a,c){return new uf(a,c)}var Q0=uf.extend({initialize:function(a,c,d){if(typeof c=="number"&&(c=i({},d,{radius:c})),y(this,c),this._latlng=re(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new H(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:zs.prototype.setStyle,_project:function(){var a=this._latlng.lng,c=this._latlng.lat,d=this._map,g=d.options.crs;if(g.distance===ye.distance){var T=Math.PI/180,O=this._mRadius/ye.R/T,ee=d.project([c+O,a]),ae=d.project([c-O,a]),he=ee.add(ae).divideBy(2),xe=d.unproject(he).lat,Be=Math.acos((Math.cos(O*T)-Math.sin(c*T)*Math.sin(xe*T))/(Math.cos(c*T)*Math.cos(xe*T)))/T;(isNaN(Be)||Be===0)&&(Be=O/Math.cos(Math.PI/180*c)),this._point=he.subtract(d.getPixelOrigin()),this._radius=isNaN(Be)?0:he.x-d.project([xe,a-Be]).x,this._radiusY=he.y-ee.y}else{var $e=g.unproject(g.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint($e).x}this._updateBounds()}});function wS(a,c,d){return new Q0(a,c,d)}var ls=zs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,c){y(this,c),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var c=1/0,d=null,g=ti,T,O,ee=0,ae=this._parts.length;ee<ae;ee++)for(var he=this._parts[ee],xe=1,Be=he.length;xe<Be;xe++){T=he[xe-1],O=he[xe];var $e=g(a,T,O,!0);$e<c&&(c=$e,d=g(a,T,O))}return d&&(d.distance=Math.sqrt(c)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return I(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,c){return c=c||this._defaultShape(),a=re(a),c.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new H,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return f(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var c=[],d=f(a),g=0,T=a.length;g<T;g++)d?(c[g]=re(a[g]),this._bounds.extend(c[g])):c[g]=this._convertLatLngs(a[g]);return c},_project:function(){var a=new Ae;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),c=new ue(a,a);this._rawPxBounds&&(this._pxBounds=new Ae([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(a,c,d){var g=a[0]instanceof q,T=a.length,O,ee;if(g){for(ee=[],O=0;O<T;O++)ee[O]=this._map.latLngToLayerPoint(a[O]),d.extend(ee[O]);c.push(ee)}else for(O=0;O<T;O++)this._projectLatlngs(a[O],c,d)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,d,g,T,O,ee,ae,he;for(d=0,T=0,O=this._rings.length;d<O;d++)for(he=this._rings[d],g=0,ee=he.length;g<ee-1;g++)ae=ka(he[g],he[g+1],a,g,!0),ae&&(c[T]=c[T]||[],c[T].push(ae[0]),(ae[1]!==he[g+1]||g===ee-2)&&(c[T].push(ae[1]),T++))}},_simplifyPoints:function(){for(var a=this._parts,c=this.options.smoothFactor,d=0,g=a.length;d<g;d++)a[d]=ec(a[d],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,c){var d,g,T,O,ee,ae,he=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(d=0,O=this._parts.length;d<O;d++)for(ae=this._parts[d],g=0,ee=ae.length,T=ee-1;g<ee;T=g++)if(!(!c&&g===0)&&tc(a,ae[T],ae[g])<=he)return!0;return!1}});function AS(a,c){return new ls(a,c)}ls._flat=v;var Po=ls.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return So(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var c=ls.prototype._convertLatLngs.call(this,a),d=c.length;return d>=2&&c[0]instanceof q&&c[0].equals(c[d-1])&&c.pop(),c},_setLatLngs:function(a){ls.prototype._setLatLngs.call(this,a),f(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return f(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,c=this.options.weight,d=new ue(c,c);if(a=new Ae(a.min.subtract(d),a.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var g=0,T=this._rings.length,O;g<T;g++)O=Ao(this._rings[g],a,!0),O.length&&this._parts.push(O)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var c=!1,d,g,T,O,ee,ae,he,xe;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(O=0,he=this._parts.length;O<he;O++)for(d=this._parts[O],ee=0,xe=d.length,ae=xe-1;ee<xe;ae=ee++)g=d[ee],T=d[ae],g.y>a.y!=T.y>a.y&&a.x<(T.x-g.x)*(a.y-g.y)/(T.y-g.y)+g.x&&(c=!c);return c||ls.prototype._containsPoint.call(this,a,!0)}});function SS(a,c){return new Po(a,c)}var cs=sr.extend({initialize:function(a,c){y(this,c),this._layers={},a&&this.addData(a)},addData:function(a){var c=w(a)?a:a.features,d,g,T;if(c){for(d=0,g=c.length;d<g;d++)T=c[d],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var O=this.options;if(O.filter&&!O.filter(a))return this;var ee=ff(a,O);return ee?(ee.feature=pf(a),ee.defaultOptions=ee.options,this.resetStyle(ee),O.onEachFeature&&O.onEachFeature(a,ee),this.addLayer(ee)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=i({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(c){this._setLayerStyle(c,a)},this)},_setLayerStyle:function(a,c){a.setStyle&&(typeof c=="function"&&(c=c(a.feature)),a.setStyle(c))}});function ff(a,c){var d=a.type==="Feature"?a.geometry:a,g=d?d.coordinates:null,T=[],O=c&&c.pointToLayer,ee=c&&c.coordsToLatLng||ed,ae,he,xe,Be;if(!g&&!d)return null;switch(d.type){case"Point":return ae=ee(g),D_(O,a,ae,c);case"MultiPoint":for(xe=0,Be=g.length;xe<Be;xe++)ae=ee(g[xe]),T.push(D_(O,a,ae,c));return new sr(T);case"LineString":case"MultiLineString":return he=hf(g,d.type==="LineString"?0:1,ee),new ls(he,c);case"Polygon":case"MultiPolygon":return he=hf(g,d.type==="Polygon"?1:2,ee),new Po(he,c);case"GeometryCollection":for(xe=0,Be=d.geometries.length;xe<Be;xe++){var $e=ff({geometry:d.geometries[xe],type:"Feature",properties:a.properties},c);$e&&T.push($e)}return new sr(T);case"FeatureCollection":for(xe=0,Be=d.features.length;xe<Be;xe++){var ut=ff(d.features[xe],c);ut&&T.push(ut)}return new sr(T);default:throw new Error("Invalid GeoJSON object.")}}function D_(a,c,d,g){return a?a(c,d):new cf(d,g&&g.markersInheritOptions&&g)}function ed(a){return new q(a[1],a[0],a[2])}function hf(a,c,d){for(var g=[],T=0,O=a.length,ee;T<O;T++)ee=c?hf(a[T],c-1,d):(d||ed)(a[T]),g.push(ee);return g}function td(a,c){return a=re(a),a.alt!==void 0?[_(a.lng,c),_(a.lat,c),_(a.alt,c)]:[_(a.lng,c),_(a.lat,c)]}function df(a,c,d,g){for(var T=[],O=0,ee=a.length;O<ee;O++)T.push(c?df(a[O],f(a[O])?0:c-1,d,g):td(a[O],g));return!c&&d&&T.length>0&&T.push(T[0].slice()),T}function No(a,c){return a.feature?i({},a.feature,{geometry:c}):pf(c)}function pf(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var rd={toGeoJSON:function(a){return No(this,{type:"Point",coordinates:td(this.getLatLng(),a)})}};cf.include(rd),Q0.include(rd),uf.include(rd),ls.include({toGeoJSON:function(a){var c=!f(this._latlngs),d=df(this._latlngs,c?1:0,!1,a);return No(this,{type:(c?"Multi":"")+"LineString",coordinates:d})}}),Po.include({toGeoJSON:function(a){var c=!f(this._latlngs),d=c&&!f(this._latlngs[0]),g=df(this._latlngs,d?2:c?1:0,!0,a);return c||(g=[g]),No(this,{type:(d?"Multi":"")+"Polygon",coordinates:g})}}),Kt.include({toMultiPoint:function(a){var c=[];return this.eachLayer(function(d){c.push(d.toGeoJSON(a).geometry.coordinates)}),No(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(a){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(a);var d=c==="GeometryCollection",g=[];return this.eachLayer(function(T){if(T.toGeoJSON){var O=T.toGeoJSON(a);if(d)g.push(O.geometry);else{var ee=pf(O);ee.type==="FeatureCollection"?g.push.apply(g,ee.features):g.push(ee)}}}),d?No(this,{geometries:g,type:"GeometryCollection"}):{type:"FeatureCollection",features:g}}});function F_(a,c){return new cs(a,c)}var IS=F_,mf=Ot.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,c,d){this._url=a,this._bounds=J(c),y(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(st(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ft(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&ns(this._image),this},bringToBack:function(){return this._map&&Fs(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=J(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",c=this._image=a?this._url:Je("img");if(st(c,"leaflet-image-layer"),this._zoomAnimated&&st(c,"leaflet-zoom-animated"),this.options.className&&st(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onload=o(this.fire,this,"load"),c.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(a){var c=this._map.getZoomScale(a.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;Mi(this._image,d,c)},_reset:function(){var a=this._image,c=new Ae(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=c.getSize();Qe(a,c.min),a.style.width=d.x+"px",a.style.height=d.y+"px"},_updateOpacity:function(){er(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),CS=function(a,c,d){return new mf(a,c,d)},b_=mf.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",c=this._image=a?this._url:Je("video");if(st(c,"leaflet-image-layer"),this._zoomAnimated&&st(c,"leaflet-zoom-animated"),this.options.className&&st(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onloadeddata=o(this.fire,this,"load"),a){for(var d=c.getElementsByTagName("source"),g=[],T=0;T<d.length;T++)g.push(d[T].src);this._url=d.length>0?g:[c.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var O=0;O<this._url.length;O++){var ee=Je("source");ee.src=this._url[O],c.appendChild(ee)}}});function kS(a,c,d){return new b_(a,c,d)}var M_=mf.extend({_initImage:function(){var a=this._image=this._url;st(a,"leaflet-image-layer"),this._zoomAnimated&&st(a,"leaflet-zoom-animated"),this.options.className&&st(a,this.options.className),a.onselectstart=m,a.onmousemove=m}});function RS(a,c,d){return new M_(a,c,d)}var Vi=Ot.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,c){a&&(a instanceof q||w(a))?(this._latlng=re(a),y(this,c)):(y(this,a),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&er(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&er(this._container,1),this.bringToFront(),this.options.interactive&&(st(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(er(this._container,0),this._removeTimeout=setTimeout(o(Ft,void 0,this._container),200)):Ft(this._container),this.options.interactive&&(jt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=re(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ns(this._container),this},bringToBack:function(){return this._map&&Fs(this._container),this},_prepareOpen:function(a){var c=this._source;if(!c._map)return!1;if(c instanceof sr){c=null;var d=this._source._layers;for(var g in d)if(d[g]._map){c=d[g];break}if(!c)return!1;this._source=c}if(!a)if(c.getCenter)a=c.getCenter();else if(c.getLatLng)a=c.getLatLng();else if(c.getBounds)a=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")a.innerHTML=c;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),c=de(this.options.offset),d=this._getAnchor();this._zoomAnimated?Qe(this._container,a.add(d)):c=c.add(a).add(d);var g=this._containerBottom=-c.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=g+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});ft.include({_initOverlay:function(a,c,d,g){var T=c;return T instanceof a||(T=new a(g).setContent(c)),d&&T.setLatLng(d),T}}),Ot.include({_initOverlay:function(a,c,d,g){var T=d;return T instanceof a?(y(T,g),T._source=this):(T=c&&!g?c:new a(g,this),T.setContent(d)),T}});var gf=Vi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,Vi.prototype.openOn.call(this,a)},onAdd:function(a){Vi.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof zs||this._source.on("preclick",ei))},onRemove:function(a){Vi.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof zs||this._source.off("preclick",ei))},getEvents:function(){var a=Vi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",c=this._container=Je("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=Je("div",a+"-content-wrapper",c);if(this._contentNode=Je("div",a+"-content",d),Bs(c),Ms(this._contentNode),Ge(c,"contextmenu",ei),this._tipContainer=Je("div",a+"-tip-container",c),this._tip=Je("div",a+"-tip",this._tipContainer),this.options.closeButton){var g=this._closeButton=Je("a",a+"-close-button",c);g.setAttribute("role","button"),g.setAttribute("aria-label","Close popup"),g.href="#close",g.innerHTML='<span aria-hidden="true">&#215;</span>',Ge(g,"click",function(T){Zt(T),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,c=a.style;c.width="",c.whiteSpace="nowrap";var d=a.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),c.width=d+1+"px",c.whiteSpace="",c.height="";var g=a.offsetHeight,T=this.options.maxHeight,O="leaflet-popup-scrolled";T&&g>T?(c.height=T+"px",st(a,O)):jt(a,O),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var c=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),d=this._getAnchor();Qe(this._container,c.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,c=parseInt(Xn(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+c,g=this._containerWidth,T=new ue(this._containerLeft,-d-this._containerBottom);T._add(Yn(this._container));var O=a.layerPointToContainerPoint(T),ee=de(this.options.autoPanPadding),ae=de(this.options.autoPanPaddingTopLeft||ee),he=de(this.options.autoPanPaddingBottomRight||ee),xe=a.getSize(),Be=0,$e=0;O.x+g+he.x>xe.x&&(Be=O.x+g-xe.x+he.x),O.x-Be-ae.x<0&&(Be=O.x-ae.x),O.y+d+he.y>xe.y&&($e=O.y+d-xe.y+he.y),O.y-$e-ae.y<0&&($e=O.y-ae.y),(Be||$e)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([Be,$e]))}},_getAnchor:function(){return de(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),PS=function(a,c){return new gf(a,c)};ft.mergeOptions({closePopupOnClick:!0}),ft.include({openPopup:function(a,c,d){return this._initOverlay(gf,a,c,d).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),Ot.include({bindPopup:function(a,c){return this._popup=this._initOverlay(gf,this._popup,a,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof sr||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){bn(a);var c=a.layer||a.target;if(this._popup._source===c&&!(c instanceof zs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=c,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var _f=Vi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){Vi.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){Vi.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=Vi.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",c=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Je("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var c,d,g=this._map,T=this._container,O=g.latLngToContainerPoint(g.getCenter()),ee=g.layerPointToContainerPoint(a),ae=this.options.direction,he=T.offsetWidth,xe=T.offsetHeight,Be=de(this.options.offset),$e=this._getAnchor();ae==="top"?(c=he/2,d=xe):ae==="bottom"?(c=he/2,d=0):ae==="center"?(c=he/2,d=xe/2):ae==="right"?(c=0,d=xe/2):ae==="left"?(c=he,d=xe/2):ee.x<O.x?(ae="right",c=0,d=xe/2):(ae="left",c=he+(Be.x+$e.x)*2,d=xe/2),a=a.subtract(de(c,d,!0)).add(Be).add($e),jt(T,"leaflet-tooltip-right"),jt(T,"leaflet-tooltip-left"),jt(T,"leaflet-tooltip-top"),jt(T,"leaflet-tooltip-bottom"),st(T,"leaflet-tooltip-"+ae),Qe(T,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&er(this._container,a)},_animateZoom:function(a){var c=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(c)},_getAnchor:function(){return de(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),NS=function(a,c){return new _f(a,c)};ft.include({openTooltip:function(a,c,d){return this._initOverlay(_f,a,c,d).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),Ot.include({bindTooltip:function(a,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(_f,this._tooltip,a,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var c=a?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[c](d),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof sr||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var c=typeof a.getElement=="function"&&a.getElement();c&&(Ge(c,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),Ge(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var c=typeof a.getElement=="function"&&a.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var c=a.latlng,d,g;this._tooltip.options.sticky&&a.originalEvent&&(d=this._map.mouseEventToContainerPoint(a.originalEvent),g=this._map.containerPointToLayerPoint(d),c=this._map.layerPointToLatLng(g)),this._tooltip.setLatLng(c)}});var B_=Ui.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var c=a&&a.tagName==="DIV"?a:document.createElement("div"),d=this.options;if(d.html instanceof Element?(Ia(c),c.appendChild(d.html)):c.innerHTML=d.html!==!1?d.html:"",d.bgPos){var g=de(d.bgPos);c.style.backgroundPosition=-g.x+"px "+-g.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function OS(a){return new B_(a)}Ui.Default=nc;var ic=Ot.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ze.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){y(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),Ft(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ns(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Fs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof ue?a:new ue(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var c=this.getPane().children,d=-a(-1/0,1/0),g=0,T=c.length,O;g<T;g++)O=c[g].style.zIndex,c[g]!==this._container&&O&&(d=a(d,+O));isFinite(d)&&(this.options.zIndex=d+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ze.ielt9){er(this._container,this.options.opacity);var a=+new Date,c=!1,d=!1;for(var g in this._tiles){var T=this._tiles[g];if(!(!T.current||!T.loaded)){var O=Math.min(1,(a-T.loaded)/200);er(T.el,O),O<1?c=!0:(T.active?d=!0:this._onOpaqueTile(T),T.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),c&&(b(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=Je("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,c=this.options.maxZoom;if(a!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===a?(this._levels[d].el.style.zIndex=c-Math.abs(a-d),this._onUpdateLevel(d)):(Ft(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var g=this._levels[a],T=this._map;return g||(g=this._levels[a]={},g.el=Je("div","leaflet-tile-container leaflet-zoom-animated",this._container),g.el.style.zIndex=c,g.origin=T.project(T.unproject(T.getPixelOrigin()),a).round(),g.zoom=a,this._setZoomTransform(g,T.getCenter(),T.getZoom()),m(g.el.offsetWidth),this._onCreateLevel(g)),this._level=g,g}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var a,c,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)c=this._tiles[a],c.retain=c.current;for(a in this._tiles)if(c=this._tiles[a],c.current&&!c.active){var g=c.coords;this._retainParent(g.x,g.y,g.z,g.z-5)||this._retainChildren(g.x,g.y,g.z,g.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var c in this._tiles)this._tiles[c].coords.z===a&&this._removeTile(c)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)Ft(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,c,d,g){var T=Math.floor(a/2),O=Math.floor(c/2),ee=d-1,ae=new ue(+T,+O);ae.z=+ee;var he=this._tileCoordsToKey(ae),xe=this._tiles[he];return xe&&xe.active?(xe.retain=!0,!0):(xe&&xe.loaded&&(xe.retain=!0),ee>g?this._retainParent(T,O,ee,g):!1)},_retainChildren:function(a,c,d,g){for(var T=2*a;T<2*a+2;T++)for(var O=2*c;O<2*c+2;O++){var ee=new ue(T,O);ee.z=d+1;var ae=this._tileCoordsToKey(ee),he=this._tiles[ae];if(he&&he.active){he.retain=!0;continue}else he&&he.loaded&&(he.retain=!0);d+1<g&&this._retainChildren(T,O,d+1,g)}},_resetView:function(a){var c=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var c=this.options;return c.minNativeZoom!==void 0&&a<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<a?c.maxNativeZoom:a},_setView:function(a,c,d,g){var T=Math.round(c);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var O=this.options.updateWhenZooming&&T!==this._tileZoom;(!g||O)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(a),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(a,c)},_setZoomTransforms:function(a,c){for(var d in this._levels)this._setZoomTransform(this._levels[d],a,c)},_setZoomTransform:function(a,c,d){var g=this._map.getZoomScale(d,a.zoom),T=a.origin.multiplyBy(g).subtract(this._map._getNewPixelOrigin(c,d)).round();ze.any3d?Mi(a.el,T,g):Qe(a.el,T)},_resetGrid:function(){var a=this._map,c=a.options.crs,d=this._tileSize=this.getTileSize(),g=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,c.wrapLng[0]],g).x/d.x),Math.ceil(a.project([0,c.wrapLng[1]],g).x/d.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([c.wrapLat[0],0],g).y/d.x),Math.ceil(a.project([c.wrapLat[1],0],g).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var c=this._map,d=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),g=c.getZoomScale(d,this._tileZoom),T=c.project(a,this._tileZoom).floor(),O=c.getSize().divideBy(g*2);return new Ae(T.subtract(O),T.add(O))},_update:function(a){var c=this._map;if(c){var d=this._clampZoom(c.getZoom());if(a===void 0&&(a=c.getCenter()),this._tileZoom!==void 0){var g=this._getTiledPixelBounds(a),T=this._pxBoundsToTileRange(g),O=T.getCenter(),ee=[],ae=this.options.keepBuffer,he=new Ae(T.getBottomLeft().subtract([ae,-ae]),T.getTopRight().add([ae,-ae]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var xe in this._tiles){var Be=this._tiles[xe].coords;(Be.z!==this._tileZoom||!he.contains(new ue(Be.x,Be.y)))&&(this._tiles[xe].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(a,d);return}for(var $e=T.min.y;$e<=T.max.y;$e++)for(var ut=T.min.x;ut<=T.max.x;ut++){var cn=new ue(ut,$e);if(cn.z=this._tileZoom,!!this._isValidTile(cn)){var kr=this._tiles[this._tileCoordsToKey(cn)];kr?kr.current=!0:ee.push(cn)}}if(ee.sort(function(Tn,Lo){return Tn.distanceTo(O)-Lo.distanceTo(O)}),ee.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ri=document.createDocumentFragment();for(ut=0;ut<ee.length;ut++)this._addTile(ee[ut],ri);this._level.el.appendChild(ri)}}}},_isValidTile:function(a){var c=this._map.options.crs;if(!c.infinite){var d=this._globalTileRange;if(!c.wrapLng&&(a.x<d.min.x||a.x>d.max.x)||!c.wrapLat&&(a.y<d.min.y||a.y>d.max.y))return!1}if(!this.options.bounds)return!0;var g=this._tileCoordsToBounds(a);return J(this.options.bounds).overlaps(g)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var c=this._map,d=this.getTileSize(),g=a.scaleBy(d),T=g.add(d),O=c.unproject(g,a.z),ee=c.unproject(T,a.z);return[O,ee]},_tileCoordsToBounds:function(a){var c=this._tileCoordsToNwSe(a),d=new H(c[0],c[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var c=a.split(":"),d=new ue(+c[0],+c[1]);return d.z=+c[2],d},_removeTile:function(a){var c=this._tiles[a];c&&(Ft(c.el),delete this._tiles[a],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){st(a,"leaflet-tile");var c=this.getTileSize();a.style.width=c.x+"px",a.style.height=c.y+"px",a.onselectstart=m,a.onmousemove=m,ze.ielt9&&this.options.opacity<1&&er(a,this.options.opacity)},_addTile:function(a,c){var d=this._getTilePos(a),g=this._tileCoordsToKey(a),T=this.createTile(this._wrapCoords(a),o(this._tileReady,this,a));this._initTile(T),this.createTile.length<2&&F(o(this._tileReady,this,a,null,T)),Qe(T,d),this._tiles[g]={el:T,coords:a,current:!0},c.appendChild(T),this.fire("tileloadstart",{tile:T,coords:a})},_tileReady:function(a,c,d){c&&this.fire("tileerror",{error:c,tile:d,coords:a});var g=this._tileCoordsToKey(a);d=this._tiles[g],d&&(d.loaded=+new Date,this._map._fadeAnimated?(er(d.el,0),b(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),c||(st(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ze.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var c=new ue(this._wrapX?p(a.x,this._wrapX):a.x,this._wrapY?p(a.y,this._wrapY):a.y);return c.z=a.z,c},_pxBoundsToTileRange:function(a){var c=this.getTileSize();return new Ae(a.min.unscaleBy(c).floor(),a.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function LS(a){return new ic(a)}var Oo=ic.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,c){this._url=a,c=y(this,c),c.detectRetina&&ze.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,c){return this._url===a&&c===void 0&&(c=!0),this._url=a,c||this.redraw(),this},createTile:function(a,c){var d=document.createElement("img");return Ge(d,"load",o(this._tileOnLoad,this,c,d)),Ge(d,"error",o(this._tileOnError,this,c,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(a),d},getTileUrl:function(a){var c={r:ze.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-a.y;this.options.tms&&(c.y=d),c["-y"]=d}return k(this._url,i(c,this.options))},_tileOnLoad:function(a,c){ze.ielt9?setTimeout(o(a,this,null,c),0):a(null,c)},_tileOnError:function(a,c,d){var g=this.options.errorTileUrl;g&&c.getAttribute("src")!==g&&(c.src=g),a(d,c)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,c=this.options.maxZoom,d=this.options.zoomReverse,g=this.options.zoomOffset;return d&&(a=c-a),a+g},_getSubdomain:function(a){var c=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var a,c;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(c=this._tiles[a].el,c.onload=m,c.onerror=m,!c.complete)){c.src=Q;var d=this._tiles[a].coords;Ft(c),delete this._tiles[a],this.fire("tileabort",{tile:c,coords:d})}},_removeTile:function(a){var c=this._tiles[a];if(c)return c.el.setAttribute("src",Q),ic.prototype._removeTile.call(this,a)},_tileReady:function(a,c,d){if(!(!this._map||d&&d.getAttribute("src")===Q))return ic.prototype._tileReady.call(this,a,c,d)}});function U_(a,c){return new Oo(a,c)}var V_=Oo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,c){this._url=a;var d=i({},this.defaultWmsParams);for(var g in c)g in this.options||(d[g]=c[g]);c=y(this,c);var T=c.detectRetina&&ze.retina?2:1,O=this.getTileSize();d.width=O.x*T,d.height=O.y*T,this.wmsParams=d},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,Oo.prototype.onAdd.call(this,a)},getTileUrl:function(a){var c=this._tileCoordsToNwSe(a),d=this._crs,g=j(d.project(c[0]),d.project(c[1])),T=g.min,O=g.max,ee=(this._wmsVersion>=1.3&&this._crs===ur?[T.y,T.x,O.y,O.x]:[T.x,T.y,O.x,O.y]).join(","),ae=Oo.prototype.getTileUrl.call(this,a);return ae+A(this.wmsParams,ae,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ee},setParams:function(a,c){return i(this.wmsParams,a),c||this.redraw(),this}});function DS(a,c){return new V_(a,c)}Oo.WMS=V_,U_.wms=DS;var us=Ot.extend({options:{padding:.1},initialize:function(a){y(this,a),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),st(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,c){var d=this._map.getZoomScale(c,this._zoom),g=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,c),O=g.multiplyBy(-d).add(T).subtract(this._map._getNewPixelOrigin(a,c));ze.any3d?Mi(this._container,O,d):Qe(this._container,O)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,c=this._map.getSize(),d=this._map.containerPointToLayerPoint(c.multiplyBy(-a)).round();this._bounds=new Ae(d,d.add(c.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),z_=us.extend({options:{tolerance:0},getEvents:function(){var a=us.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){us.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");Ge(a,"mousemove",this._onMouseMove,this),Ge(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ge(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){b(this._redrawRequest),delete this._ctx,Ft(this._container),Nt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var c in this._layers)a=this._layers[c],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){us.prototype._update.call(this);var a=this._bounds,c=this._container,d=a.getSize(),g=ze.retina?2:1;Qe(c,a.min),c.width=g*d.x,c.height=g*d.y,c.style.width=d.x+"px",c.style.height=d.y+"px",ze.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){us.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[u(a)]=a;var c=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var c=a._order,d=c.next,g=c.prev;d?d.prev=g:this._drawLast=g,g?g.next=d:this._drawFirst=d,delete a._order,delete this._layers[u(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var c=a.options.dashArray.split(/[, ]+/),d=[],g,T;for(T=0;T<c.length;T++){if(g=Number(c[T]),isNaN(g))return;d.push(g)}a.options._dashArray=d}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var c=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Ae,this._redrawBounds.extend(a._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(a._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var c=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,c=this._redrawBounds;if(this._ctx.save(),c){var d=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var g=this._drawFirst;g;g=g.next)a=g.layer,(!c||a._pxBounds&&a._pxBounds.intersects(c))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,c){if(this._drawing){var d,g,T,O,ee=a._parts,ae=ee.length,he=this._ctx;if(ae){for(he.beginPath(),d=0;d<ae;d++){for(g=0,T=ee[d].length;g<T;g++)O=ee[d][g],he[g?"lineTo":"moveTo"](O.x,O.y);c&&he.closePath()}this._fillStroke(he,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var c=a._point,d=this._ctx,g=Math.max(Math.round(a._radius),1),T=(Math.max(Math.round(a._radiusY),1)||g)/g;T!==1&&(d.save(),d.scale(1,T)),d.beginPath(),d.arc(c.x,c.y/T,g,0,Math.PI*2,!1),T!==1&&d.restore(),this._fillStroke(d,a)}},_fillStroke:function(a,c){var d=c.options;d.fill&&(a.globalAlpha=d.fillOpacity,a.fillStyle=d.fillColor||d.color,a.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(a.setLineDash&&a.setLineDash(c.options&&c.options._dashArray||[]),a.globalAlpha=d.opacity,a.lineWidth=d.weight,a.strokeStyle=d.color,a.lineCap=d.lineCap,a.lineJoin=d.lineJoin,a.stroke())},_onClick:function(a){for(var c=this._map.mouseEventToLayerPoint(a),d,g,T=this._drawFirst;T;T=T.next)d=T.layer,d.options.interactive&&d._containsPoint(c)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(d))&&(g=d);this._fireEvent(g?[g]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,c)}},_handleMouseOut:function(a){var c=this._hoveredLayer;c&&(jt(this._container,"leaflet-interactive"),this._fireEvent([c],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,c){if(!this._mouseHoverThrottled){for(var d,g,T=this._drawFirst;T;T=T.next)d=T.layer,d.options.interactive&&d._containsPoint(c)&&(g=d);g!==this._hoveredLayer&&(this._handleMouseOut(a),g&&(st(this._container,"leaflet-interactive"),this._fireEvent([g],a,"mouseover"),this._hoveredLayer=g)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,c,d){this._map._fireDOMEvent(c,d||c.type,a)},_bringToFront:function(a){var c=a._order;if(c){var d=c.next,g=c.prev;if(d)d.prev=g;else return;g?g.next=d:d&&(this._drawFirst=d),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(a)}},_bringToBack:function(a){var c=a._order;if(c){var d=c.next,g=c.prev;if(g)g.next=d;else return;d?d.prev=g:g&&(this._drawLast=g),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(a)}}});function j_(a){return ze.canvas?new z_(a):null}var sc=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),FS={_initContainer:function(){this._container=Je("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(us.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var c=a._container=sc("shape");st(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",a._path=sc("path"),c.appendChild(a._path),this._updateStyle(a),this._layers[u(a)]=a},_addPath:function(a){var c=a._container;this._container.appendChild(c),a.options.interactive&&a.addInteractiveTarget(c)},_removePath:function(a){var c=a._container;Ft(c),a.removeInteractiveTarget(c),delete this._layers[u(a)]},_updateStyle:function(a){var c=a._stroke,d=a._fill,g=a.options,T=a._container;T.stroked=!!g.stroke,T.filled=!!g.fill,g.stroke?(c||(c=a._stroke=sc("stroke")),T.appendChild(c),c.weight=g.weight+"px",c.color=g.color,c.opacity=g.opacity,g.dashArray?c.dashStyle=w(g.dashArray)?g.dashArray.join(" "):g.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=g.lineCap.replace("butt","flat"),c.joinstyle=g.lineJoin):c&&(T.removeChild(c),a._stroke=null),g.fill?(d||(d=a._fill=sc("fill")),T.appendChild(d),d.color=g.fillColor||g.color,d.opacity=g.fillOpacity):d&&(T.removeChild(d),a._fill=null)},_updateCircle:function(a){var c=a._point.round(),d=Math.round(a._radius),g=Math.round(a._radiusY||d);this._setPath(a,a._empty()?"M0 0":"AL "+c.x+","+c.y+" "+d+","+g+" 0,"+65535*360)},_setPath:function(a,c){a._path.v=c},_bringToFront:function(a){ns(a._container)},_bringToBack:function(a){Fs(a._container)}},vf=ze.vml?sc:ot,ac=us.extend({_initContainer:function(){this._container=vf("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=vf("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ft(this._container),Nt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){us.prototype._update.call(this);var a=this._bounds,c=a.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,d.setAttribute("width",c.x),d.setAttribute("height",c.y)),Qe(d,a.min),d.setAttribute("viewBox",[a.min.x,a.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(a){var c=a._path=vf("path");a.options.className&&st(c,a.options.className),a.options.interactive&&st(c,"leaflet-interactive"),this._updateStyle(a),this._layers[u(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){Ft(a._path),a.removeInteractiveTarget(a._path),delete this._layers[u(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var c=a._path,d=a.options;c&&(d.stroke?(c.setAttribute("stroke",d.color),c.setAttribute("stroke-opacity",d.opacity),c.setAttribute("stroke-width",d.weight),c.setAttribute("stroke-linecap",d.lineCap),c.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?c.setAttribute("stroke-dasharray",d.dashArray):c.removeAttribute("stroke-dasharray"),d.dashOffset?c.setAttribute("stroke-dashoffset",d.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),d.fill?(c.setAttribute("fill",d.fillColor||d.color),c.setAttribute("fill-opacity",d.fillOpacity),c.setAttribute("fill-rule",d.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(a,c){this._setPath(a,ne(a._parts,c))},_updateCircle:function(a){var c=a._point,d=Math.max(Math.round(a._radius),1),g=Math.max(Math.round(a._radiusY),1)||d,T="a"+d+","+g+" 0 1,0 ",O=a._empty()?"M0 0":"M"+(c.x-d)+","+c.y+T+d*2+",0 "+T+-d*2+",0 ";this._setPath(a,O)},_setPath:function(a,c){a._path.setAttribute("d",c)},_bringToFront:function(a){ns(a._path)},_bringToBack:function(a){Fs(a._path)}});ze.vml&&ac.include(FS);function H_(a){return ze.svg||ze.vml?new ac(a):null}ft.include({getRenderer:function(a){var c=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var c=this._paneRenderers[a];return c===void 0&&(c=this._createRenderer({pane:a}),this._paneRenderers[a]=c),c},_createRenderer:function(a){return this.options.preferCanvas&&j_(a)||H_(a)}});var W_=Po.extend({initialize:function(a,c){Po.prototype.initialize.call(this,this._boundsToLatLngs(a),c)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=J(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function bS(a,c){return new W_(a,c)}ac.create=vf,ac.pointsToPath=ne,cs.geometryToLayer=ff,cs.coordsToLatLng=ed,cs.coordsToLatLngs=hf,cs.latLngToCoords=td,cs.latLngsToCoords=df,cs.getFeature=No,cs.asFeature=pf,ft.mergeOptions({boxZoom:!0});var G_=Mn.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){Ge(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Nt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ft(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),vi(),Hl(),this._startPoint=this._map.mouseEventToContainerPoint(a),Ge(document,{contextmenu:bn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=Je("div","leaflet-zoom-box",this._container),st(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var c=new Ae(this._point,this._startPoint),d=c.getSize();Qe(this._box,c.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(Ft(this._box),jt(this._container,"leaflet-crosshair")),xi(),Wl(),Nt(document,{contextmenu:bn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var c=new H(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ft.addInitHook("addHandler","boxZoom",G_),ft.mergeOptions({doubleClickZoom:!0});var $_=Mn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var c=this._map,d=c.getZoom(),g=c.options.zoomDelta,T=a.originalEvent.shiftKey?d-g:d+g;c.options.doubleClickZoom==="center"?c.setZoom(T):c.setZoomAround(a.containerPoint,T)}});ft.addInitHook("addHandler","doubleClickZoom",$_),ft.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Z_=Mn.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new yi(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}st(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){jt(this._map._container,"leaflet-grab"),jt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=J(this._map.options.maxBounds);this._offsetLimit=j(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var c=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(c),this._prunePositions(c)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,c){return a-(a-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;a.x<c.min.x&&(a.x=this._viscousLimit(a.x,c.min.x)),a.y<c.min.y&&(a.y=this._viscousLimit(a.y,c.min.y)),a.x>c.max.x&&(a.x=this._viscousLimit(a.x,c.max.x)),a.y>c.max.y&&(a.y=this._viscousLimit(a.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,c=Math.round(a/2),d=this._initialWorldOffset,g=this._draggable._newPos.x,T=(g-c+d)%a+c-d,O=(g+c+d)%a-c-d,ee=Math.abs(T+d)<Math.abs(O+d)?T:O;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ee},_onDragEnd:function(a){var c=this._map,d=c.options,g=!d.inertia||a.noInertia||this._times.length<2;if(c.fire("dragend",a),g)c.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),O=(this._lastTime-this._times[0])/1e3,ee=d.easeLinearity,ae=T.multiplyBy(ee/O),he=ae.distanceTo([0,0]),xe=Math.min(d.inertiaMaxSpeed,he),Be=ae.multiplyBy(xe/he),$e=xe/(d.inertiaDeceleration*ee),ut=Be.multiplyBy(-$e/2).round();!ut.x&&!ut.y?c.fire("moveend"):(ut=c._limitOffset(ut,c.options.maxBounds),F(function(){c.panBy(ut,{duration:$e,easeLinearity:ee,noMoveStart:!0,animate:!0})}))}}});ft.addInitHook("addHandler","dragging",Z_),ft.mergeOptions({keyboard:!0,keyboardPanDelta:80});var K_=Mn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),Ge(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Nt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,c=document.documentElement,d=a.scrollTop||c.scrollTop,g=a.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(g,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var c=this._panKeys={},d=this.keyCodes,g,T;for(g=0,T=d.left.length;g<T;g++)c[d.left[g]]=[-1*a,0];for(g=0,T=d.right.length;g<T;g++)c[d.right[g]]=[a,0];for(g=0,T=d.down.length;g<T;g++)c[d.down[g]]=[0,a];for(g=0,T=d.up.length;g<T;g++)c[d.up[g]]=[0,-1*a]},_setZoomDelta:function(a){var c=this._zoomKeys={},d=this.keyCodes,g,T;for(g=0,T=d.zoomIn.length;g<T;g++)c[d.zoomIn[g]]=a;for(g=0,T=d.zoomOut.length;g<T;g++)c[d.zoomOut[g]]=-a},_addHooks:function(){Ge(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Nt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var c=a.keyCode,d=this._map,g;if(c in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(g=this._panKeys[c],a.shiftKey&&(g=de(g).multiplyBy(3)),d.options.maxBounds&&(g=d._limitOffset(de(g),d.options.maxBounds)),d.options.worldCopyJump){var T=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(g)));d.panTo(T)}else d.panBy(g)}else if(c in this._zoomKeys)d.setZoom(d.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;bn(a)}}});ft.addInitHook("addHandler","keyboard",K_),ft.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var X_=Mn.extend({addHooks:function(){Ge(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Nt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var c=tf(a),d=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var g=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),g),bn(a)},_performZoom:function(){var a=this._map,c=a.getZoom(),d=this._map.options.zoomSnap||0;a._stop();var g=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(g))))/Math.LN2,O=d?Math.ceil(T/d)*d:T,ee=a._limitZoom(c+(this._delta>0?O:-O))-c;this._delta=0,this._startTime=null,ee&&(a.options.scrollWheelZoom==="center"?a.setZoom(c+ee):a.setZoomAround(this._lastMousePos,c+ee))}});ft.addInitHook("addHandler","scrollWheelZoom",X_);var MS=600;ft.mergeOptions({tapHold:ze.touchNative&&ze.safari&&ze.mobile,tapTolerance:15});var q_=Mn.extend({addHooks:function(){Ge(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Nt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var c=a.touches[0];this._startPos=this._newPos=new ue(c.clientX,c.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Ge(document,"touchend",Zt),Ge(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),MS),Ge(document,"touchend touchcancel contextmenu",this._cancel,this),Ge(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){Nt(document,"touchend",Zt),Nt(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),Nt(document,"touchend touchcancel contextmenu",this._cancel,this),Nt(document,"touchmove",this._onMove,this)},_onMove:function(a){var c=a.touches[0];this._newPos=new ue(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,c){var d=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});d._simulated=!0,c.target.dispatchEvent(d)}});ft.addInitHook("addHandler","tapHold",q_),ft.mergeOptions({touchZoom:ze.touch,bounceAtZoomLimits:!0});var Y_=Mn.extend({addHooks:function(){st(this._map._container,"leaflet-touch-zoom"),Ge(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){jt(this._map._container,"leaflet-touch-zoom"),Nt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(!(!a.touches||a.touches.length!==2||c._animatingZoom||this._zooming)){var d=c.mouseEventToContainerPoint(a.touches[0]),g=c.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(d.add(g)._divideBy(2))),this._startDist=d.distanceTo(g),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),Ge(document,"touchmove",this._onTouchMove,this),Ge(document,"touchend touchcancel",this._onTouchEnd,this),Zt(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var c=this._map,d=c.mouseEventToContainerPoint(a.touches[0]),g=c.mouseEventToContainerPoint(a.touches[1]),T=d.distanceTo(g)/this._startDist;if(this._zoom=c.getScaleZoom(T,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&T<1||this._zoom>c.getMaxZoom()&&T>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var O=d._add(g)._divideBy(2)._subtract(this._centerPoint);if(T===1&&O.x===0&&O.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(O),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),b(this._animRequest);var ee=o(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(ee,this,!0),Zt(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,b(this._animRequest),Nt(document,"touchmove",this._onTouchMove,this),Nt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ft.addInitHook("addHandler","touchZoom",Y_),ft.BoxZoom=G_,ft.DoubleClickZoom=$_,ft.Drag=Z_,ft.Keyboard=K_,ft.ScrollWheelZoom=X_,ft.TapHold=q_,ft.TouchZoom=Y_,r.Bounds=Ae,r.Browser=ze,r.CRS=ge,r.Canvas=z_,r.Circle=Q0,r.CircleMarker=uf,r.Class=Pe,r.Control=En,r.DivIcon=B_,r.DivOverlay=Vi,r.DomEvent=rf,r.DomUtil=Qu,r.Draggable=yi,r.Evented=Oe,r.FeatureGroup=sr,r.GeoJSON=cs,r.GridLayer=ic,r.Handler=Mn,r.Icon=Ui,r.ImageOverlay=mf,r.LatLng=q,r.LatLngBounds=H,r.Layer=Ot,r.LayerGroup=Kt,r.LineUtil=B,r.Map=ft,r.Marker=cf,r.Mixin=Ca,r.Path=zs,r.Point=ue,r.PolyUtil=Co,r.Polygon=Po,r.Polyline=ls,r.Popup=gf,r.PosAnimation=Yl,r.Projection=De,r.Rectangle=W_,r.Renderer=us,r.SVG=ac,r.SVGOverlay=M_,r.TileLayer=Oo,r.Tooltip=_f,r.Transformation=Ye,r.Util=M,r.VideoOverlay=b_,r.bind=o,r.bounds=j,r.canvas=j_,r.circle=wS,r.circleMarker=TS,r.control=ln,r.divIcon=OS,r.extend=i,r.featureGroup=Ro,r.geoJSON=F_,r.geoJson=IS,r.gridLayer=LS,r.icon=yS,r.imageOverlay=CS,r.latLng=re,r.latLngBounds=J,r.layerGroup=Vs,r.map=Eo,r.marker=ES,r.point=de,r.polygon=SS,r.polyline=AS,r.popup=PS,r.rectangle=bS,r.setOptions=y,r.stamp=u,r.svg=H_,r.svgOverlay=RS,r.tileLayer=U_,r.tooltip=NS,r.transformation=Y,r.version=n,r.videoOverlay=kS;var BS=window.L;r.noConflict=function(){return window.L=BS,this},window.L=r})})(Xp,Xp.exports);var Uu=Xp.exports;function P0(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function Ig(e,t){return t==null?function(n,i){const s=_e.useRef();return s.current||(s.current=e(n,i)),s}:function(n,i){const s=_e.useRef();s.current||(s.current=e(n,i));const o=_e.useRef(n),{instance:l}=s.current;return _e.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,i]),s}}function q2(e,t){_e.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var s;(s=t.layerContainer)==null||s.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function SR(e){return function(r){const n=k0(),i=e(R0(r,n),n);return $2(n.map,r.attribution),Sg(i.current,r.eventHandlers),q2(i.current,n),i}}function IR(e,t){const r=_e.useRef();_e.useEffect(function(){if(t.pathOptions!==r.current){const i=t.pathOptions??{};e.instance.setStyle(i),r.current=i}},[e,t])}function CR(e){return function(r){const n=k0(),i=e(R0(r,n),n);return Sg(i.current,r.eventHandlers),q2(i.current,n),IR(i.current,r),i}}function kR(e,t){const r=Ig(e),n=AR(r,t);return TR(n)}function Y2(e,t){const r=Ig(e,t),n=CR(r);return ER(n)}function RR(e,t){const r=Ig(e,t),n=SR(r);return wR(n)}function PR(e,t,r){const{opacity:n,zIndex:i}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),i!=null&&i!==r.zIndex&&e.setZIndex(i)}function J2(){return k0().map}const Q2=Y2(function({center:t,children:r,...n},i){const s=new Uu.CircleMarker(t,n);return P0(s,Z2(i,{overlayContainer:s}))},vR),eT=Y2(function({data:t,...r},n){const i=new Uu.GeoJSON(t,r);return P0(i,Z2(n,{overlayContainer:i}))},function(t,r,n){r.style!==n.style&&(r.style==null?t.resetStyle():t.setStyle(r.style))});function qp(){return qp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qp.apply(this,arguments)}function NR({bounds:e,boundsOptions:t,center:r,children:n,className:i,id:s,placeholder:o,style:l,whenReady:u,zoom:h,...p},m){const[_]=_e.useState({className:i,id:s,style:l}),[x,E]=_e.useState(null);_e.useImperativeHandle(m,()=>(x==null?void 0:x.map)??null,[x]);const y=_e.useCallback(C=>{if(C!==null&&x===null){const k=new Uu.Map(C,p);r!=null&&h!=null?k.setView(r,h):e!=null&&k.fitBounds(e,t),u!=null&&k.whenReady(u),E(yR(k))}},[]);_e.useEffect(()=>()=>{x==null||x.map.remove()},[x]);const A=x?Wa.createElement(X2,{value:x},n):o??null;return Wa.createElement("div",qp({},_,{ref:y}),A)}const tT=_e.forwardRef(NR),rT=RR(function({url:t,...r},n){const i=new Uu.TileLayer(t,R0(r,n));return P0(i,n)},function(t,r,n){PR(t,r,n);const{url:i}=r;i!=null&&i!==n.url&&t.setUrl(i)}),Bh=kR(function(t,r){const n=new Uu.Tooltip(t,r.overlayContainer);return P0(n,r)},function(t,r,{position:n},i){_e.useEffect(function(){const o=r.overlayContainer;if(o==null)return;const{instance:l}=t,u=p=>{p.tooltip===l&&(n!=null&&l.setLatLng(n),l.update(),i(!0))},h=p=>{p.tooltip===l&&i(!1)};return o.on({tooltipopen:u,tooltipclose:h}),o.bindTooltip(l),function(){o.off({tooltipopen:u,tooltipclose:h}),o._map!=null&&o.unbindTooltip()}},[t,r,i,n])});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var nT=1252,OR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Cg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},kg=function(e){OR.indexOf(e)!=-1&&(nT=Cg[0]=e)};function LR(){kg(1252)}var ki=function(e){kg(e)};function iT(){ki(1200),LR()}function xv(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function DR(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function sT(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ec=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?DR(e.slice(2)):t==254&&r==255?sT(e.slice(2)):t==65279?e.slice(1):e},Mf=function(t){return String.fromCharCode(t)},yv=function(t){return String.fromCharCode(t)},_u,Js="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ev(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0,u=0,h=0;h<e.length;)r=e.charCodeAt(h++),s=r>>2,n=e.charCodeAt(h++),o=(r&3)<<4|n>>4,i=e.charCodeAt(h++),l=(n&15)<<2|i>>6,u=i&63,isNaN(n)?l=u=64:isNaN(i)&&(u=64),t+=Js.charAt(s)+Js.charAt(o)+Js.charAt(l)+Js.charAt(u);return t}function $n(e){var t="",r=0,n=0,i=0,s=0,o=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)s=Js.indexOf(e.charAt(h++)),o=Js.indexOf(e.charAt(h++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=Js.indexOf(e.charAt(h++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),u=Js.indexOf(e.charAt(h++)),i=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var pt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),so=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ma(e){return pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Tv(e){return pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ci=function(t){return pt?so(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ao(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Rg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Rg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ks=pt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:so(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function FR(e){for(var t=[],r=0,n=e.length+250,i=ma(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=ma(65535),n=65530)}return t.push(i.slice(0,r)),Ks(t)}var mn=/\u0000/g,Tc=/[\u0001-\u0006]/g;function ol(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ri(e,t){var r=""+e;return r.length>=t?r:rr("0",t-r.length)+r}function Pg(e,t){var r=""+e;return r.length>=t?r:rr(" ",t-r.length)+r}function Uh(e,t){var r=""+e;return r.length>=t?r:r+rr(" ",t-r.length)}function bR(e,t){var r=""+Math.round(e);return r.length>=t?r:rr("0",t-r.length)+r}function MR(e,t){var r=""+e;return r.length>=t?r:rr("0",t-r.length)+r}var wv=Math.pow(2,32);function Fo(e,t){if(e>wv||e<-wv)return bR(e,t);var r=Math.round(e);return MR(r,t)}function Vh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Av=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Nd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function BR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var at={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Sv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},UR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function zh(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,l=0,u=1,h=0,p=0,m=Math.floor(i);h<t&&(m=Math.floor(i),l=m*o+s,p=m*h+u,!(i-m<5e-8));)i=1/(i-m),s=o,o=l,u=h,h=p;if(p>t&&(h>t?(p=u,l=s):(p=h,l=o)),!r)return[0,n*l,p];var _=Math.floor(n*l/p);return[_,n*l-_*p,p]}function ba(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),n<60&&(s=(s+6)%7),r&&(s=GR(u,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}var aT=new Date(1899,11,31,0,0,0),VR=aT.getTime(),zR=new Date(1900,2,1,0,0,0);function oT(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=zR&&(r+=24*60*60*1e3),(r-(VR+(e.getTimezoneOffset()-aT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ng(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function jR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function HR(e){var t=e<0?12:11,r=Ng(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function WR(e){var t=Ng(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function vu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=HR(e):t===10?r=e.toFixed(10).substr(0,12):r=WR(e),Ng(jR(r.toUpperCase()))}function qa(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):vu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return di(14,oT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function GR(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function $R(e,t,r,n){var i="",s=0,o=0,l=r.y,u,h=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,h=2;break;default:u=l%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,h=t.length;break;case 3:return Nd[r.m-1][1];case 5:return Nd[r.m-1][0];default:return Nd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,h=t.length;break;case 3:return Av[r.q][0];default:return Av[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ri(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=Ri(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:u=l,h=1;break}var p=h>0?Ri(u,h):"";return p}function Qs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var lT=/%/g;function ZR(e,t,r){var n=t.replace(lT,""),i=t.length-n.length;return vs(e,n,r*Math.pow(10,2*i))+rr("%",i)}function KR(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return vs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function cT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+cT(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,h,p){return u+h+p.substr(0,(i+s)%i)+"."+p.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var uT=/# (\?+)( ?)\/( ?)(\d+)/;function XR(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?rr(" ",e[1].length+1+e[4].length):Pg(o,e[1].length)+e[2]+"/"+e[3]+Ri(l,e[4].length))}function qR(e,t,r){return r+(t===0?"":""+t)+rr(" ",e[1].length+2+e[4].length)}var fT=/^#*0*\.([0#]+)/,hT=/\).*[0#]/,dT=/\(###\) ###\\?-####/;function fn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Iv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Cv(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function YR(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function JR(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ii(e,t,r){if(e.charCodeAt(0)===40&&!t.match(hT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ii("n",n,r):"("+ii("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return KR(e,t,r);if(t.indexOf("%")!==-1)return ZR(e,t,r);if(t.indexOf("E")!==-1)return cT(t,r);if(t.charCodeAt(0)===36)return"$"+ii(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,u=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+Fo(u,t.length);if(t.match(/^[#?]+$/))return i=Fo(r,0),i==="0"&&(i=""),i.length>t.length?i:fn(t.substr(0,t.length-i.length))+i;if(s=t.match(uT))return XR(s,u,h);if(t.match(/^#+0+$/))return h+Fo(u,t.length-t.indexOf("0"));if(s=t.match(fT))return i=Iv(r,s[1].length).replace(/^([^\.]+)$/,"$1."+fn(s[1])).replace(/\.$/,"."+fn(s[1])).replace(/\.(\d*)$/,function(E,y){return"."+y+rr("0",fn(s[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+Iv(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+Qs(Fo(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ii(e,t,-r):Qs(""+(Math.floor(r)+YR(r,s[1].length)))+"."+Ri(Cv(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ii(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ol(ii(e,t.replace(/[\\-]/g,""),r)),o=0,ol(ol(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(t.match(dT))return i=ii(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=zh(u,Math.pow(10,o)-1,!1),i=""+h,p=vs("n",s[1],l[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+s[2]+"/"+s[3],p=Uh(l[2],o),p.length<s[4].length&&(p=fn(s[4].substr(s[4].length-p.length))+p),i+=p,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=zh(u,Math.pow(10,o)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Pg(l[1],o)+s[2]+"/"+s[3]+Uh(l[2],o):rr(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Fo(r,0),t.length<=i.length?i:fn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,_=t.length-i.length-m;return fn(t.substr(0,m)+i+t.substr(t.length-_))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=Cv(r,s[1].length),r<0?"-"+ii(e,t,-r):Qs(JR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Ri(0,3-E.length):"")+E})+"."+Ri(o,s[1].length);switch(t){case"###,##0.00":return ii(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=Qs(Fo(u,0));return x!=="0"?h+x:"";case"###,###.00":return ii(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ii(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function QR(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return vs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function e4(e,t,r){var n=t.replace(lT,""),i=t.length-n.length;return vs(e,n,r*Math.pow(10,2*i))+rr("%",i)}function pT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+pT(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,h,p){return u+h+p.substr(0,(i+s)%i)+"."+p.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Hi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(hT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Hi("n",n,r):"("+Hi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return QR(e,t,r);if(t.indexOf("%")!==-1)return e4(e,t,r);if(t.indexOf("E")!==-1)return pT(t,r);if(t.charCodeAt(0)===36)return"$"+Hi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,u=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+Ri(u,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:fn(t.substr(0,t.length-i.length))+i;if(s=t.match(uT))return qR(s,u,h);if(t.match(/^#+0+$/))return h+Ri(u,t.length-t.indexOf("0"));if(s=t.match(fT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+fn(s[1])).replace(/\.$/,"."+fn(s[1])),i=i.replace(/\.(\d*)$/,function(E,y){return"."+y+rr("0",fn(s[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+Qs(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Hi(e,t,-r):Qs(""+r)+"."+rr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Hi(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ol(Hi(e,t.replace(/[\\-]/g,""),r)),o=0,ol(ol(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(t.match(dT))return i=Hi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=zh(u,Math.pow(10,o)-1,!1),i=""+h,p=vs("n",s[1],l[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+s[2]+"/"+s[3],p=Uh(l[2],o),p.length<s[4].length&&(p=fn(s[4].substr(s[4].length-p.length))+p),i+=p,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=zh(u,Math.pow(10,o)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Pg(l[1],o)+s[2]+"/"+s[3]+Uh(l[2],o):rr(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:fn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,_=t.length-i.length-m;return fn(t.substr(0,m)+i+t.substr(t.length-_))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Hi(e,t,-r):Qs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Ri(0,3-E.length):"")+E})+"."+Ri(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=Qs(""+u);return x!=="0"?h+x:"";default:if(t.match(/\.[0#?]*$/))return Hi(e,t.slice(0,t.lastIndexOf(".")),r)+fn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function vs(e,t,r){return(r|0)===r?Hi(e,t,r):ii(e,t,r)}function t4(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var mT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ll(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Vh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(mT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function r4(e,t,r,n){for(var i=[],s="",o=0,l="",u="t",h,p,m,_="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Vh(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(m=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(m);i[i.length]={t:"t",v:s},++o;break;case"\\":var x=e.charAt(++o),E=x==="("||x===")"?x:"t";i[i.length]={t:E,v:x},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(h==null&&(h=ba(t,r,e.charAt(o+1)==="2"),h==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},u=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=ba(t,r),h==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=_),i[i.length]={t:l,v:s},u=l;break;case"A":case"a":case"":var y={t:l,v:l};if(h==null&&(h=ba(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(y.v=h.H>=12?"P":"A"),y.t="T",_="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(y.v=h.H>=12?"PM":"AM"),y.t="T",o+=5,_="h"):e.substr(o,5).toUpperCase()==="/"?(h!=null&&(y.v=h.H>=12?"":""),y.t="T",o+=5,_="h"):(y.t="t",++o),h==null&&y.t==="T")return"";i[i.length]=y,u=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(mT)){if(h==null&&(h=ba(t,r),h==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ll(e)||(i[i.length]={t:"t",v:s}));break;case".":if(h!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;i[i.length]={t:l,v:s},u=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var A=0,C=0,k;for(o=i.length-1,u="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=_,u="h",A<1&&(A=1);break;case"s":(k=i[o].v.match(/\.0+$/))&&(C=Math.max(C,k[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":u=i[o].t;break;case"m":u==="s"&&(i[o].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&i[o].v.match(/[Hh]/)&&(A=1),A<2&&i[o].v.match(/[Mm]/)&&(A=2),A<3&&i[o].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var w="",V;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=$R(i[o].t.charCodeAt(0),i[o].v,h,C),i[o].t="t";break;case"n":case"?":for(V=o+1;i[V]!=null&&((l=i[V].t)==="?"||l==="D"||(l===" "||l==="t")&&i[V+1]!=null&&(i[V+1].t==="?"||i[V+1].t==="t"&&i[V+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[V].v==="/"||i[V].v===" "&&i[V+1]!=null&&i[V+1].t=="?"));)i[o].v+=i[V].v,i[V]={v:"",t:";"},++V;w+=i[o].v,o=V-1;break;case"G":i[o].t="t",i[o].v=qa(t,r);break}var Q="",X,S;if(w.length>0){w.charCodeAt(0)==40?(X=t<0&&w.charCodeAt(0)===45?-t:t,S=vs("n",w,X)):(X=t<0&&n>1?-t:t,S=vs("n",w,X),X<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),V=S.length-1;var R=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){R=o;break}var P=i.length;if(R===i.length&&S.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(V>=i[o].v.length-1?(V-=i[o].v.length,i[o].v=S.substr(V+1,i[o].v.length)):V<0?i[o].v="":(i[o].v=S.substr(0,V+1),V=-1),i[o].t="t",P=o);V>=0&&P<i.length&&(i[P].v=S.substr(0,V+1)+i[P].v)}else if(R!==i.length&&S.indexOf("E")===-1){for(V=S.indexOf(".")-1,o=R;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(p=i[o].v.indexOf(".")>-1&&o===R?i[o].v.indexOf(".")-1:i[o].v.length-1,Q=i[o].v.substr(p+1);p>=0;--p)V>=0&&(i[o].v.charAt(p)==="0"||i[o].v.charAt(p)==="#")&&(Q=S.charAt(V--)+Q);i[o].v=Q,i[o].t="t",P=o}for(V>=0&&P<i.length&&(i[P].v=S.substr(0,V+1)+i[P].v),V=S.indexOf(".")+1,o=R;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==R)){for(p=i[o].v.indexOf(".")>-1&&o===R?i[o].v.indexOf(".")+1:0,Q=i[o].v.substr(0,p);p<i[o].v.length;++p)V<S.length&&(Q+=S.charAt(V++));i[o].v=Q,i[o].t="t",P=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(X=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=vs(i[o].t,i[o].v,X),i[o].t="t");var D="";for(o=0;o!==i.length;++o)i[o]!=null&&(D+=i[o].v);return D}var kv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Rv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function n4(e,t){var r=t4(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(kv),l=r[1].match(kv);return Rv(t,o)?[n,r[0]]:Rv(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function di(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:at)[e],n==null&&(n=r.table&&r.table[Sv[e]]||at[Sv[e]]),n==null&&(n=UR[e]||"General");break}if(Vh(n,0))return qa(t,r);t instanceof Date&&(t=oT(t,r.date1904));var i=n4(n,t);if(Vh(i[1]))return qa(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return r4(i[1],t,r,i[0])}function za(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(at[r]==null){t<0&&(t=r);continue}if(at[r]==e){t=r;break}}t<0&&(t=391)}return at[t]=e,t}function gT(){at=BR()}var i4={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},_T=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function s4(e){var t=typeof e=="number"?at[e]:e;return t=t.replace(_T,"(\\d+)"),new RegExp("^"+t+"$")}function a4(e,t,r){var n=-1,i=-1,s=-1,o=-1,l=-1,u=-1;(t.match(_T)||[]).forEach(function(m,_){var x=parseInt(r[_+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=x;break;case"d":s=x;break;case"h":o=x;break;case"s":u=x;break;case"m":o>=0?l=x:i=x;break}}),u>=0&&l==-1&&i>=0&&(l=i,i=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&l==-1&&u==-1?h:n==-1&&i==-1&&s==-1?p:h+"T"+p}var o4=function(){var e={};e.version="1.2.0";function t(){for(var S=0,R=new Array(256),P=0;P!=256;++P)S=P,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,R[P]=S;return typeof Int32Array<"u"?new Int32Array(R):R}var r=t();function n(S){var R=0,P=0,D=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)F[D]=S[D];for(D=0;D!=256;++D)for(P=S[D],R=256+D;R<4096;R+=256)P=F[R]=P>>>8^S[P&255];var b=[];for(D=1;D!=16;++D)b[D-1]=typeof Int32Array<"u"?F.subarray(D*256,D*256+256):F.slice(D*256,D*256+256);return b}var i=n(r),s=i[0],o=i[1],l=i[2],u=i[3],h=i[4],p=i[5],m=i[6],_=i[7],x=i[8],E=i[9],y=i[10],A=i[11],C=i[12],k=i[13],w=i[14];function V(S,R){for(var P=R^-1,D=0,F=S.length;D<F;)P=P>>>8^r[(P^S.charCodeAt(D++))&255];return~P}function Q(S,R){for(var P=R^-1,D=S.length-15,F=0;F<D;)P=w[S[F++]^P&255]^k[S[F++]^P>>8&255]^C[S[F++]^P>>16&255]^A[S[F++]^P>>>24]^y[S[F++]]^E[S[F++]]^x[S[F++]]^_[S[F++]]^m[S[F++]]^p[S[F++]]^h[S[F++]]^u[S[F++]]^l[S[F++]]^o[S[F++]]^s[S[F++]]^r[S[F++]];for(D+=15;F<D;)P=P>>>8^r[(P^S[F++])&255];return~P}function X(S,R){for(var P=R^-1,D=0,F=S.length,b=0,M=0;D<F;)b=S.charCodeAt(D++),b<128?P=P>>>8^r[(P^b)&255]:b<2048?(P=P>>>8^r[(P^(192|b>>6&31))&255],P=P>>>8^r[(P^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,M=S.charCodeAt(D++)&1023,P=P>>>8^r[(P^(240|b>>8&7))&255],P=P>>>8^r[(P^(128|b>>2&63))&255],P=P>>>8^r[(P^(128|M>>6&15|(b&3)<<4))&255],P=P>>>8^r[(P^(128|M&63))&255]):(P=P>>>8^r[(P^(224|b>>12&15))&255],P=P>>>8^r[(P^(128|b>>6&63))&255],P=P>>>8^r[(P^(128|b&63))&255]);return~P}return e.table=r,e.bstr=V,e.buf=Q,e.str=X,e}(),vt=function(){var t={};t.version="1.2.1";function r(N,W){for(var U=N.split("/"),z=W.split("/"),G=0,K=0,se=Math.min(U.length,z.length);G<se;++G){if(K=U[G].length-z[G].length)return K;if(U[G]!=z[G])return U[G]<z[G]?-1:1}return U.length-z.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var W=N.lastIndexOf("/");return W===-1?N:N.slice(0,W+1)}function i(N){if(N.charAt(N.length-1)=="/")return i(N.slice(0,-1));var W=N.lastIndexOf("/");return W===-1?N:N.slice(W+1)}function s(N,W){typeof W=="string"&&(W=new Date(W));var U=W.getHours();U=U<<6|W.getMinutes(),U=U<<5|W.getSeconds()>>>1,N.write_shift(2,U);var z=W.getFullYear()-1980;z=z<<4|W.getMonth()+1,z=z<<5|W.getDate(),N.write_shift(2,z)}function o(N){var W=N.read_shift(2)&65535,U=N.read_shift(2)&65535,z=new Date,G=U&31;U>>>=5;var K=U&15;U>>>=4,z.setMilliseconds(0),z.setFullYear(U+1980),z.setMonth(K-1),z.setDate(G);var se=W&31;W>>>=5;var me=W&63;return W>>>=6,z.setHours(W),z.setMinutes(me),z.setSeconds(se<<1),z}function l(N){Mr(N,0);for(var W={},U=0;N.l<=N.length-4;){var z=N.read_shift(2),G=N.read_shift(2),K=N.l+G,se={};switch(z){case 21589:U=N.read_shift(1),U&1&&(se.mtime=N.read_shift(4)),G>5&&(U&2&&(se.atime=N.read_shift(4)),U&4&&(se.ctime=N.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}N.l=K,W[z]=se}return W}var u;function h(){return u||(u={})}function p(N,W){if(N[0]==80&&N[1]==75)return Di(N,W);if((N[0]|32)==109&&(N[1]|32)==105)return Ds(N,W);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var U=3,z=512,G=0,K=0,se=0,me=0,oe=0,le=[],ce=N.slice(0,512);Mr(ce,0);var Te=m(ce);switch(U=Te[0],U){case 3:z=512;break;case 4:z=4096;break;case 0:if(Te[1]==0)return Di(N,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}z!==512&&(ce=N.slice(0,z),Mr(ce,28));var Le=N.slice(0,z);_(ce,U);var Me=ce.read_shift(4,"i");if(U===3&&Me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Me);ce.l+=4,se=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),me=ce.read_shift(4,"i"),G=ce.read_shift(4,"i"),oe=ce.read_shift(4,"i"),K=ce.read_shift(4,"i");for(var Ie=-1,Fe=0;Fe<109&&(Ie=ce.read_shift(4,"i"),!(Ie<0));++Fe)le[Fe]=Ie;var Ze=x(N,z);A(oe,K,Ze,z,le);var Ct=k(Ze,se,le,z);Ct[se].name="!Directory",G>0&&me!==M&&(Ct[me].name="!MiniFAT"),Ct[le[0]].name="!FAT",Ct.fat_addrs=le,Ct.ssz=z;var It={},Mt=[],On=[],Ln=[];w(se,Ct,Ze,Mt,G,It,On,me),E(On,Ln,Mt),Mt.shift();var _i={FileIndex:On,FullPaths:Ln};return W&&W.raw&&(_i.raw={header:Le,sectors:Ze}),_i}function m(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Pe,"Header Signature: "),N.l+=16;var W=N.read_shift(2,"u");return[N.read_shift(2,"u"),W]}function _(N,W){var U=9;switch(N.l+=2,U=N.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function x(N,W){for(var U=Math.ceil(N.length/W)-1,z=[],G=1;G<U;++G)z[G-1]=N.slice(G*W,(G+1)*W);return z[U-1]=N.slice(U*W),z}function E(N,W,U){for(var z=0,G=0,K=0,se=0,me=0,oe=U.length,le=[],ce=[];z<oe;++z)le[z]=ce[z]=z,W[z]=U[z];for(;me<ce.length;++me)z=ce[me],G=N[z].L,K=N[z].R,se=N[z].C,le[z]===z&&(G!==-1&&le[G]!==G&&(le[z]=le[G]),K!==-1&&le[K]!==K&&(le[z]=le[K])),se!==-1&&(le[se]=z),G!==-1&&z!=le[z]&&(le[G]=le[z],ce.lastIndexOf(G)<me&&ce.push(G)),K!==-1&&z!=le[z]&&(le[K]=le[z],ce.lastIndexOf(K)<me&&ce.push(K));for(z=1;z<oe;++z)le[z]===z&&(K!==-1&&le[K]!==K?le[z]=le[K]:G!==-1&&le[G]!==G&&(le[z]=le[G]));for(z=1;z<oe;++z)if(N[z].type!==0){if(me=z,me!=le[me])do me=le[me],W[z]=W[me]+"/"+W[z];while(me!==0&&le[me]!==-1&&me!=le[me]);le[z]=-1}for(W[0]+="/",z=1;z<oe;++z)N[z].type!==2&&(W[z]+="/")}function y(N,W,U){for(var z=N.start,G=N.size,K=[],se=z;U&&G>0&&se>=0;)K.push(W.slice(se*b,se*b+b)),G-=b,se=Oa(U,se*4);return K.length===0?vr(0):Ks(K).slice(0,N.size)}function A(N,W,U,z,G){var K=M;if(N===M){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var se=U[N],me=(z>>>2)-1;if(!se)return;for(var oe=0;oe<me&&(K=Oa(se,oe*4))!==M;++oe)G.push(K);A(Oa(se,z-4),W-1,U,z,G)}}function C(N,W,U,z,G){var K=[],se=[];G||(G=[]);var me=z-1,oe=0,le=0;for(oe=W;oe>=0;){G[oe]=!0,K[K.length]=oe,se.push(N[oe]);var ce=U[Math.floor(oe*4/z)];if(le=oe*4&me,z<4+le)throw new Error("FAT boundary crossed: "+oe+" 4 "+z);if(!N[ce])break;oe=Oa(N[ce],le)}return{nodes:K,data:Uv([se])}}function k(N,W,U,z){var G=N.length,K=[],se=[],me=[],oe=[],le=z-1,ce=0,Te=0,Le=0,Me=0;for(ce=0;ce<G;++ce)if(me=[],Le=ce+W,Le>=G&&(Le-=G),!se[Le]){oe=[];var Ie=[];for(Te=Le;Te>=0;){Ie[Te]=!0,se[Te]=!0,me[me.length]=Te,oe.push(N[Te]);var Fe=U[Math.floor(Te*4/z)];if(Me=Te*4&le,z<4+Me)throw new Error("FAT boundary crossed: "+Te+" 4 "+z);if(!N[Fe]||(Te=Oa(N[Fe],Me),Ie[Te]))break}K[Le]={nodes:me,data:Uv([oe])}}return K}function w(N,W,U,z,G,K,se,me){for(var oe=0,le=z.length?2:0,ce=W[N].data,Te=0,Le=0,Me;Te<ce.length;Te+=128){var Ie=ce.slice(Te,Te+128);Mr(Ie,64),Le=Ie.read_shift(2),Me=bg(Ie,0,Le-le),z.push(Me);var Fe={name:Me,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},Ze=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Ze!==0&&(Fe.ct=V(Ie,Ie.l-8));var Ct=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Ct!==0&&(Fe.mt=V(Ie,Ie.l-8)),Fe.start=Ie.read_shift(4,"i"),Fe.size=Ie.read_shift(4,"i"),Fe.size<0&&Fe.start<0&&(Fe.size=Fe.type=0,Fe.start=M,Fe.name=""),Fe.type===5?(oe=Fe.start,G>0&&oe!==M&&(W[oe].name="!StreamData")):Fe.size>=4096?(Fe.storage="fat",W[Fe.start]===void 0&&(W[Fe.start]=C(U,Fe.start,W.fat_addrs,W.ssz)),W[Fe.start].name=Fe.name,Fe.content=W[Fe.start].data.slice(0,Fe.size)):(Fe.storage="minifat",Fe.size<0?Fe.size=0:oe!==M&&Fe.start!==M&&W[oe]&&(Fe.content=y(Fe,W[oe].data,(W[me]||{}).data))),Fe.content&&Mr(Fe.content,0),K[Me]=Fe,se.push(Fe)}}function V(N,W){return new Date((Un(N,W+4)/1e7*Math.pow(2,32)+Un(N,W)/1e7-11644473600)*1e3)}function Q(N,W){return h(),p(u.readFileSync(N),W)}function X(N,W){var U=W&&W.type;switch(U||pt&&Buffer.isBuffer(N)&&(U="buffer"),U||"base64"){case"file":return Q(N,W);case"base64":return p(Ci($n(N)),W);case"binary":return p(Ci(N),W)}return p(N,W)}function S(N,W){var U=W||{},z=U.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=z+"/",N.FileIndex[0]={name:z,type:5}),U.CLSID&&(N.FileIndex[0].clsid=U.CLSID),R(N)}function R(N){var W="Sh33tJ5";if(!vt.find(N,"/"+W)){var U=vr(4);U[0]=55,U[1]=U[3]=50,U[2]=54,N.FileIndex.push({name:W,type:2,content:U,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+W),P(N)}}function P(N,W){S(N);for(var U=!1,z=!1,G=N.FullPaths.length-1;G>=0;--G){var K=N.FileIndex[G];switch(K.type){case 0:z?U=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(K.R*K.L*K.C)&&(U=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!W)){var se=new Date(1987,1,19),me=0,oe=Object.create?Object.create(null):{},le=[];for(G=0;G<N.FullPaths.length;++G)oe[N.FullPaths[G]]=!0,N.FileIndex[G].type!==0&&le.push([N.FullPaths[G],N.FileIndex[G]]);for(G=0;G<le.length;++G){var ce=n(le[G][0]);z=oe[ce],z||(le.push([ce,{name:i(ce).replace("/",""),type:1,clsid:Ne,ct:se,mt:se,content:null}]),oe[ce]=!0)}for(le.sort(function(Me,Ie){return r(Me[0],Ie[0])}),N.FullPaths=[],N.FileIndex=[],G=0;G<le.length;++G)N.FullPaths[G]=le[G][0],N.FileIndex[G]=le[G][1];for(G=0;G<le.length;++G){var Te=N.FileIndex[G],Le=N.FullPaths[G];if(Te.name=i(Le).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||Ne,G===0)Te.C=le.length>1?1:-1,Te.size=0,Te.type=5;else if(Le.slice(-1)=="/"){for(me=G+1;me<le.length&&n(N.FullPaths[me])!=Le;++me);for(Te.C=me>=le.length?-1:me,me=G+1;me<le.length&&n(N.FullPaths[me])!=n(Le);++me);Te.R=me>=le.length?-1:me,Te.type=1}else n(N.FullPaths[G+1]||"")==n(Le)&&(Te.R=G+1),Te.type=2}}}function D(N,W){var U=W||{};if(U.fileType=="mad")return _r(N,U);switch(P(N),U.fileType){case"zip":return Os(N,U)}var z=function(Me){for(var Ie=0,Fe=0,Ze=0;Ze<Me.FileIndex.length;++Ze){var Ct=Me.FileIndex[Ze];if(Ct.content){var It=Ct.content.length;It>0&&(It<4096?Ie+=It+63>>6:Fe+=It+511>>9)}}for(var Mt=Me.FullPaths.length+3>>2,On=Ie+7>>3,Ln=Ie+127>>7,_i=On+Fe+Mt+Ln,Dn=_i+127>>7,Xn=Dn<=109?0:Math.ceil((Dn-109)/127);_i+Dn+Xn+127>>7>Dn;)Xn=++Dn<=109?0:Math.ceil((Dn-109)/127);var Je=[1,Xn,Dn,Ln,Mt,Fe,Ie,0];return Me.FileIndex[0].size=Ie<<6,Je[7]=(Me.FileIndex[0].start=Je[0]+Je[1]+Je[2]+Je[3]+Je[4]+Je[5])+(Je[6]+7>>3),Je}(N),G=vr(z[7]<<9),K=0,se=0;{for(K=0;K<8;++K)G.write_shift(1,ke[K]);for(K=0;K<8;++K)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),K=0;K<3;++K)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,z[2]),G.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:M),G.write_shift(4,z[3]),G.write_shift(-4,z[1]?z[0]-1:M),G.write_shift(4,z[1]),K=0;K<109;++K)G.write_shift(-4,K<z[2]?z[1]+K:-1)}if(z[1])for(se=0;se<z[1];++se){for(;K<236+se*127;++K)G.write_shift(-4,K<z[2]?z[1]+K:-1);G.write_shift(-4,se===z[1]-1?M:se+1)}var me=function(Me){for(se+=Me;K<se-1;++K)G.write_shift(-4,K+1);Me&&(++K,G.write_shift(-4,M))};for(se=K=0,se+=z[1];K<se;++K)G.write_shift(-4,Oe.DIFSECT);for(se+=z[2];K<se;++K)G.write_shift(-4,Oe.FATSECT);me(z[3]),me(z[4]);for(var oe=0,le=0,ce=N.FileIndex[0];oe<N.FileIndex.length;++oe)ce=N.FileIndex[oe],ce.content&&(le=ce.content.length,!(le<4096)&&(ce.start=se,me(le+511>>9)));for(me(z[6]+7>>3);G.l&511;)G.write_shift(-4,Oe.ENDOFCHAIN);for(se=K=0,oe=0;oe<N.FileIndex.length;++oe)ce=N.FileIndex[oe],ce.content&&(le=ce.content.length,!(!le||le>=4096)&&(ce.start=se,me(le+63>>6)));for(;G.l&511;)G.write_shift(-4,Oe.ENDOFCHAIN);for(K=0;K<z[4]<<2;++K){var Te=N.FullPaths[K];if(!Te||Te.length===0){for(oe=0;oe<17;++oe)G.write_shift(4,0);for(oe=0;oe<3;++oe)G.write_shift(4,-1);for(oe=0;oe<12;++oe)G.write_shift(4,0);continue}ce=N.FileIndex[K],K===0&&(ce.start=ce.size?ce.start-1:M);var Le=K===0&&U.root||ce.name;if(le=2*(Le.length+1),G.write_shift(64,Le,"utf16le"),G.write_shift(2,le),G.write_shift(1,ce.type),G.write_shift(1,ce.color),G.write_shift(-4,ce.L),G.write_shift(-4,ce.R),G.write_shift(-4,ce.C),ce.clsid)G.write_shift(16,ce.clsid,"hex");else for(oe=0;oe<4;++oe)G.write_shift(4,0);G.write_shift(4,ce.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,ce.start),G.write_shift(4,ce.size),G.write_shift(4,0)}for(K=1;K<N.FileIndex.length;++K)if(ce=N.FileIndex[K],ce.size>=4096)if(G.l=ce.start+1<<9,pt&&Buffer.isBuffer(ce.content))ce.content.copy(G,G.l,0,ce.size),G.l+=ce.size+511&-512;else{for(oe=0;oe<ce.size;++oe)G.write_shift(1,ce.content[oe]);for(;oe&511;++oe)G.write_shift(1,0)}for(K=1;K<N.FileIndex.length;++K)if(ce=N.FileIndex[K],ce.size>0&&ce.size<4096)if(pt&&Buffer.isBuffer(ce.content))ce.content.copy(G,G.l,0,ce.size),G.l+=ce.size+63&-64;else{for(oe=0;oe<ce.size;++oe)G.write_shift(1,ce.content[oe]);for(;oe&63;++oe)G.write_shift(1,0)}if(pt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function F(N,W){var U=N.FullPaths.map(function(oe){return oe.toUpperCase()}),z=U.map(function(oe){var le=oe.split("/");return le[le.length-(oe.slice(-1)=="/"?2:1)]}),G=!1;W.charCodeAt(0)===47?(G=!0,W=U[0].slice(0,-1)+W):G=W.indexOf("/")!==-1;var K=W.toUpperCase(),se=G===!0?U.indexOf(K):z.indexOf(K);if(se!==-1)return N.FileIndex[se];var me=!K.match(Tc);for(K=K.replace(mn,""),me&&(K=K.replace(Tc,"!")),se=0;se<U.length;++se)if((me?U[se].replace(Tc,"!"):U[se]).replace(mn,"")==K||(me?z[se].replace(Tc,"!"):z[se]).replace(mn,"")==K)return N.FileIndex[se];return null}var b=64,M=-2,Pe="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],Ne="00000000000000000000000000000000",Oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:Pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(N,W,U){h();var z=D(N,U);u.writeFileSync(W,z)}function te(N){for(var W=new Array(N.length),U=0;U<N.length;++U)W[U]=String.fromCharCode(N[U]);return W.join("")}function de(N,W){var U=D(N,W);switch(W&&W.type||"buffer"){case"file":return h(),u.writeFileSync(W.filename,U),U;case"binary":return typeof U=="string"?U:te(U);case"base64":return Ev(typeof U=="string"?U:te(U));case"buffer":if(pt)return Buffer.isBuffer(U)?U:so(U);case"array":return typeof U=="string"?Ci(U):U}return U}var Ae;function j(N){try{var W=N.InflateRaw,U=new W;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)Ae=N;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function H(N,W){if(!Ae)return Pn(N,W);var U=Ae.InflateRaw,z=new U,G=z._processChunk(N.slice(N.l),z._finishFlushFlag);return N.l+=z.bytesRead,G}function J(N){return Ae?Ae.deflateRawSync(N):Re(N)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ye(N){var W=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(W>>16|W>>8|W)&255}for(var Se=typeof Uint8Array<"u",ve=Se?new Uint8Array(256):[],Ye=0;Ye<256;++Ye)ve[Ye]=ye(Ye);function Y(N,W){var U=ve[N&255];return W<=8?U>>>8-W:(U=U<<8|ve[N>>8&255],W<=16?U>>>16-W:(U=U<<8|ve[N>>16&255],U>>>24-W))}function yt(N,W){var U=W&7,z=W>>>3;return(N[z]|(U<=6?0:N[z+1]<<8))>>>U&3}function He(N,W){var U=W&7,z=W>>>3;return(N[z]|(U<=5?0:N[z+1]<<8))>>>U&7}function ot(N,W){var U=W&7,z=W>>>3;return(N[z]|(U<=4?0:N[z+1]<<8))>>>U&15}function ne(N,W){var U=W&7,z=W>>>3;return(N[z]|(U<=3?0:N[z+1]<<8))>>>U&31}function fe(N,W){var U=W&7,z=W>>>3;return(N[z]|(U<=1?0:N[z+1]<<8))>>>U&127}function be(N,W,U){var z=W&7,G=W>>>3,K=(1<<U)-1,se=N[G]>>>z;return U<8-z||(se|=N[G+1]<<8-z,U<16-z)||(se|=N[G+2]<<16-z,U<24-z)||(se|=N[G+3]<<24-z),se&K}function Xe(N,W,U){var z=W&7,G=W>>>3;return z<=5?N[G]|=(U&7)<<z:(N[G]|=U<<z&255,N[G+1]=(U&7)>>8-z),W+3}function qe(N,W,U){var z=W&7,G=W>>>3;return U=(U&1)<<z,N[G]|=U,W+1}function mt(N,W,U){var z=W&7,G=W>>>3;return U<<=z,N[G]|=U&255,U>>>=8,N[G+1]=U,W+8}function Lt(N,W,U){var z=W&7,G=W>>>3;return U<<=z,N[G]|=U&255,U>>>=8,N[G+1]=U&255,N[G+2]=U>>>8,W+16}function ir(N,W){var U=N.length,z=2*U>W?2*U:W+5,G=0;if(U>=W)return N;if(pt){var K=Tv(z);if(N.copy)N.copy(K);else for(;G<N.length;++G)K[G]=N[G];return K}else if(Se){var se=new Uint8Array(z);if(se.set)se.set(N);else for(;G<U;++G)se[G]=N[G];return se}return N.length=z,N}function Qt(N){for(var W=new Array(N),U=0;U<N;++U)W[U]=0;return W}function Dr(N,W,U){var z=1,G=0,K=0,se=0,me=0,oe=N.length,le=Se?new Uint16Array(32):Qt(32);for(K=0;K<32;++K)le[K]=0;for(K=oe;K<U;++K)N[K]=0;oe=N.length;var ce=Se?new Uint16Array(oe):Qt(oe);for(K=0;K<oe;++K)le[G=N[K]]++,z<G&&(z=G),ce[K]=0;for(le[0]=0,K=1;K<=z;++K)le[K+16]=me=me+le[K-1]<<1;for(K=0;K<oe;++K)me=N[K],me!=0&&(ce[K]=le[me+16]++);var Te=0;for(K=0;K<oe;++K)if(Te=N[K],Te!=0)for(me=Y(ce[K],z)>>z-Te,se=(1<<z+4-Te)-1;se>=0;--se)W[me|se<<Te]=Te&15|K<<4;return z}var ct=Se?new Uint16Array(512):Qt(512),Dt=Se?new Uint16Array(32):Qt(32);if(!Se){for(var bt=0;bt<512;++bt)ct[bt]=0;for(bt=0;bt<32;++bt)Dt[bt]=0}(function(){for(var N=[],W=0;W<32;W++)N.push(5);Dr(N,Dt,32);var U=[];for(W=0;W<=143;W++)U.push(8);for(;W<=255;W++)U.push(9);for(;W<=279;W++)U.push(7);for(;W<=287;W++)U.push(8);Dr(U,ct,288)})();var Ir=function(){for(var W=Se?new Uint8Array(32768):[],U=0,z=0;U<ge.length-1;++U)for(;z<ge[U+1];++z)W[z]=U;for(;z<32768;++z)W[z]=29;var G=Se?new Uint8Array(259):[];for(U=0,z=0;U<re.length-1;++U)for(;z<re[U+1];++z)G[z]=U;function K(me,oe){for(var le=0;le<me.length;){var ce=Math.min(65535,me.length-le),Te=le+ce==me.length;for(oe.write_shift(1,+Te),oe.write_shift(2,ce),oe.write_shift(2,~ce&65535);ce-- >0;)oe[oe.l++]=me[le++]}return oe.l}function se(me,oe){for(var le=0,ce=0,Te=Se?new Uint16Array(32768):[];ce<me.length;){var Le=Math.min(65535,me.length-ce);if(Le<10){for(le=Xe(oe,le,+(ce+Le==me.length)),le&7&&(le+=8-(le&7)),oe.l=le/8|0,oe.write_shift(2,Le),oe.write_shift(2,~Le&65535);Le-- >0;)oe[oe.l++]=me[ce++];le=oe.l*8;continue}le=Xe(oe,le,+(ce+Le==me.length)+2);for(var Me=0;Le-- >0;){var Ie=me[ce];Me=(Me<<5^Ie)&32767;var Fe=-1,Ze=0;if((Fe=Te[Me])&&(Fe|=ce&-32768,Fe>ce&&(Fe-=32768),Fe<ce))for(;me[Fe+Ze]==me[ce+Ze]&&Ze<250;)++Ze;if(Ze>2){Ie=G[Ze],Ie<=22?le=mt(oe,le,ve[Ie+1]>>1)-1:(mt(oe,le,3),le+=5,mt(oe,le,ve[Ie-23]>>5),le+=3);var Ct=Ie<8?0:Ie-4>>2;Ct>0&&(Lt(oe,le,Ze-re[Ie]),le+=Ct),Ie=W[ce-Fe],le=mt(oe,le,ve[Ie]>>3),le-=3;var It=Ie<4?0:Ie-2>>1;It>0&&(Lt(oe,le,ce-Fe-ge[Ie]),le+=It);for(var Mt=0;Mt<Ze;++Mt)Te[Me]=ce&32767,Me=(Me<<5^me[ce])&32767,++ce;Le-=Ze-1}else Ie<=143?Ie=Ie+48:le=qe(oe,le,1),le=mt(oe,le,ve[Ie]),Te[Me]=ce&32767,++ce}le=mt(oe,le,0)-1}return oe.l=(le+7)/8|0,oe.l}return function(oe,le){return oe.length<8?K(oe,le):se(oe,le)}}();function Re(N){var W=vr(50+Math.floor(N.length*1.1)),U=Ir(N,W);return W.slice(0,U)}var it=Se?new Uint16Array(32768):Qt(32768),At=Se?new Uint16Array(32768):Qt(32768),lt=Se?new Uint16Array(128):Qt(128),cr=1,xn=1;function an(N,W){var U=ne(N,W)+257;W+=5;var z=ne(N,W)+1;W+=5;var G=ot(N,W)+4;W+=4;for(var K=0,se=Se?new Uint8Array(19):Qt(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,le=Se?new Uint8Array(8):Qt(8),ce=Se?new Uint8Array(8):Qt(8),Te=se.length,Le=0;Le<G;++Le)se[q[Le]]=K=He(N,W),oe<K&&(oe=K),le[K]++,W+=3;var Me=0;for(le[0]=0,Le=1;Le<=oe;++Le)ce[Le]=Me=Me+le[Le-1]<<1;for(Le=0;Le<Te;++Le)(Me=se[Le])!=0&&(me[Le]=ce[Me]++);var Ie=0;for(Le=0;Le<Te;++Le)if(Ie=se[Le],Ie!=0){Me=ve[me[Le]]>>8-Ie;for(var Fe=(1<<7-Ie)-1;Fe>=0;--Fe)lt[Me|Fe<<Ie]=Ie&7|Le<<3}var Ze=[];for(oe=1;Ze.length<U+z;)switch(Me=lt[fe(N,W)],W+=Me&7,Me>>>=3){case 16:for(K=3+yt(N,W),W+=2,Me=Ze[Ze.length-1];K-- >0;)Ze.push(Me);break;case 17:for(K=3+He(N,W),W+=3;K-- >0;)Ze.push(0);break;case 18:for(K=11+fe(N,W),W+=7;K-- >0;)Ze.push(0);break;default:Ze.push(Me),oe<Me&&(oe=Me);break}var Ct=Ze.slice(0,U),It=Ze.slice(U);for(Le=U;Le<286;++Le)Ct[Le]=0;for(Le=z;Le<30;++Le)It[Le]=0;return cr=Dr(Ct,it,286),xn=Dr(It,At,30),W}function on(N,W){if(N[0]==3&&!(N[1]&3))return[ma(W),2];for(var U=0,z=0,G=Tv(W||1<<18),K=0,se=G.length>>>0,me=0,oe=0;!(z&1);){if(z=He(N,U),U+=3,z>>>1)z>>1==1?(me=9,oe=5):(U=an(N,U),me=cr,oe=xn);else{U&7&&(U+=8-(U&7));var le=N[U>>>3]|N[(U>>>3)+1]<<8;if(U+=32,le>0)for(!W&&se<K+le&&(G=ir(G,K+le),se=G.length);le-- >0;)G[K++]=N[U>>>3],U+=8;continue}for(;;){!W&&se<K+32767&&(G=ir(G,K+32767),se=G.length);var ce=be(N,U,me),Te=z>>>1==1?ct[ce]:it[ce];if(U+=Te&15,Te>>>=4,!(Te>>>8&255))G[K++]=Te;else{if(Te==256)break;Te-=257;var Le=Te<8?0:Te-4>>2;Le>5&&(Le=0);var Me=K+re[Te];Le>0&&(Me+=be(N,U,Le),U+=Le),ce=be(N,U,oe),Te=z>>>1==1?Dt[ce]:At[ce],U+=Te&15,Te>>>=4;var Ie=Te<4?0:Te-2>>1,Fe=ge[Te];for(Ie>0&&(Fe+=be(N,U,Ie),U+=Ie),!W&&se<Me&&(G=ir(G,Me+100),se=G.length);K<Me;)G[K]=G[K-Fe],++K}}}return W?[G,U+7>>>3]:[G.slice(0,K),U+7>>>3]}function Pn(N,W){var U=N.slice(N.l||0),z=on(U,W);return N.l+=z[1],z[0]}function Nn(N,W){if(N)typeof console<"u"&&console.error(W);else throw new Error(W)}function Di(N,W){var U=N;Mr(U,0);var z=[],G=[],K={FileIndex:z,FullPaths:G};S(K,{root:W.root});for(var se=U.length-4;(U[se]!=80||U[se+1]!=75||U[se+2]!=5||U[se+3]!=6)&&se>=0;)--se;U.l=se+4,U.l+=4;var me=U.read_shift(2);U.l+=6;var oe=U.read_shift(4);for(U.l=oe,se=0;se<me;++se){U.l+=20;var le=U.read_shift(4),ce=U.read_shift(4),Te=U.read_shift(2),Le=U.read_shift(2),Me=U.read_shift(2);U.l+=8;var Ie=U.read_shift(4),Fe=l(U.slice(U.l+Te,U.l+Te+Le));U.l+=Te+Le+Me;var Ze=U.l;U.l=Ie+4,Fi(U,le,ce,K,Fe),U.l=Ze}return K}function Fi(N,W,U,z,G){N.l+=2;var K=N.read_shift(2),se=N.read_shift(2),me=o(N);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var oe=N.read_shift(4),le=N.read_shift(4),ce=N.read_shift(4),Te=N.read_shift(2),Le=N.read_shift(2),Me="",Ie=0;Ie<Te;++Ie)Me+=String.fromCharCode(N[N.l++]);if(Le){var Fe=l(N.slice(N.l,N.l+Le));(Fe[21589]||{}).mt&&(me=Fe[21589].mt),((G||{})[21589]||{}).mt&&(me=G[21589].mt)}N.l+=Le;var Ze=N.slice(N.l,N.l+le);switch(se){case 8:Ze=H(N,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var Ct=!1;K&8&&(oe=N.read_shift(4),oe==134695760&&(oe=N.read_shift(4),Ct=!0),le=N.read_shift(4),ce=N.read_shift(4)),le!=W&&Nn(Ct,"Bad compressed size: "+W+" != "+le),ce!=U&&Nn(Ct,"Bad uncompressed size: "+U+" != "+ce),gi(z,Me,Ze,{unsafe:!0,mt:me})}function Os(N,W){var U=W||{},z=[],G=[],K=vr(1),se=U.compression?8:0,me=0,oe=0,le=0,ce=0,Te=0,Le=N.FullPaths[0],Me=Le,Ie=N.FileIndex[0],Fe=[],Ze=0;for(oe=1;oe<N.FullPaths.length;++oe)if(Me=N.FullPaths[oe].slice(Le.length),Ie=N.FileIndex[oe],!(!Ie.size||!Ie.content||Me=="Sh33tJ5")){var Ct=ce,It=vr(Me.length);for(le=0;le<Me.length;++le)It.write_shift(1,Me.charCodeAt(le)&127);It=It.slice(0,It.l),Fe[Te]=o4.buf(Ie.content,0);var Mt=Ie.content;se==8&&(Mt=J(Mt)),K=vr(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,me),K.write_shift(2,se),Ie.mt?s(K,Ie.mt):K.write_shift(4,0),K.write_shift(-4,Fe[Te]),K.write_shift(4,Mt.length),K.write_shift(4,Ie.content.length),K.write_shift(2,It.length),K.write_shift(2,0),ce+=K.length,z.push(K),ce+=It.length,z.push(It),ce+=Mt.length,z.push(Mt),K=vr(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,me),K.write_shift(2,se),K.write_shift(4,0),K.write_shift(-4,Fe[Te]),K.write_shift(4,Mt.length),K.write_shift(4,Ie.content.length),K.write_shift(2,It.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,Ct),Ze+=K.l,G.push(K),Ze+=It.length,G.push(It),++Te}return K=vr(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,Te),K.write_shift(2,Te),K.write_shift(4,Ze),K.write_shift(4,ce),K.write_shift(2,0),Ks([Ks(z),Ks(G),K])}var bi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function mi(N,W){if(N.ctype)return N.ctype;var U=N.name||"",z=U.match(/\.([^\.]+)$/);return z&&bi[z[1]]||W&&(z=(U=W).match(/[\.\\]([^\.\\])+$/),z&&bi[z[1]])?bi[z[1]]:"application/octet-stream"}function po(N){for(var W=Ev(N),U=[],z=0;z<W.length;z+=76)U.push(W.slice(z,z+76));return U.join(`\r
`)+`\r
`}function Ls(N){var W=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var ce=le.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],z=W.split(`\r
`),G=0;G<z.length;++G){var K=z[G];if(K.length==0){U.push("");continue}for(var se=0;se<K.length;){var me=76,oe=K.slice(se,se+me);oe.charAt(me-1)=="="?me--:oe.charAt(me-2)=="="?me-=2:oe.charAt(me-3)=="="&&(me-=3),oe=K.slice(se,se+me),se+=me,se<K.length&&(oe+="="),U.push(oe)}}return U.join(`\r
`)}function mo(N){for(var W=[],U=0;U<N.length;++U){for(var z=N[U];U<=N.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+N[++U];W.push(z)}for(var G=0;G<W.length;++G)W[G]=W[G].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return Ci(W.join(`\r
`))}function ts(N,W,U){for(var z="",G="",K="",se,me=0;me<10;++me){var oe=W[me];if(!oe||oe.match(/^\s*$/))break;var le=oe.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":z=le[2].trim();break;case"content-type":K=le[2].trim();break;case"content-transfer-encoding":G=le[2].trim();break}}switch(++me,G.toLowerCase()){case"base64":se=Ci($n(W.slice(me).join("")));break;case"quoted-printable":se=mo(W.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var ce=gi(N,z.slice(U.length),se,{unsafe:!0});K&&(ce.ctype=K)}function Ds(N,W){if(te(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=W&&W.root||"",z=(pt&&Buffer.isBuffer(N)?N.toString("binary"):te(N)).split(`\r
`),G=0,K="";for(G=0;G<z.length;++G)if(K=z[G],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),U||(U=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),K.slice(0,U.length)!=U););var se=(z[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var me="--"+(se[1]||""),oe=[],le=[],ce={FileIndex:oe,FullPaths:le};S(ce);var Te,Le=0;for(G=0;G<z.length;++G){var Me=z[G];Me!==me&&Me!==me+"--"||(Le++&&ts(ce,z.slice(Te,G),U),Te=G)}return ce}function _r(N,W){var U=W||{},z=U.boundary||"SheetJS";z="------="+z;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],K=N.FullPaths[0],se=K,me=N.FileIndex[0],oe=1;oe<N.FullPaths.length;++oe)if(se=N.FullPaths[oe].slice(K.length),me=N.FileIndex[oe],!(!me.size||!me.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ze){return"_x"+Ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ze){return"_u"+Ze.charCodeAt(0).toString(16)+"_"});for(var le=me.content,ce=pt&&Buffer.isBuffer(le)?le.toString("binary"):te(le),Te=0,Le=Math.min(1024,ce.length),Me=0,Ie=0;Ie<=Le;++Ie)(Me=ce.charCodeAt(Ie))>=32&&Me<128&&++Te;var Fe=Te>=Le*4/5;G.push(z),G.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+se),G.push("Content-Transfer-Encoding: "+(Fe?"quoted-printable":"base64")),G.push("Content-Type: "+mi(me,se)),G.push(""),G.push(Fe?Ls(ce):po(ce))}return G.push(z+`--\r
`),G.join(`\r
`)}function go(N){var W={};return S(W,N),W}function gi(N,W,U,z){var G=z&&z.unsafe;G||S(N);var K=!G&&vt.find(N,W);if(!K){var se=N.FullPaths[0];W.slice(0,se.length)==se?se=W:(se.slice(-1)!="/"&&(se+="/"),se=(se+W).replace("//","/")),K={name:i(W),type:2},N.FileIndex.push(K),N.FullPaths.push(se),G||vt.utils.cfb_gc(N)}return K.content=U,K.size=U?U.length:0,z&&(z.CLSID&&(K.clsid=z.CLSID),z.mt&&(K.mt=z.mt),z.ct&&(K.ct=z.ct)),K}function rs(N,W){S(N);var U=vt.find(N,W);if(U){for(var z=0;z<N.FileIndex.length;++z)if(N.FileIndex[z]==U)return N.FileIndex.splice(z,1),N.FullPaths.splice(z,1),!0}return!1}function yn(N,W,U){S(N);var z=vt.find(N,W);if(z){for(var G=0;G<N.FileIndex.length;++G)if(N.FileIndex[G]==z)return N.FileIndex[G].name=i(U),N.FullPaths[G]=U,!0}return!1}function ze(N){P(N,!0)}return t.find=F,t.read=X,t.parse=p,t.write=de,t.writeFile=ue,t.utils={cfb_new:go,cfb_add:gi,cfb_del:rs,cfb_mov:yn,cfb_gc:ze,ReadShift:Bc,CheckField:UT,prep_blob:Mr,bconcat:Ks,use_zlib:j,_deflateRaw:Re,_inflateRaw:Pn,consts:Oe},t}();function l4(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function qi(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Og(e){for(var t=[],r=qi(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var jh=new Date(1899,11,30,0,0,0);function gn(e,t){var r=e.getTime(),n=jh.getTime()+(e.getTimezoneOffset()-jh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var vT=new Date,c4=jh.getTime()+(vT.getTimezoneOffset()-jh.getTimezoneOffset())*6e4,Pv=vT.getTimezoneOffset();function N0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+c4),t.getTimezoneOffset()!==Pv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Pv)*6e4),t}function u4(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var Nv=new Date("2017-02-19T19:06:09.000Z"),xT=isNaN(Nv.getFullYear())?new Date("2/19/17"):Nv,f4=xT.getFullYear()==2017;function Lr(e,t){var r=new Date(e);if(f4)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(xT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ya(e,t){if(pt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ac(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ac(sT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ac(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ac(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Vr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Vr(e[r]));return t}function rr(e,t){for(var r="";r.length<t;)r+=e;return r}function Oi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var h4=["january","february","march","april","may","june","july","august","september","october","november","december"];function yl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&h4.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var d4=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(i),o.push(s[l]);return o}}();function yT(e){return e?e.content&&e.type?Ya(e.content,!0):e.data?Ec(e.data):e.asNodeBuffer&&pt?Ec(e.asNodeBuffer().toString("binary")):e.asBinary?Ec(e.asBinary()):e._data&&e._data.getContent?Ec(Ya(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ET(e){if(!e)return null;if(e.data)return xv(e.data);if(e.asNodeBuffer&&pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?xv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function p4(e){return e&&e.name.slice(-4)===".bin"?ET(e):yT(e)}function si(e,t){for(var r=e.FullPaths||qi(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Lg(e,t){var r=si(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function pr(e,t,r){if(!r)return p4(Lg(e,t));if(!t)return null;try{return pr(e,t)}catch{return null}}function Vn(e,t,r){if(!r)return yT(Lg(e,t));if(!t)return null;try{return Vn(e,t)}catch{return null}}function m4(e,t,r){return ET(Lg(e,t))}function Ov(e){for(var t=e.FullPaths||qi(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function g4(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return pt?n=so(r):n=FR(r),vt.utils.cfb_add(e,t,n)}vt.utils.cfb_add(e,t,r)}else e.file(t,r)}function TT(e,t){switch(t.type){case"base64":return vt.read(e,{type:"base64"});case"binary":return vt.read(e,{type:"binary"});case"buffer":case"array":return vt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function wc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var wT=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_4=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Lv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,v4=/<[^>]*>/g,sn=wT.match(Lv)?Lv:v4,x4=/<\w*:/,y4=/<(\/?)\w+:/;function Ke(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(_4),l=0,u="",h=0,p="",m="",_=1;if(o)for(h=0;h!=o.length;++h){for(m=o[h],s=0;s!=m.length&&m.charCodeAt(s)!==61;++s);for(p=m.slice(0,s).trim();m.charCodeAt(s+1)==32;)++s;for(_=(i=m.charCodeAt(s+1))==34||i==39?1:0,u=m.slice(s+1+_,m.length-_),l=0;l!=p.length&&p.charCodeAt(l)!==58;++l);if(l===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=u,n[p.toLowerCase()]=u;else{var x=(l===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(l+1);if(n[x]&&p.slice(l-3,l)=="ext")continue;n[x]=u,n[x.toLowerCase()]=u}}return n}function Qi(e){return e.replace(y4,"<$1")}var AT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},E4=Og(AT),wt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(l,u){return AT[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,u){return String.fromCharCode(parseInt(u,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),T4=/[&<>'"]/g,w4=/[\u0000-\u001f]/g;function Dg(e){var t=e+"";return t.replace(T4,function(r){return E4[r]}).replace(/\n/g,"<br/>").replace(w4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Dv=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Wt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Od(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Fv(e){var t=ma(2*e.length),r,n,i=1,s=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function bv(e){return so(e,"binary").toString("utf8")}var Bf="foo bar baz",Ut=pt&&(bv(Bf)==Od(Bf)&&bv||Fv(Bf)==Od(Bf)&&Fv)||Od,Ac=pt?function(e){return so(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},xu=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),ST=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),A4=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),S4=/<\/?(?:vt:)?variant>/g,I4=/<(?:vt:)([^>]*)>([\s\S]*)</;function Mv(e,t){var r=Ke(e),n=e.match(A4(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(S4,"").match(I4);o&&i.push({v:Ut(o[2]),t:o[1]})}),i}var C4=/(^\s|\s$|\n)/;function k4(e){return qi(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function R4(e,t,r){return"<"+e+(r!=null?k4(r):"")+(t!=null?(t.match(C4)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Fg(e){if(pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ut(ao(Rg(e)));throw new Error("Bad input format: expected Buffer or string")}var yu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,P4={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},N4=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function O4(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function L4(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var Bv=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Uv=pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:so(t)})):Bv(e)}:Bv,Vv=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(gs(e,i)));return n.join("").replace(mn,"")},bg=pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(mn,""):Vv(e,t,r)}:Vv,zv=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},IT=pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):zv(e,t,r)}:zv,jv=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(bo(e,i)));return n.join("")},Vu=pt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):jv(t,r,n)}:jv,CT=function(e,t){var r=Un(e,t);return r>0?Vu(e,t+4,t+4+r-1):""},kT=CT,RT=function(e,t){var r=Un(e,t);return r>0?Vu(e,t+4,t+4+r-1):""},PT=RT,NT=function(e,t){var r=2*Un(e,t);return r>0?Vu(e,t+4,t+4+r-1):""},OT=NT,LT=function(t,r){var n=Un(t,r);return n>0?bg(t,r+4,r+4+n):""},DT=LT,FT=function(e,t){var r=Un(e,t);return r>0?Vu(e,t+4,t+4+r):""},bT=FT,MT=function(e,t){return O4(e,t)},Hh=MT,BT=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};pt&&(kT=function(t,r){if(!Buffer.isBuffer(t))return CT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},PT=function(t,r){if(!Buffer.isBuffer(t))return RT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},OT=function(t,r){if(!Buffer.isBuffer(t))return NT(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},DT=function(t,r){if(!Buffer.isBuffer(t))return LT(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},bT=function(t,r){if(!Buffer.isBuffer(t))return FT(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Hh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):MT(t,r)},BT=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var bo=function(e,t){return e[t]},gs=function(e,t){return e[t+1]*256+e[t]},D4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Un=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Oa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},F4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Bc(e,t){var r="",n,i,s=[],o,l,u,h;switch(t){case"dbcs":if(h=this.l,pt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(gs(this,h)),h+=2;e*=2;break;case"utf8":r=Vu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=bg(this,this.l,this.l+e);break;case"wstr":return Bc.call(this,e,"dbcs");case"lpstr-ansi":r=kT(this,this.l),e=4+Un(this,this.l);break;case"lpstr-cp":r=PT(this,this.l),e=4+Un(this,this.l);break;case"lpwstr":r=OT(this,this.l),e=4+2*Un(this,this.l);break;case"lpp4":e=4+Un(this,this.l),r=DT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Un(this,this.l),r=bT(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=bo(this,this.l+e++))!==0;)s.push(Mf(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=gs(this,this.l+e))!==0;)s.push(Mf(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",h=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=bo(this,h),this.l=h+1,l=Bc.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Mf(gs(this,h))),h+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=bo(this,h),this.l=h+1,l=Bc.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Mf(bo(this,h))),h+=1}r=s.join("");break;default:switch(e){case 1:return n=bo(this,this.l),this.l++,n;case 2:return n=(t==="i"?D4:gs)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Oa:F4)(this,this.l),this.l+=4,n):(i=Un(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Hh(this,this.l):i=Hh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=IT(this,this.l,e);break}}return this.l+=e,r}var b4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},M4=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},B4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function U4(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)B4(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,b4(this,t,this.l);break;case 8:if(n=8,r==="f"){L4(this,t,this.l);break}case 16:break;case-4:n=4,M4(this,t,this.l);break}return this.l+=n,this}function UT(e,t){var r=IT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Mr(e,t){e.l=t,e.read_shift=Bc,e.chk=UT,e.write_shift=U4}function nn(e,t){e.l+=t}function vr(e){var t=ma(e);return Mr(t,0),t}function Ns(e,t,r){if(e){var n,i,s;Mr(e,e.l||0);for(var o=e.length,l=0,u=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var h=Xh[l]||Xh[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;u=e.l+s;var p=h.f&&h.f(e,s,r);if(e.l=u,t(p,h,l))return}}}function Yp(){var e=[],t=pt?256:2048,r=function(h){var p=vr(h);return Mr(p,0),p},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(h){return n&&h<n.length-n.l?n:(i(),n=r(Math.max(h+1,t)))},o=function(){return i(),Ks(e)},l=function(h){i(),n=h,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function Uc(e,t,r){var n=Vr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Hv(e,t,r){var n=Vr(e);return n.s=Uc(n.s,t.s,r),n.e=Uc(n.e,t.s,r),n}function Vc(e,t){if(e.cRel&&e.c<0)for(e=Vr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Vr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=tt(e);return!e.cRel&&e.cRel!=null&&(r=j4(r)),!e.rRel&&e.rRel!=null&&(r=V4(r)),r}function Ld(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Tr(e.s.c)+":"+(e.e.cRel?"":"$")+Tr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+zr(e.s.r)+":"+(e.e.rRel?"":"$")+zr(e.e.r):Vc(e.s,t.biff)+":"+Vc(e.e,t.biff)}function Mg(e){return parseInt(z4(e),10)-1}function zr(e){return""+(e+1)}function V4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function z4(e){return e.replace(/\$(\d+)$/,"$1")}function Bg(e){for(var t=H4(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Tr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function j4(e){return e.replace(/^([A-Z])/,"$$$1")}function H4(e){return e.replace(/^\$([A-Z])/,"$1")}function W4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function dn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function tt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Dl(e){var t=e.indexOf(":");return t==-1?{s:dn(e),e:dn(e)}:{s:dn(e.slice(0,t)),e:dn(e.slice(t+1))}}function xt(e,t){return typeof t>"u"||typeof t=="number"?xt(e.s,e.e):(typeof e!="string"&&(e=tt(e)),typeof t!="string"&&(t=tt(t)),e==t?e:e+":"+t)}function nr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Wv(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=di(e.z,r?gn(t):t)}catch{}try{return e.w=di((e.XF||{}).numFmtId||(r?14:0),r?gn(t):t)}catch{return""+t}}function Ss(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?co[e.v]||e.v:t==null?Wv(e,e.v):Wv(e,t))}function Aa(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function VT(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?dn(n.origin):n.origin;o=u.r,l=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var p=nr(s["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),o==-1&&(h.e.r=o=p.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=t[m].length;++_)if(!(typeof t[m][_]>"u")){var x={v:t[m][_]},E=o+m,y=l+_;if(h.s.r>E&&(h.s.r=E),h.s.c>y&&(h.s.c=y),h.e.r<E&&(h.e.r=E),h.e.c<y&&(h.e.c=y),t[m][_]&&typeof t[m][_]=="object"&&!Array.isArray(t[m][_])&&!(t[m][_]instanceof Date))x=t[m][_];else if(Array.isArray(x.v)&&(x.f=t[m][_][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||at[14],n.cellDates?(x.t="d",x.w=di(x.z,gn(x.v))):(x.t="n",x.v=gn(x.v),x.w=di(x.z,x.v))):x.t="s";if(i)s[E]||(s[E]=[]),s[E][y]&&s[E][y].z&&(x.z=s[E][y].z),s[E][y]=x;else{var A=tt({c:y,r:E});s[A]&&s[A].z&&(x.z=s[A].z),s[A]=x}}}return h.s.c<1e7&&(s["!ref"]=xt(h)),s}function Fl(e,t){return VT(null,e,t)}function G4(e){return e.read_shift(4,"i")}function tn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function $4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ug(e,t){var r=e.l,n=e.read_shift(1),i=tn(e),s=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),u=0;u!=l;++u)s.push($4(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var Z4=Ug;function pi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function oo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var K4=tn;function Vg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var X4=tn,Jp=Vg;function zg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Hh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Oa(t,0)>>2;return r?i/100:i}function zT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var lo=zT;function Qr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function q4(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var h=ja[i];h&&(t.rgb=Tu(h));break;case 2:t.rgb=Tu([o,l,u]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Y4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function jT(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function J4(e){return jT(e,1)}function Q4(e){return jT(e,2)}var jg=2,wn=3,Uf=11,Gv=12,Wh=19,Vf=64,eP=65,tP=71,rP=4108,nP=4126,Rr=80,HT=81,iP=[Rr,HT],sP={1:{n:"CodePage",t:jg},2:{n:"Category",t:Rr},3:{n:"PresentationFormat",t:Rr},4:{n:"ByteCount",t:wn},5:{n:"LineCount",t:wn},6:{n:"ParagraphCount",t:wn},7:{n:"SlideCount",t:wn},8:{n:"NoteCount",t:wn},9:{n:"HiddenCount",t:wn},10:{n:"MultimediaClipCount",t:wn},11:{n:"ScaleCrop",t:Uf},12:{n:"HeadingPairs",t:rP},13:{n:"TitlesOfParts",t:nP},14:{n:"Manager",t:Rr},15:{n:"Company",t:Rr},16:{n:"LinksUpToDate",t:Uf},17:{n:"CharacterCount",t:wn},19:{n:"SharedDoc",t:Uf},22:{n:"HyperlinksChanged",t:Uf},23:{n:"AppVersion",t:wn,p:"version"},24:{n:"DigSig",t:eP},26:{n:"ContentType",t:Rr},27:{n:"ContentStatus",t:Rr},28:{n:"Language",t:Rr},29:{n:"Version",t:Rr},255:{},2147483648:{n:"Locale",t:Wh},2147483651:{n:"Behavior",t:Wh},1919054434:{}},aP={1:{n:"CodePage",t:jg},2:{n:"Title",t:Rr},3:{n:"Subject",t:Rr},4:{n:"Author",t:Rr},5:{n:"Keywords",t:Rr},6:{n:"Comments",t:Rr},7:{n:"Template",t:Rr},8:{n:"LastAuthor",t:Rr},9:{n:"RevNumber",t:Rr},10:{n:"EditTime",t:Vf},11:{n:"LastPrinted",t:Vf},12:{n:"CreatedDate",t:Vf},13:{n:"ModifiedDate",t:Vf},14:{n:"PageCount",t:wn},15:{n:"WordCount",t:wn},16:{n:"CharCount",t:wn},17:{n:"Thumbnail",t:tP},18:{n:"Application",t:Rr},19:{n:"DocSecurity",t:wn},255:{},2147483648:{n:"Locale",t:Wh},2147483651:{n:"Behavior",t:Wh},1919054434:{}},$v={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},oP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function lP(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var cP=lP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ja=Vr(cP),co={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},WT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Zv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function uP(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function fP(e){var t=uP();if(!e||!e.match)return t;var r={};if((e.match(sn)||[]).forEach(function(n){var i=Ke(n);switch(i[0].replace(x4,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Zv[i.ContentType]]!==void 0&&t[Zv[i.ContentType]].push(i.PartName);break}}),t.xmlns!==P4.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Qo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Qp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function zc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(sn)||[]).forEach(function(i){var s=Ke(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:wc(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}var hP="application/vnd.oasis.opendocument.spreadsheet";function dP(e,t){for(var r=Fg(e),n,i;n=yu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ke(n[0],!1),i.path=="/"&&i.type!==hP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var jc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],pP=function(){for(var e=new Array(jc.length),t=0;t<jc.length;++t){var r=jc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function GT(e){var t={};e=Ut(e);for(var r=0;r<jc.length;++r){var n=jc[r],i=e.match(pP[r]);i!=null&&i.length>0&&(t[n[1]]=wt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Lr(t[n[1]]))}return t}var mP=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function $T(e,t,r,n){var i=[];if(typeof e=="string")i=Mv(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(p){return{v:p}}));var o=typeof t=="string"?Mv(t,n).map(function(p){return p.v}):t,l=0,u=0;if(o.length>0)for(var h=0;h!==i.length;h+=2){switch(u=+i[h+1].v,i[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(l,l+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(l,l+u);break}l+=u}}function gP(e,t,r){var n={};return t||(t={}),e=Ut(e),mP.forEach(function(i){var s=(e.match(xu(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=wt(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&$T(n.HeadingPairs,n.TitlesOfParts,t,r),t}var _P=/<[^>]+>[^<]*/g;function vP(e,t){var r={},n="",i=e.match(_P);if(i)for(var s=0;s!=i.length;++s){var o=i[s],l=Ke(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=wt(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),h=u[0].slice(4),p=u[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=wt(p);break;case"bool":r[n]=Wt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=Lr(p);break;case"cy":case"error":r[n]=wt(p);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var xP={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Dd;function yP(e,t,r){Dd||(Dd=Og(xP)),t=Dd[t]||t,e[t]=r}function Hg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ZT(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function KT(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function XT(e,t,r){return t===31?KT(e):ZT(e,t,r)}function em(e,t,r){return XT(e,t,r===!1?0:4)}function EP(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return XT(e,t,0)}function TP(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(mn,""),e.l-i&2&&(e.l+=2)}return r}function wP(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(mn,"");return r}function AP(e){var t=e.l,r=Gh(e,HT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Gh(e,wn);return[r,n]}function SP(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(AP(e));return r}function Kv(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(mn,"").replace(Tc,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function qT(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function IP(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Gh(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==Gv&&n!==t&&iP.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Gv?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return ZT(e,n,4).replace(mn,"");case 31:return KT(e);case 64:return Hg(e);case 65:return qT(e);case 71:return IP(e);case 80:return em(e,n,!s.raw).replace(mn,"");case 81:return EP(e,n).replace(mn,"");case 4108:return SP(e);case 4126:case 4127:return n==4127?TP(e):wP(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Xv(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,l=0,u=-1,h={};for(o=0;o!=i;++o){var p=e.read_shift(4),m=e.read_shift(4);s[o]=[p,m+r]}s.sort(function(k,w){return k[1]-w[1]});var _={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var x=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,x=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],x=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],x=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(x=!1,e.l=s[o][1]),x)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var E=t[s[o][0]];if(_[E.n]=Gh(e,E.t,{raw:!0}),E.p==="version"&&(_[E.n]=String(_[E.n]>>16)+"."+("0000"+String(_[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(_[E.n]){case 0:_[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ki(l=_[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[E.n])}}else if(s[o][0]===1){if(l=_.CodePage=Gh(e,jg),ki(l),u!==-1){var y=e.l;e.l=s[u][1],h=Kv(e,l),e.l=y}}else if(s[o][0]===0){if(l===0){u=o,e.l=s[o+1][1];continue}h=Kv(e,l)}else{var A=h[s[o][0]],C;switch(e[e.l]){case 65:e.l+=4,C=qT(e);break;case 30:e.l+=4,C=em(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=em(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=ar(e,4);break;case 64:e.l+=4,C=Lr(Hg(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[A]=C}}return e.l=r+n,_}function qv(e,t,r){var n=e.content;if(!n)return{};Mr(n,0);var i,s,o,l,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),p=n.read_shift(16);if(p!==vt.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),u=n.read_shift(4));var m=Xv(n,t),_={SystemIdentifier:h};for(var x in m)_[x]=m[x];if(_.FMTID=s,i===1)return _;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var E;try{E=Xv(n,null)}catch{}for(x in E)_[x]=E[x];return _.FMTID=[s,o],_}function Hs(e,t){return e.read_shift(t),null}function CP(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function ar(e,t){return e.read_shift(t)===1}function mr(e){return e.read_shift(2,"u")}function YT(e,t){return CP(e,t,mr)}function kP(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function zu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function RP(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,l,u={};i&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var h=s==2?"dbcs-cont":"sbcs-cont",p=t===0?"":e.read_shift(t,h);return i&&(e.l+=4*o),n&&(e.l+=l),u.t=p,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function Ja(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ju(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ja(e,n,r)}function uo(e,t,r){if(r.biff>5)return ju(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function PP(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function NP(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(mn,"");return n&&(e.l+=24),i}function OP(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(mn,"");return r+o}function LP(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return NP(e);case"0303000000000000c000000000000046":return OP(e);default:throw new Error("Unsupported Moniker "+r)}}function zf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(mn,""):"";return r}function DP(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,l,u,h="",p,m;i&16&&(s=zf(e,r-e.l)),i&128&&(o=zf(e,r-e.l)),(i&257)===257&&(l=zf(e,r-e.l)),(i&257)===1&&(u=LP(e,r-e.l)),i&8&&(h=zf(e,r-e.l)),i&32&&(p=e.read_shift(16)),i&64&&(m=Hg(e)),e.l=r;var _=o||l||u||"";_&&h&&(_+="#"+h),_||(_="#"+h),i&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var x={Target:_};return p&&(x.guid=p),m&&(x.time=m),s&&(x.Tooltip=s),x}function JT(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function QT(e,t){var r=JT(e);return r[3]=0,r}function es(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function FP(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function bP(e,t,r){return t===0?"":uo(e,t,r)}function MP(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,s,o]}function ew(e){var t=e.read_shift(2),r=zg(e);return[t,r]}function BP(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=zu(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function O0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function tw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var UP=tw;function rw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function VP(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function zP(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Zr(e){e.l+=2,e.l+=e.read_shift(2)}var jP={0:Zr,4:Zr,5:Zr,6:Zr,7:zP,8:Zr,9:Zr,10:Zr,11:Zr,12:Zr,13:VP,14:Zr,15:Zr,16:Zr,17:Zr,18:Zr,19:Zr,20:Zr,21:rw};function HP(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(jP[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function jf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function WP(e,t){return t===0||e.read_shift(2),1200}function GP(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=uo(e,0,r);return e.read_shift(t+n-e.l),i}function $P(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function ZP(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=zu(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function KP(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(RP(e));return s.Count=n,s.Unique=i,s}function XP(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function qP(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function YP(e){var t=FP(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function JP(e){return e.read_shift(2),e.read_shift(4)}function Yv(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function QP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:l,Selected:u,TabRatio:h}}function eN(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function tN(){}function rN(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=zu(e,0,r),n}function nN(e){var t=es(e);return t.isst=e.read_shift(4),t}function iN(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=es(e);r.biff==2&&e.l++;var s=ju(e,n-e.l,r);return i.val=s,i}function sN(e,t,r){var n=e.read_shift(2),i=uo(e,0,r);return[n,i]}var aN=uo;function Jv(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c:u}}}function oN(e){var t=e.read_shift(2),r=e.read_shift(2),n=ew(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function lN(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(ew(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function cN(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function uN(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(2);return i.patternType=oP[l>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function fN(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=uN(e,t,n.fStyle,r),n}function hN(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Qv(e,t,r){var n=es(e);(r.biff==2||t==9)&&++e.l;var i=kP(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function dN(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=es(e),i=Qr(e);return n.val=i,n}var ex=bP;function pN(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=Ja(e,s),l=[];n>e.l;)l.push(ju(e));return[s,i,o,l]}function tx(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=BP(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var mN=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function rx(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var h=Ja(e,o,r);i&32&&(h=mN[h.charCodeAt(0)]);var p=n-e.l;r&&r.biff==2&&--p;var m=n==e.l||l===0||!(p>0)?[]:qL(e,p,r,l);return{chKey:s,Name:h,itab:u,rgce:m}}function nw(e,t,r){if(r.biff<8)return gN(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(MP(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function gN(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=zu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function _N(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=Ja(e,n,r),o=Ja(e,i,r);return[s,o]}function vN(e,t,r){var n=tw(e);e.l++;var i=e.read_shift(1);return t-=8,[YL(e,t,r),i,n]}function nx(e,t,r){var n=UP(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,KL(e,t,r)]}function xN(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function yN(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=uo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,s]}}function EN(e,t,r){return yN(e,t,r)}function TN(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(O0(e));return r}function wN(e,t,r){if(r&&r.biff<8)return SN(e,t,r);var n=rw(e),i=HP(e,t-22,n[1]);return{cmo:n,ft:i}}var AN={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function SN(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((AN[n]||nn)(e,t,r)),{cmo:[i,n,s],ft:o}}function IN(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=PP(e,6,r);var l=e.read_shift(2);e.read_shift(2),mr(e,2);var u=e.read_shift(2);e.l+=u;for(var h=1;h<e.lens.length-1;++h){if(e.l-n!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],m=Ja(e,e.lens[h+1]-e.lens[h]-1);if(i+=m,i.length>=(p?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function CN(e,t){var r=O0(e);e.l+=16;var n=DP(e,t-24);return[r,n]}function kN(e,t){e.read_shift(2);var r=O0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(mn,""),[r,n]}function RN(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=$v[r]||r,r=e.read_shift(2),t[1]=$v[r]||r,t}function PN(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(QT(e));return r}function NN(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(QT(e));return r}function ON(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function iw(e,t,r){if(!r.cellStyles)return nn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var h={s:i,e:s,w:o,ixfe:l,flags:u};return(r.biff>=5||!r.biff)&&(h.level=u>>8&7),h}function LN(e,t){var r={};return t<32||(e.l+=16,r.header=Qr(e),r.footer=Qr(e),e.l+=2),r}function DN(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var FN=es,bN=YT,MN=ju;function BN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function UN(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=es(e);++e.l;var i=uo(e,t-7,r);return n.t="str",n.val=i,n}function VN(e){var t=es(e);++e.l;var r=Qr(e);return t.t="n",t.val=r,t}function zN(e){var t=es(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function jN(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function HN(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function WN(e,t,r){var n=e.l+t,i=es(e),s=e.read_shift(2),o=Ja(e,s,r);return e.l=n,i.t="str",i.val=o,i}var GN=[2,3,48,49,131,139,140,245],ix=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Og({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var h=[],p=ma(1);switch(u.type){case"base64":p=Ci($n(l));break;case"binary":p=Ci(l);break;case"buffer":case"array":p=l;break}Mr(p,0);var m=p.read_shift(1),_=!!(m&136),x=!1,E=!1;switch(m){case 2:break;case 3:break;case 48:x=!0,_=!0;break;case 49:x=!0,_=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var y=0,A=521;m==2&&(y=p.read_shift(2)),p.l+=3,m!=2&&(y=p.read_shift(4)),y>1048576&&(y=1e6),m!=2&&(A=p.read_shift(2));var C=p.read_shift(2),k=u.codepage||1252;m!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(k=e[p[p.l]]),p.l+=1,p.l+=2),E&&(p.l+=36);for(var w=[],V={},Q=Math.min(p.length,m==2?521:A-10-(x?264:0)),X=E?32:11;p.l<Q&&p[p.l]!=13;)switch(V={},V.name=_u.utils.decode(k,p.slice(p.l,p.l+X)).replace(/[\u0000\r\n].*$/g,""),p.l+=X,V.type=String.fromCharCode(p.read_shift(1)),m!=2&&!E&&(V.offset=p.read_shift(4)),V.len=p.read_shift(1),m==2&&(V.offset=p.read_shift(2)),V.dec=p.read_shift(1),V.name.length&&w.push(V),m!=2&&(p.l+=E?13:14),V.type){case"B":(!x||V.len!=8)&&u.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+V.type)}if(p[p.l]!==13&&(p.l=A-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=A;var S=0,R=0;for(h[0]=[],R=0;R!=w.length;++R)h[0][R]=w[R].name;for(;y-- >0;){if(p[p.l]===42){p.l+=C;continue}for(++p.l,h[++S]=[],R=0,R=0;R!=w.length;++R){var P=p.slice(p.l,p.l+w[R].len);p.l+=w[R].len,Mr(P,0);var D=_u.utils.decode(k,P);switch(w[R].type){case"C":D.trim().length&&(h[S][R]=D.replace(/\s+$/,""));break;case"D":D.length===8?h[S][R]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):h[S][R]=D;break;case"F":h[S][R]=parseFloat(D.trim());break;case"+":case"I":h[S][R]=E?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":h[S][R]=!0;break;case"N":case"F":h[S][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));h[S][R]="##MEMO##"+(E?parseInt(D.trim(),10):P.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(h[S][R]=+D||0);break;case"@":h[S][R]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":h[S][R]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":h[S][R]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[S][R]=-P.read_shift(-8,"f");break;case"B":if(x&&w[R].len==8){h[S][R]=P.read_shift(8,"f");break}case"G":case"P":P.l+=w[R].len;break;case"0":if(w[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[R].type)}}}if(m!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return u&&u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=w,h}function n(l,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var p=Fl(r(l,h),h);return p["!cols"]=h.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete h.DBF,p}function i(l,u){try{return Aa(n(l,u),u)}catch(h){if(u&&u.WTF)throw h}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,u){var h=u||{};if(+h.codepage>=0&&ki(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=Yp(),m=om(l,{header:1,raw:!0,cellDates:!0}),_=m[0],x=m.slice(1),E=l["!cols"]||[],y=0,A=0,C=0,k=1;for(y=0;y<_.length;++y){if(((E[y]||{}).DBF||{}).name){_[y]=E[y].DBF.name,++C;continue}if(_[y]!=null){if(++C,typeof _[y]=="number"&&(_[y]=_[y].toString(10)),typeof _[y]!="string")throw new Error("DBF Invalid column name "+_[y]+" |"+typeof _[y]+"|");if(_.indexOf(_[y])!==y){for(A=0;A<1024;++A)if(_.indexOf(_[y]+"_"+A)==-1){_[y]+="_"+A;break}}}}var w=nr(l["!ref"]),V=[],Q=[],X=[];for(y=0;y<=w.e.c-w.s.c;++y){var S="",R="",P=0,D=[];for(A=0;A<x.length;++A)x[A][y]!=null&&D.push(x[A][y]);if(D.length==0||_[y]==null){V[y]="?";continue}for(A=0;A<D.length;++A){switch(typeof D[A]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=D[A]instanceof Date?"D":"C";break;default:R="C"}P=Math.max(P,String(D[A]).length),S=S&&S!=R?"C":R}P>250&&(P=250),R=((E[y]||{}).DBF||{}).type,R=="C"&&E[y].DBF.len>P&&(P=E[y].DBF.len),S=="B"&&R=="N"&&(S="N",X[y]=E[y].DBF.dec,P=E[y].DBF.len),Q[y]=S=="C"||R=="N"?P:s[S]||0,k+=Q[y],V[y]=S}var F=p.next(32);for(F.write_shift(4,318902576),F.write_shift(4,x.length),F.write_shift(2,296+32*C),F.write_shift(2,k),y=0;y<4;++y)F.write_shift(4,0);for(F.write_shift(4,0|(+t[nT]||3)<<8),y=0,A=0;y<_.length;++y)if(_[y]!=null){var b=p.next(32),M=(_[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,M,"sbcs"),b.write_shift(1,V[y]=="?"?"C":V[y],"sbcs"),b.write_shift(4,A),b.write_shift(1,Q[y]||s[V[y]]||0),b.write_shift(1,X[y]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),A+=Q[y]||s[V[y]]||0}var Pe=p.next(264);for(Pe.write_shift(4,13),y=0;y<65;++y)Pe.write_shift(4,0);for(y=0;y<x.length;++y){var ke=p.next(k);for(ke.write_shift(1,0),A=0;A<_.length;++A)if(_[A]!=null)switch(V[A]){case"L":ke.write_shift(1,x[y][A]==null?63:x[y][A]?84:70);break;case"B":ke.write_shift(8,x[y][A]||0,"f");break;case"N":var Ne="0";for(typeof x[y][A]=="number"&&(Ne=x[y][A].toFixed(X[A]||0)),C=0;C<Q[A]-Ne.length;++C)ke.write_shift(1,32);ke.write_shift(1,Ne,"sbcs");break;case"D":x[y][A]?(ke.write_shift(4,("0000"+x[y][A].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(x[y][A].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+x[y][A].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var Oe=String(x[y][A]!=null?x[y][A]:"").slice(0,Q[A]);for(ke.write_shift(1,Oe,"sbcs"),C=0;C<Q[A]-Oe.length;++C)ke.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),$N=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+qi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,x){var E=e[x];return typeof E=="number"?yv(E):E},n=function(_,x,E){var y=x.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return y==59?_:yv(y)};e["|"]=254;function i(_,x){switch(x.type){case"base64":return s($n(_),x);case"binary":return s(_,x);case"buffer":return s(pt&&Buffer.isBuffer(_)?_.toString("binary"):ao(_),x);case"array":return s(Ya(_),x)}throw new Error("Unrecognized type "+x.type)}function s(_,x){var E=_.split(/[\n\r]+/),y=-1,A=-1,C=0,k=0,w=[],V=[],Q=null,X={},S=[],R=[],P=[],D=0,F;for(+x.codepage>=0&&ki(+x.codepage);C!==E.length;++C){D=0;var b=E[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),M=b.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),Pe=M[0],ke;if(b.length>0)switch(Pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&V.push(b.slice(3).replace(/;;/g,";"));break;case"C":var Ne=!1,Oe=!1,ue=!1,te=!1,de=-1,Ae=-1;for(k=1;k<M.length;++k)switch(M[k].charAt(0)){case"A":break;case"X":A=parseInt(M[k].slice(1))-1,Oe=!0;break;case"Y":for(y=parseInt(M[k].slice(1))-1,Oe||(A=0),F=w.length;F<=y;++F)w[F]=[];break;case"K":ke=M[k].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(Oi(ke))?isNaN(yl(ke).getDate())||(ke=Lr(ke)):(ke=Oi(ke),Q!==null&&Ll(Q)&&(ke=N0(ke))),Ne=!0;break;case"E":te=!0;var j=ll(M[k].slice(1),{r:y,c:A});w[y][A]=[w[y][A],j];break;case"S":ue=!0,w[y][A]=[w[y][A],"S5S"];break;case"G":break;case"R":de=parseInt(M[k].slice(1))-1;break;case"C":Ae=parseInt(M[k].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+b)}if(Ne&&(w[y][A]&&w[y][A].length==2?w[y][A][0]=ke:w[y][A]=ke,Q=null),ue){if(te)throw new Error("SYLK shared formula cannot have own formula");var H=de>-1&&w[de][Ae];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");w[y][A][1]=pw(H[1],{r:y-de,c:A-Ae})}break;case"F":var J=0;for(k=1;k<M.length;++k)switch(M[k].charAt(0)){case"X":A=parseInt(M[k].slice(1))-1,++J;break;case"Y":for(y=parseInt(M[k].slice(1))-1,F=w.length;F<=y;++F)w[F]=[];break;case"M":D=parseInt(M[k].slice(1))/20;break;case"F":break;case"G":break;case"P":Q=V[parseInt(M[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=M[k].slice(1).split(" "),F=parseInt(P[0],10);F<=parseInt(P[1],10);++F)D=parseInt(P[2],10),R[F-1]=D===0?{hidden:!0}:{wch:D},El(R[F-1]);break;case"C":A=parseInt(M[k].slice(1))-1,R[A]||(R[A]={});break;case"R":y=parseInt(M[k].slice(1))-1,S[y]||(S[y]={}),D>0?(S[y].hpt=D,S[y].hpx=wu(D)):D===0&&(S[y].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+b)}J<1&&(Q=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+b)}}return S.length>0&&(X["!rows"]=S),R.length>0&&(X["!cols"]=R),x&&x.sheetRows&&(w=w.slice(0,x.sheetRows)),[w,X]}function o(_,x){var E=i(_,x),y=E[0],A=E[1],C=Fl(y,x);return qi(A).forEach(function(k){C[k]=A[k]}),C}function l(_,x){return Aa(o(_,x),x)}function u(_,x,E,y){var A="C;Y"+(E+1)+";X"+(y+1)+";K";switch(_.t){case"n":A+=_.v||0,_.f&&!_.F&&(A+=";E"+OO(_.f,{r:E,c:y}));break;case"b":A+=_.v?"TRUE":"FALSE";break;case"e":A+=_.w||_.v;break;case"d":A+='"'+(_.w||_.v)+'"';break;case"s":A+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function h(_,x){x.forEach(function(E,y){var A="F;W"+(y+1)+" "+(y+1)+" ";E.hidden?A+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Zh(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=Kh(E.wpx)),typeof E.wch=="number"&&(A+=Math.round(E.wch))),A.charAt(A.length-1)!=" "&&_.push(A)})}function p(_,x){x.forEach(function(E,y){var A="F;";E.hidden?A+="M0;":E.hpt?A+="M"+20*E.hpt+";":E.hpx&&(A+="M"+20*fw(E.hpx)+";"),A.length>2&&_.push(A+"R"+(y+1))})}function m(_,x){var E=["ID;PWXL;N;E"],y=[],A=nr(_["!ref"]),C,k=Array.isArray(_),w=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),_["!cols"]&&h(E,_["!cols"]),_["!rows"]&&p(E,_["!rows"]),E.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var V=A.s.r;V<=A.e.r;++V)for(var Q=A.s.c;Q<=A.e.c;++Q){var X=tt({r:V,c:Q});C=k?(_[V]||[])[Q]:_[X],!(!C||C.v==null&&(!C.f||C.F))&&y.push(u(C,_,V,Q))}return E.join(w)+w+y.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:m}}(),ZN=function(){function e(s,o){switch(o.type){case"base64":return t($n(s),o);case"binary":return t(s,o);case"buffer":return t(pt&&Buffer.isBuffer(s)?s.toString("binary"):ao(s),o);case"array":return t(Ya(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),u=-1,h=-1,p=0,m=[];p!==l.length;++p){if(l[p].trim()==="BOT"){m[++u]=[],h=0;continue}if(!(u<0)){var _=l[p].trim().split(","),x=_[0],E=_[1];++p;for(var y=l[p]||"";(y.match(/["]/g)||[]).length&1&&p<l.length-1;)y+=`
`+l[++p];switch(y=y.trim(),+x){case-1:if(y==="BOT"){m[++u]=[],h=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?m[u][h]=!0:y==="FALSE"?m[u][h]=!1:isNaN(Oi(E))?isNaN(yl(E).getDate())?m[u][h]=E:m[u][h]=Lr(E):m[u][h]=Oi(E),++h;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),m[u][h++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(s,o){return Fl(e(s,o),o)}function n(s,o){return Aa(r(s,o),o)}var i=function(){var s=function(u,h,p,m,_){u.push(h),u.push(p+","+m),u.push('"'+_.replace(/"/g,'""')+'"')},o=function(u,h,p,m){u.push(h+","+p),u.push(h==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var h=[],p=nr(u["!ref"]),m,_=Array.isArray(u);s(h,"TABLE",0,1,"sheetjs"),s(h,"VECTORS",0,p.e.r-p.s.r+1,""),s(h,"TUPLES",0,p.e.c-p.s.c+1,""),s(h,"DATA",0,0,"");for(var x=p.s.r;x<=p.e.r;++x){o(h,-1,0,"BOT");for(var E=p.s.c;E<=p.e.c;++E){var y=tt({r:x,c:E});if(m=_?(u[x]||[])[E]:u[y],!m){o(h,1,0,"");continue}switch(m.t){case"n":var A=m.w;!A&&m.v!=null&&(A=m.v),A==null?m.f&&!m.F?o(h,1,0,"="+m.f):o(h,1,0,""):o(h,0,A,"V");break;case"b":o(h,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=di(m.z||at[14],gn(Lr(m.v)))),o(h,0,m.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var C=`\r
`,k=h.join(C);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),KN=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,_){for(var x=m.split(`
`),E=-1,y=-1,A=0,C=[];A!==x.length;++A){var k=x[A].trim().split(":");if(k[0]==="cell"){var w=dn(k[1]);if(C.length<=w.r)for(E=C.length;E<=w.r;++E)C[E]||(C[E]=[]);switch(E=w.r,y=w.c,k[2]){case"t":C[E][y]=e(k[3]);break;case"v":C[E][y]=+k[3];break;case"vtf":var V=k[k.length-1];case"vtc":switch(k[3]){case"nl":C[E][y]=!!+k[4];break;default:C[E][y]=+k[4];break}k[2]=="vtf"&&(C[E][y]=[C[E][y],V])}}}return _&&_.sheetRows&&(C=C.slice(0,_.sheetRows)),C}function n(m,_){return Fl(r(m,_),_)}function i(m,_){return Aa(n(m,_),_)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(m){if(!m||!m["!ref"])return"";for(var _=[],x=[],E,y="",A=Dl(m["!ref"]),C=Array.isArray(m),k=A.s.r;k<=A.e.r;++k)for(var w=A.s.c;w<=A.e.c;++w)if(y=tt({r:k,c:w}),E=C?(m[k]||[])[w]:m[y],!(!E||E.v==null||E.t==="z")){switch(x=["cell",y,"t"],E.t){case"s":case"str":x.push(t(E.v));break;case"n":E.f?(x[2]="vtf",x[3]="n",x[4]=E.v,x[5]=t(E.f)):(x[2]="v",x[3]=E.v);break;case"b":x[2]="vt"+(E.f?"f":"c"),x[3]="nl",x[4]=E.v?"1":"0",x[5]=t(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var V=gn(Lr(E.v));x[2]="vtc",x[3]="nd",x[4]=""+V,x[5]=E.w||di(E.z||at[14],V);break;case"e":continue}_.push(x.join(":"))}return _.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function p(m){return[s,o,l,o,h(m),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:p}}(),Eu=function(){function e(p,m,_,x,E){E.raw?m[_][x]=p:p===""||(p==="TRUE"?m[_][x]=!0:p==="FALSE"?m[_][x]=!1:isNaN(Oi(p))?isNaN(yl(p).getDate())?m[_][x]=p:m[_][x]=Lr(p):m[_][x]=Oi(p))}function t(p,m){var _=m||{},x=[];if(!p||p.length===0)return x;for(var E=p.split(/[\r\n]/),y=E.length-1;y>=0&&E[y].length===0;)--y;for(var A=10,C=0,k=0;k<=y;++k)C=E[k].indexOf(" "),C==-1?C=E[k].length:C++,A=Math.max(A,C);for(k=0;k<=y;++k){x[k]=[];var w=0;for(e(E[k].slice(0,A).trim(),x,k,w,_),w=1;w<=(E[k].length-A)/10+1;++w)e(E[k].slice(A+(w-1)*10,A+w*10).trim(),x,k,w,_)}return _.sheetRows&&(x=x.slice(0,_.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(p){for(var m={},_=!1,x=0,E=0;x<p.length;++x)(E=p.charCodeAt(x))==34?_=!_:!_&&E in r&&(m[E]=(m[E]||0)+1);E=[];for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&E.push([m[x],x]);if(!E.length){m=n;for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&E.push([m[x],x])}return E.sort(function(y,A){return y[0]-A[0]||n[y[1]]-n[A[1]]}),r[E.pop()[1]]||44}function s(p,m){var _=m||{},x="",E=_.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(x=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(x=p.charAt(4),p=p.slice(6)):x=i(p.slice(0,1024)):_&&_.FS?x=_.FS:x=i(p.slice(0,1024));var A=0,C=0,k=0,w=0,V=0,Q=x.charCodeAt(0),X=!1,S=0,R=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var P=_.dateNF!=null?s4(_.dateNF):null;function D(){var F=p.slice(w,V),b={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)b.t="z";else if(_.raw)b.t="s",b.v=F;else if(F.trim().length===0)b.t="s",b.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(b.t="s",b.v=F.slice(2,-1).replace(/""/g,'"')):DO(F)?(b.t="n",b.f=F.slice(1)):(b.t="s",b.v=F);else if(F=="TRUE")b.t="b",b.v=!0;else if(F=="FALSE")b.t="b",b.v=!1;else if(!isNaN(k=Oi(F)))b.t="n",_.cellText!==!1&&(b.w=F),b.v=k;else if(!isNaN(yl(F).getDate())||P&&F.match(P)){b.z=_.dateNF||at[14];var M=0;P&&F.match(P)&&(F=a4(F,_.dateNF,F.match(P)||[]),M=1),_.cellDates?(b.t="d",b.v=Lr(F,M)):(b.t="n",b.v=gn(Lr(F,M))),_.cellText!==!1&&(b.w=di(b.z,b.v instanceof Date?gn(b.v):b.v)),_.cellNF||delete b.z}else b.t="s",b.v=F;if(b.t=="z"||(_.dense?(E[A]||(E[A]=[]),E[A][C]=b):E[tt({c:C,r:A})]=b),w=V+1,R=p.charCodeAt(w),y.e.c<C&&(y.e.c=C),y.e.r<A&&(y.e.r=A),S==Q)++C;else if(C=0,++A,_.sheetRows&&_.sheetRows<=A)return!0}e:for(;V<p.length;++V)switch(S=p.charCodeAt(V)){case 34:R===34&&(X=!X);break;case Q:case 10:case 13:if(!X&&D())break e;break}return V-w>0&&D(),E["!ref"]=xt(y),E}function o(p,m){return!(m&&m.PRN)||m.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?s(p,m):Fl(t(p,m),m)}function l(p,m){var _="",x=m.type=="string"?[0,0,0,0]:Yg(p,m);switch(m.type){case"base64":_=$n(p);break;case"binary":_=p;break;case"buffer":m.codepage==65001?_=p.toString("utf8"):m.codepage&&typeof _u<"u"||(_=pt&&Buffer.isBuffer(p)?p.toString("binary"):ao(p));break;case"array":_=Ya(p);break;case"string":_=p;break;default:throw new Error("Unrecognized type "+m.type)}return x[0]==239&&x[1]==187&&x[2]==191?_=Ut(_.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?_=Ut(_):m.type=="binary"&&typeof _u<"u",_.slice(0,19)=="socialcalc:version:"?KN.to_sheet(m.type=="string"?_:Ut(_),m):o(_,m)}function u(p,m){return Aa(l(p,m),m)}function h(p){for(var m=[],_=nr(p["!ref"]),x,E=Array.isArray(p),y=_.s.r;y<=_.e.r;++y){for(var A=[],C=_.s.c;C<=_.e.c;++C){var k=tt({r:y,c:C});if(x=E?(p[y]||[])[C]:p[k],!x||x.v==null){A.push("          ");continue}for(var w=(x.w||(Ss(x),x.w)||"").slice(0,10);w.length<10;)w+=" ";A.push(w+(C===0?" ":""))}m.push(A.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:h}}();function XN(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=$N.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Eu.to_workbook(e,t)}}var Hc=function(){function e(j,H,J){if(j){Mr(j,j.l||0);for(var q=J.Enum||de;j.l<j.length;){var re=j.read_shift(2),ge=q[re]||q[65535],ye=j.read_shift(2),Se=j.l+ye,ve=ge.f&&ge.f(j,ye,J);if(j.l=Se,H(ve,ge,re))return}}}function t(j,H){switch(H.type){case"base64":return r(Ci($n(j)),H);case"binary":return r(Ci(j),H);case"buffer":case"array":return r(j,H)}throw"Unsupported type "+H.type}function r(j,H){if(!j)return j;var J=H||{},q=J.dense?[]:{},re="Sheet1",ge="",ye=0,Se={},ve=[],Ye=[],Y={s:{r:0,c:0},e:{r:0,c:0}},yt=J.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)J.Enum=de,e(j,function(fe,be,Xe){switch(Xe){case 0:J.vers=fe,fe>=4096&&(J.qpro=!0);break;case 6:Y=fe;break;case 204:fe&&(ge=fe);break;case 222:ge=fe;break;case 15:case 51:J.qpro||(fe[1].v=fe[1].v.slice(1));case 13:case 14:case 16:Xe==14&&(fe[2]&112)==112&&(fe[2]&15)>1&&(fe[2]&15)<15&&(fe[1].z=J.dateNF||at[14],J.cellDates&&(fe[1].t="d",fe[1].v=N0(fe[1].v))),J.qpro&&fe[3]>ye&&(q["!ref"]=xt(Y),Se[re]=q,ve.push(re),q=J.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ye=fe[3],re=ge||"Sheet"+(ye+1),ge="");var qe=J.dense?(q[fe[0].r]||[])[fe[0].c]:q[tt(fe[0])];if(qe){qe.t=fe[1].t,qe.v=fe[1].v,fe[1].z!=null&&(qe.z=fe[1].z),fe[1].f!=null&&(qe.f=fe[1].f);break}J.dense?(q[fe[0].r]||(q[fe[0].r]=[]),q[fe[0].r][fe[0].c]=fe[1]):q[tt(fe[0])]=fe[1];break}},J);else if(j[2]==26||j[2]==14)J.Enum=Ae,j[2]==14&&(J.qpro=!0,j.l=0),e(j,function(fe,be,Xe){switch(Xe){case 204:re=fe;break;case 22:fe[1].v=fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>ye&&(q["!ref"]=xt(Y),Se[re]=q,ve.push(re),q=J.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},ye=fe[3],re="Sheet"+(ye+1)),yt>0&&fe[0].r>=yt)break;J.dense?(q[fe[0].r]||(q[fe[0].r]=[]),q[fe[0].r][fe[0].c]=fe[1]):q[tt(fe[0])]=fe[1],Y.e.c<fe[0].c&&(Y.e.c=fe[0].c),Y.e.r<fe[0].r&&(Y.e.r=fe[0].r);break;case 27:fe[14e3]&&(Ye[fe[14e3][0]]=fe[14e3][1]);break;case 1537:Ye[fe[0]]=fe[1],fe[0]==ye&&(re=fe[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(q["!ref"]=xt(Y),Se[ge||re]=q,ve.push(ge||re),!Ye.length)return{SheetNames:ve,Sheets:Se};for(var He={},ot=[],ne=0;ne<Ye.length;++ne)Se[ve[ne]]?(ot.push(Ye[ne]||ve[ne]),He[Ye[ne]]=Se[Ye[ne]]||Se[ve[ne]]):(ot.push(Ye[ne]),He[Ye[ne]]={"!ref":"A1"});return{SheetNames:ot,Sheets:He}}function n(j,H){var J=H||{};if(+J.codepage>=0&&ki(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Yp(),re=nr(j["!ref"]),ge=Array.isArray(j),ye=[];wi(q,0,s(1030)),wi(q,6,u(re));for(var Se=Math.min(re.e.r,8191),ve=re.s.r;ve<=Se;++ve)for(var Ye=zr(ve),Y=re.s.c;Y<=re.e.c;++Y){ve===re.s.r&&(ye[Y]=Tr(Y));var yt=ye[Y]+Ye,He=ge?(j[ve]||[])[Y]:j[yt];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?wi(q,13,x(ve,Y,He.v)):wi(q,14,y(ve,Y,He.v));else{var ot=Ss(He);wi(q,15,m(ve,Y,ot.slice(0,239)))}}return wi(q,1),q.end()}function i(j,H){var J=H||{};if(+J.codepage>=0&&ki(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Yp();wi(q,0,o(j));for(var re=0,ge=0;re<j.SheetNames.length;++re)(j.Sheets[j.SheetNames[re]]||{})["!ref"]&&wi(q,27,te(j.SheetNames[re],ge++));var ye=0;for(re=0;re<j.SheetNames.length;++re){var Se=j.Sheets[j.SheetNames[re]];if(!(!Se||!Se["!ref"])){for(var ve=nr(Se["!ref"]),Ye=Array.isArray(Se),Y=[],yt=Math.min(ve.e.r,8191),He=ve.s.r;He<=yt;++He)for(var ot=zr(He),ne=ve.s.c;ne<=ve.e.c;++ne){He===ve.s.r&&(Y[ne]=Tr(ne));var fe=Y[ne]+ot,be=Ye?(Se[He]||[])[ne]:Se[fe];if(!(!be||be.t=="z"))if(be.t=="n")wi(q,23,D(He,ne,ye,be.v));else{var Xe=Ss(be);wi(q,22,S(He,ne,ye,Xe.slice(0,239)))}}++ye}}return wi(q,1),q.end()}function s(j){var H=vr(2);return H.write_shift(2,j),H}function o(j){var H=vr(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var J=0,q=0,re=0,ge=0;ge<j.SheetNames.length;++ge){var ye=j.SheetNames[ge],Se=j.Sheets[ye];if(!(!Se||!Se["!ref"])){++re;var ve=Dl(Se["!ref"]);J<ve.e.r&&(J=ve.e.r),q<ve.e.c&&(q=ve.e.c)}}return J>8191&&(J=8191),H.write_shift(2,J),H.write_shift(1,re),H.write_shift(1,q),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function l(j,H,J){var q={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&J.qpro?(q.s.c=j.read_shift(1),j.l++,q.s.r=j.read_shift(2),q.e.c=j.read_shift(1),j.l++,q.e.r=j.read_shift(2),q):(q.s.c=j.read_shift(2),q.s.r=j.read_shift(2),H==12&&J.qpro&&(j.l+=2),q.e.c=j.read_shift(2),q.e.r=j.read_shift(2),H==12&&J.qpro&&(j.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function u(j){var H=vr(8);return H.write_shift(2,j.s.c),H.write_shift(2,j.s.r),H.write_shift(2,j.e.c),H.write_shift(2,j.e.r),H}function h(j,H,J){var q=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(q[0].c=j.read_shift(1),q[3]=j.read_shift(1),q[0].r=j.read_shift(2),j.l+=2):(q[2]=j.read_shift(1),q[0].c=j.read_shift(2),q[0].r=j.read_shift(2)),q}function p(j,H,J){var q=j.l+H,re=h(j,H,J);if(re[1].t="s",J.vers==20768){j.l++;var ge=j.read_shift(1);return re[1].v=j.read_shift(ge,"utf8"),re}return J.qpro&&j.l++,re[1].v=j.read_shift(q-j.l,"cstr"),re}function m(j,H,J){var q=vr(7+J.length);q.write_shift(1,255),q.write_shift(2,H),q.write_shift(2,j),q.write_shift(1,39);for(var re=0;re<q.length;++re){var ge=J.charCodeAt(re);q.write_shift(1,ge>=128?95:ge)}return q.write_shift(1,0),q}function _(j,H,J){var q=h(j,H,J);return q[1].v=j.read_shift(2,"i"),q}function x(j,H,J){var q=vr(7);return q.write_shift(1,255),q.write_shift(2,H),q.write_shift(2,j),q.write_shift(2,J,"i"),q}function E(j,H,J){var q=h(j,H,J);return q[1].v=j.read_shift(8,"f"),q}function y(j,H,J){var q=vr(13);return q.write_shift(1,255),q.write_shift(2,H),q.write_shift(2,j),q.write_shift(8,J,"f"),q}function A(j,H,J){var q=j.l+H,re=h(j,H,J);if(re[1].v=j.read_shift(8,"f"),J.qpro)j.l=q;else{var ge=j.read_shift(2);V(j.slice(j.l,j.l+ge),re),j.l+=ge}return re}function C(j,H,J){var q=H&32768;return H&=-32769,H=(q?j:0)+(H>=8192?H-16384:H),(q?"":"$")+(J?Tr(H):zr(H))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function V(j,H){Mr(j,0);for(var J=[],q=0,re="",ge="",ye="",Se="";j.l<j.length;){var ve=j[j.l++];switch(ve){case 0:J.push(j.read_shift(8,"f"));break;case 1:ge=C(H[0].c,j.read_shift(2),!0),re=C(H[0].r,j.read_shift(2),!1),J.push(ge+re);break;case 2:{var Ye=C(H[0].c,j.read_shift(2),!0),Y=C(H[0].r,j.read_shift(2),!1);ge=C(H[0].c,j.read_shift(2),!0),re=C(H[0].r,j.read_shift(2),!1),J.push(Ye+Y+":"+ge+re)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(j.read_shift(2));break;case 6:{for(var yt="";ve=j[j.l++];)yt+=String.fromCharCode(ve);J.push('"'+yt.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:Se=J.pop(),ye=J.pop(),J.push(["AND","OR"][ve-20]+"("+ye+","+Se+")");break;default:if(ve<32&&w[ve])Se=J.pop(),ye=J.pop(),J.push(ye+w[ve]+Se);else if(k[ve]){if(q=k[ve][1],q==69&&(q=j[j.l++]),q>J.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+J.join("|")+"|");return}var He=J.slice(-q);J.length-=q,J.push(k[ve][0]+"("+He.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}J.length==1?H[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function Q(j){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=j.read_shift(2),H[3]=j[j.l++],H[0].c=j[j.l++],H}function X(j,H){var J=Q(j);return J[1].t="s",J[1].v=j.read_shift(H-4,"cstr"),J}function S(j,H,J,q){var re=vr(6+q.length);re.write_shift(2,j),re.write_shift(1,J),re.write_shift(1,H),re.write_shift(1,39);for(var ge=0;ge<q.length;++ge){var ye=q.charCodeAt(ge);re.write_shift(1,ye>=128?95:ye)}return re.write_shift(1,0),re}function R(j,H){var J=Q(j);J[1].v=j.read_shift(2);var q=J[1].v>>1;if(J[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return J[1].v=q,J}function P(j,H){var J=Q(j),q=j.read_shift(4),re=j.read_shift(4),ge=j.read_shift(2);if(ge==65535)return q===0&&re===3221225472?(J[1].t="e",J[1].v=15):q===0&&re===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var ye=ge&32768;return ge=(ge&32767)-16446,J[1].v=(1-ye*2)*(re*Math.pow(2,ge+32)+q*Math.pow(2,ge)),J}function D(j,H,J,q){var re=vr(14);if(re.write_shift(2,j),re.write_shift(1,J),re.write_shift(1,H),q==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var ge=0,ye=0,Se=0,ve=0;return q<0&&(ge=1,q=-q),ye=Math.log2(q)|0,q/=Math.pow(2,ye-31),ve=q>>>0,ve&2147483648||(q/=2,++ye,ve=q>>>0),q-=ve,ve|=2147483648,ve>>>=0,q*=Math.pow(2,32),Se=q>>>0,re.write_shift(4,Se),re.write_shift(4,ve),ye+=16383+(ge?32768:0),re.write_shift(2,ye),re}function F(j,H){var J=P(j);return j.l+=H-14,J}function b(j,H){var J=Q(j),q=j.read_shift(4);return J[1].v=q>>6,J}function M(j,H){var J=Q(j),q=j.read_shift(8,"f");return J[1].v=q,J}function Pe(j,H){var J=M(j);return j.l+=H-10,J}function ke(j,H){return j[j.l+H-1]==0?j.read_shift(H,"cstr"):""}function Ne(j,H){var J=j[j.l++];J>H-1&&(J=H-1);for(var q="";q.length<J;)q+=String.fromCharCode(j[j.l++]);return q}function Oe(j,H,J){if(!(!J.qpro||H<21)){var q=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var re=j.read_shift(H-21,"cstr");return[q,re]}}function ue(j,H){for(var J={},q=j.l+H;j.l<q;){var re=j.read_shift(2);if(re==14e3){for(J[re]=[0,""],J[re][0]=j.read_shift(2);j[j.l];)J[re][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return J}function te(j,H){var J=vr(5+j.length);J.write_shift(2,14e3),J.write_shift(2,H);for(var q=0;q<j.length;++q){var re=j.charCodeAt(q);J[J.l++]=re>127?95:re}return J[J.l++]=0,J}var de={0:{n:"BOF",f:mr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:Ne},65535:{n:""}},Ae={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:X},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:Pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function qN(e){var t={},r=e.match(sn),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Ke(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Cg[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var YN=function(){var e=xu("t"),t=xu("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:wt(o[1])},u=s.match(t);return u&&(l.s=qN(u[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(l){return l.v})}}(),JN=function(){var t=/(\r\n|\n)/g;function r(i,s,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),QN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,e3=/<(?:\w+:)?r>/,t3=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Wg(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=wt(Ut(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ut(e),r&&(n.h=Dg(n.t))):e.match(e3)&&(n.r=Ut(e),n.t=wt(Ut((e.replace(t3,"").match(QN)||[]).join("").replace(sn,""))),r&&(n.h=JN(YN(n.r)))),n):{t:""}}var r3=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,n3=/<(?:\w+:)?(?:si|sstItem)>/g,i3=/<\/(?:\w+:)?(?:si|sstItem)>/;function s3(e,t){var r=[],n="";if(!e)return r;var i=e.match(r3);if(i){n=i[2].replace(n3,"").split(i3);for(var s=0;s!=n.length;++s){var o=Wg(n[s].trim(),t);o!=null&&(r[r.length]=o)}i=Ke(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function a3(e){return[e.read_shift(4),e.read_shift(4)]}function o3(e,t){var r=[],n=!1;return Ns(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function sw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function xs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function l3(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=xs(e,4),t.U=xs(e,4),t.W=xs(e,4),t}function c3(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function u3(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(c3(e));return t}function f3(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function h3(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=xs(e,4),t.U=xs(e,4),t.W=xs(e,4),t}function d3(e){var t=h3(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function aw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function ow(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function p3(e){var t=xs(e);switch(t.Minor){case 2:return[t.Minor,m3(e)];case 3:return[t.Minor,g3()];case 4:return[t.Minor,_3(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function m3(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=aw(e,r),i=ow(e,e.length-e.l);return{t:"Std",h:n,v:i}}function g3(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _3(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(sn,function(s){var o=Ke(s);switch(Qi(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function v3(e,t){var r={},n=r.EncryptionVersionInfo=xs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=aw(e,i),t-=i,r.EncryptionVerifier=ow(e,t),r}function x3(e){var t={},r=t.EncryptionVersionInfo=xs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function y3(e){var t=0,r,n=sw(e),i=n.length+1,s,o,l,u,h;for(r=ma(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],l=t&16384?1:0,u=t<<1&32767,h=l|u,t=h^o;return t^52811}var lw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],u=104,h=o.length-1;h>=0;--h)for(var p=o[h],m=0;m!=7;++m)p&64&&(l^=r[u]),p*=2,--u;return l};return function(o){for(var l=sw(o),u=s(l),h=l.length,p=ma(16),m=0;m!=16;++m)p[m]=0;var _,x,E;for((h&1)===1&&(_=u>>8,p[h]=i(e[0],_),--h,_=u&255,x=l[l.length-1],p[h]=i(x,_));h>0;)--h,_=u>>8,p[h]=i(l[h],_),--h,_=u&255,p[h]=i(l[h],_);for(h=15,E=15-l.length;E>0;)_=u>>8,p[h]=i(e[E],_),--h,--E,_=u&255,p[h]=i(l[h],_),--h,--E;return p}}(),E3=function(e,t,r,n,i){i||(i=t),n||(n=lw(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},T3=function(e){var t=0,r=lw(e);return function(n){var i=E3("",n,t,r);return t=i[1],i[0]}};function w3(e,t,r,n){var i={key:mr(e),verificationBytes:mr(e)};return r.password&&(i.verifier=y3(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=T3(r.password)),i}function A3(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=x3(e):n.Data=v3(e,t),n}function S3(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?A3(e,t-2,n):w3(e,r.biff>=8?t:t-2,r,n),n}var I3=function(){function e(i,s){switch(s.type){case"base64":return t($n(i),s);case"binary":return t(i,s);case"buffer":return t(pt&&Buffer.isBuffer(i)?i.toString("binary"):ao(i),s);case"array":return t(Ya(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},l=o.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(p,m){Array.isArray(l)&&(l[m]=[]);for(var _=/\\\w+\b/g,x=0,E,y=-1;E=_.exec(p);){switch(E[0]){case"\\cell":var A=p.slice(x,_.lastIndex-E[0].length);if(A[0]==" "&&(A=A.slice(1)),++y,A.length){var C={v:A,t:"s"};Array.isArray(l)?l[m][y]=C:l[tt({r:m,c:y})]=C}break}x=_.lastIndex}y>h.e.c&&(h.e.c=y)}),l["!ref"]=xt(h),l}function r(i,s){return Aa(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=nr(i["!ref"]),l,u=Array.isArray(i),h=o.s.r;h<=o.e.r;++h){s.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)s.push("\\cellx"+(p+1));for(s.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var m=tt({r:h,c:p});l=u?(i[h]||[])[p]:i[m],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(Ss(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function C3(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Tu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function k3(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(o===0)return[0,0,t];var l=0,u=0,h=i+s;switch(u=o/(h>1?2-h:h),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,u,h/2]}function R3(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],l=6*t,u;if(r!==0)switch(l|0){case 0:case 6:u=i*l,o[0]+=i,o[1]+=u;break;case 1:u=i*(2-l),o[0]+=u,o[1]+=i;break;case 2:u=i*(l-2),o[1]+=i,o[2]+=u;break;case 3:u=i*(4-l),o[1]+=u,o[2]+=i;break;case 4:u=i*(l-4),o[2]+=i,o[0]+=u;break;case 5:u=i*(6-l),o[2]+=u,o[0]+=i;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function $h(e,t){if(t===0)return e;var r=k3(C3(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Tu(R3(r))}var cw=6,P3=15,N3=1,hn=cw;function Zh(e){return Math.floor((e+Math.round(128/hn)/256)*hn)}function Kh(e){return Math.floor((e-5)/hn*100+.5)/100}function tm(e){return Math.round((e*hn+5)/hn*256)/256}function Fd(e){return tm(Kh(Zh(e)))}function Gg(e){var t=Math.abs(e-Fd(e)),r=hn;if(t>.005)for(hn=N3;hn<P3;++hn)Math.abs(e-Fd(e))<=t&&(t=Math.abs(e-Fd(e)),r=hn);hn=r}function El(e){e.width?(e.wpx=Zh(e.width),e.wch=Kh(e.wpx),e.MDW=hn):e.wpx?(e.wch=Kh(e.wpx),e.width=tm(e.wch),e.MDW=hn):typeof e.wch=="number"&&(e.width=tm(e.wch),e.wpx=Zh(e.width),e.MDW=hn),e.customWidth&&delete e.customWidth}var O3=96,uw=O3;function fw(e){return e*96/uw}function wu(e){return e*uw/96}var L3={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function D3(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(sn)||[]).forEach(function(o){var l=Ke(o);switch(Qi(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=Wt(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=Wt(l.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function F3(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(sn)||[]).forEach(function(o){var l=Ke(o);switch(Qi(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function b3(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(sn)||[]).forEach(function(o){var l=Ke(o);switch(Qi(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=Ut(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?Wt(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?Wt(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?Wt(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?Wt(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?Wt(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?Wt(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?Wt(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Cg[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=Wt(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var u=ja[i.color.index];i.color.index==81&&(u=ja[1]),u||(u=ja[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=$h(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function M3(e,t,r){t.NumberFmt=[];for(var n=qi(at),i=0;i<n.length;++i)t.NumberFmt[n[i]]=at[n[i]];var s=e[0].match(sn);if(s)for(i=0;i<s.length;++i){var o=Ke(s[i]);switch(Qi(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=wt(Ut(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=l}za(l,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Hf=["numFmtId","fillId","fontId","borderId","xfId"],Wf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function B3(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(sn)||[]).forEach(function(s){var o=Ke(s),l=0;switch(Qi(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Hf.length;++l)n[Hf[l]]&&(n[Hf[l]]=parseInt(n[Hf[l]],10));for(l=0;l<Wf.length;++l)n[Wf[l]]&&(n[Wf[l]]=Wt(n[Wf[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Wt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var U3=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,h){var p={};if(!l)return p;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&M3(m,p,h),(m=l.match(i))&&b3(m,p,u,h),(m=l.match(n))&&F3(m,p,u,h),(m=l.match(s))&&D3(m,p,u,h),(m=l.match(r))&&B3(m,p,h),p}}();function V3(e,t){var r=e.read_shift(2),n=tn(e);return[r,n]}function z3(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Y4(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=q4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=tn(e),n}var j3=nn;function H3(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var W3=nn;function G3(e,t,r){var n={};n.NumberFmt=[];for(var i in at)n.NumberFmt[i]=at[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return Ns(e,function(u,h,p){switch(p){case 44:n.NumberFmt[u[0]]=u[1],za(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=$h(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(p),o=!0;break;case 38:s.pop(),o=!1;break;default:if(h.T>0)s.push(p);else if(h.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}var $3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Z3(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(sn)||[]).forEach(function(i){var s=Ke(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[$3.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function K3(){}function X3(){}var q3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Y3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,J3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Q3(e,t,r){t.themeElements={};var n;[["clrScheme",q3,Z3],["fontScheme",Y3,K3],["fmtScheme",J3,X3]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var eO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function hw(e,t){(!e||e.length===0)&&(e=tO());var r,n={};if(!(r=e.match(eO)))throw new Error("themeElements not found in theme");return Q3(r[0],n,t),n.raw=e,n}function tO(e,t){var r=[wT];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rO(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=TT(s,{type:"array"})}catch{return}var l=Vn(o,"theme/theme/theme1.xml",!0);if(l)return hw(l,r)}}function nO(e){return e.read_shift(4)}function iO(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=sO(e,4);break;case 2:t.xclrValue=JT(e);break;case 3:t.xclrValue=nO(e);break;case 4:e.l+=4;break}return e.l+=8,t}function sO(e,t){return nn(e,t)}function aO(e,t){return nn(e,t)}function oO(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=iO(e);break;case 6:n[1]=aO(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function lO(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(oO(e,r-e.l));return{ixfe:n,ext:s}}function cO(e,t){t.forEach(function(r){switch(r[0]){}})}function uO(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:tn(e)}}function fO(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function hO(e){return e.l+=4,e.read_shift(4)!=0}function dO(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,l=2;return Ns(e,function(u,h,p){switch(p){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(m){l==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):l==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:s.push(p),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!h.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function pO(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,o;return e.replace(sn,function(l){var u=Ke(l);switch(Qi(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==u.name&&(o=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):s==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),n}function mO(e){var t=[];if(!e)return t;var r=1;return(e.match(sn)||[]).forEach(function(n){var i=Ke(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function gO(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=tt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function _O(e,t,r){var n=[];return Ns(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function vO(e,t,r,n){if(!e)return e;var i=n||{},s=!1;Ns(e,function(l,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function xO(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function sx(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(o){var l=dn(o.ref);if(i?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},i?e[l.r][l.c]=s:e[o.ref]=s;var u=nr(e["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var h=xt(u);h!==e["!ref"]&&(e["!ref"]=h)}s.c||(s.c=[]);var p={a:o.author,t:o.t,r:o.r,T:r};o.h&&(p.h=o.h);for(var m=s.c.length-1;m>=0;--m){if(!r&&s.c[m].T)return;r&&!s.c[m].T&&s.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(p.a==n[m].id){p.a=n[m].name||p.a;break}}s.c.push(p)})}function yO(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=Ke(l[0]),h={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},p=dn(u.ref);if(!(t.sheetRows&&t.sheetRows<=p.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!m&&!!m[1]&&Wg(m[1])||{r:"",t:"",h:""};h.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),h.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=_.h),n.push(h)}}}}),n}function EO(e,t){var r=[],n=!1,i={},s=0;return e.replace(sn,function(l,u){var h=Ke(l);switch(Qi(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=u+l.length;break;case"</text>":i.t=e.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return l}),r}function TO(e,t){var r=[],n=!1;return e.replace(sn,function(s){var o=Ke(s);switch(Qi(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function wO(e){var t={};t.iauthor=e.read_shift(4);var r=lo(e);return t.rfx=r.s,t.ref=tt(r.s),e.l+=16,t}var AO=tn;function SO(e,t){var r=[],n=[],i={},s=!1;return Ns(e,function(l,u,h){switch(h){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}var IO="application/vnd.ms-office.vbaProject";function CO(e){var t=vt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");vt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),vt.write(t)}function kO(){return{"!type":"dialog"}}function RO(){return{"!type":"dialog"}}function PO(){return{"!type":"macro"}}function NO(){return{"!type":"macro"}}var ll=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,o){var l=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var h=s.length>0?parseInt(s,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return l?p+=t.c:--p,u?h+=t.r:--h,i+(l?"":"$")+Tr(p)+(u?"":"$")+zr(h)}return function(i,s){return t=s,i.replace(e,r)}}(),dw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,OO=function(){return function(t,r){return t.replace(dw,function(n,i,s,o,l,u){var h=Bg(o)-(s?0:r.c),p=Mg(u)-(l?0:r.r),m=p==0?"":l?p+1:"["+p+"]",_=h==0?"":s?h+1:"["+h+"]";return i+"R"+m+"C"+_})}}();function pw(e,t){return e.replace(dw,function(r,n,i,s,o,l){return n+(i=="$"?i+s:Tr(Bg(s)+t.c))+(o=="$"?o+l:zr(Mg(l)+t.r))})}function LO(e,t,r){var n=Dl(t),i=n.s,s=dn(r),o={r:s.r-i.r,c:s.c-i.c};return pw(e,o)}function DO(e){return e.length!=1}function ax(e){return e.replace(/_xlfn\./g,"")}function hr(e){e.l+=1}function ga(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function mw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return gw(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=ga(e),l=ga(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function gw(e){var t=ga(e),r=ga(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function FO(e,t,r){if(r.biff<8)return gw(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=ga(e),o=ga(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function _w(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return bO(e);var n=e.read_shift(r&&r.biff==12?4:2),i=ga(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function bO(e){var t=ga(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function MO(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function BO(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return UO(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:l}}function UO(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function VO(e,t,r){var n=(e[e.l++]&96)>>5,i=mw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function zO(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=mw(e,s,r);return[n,i,o]}function jO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function HO(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function WO(e,t,r){var n=(e[e.l++]&96)>>5,i=FO(e,t-1,r);return[n,i]}function GO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ox(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function $O(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function ZO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function KO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function XO(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function qO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function vw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function YO(e){return e.read_shift(2),vw(e)}function JO(e){return e.read_shift(2),vw(e)}function QO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=_w(e,0,r);return[n,i]}function eL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=BO(e,0,r);return[n,i]}function tL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=_w(e,0,r);return[n,i,s]}function rL(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[nD[i],Ew[i],n]}function nL(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:iL(e);return[i,(s[0]===0?Ew:rD)[s[1]]]}function iL(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function sL(e,t,r){e.l+=r&&r.biff==2?3:4}function aL(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function oL(e){return e.l++,co[e.read_shift(1)]}function lL(e){return e.l++,e.read_shift(2)}function cL(e){return e.l++,e.read_shift(1)!==0}function uL(e){return e.l++,Qr(e)}function fL(e,t,r){return e.l++,zu(e,t-1,r)}function hL(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=ar(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=co[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Qr(e);break;case 2:r[1]=uo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function dL(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?lo:O0)(e));return i}function pL(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=i;++l)o[s][l]=hL(e,r.biff);return o}function mL(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function gL(e,t,r){if(r.biff==5)return _L(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function _L(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function vL(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function xL(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function yL(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function EL(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var TL=nn,wL=nn,AL=nn;function Hu(e,t,r){return e.l+=2,[MO(e)]}function $g(e){return e.l+=6,[]}var SL=Hu,IL=$g,CL=$g,kL=Hu;function xw(e){return e.l+=2,[mr(e),e.read_shift(2)&1]}var RL=Hu,PL=xw,NL=$g,OL=Hu,LL=Hu,DL=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function FL(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=DL[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:s}}function bL(e){return e.l+=2,[e.read_shift(4)]}function ML(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function BL(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function UL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function VL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function zL(e){return e.l+=4,[0,0]}var lx={1:{n:"PtgExp",f:aL},2:{n:"PtgTbl",f:AL},3:{n:"PtgAdd",f:hr},4:{n:"PtgSub",f:hr},5:{n:"PtgMul",f:hr},6:{n:"PtgDiv",f:hr},7:{n:"PtgPower",f:hr},8:{n:"PtgConcat",f:hr},9:{n:"PtgLt",f:hr},10:{n:"PtgLe",f:hr},11:{n:"PtgEq",f:hr},12:{n:"PtgGe",f:hr},13:{n:"PtgGt",f:hr},14:{n:"PtgNe",f:hr},15:{n:"PtgIsect",f:hr},16:{n:"PtgUnion",f:hr},17:{n:"PtgRange",f:hr},18:{n:"PtgUplus",f:hr},19:{n:"PtgUminus",f:hr},20:{n:"PtgPercent",f:hr},21:{n:"PtgParen",f:hr},22:{n:"PtgMissArg",f:hr},23:{n:"PtgStr",f:fL},26:{n:"PtgSheet",f:ML},27:{n:"PtgEndSheet",f:BL},28:{n:"PtgErr",f:oL},29:{n:"PtgBool",f:cL},30:{n:"PtgInt",f:lL},31:{n:"PtgNum",f:uL},32:{n:"PtgArray",f:GO},33:{n:"PtgFunc",f:rL},34:{n:"PtgFuncVar",f:nL},35:{n:"PtgName",f:mL},36:{n:"PtgRef",f:QO},37:{n:"PtgArea",f:VO},38:{n:"PtgMemArea",f:vL},39:{n:"PtgMemErr",f:TL},40:{n:"PtgMemNoMem",f:wL},41:{n:"PtgMemFunc",f:xL},42:{n:"PtgRefErr",f:yL},43:{n:"PtgAreaErr",f:jO},44:{n:"PtgRefN",f:eL},45:{n:"PtgAreaN",f:WO},46:{n:"PtgMemAreaN",f:UL},47:{n:"PtgMemNoMemN",f:VL},57:{n:"PtgNameX",f:gL},58:{n:"PtgRef3d",f:tL},59:{n:"PtgArea3d",f:zO},60:{n:"PtgRefErr3d",f:EL},61:{n:"PtgAreaErr3d",f:HO},255:{}},jL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},HL={1:{n:"PtgElfLel",f:xw},2:{n:"PtgElfRw",f:OL},3:{n:"PtgElfCol",f:SL},6:{n:"PtgElfRwV",f:LL},7:{n:"PtgElfColV",f:kL},10:{n:"PtgElfRadical",f:RL},11:{n:"PtgElfRadicalS",f:NL},13:{n:"PtgElfColS",f:IL},15:{n:"PtgElfColSV",f:CL},16:{n:"PtgElfRadicalLel",f:PL},25:{n:"PtgList",f:FL},29:{n:"PtgSxName",f:bL},255:{}},WL={0:{n:"PtgAttrNoop",f:zL},1:{n:"PtgAttrSemi",f:qO},2:{n:"PtgAttrIf",f:KO},4:{n:"PtgAttrChoose",f:$O},8:{n:"PtgAttrGoto",f:ZO},16:{n:"PtgAttrSum",f:sL},32:{n:"PtgAttrBaxcel",f:ox},33:{n:"PtgAttrBaxcel",f:ox},64:{n:"PtgAttrSpace",f:YO},65:{n:"PtgAttrSpaceSemi",f:JO},128:{n:"PtgAttrIfError",f:XO},255:{}};function Wu(e,t,r,n){if(n.biff<8)return nn(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=pL(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=dL(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&s.push(nn(e,t)),s}function Gu(e,t,r){for(var n=e.l+t,i,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],i=lx[s]||lx[jL[s]],(s===24||s===25)&&(i=(s===24?HL:WL)[e[e.l+1]]),!i||!i.f?nn(e,t):o.push([i.n,i.f(e,t,r)]);return o}function GL(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var $L={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ZL(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function yw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function cx(e,t,r){var n=yw(e,t,r);return n=="#REF"?n:ZL(n,r)}function qr(e,t,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},l=[],u,h,p,m=0,_=0,x,E="";if(!e[0]||!e[0][0])return"";for(var y=-1,A="",C=0,k=e[0].length;C<k;++C){var w=e[0][C];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),h=l.pop(),y>=0){switch(e[0][y][1][0]){case 0:A=rr(" ",e[0][y][1][1]);break;case 1:A=rr("\r",e[0][y][1][1]);break;default:if(A="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}h=h+A,y=-1}l.push(h+$L[w[0]]+u);break;case"PtgIsect":u=l.pop(),h=l.pop(),l.push(h+" "+u);break;case"PtgUnion":u=l.pop(),h=l.pop(),l.push(h+","+u);break;case"PtgRange":u=l.pop(),h=l.pop(),l.push(h+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Uc(w[1][1],o,i),l.push(Vc(p,s));break;case"PtgRefN":p=r?Uc(w[1][1],r,i):w[1][1],l.push(Vc(p,s));break;case"PtgRef3d":m=w[1][1],p=Uc(w[1][2],o,i),E=cx(n,m,i),l.push(E+"!"+Vc(p,s));break;case"PtgFunc":case"PtgFuncVar":var V=w[1][0],Q=w[1][1];V||(V=0),V&=127;var X=V==0?[]:l.slice(-V);l.length-=V,Q==="User"&&(Q=X.shift()),l.push(Q+"("+X.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":x=Hv(w[1][1],r?{s:r}:o,i),l.push(Ld(x,i));break;case"PtgArea":x=Hv(w[1][1],o,i),l.push(Ld(x,i));break;case"PtgArea3d":m=w[1][1],x=w[1][2],E=cx(n,m,i),l.push(E+"!"+Ld(x,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=w[1][2];var S=(n.names||[])[_-1]||(n[0]||[])[_],R=S?S.Name:"SH33TJSNAME"+String(_);R&&R.slice(0,6)=="_xlfn."&&!i.xlfn&&(R=R.slice(6)),l.push(R);break;case"PtgNameX":var P=w[1][1];_=w[1][2];var D;if(i.biff<=5)P<0&&(P=-P),n[P]&&(D=n[P][_]);else{var F="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][_]&&n[P][_].itab>0&&(F=n.SheetNames[n[P][_].itab-1]+"!"):F=n.SheetNames[_-1]+"!"),n[P]&&n[P][_])F+=n[P][_].Name;else if(n[0]&&n[0][_])F+=n[0][_].Name;else{var b=(yw(n,P,i)||"").split(";;");b[_-1]?F=b[_-1]:F+="SH33TJSERRX"}l.push(F);break}D||(D={Name:"SH33TJSERRY"}),l.push(D.Name);break;case"PtgParen":var M="(",Pe=")";if(y>=0){switch(A="",e[0][y][1][0]){case 2:M=rr(" ",e[0][y][1][1])+M;break;case 3:M=rr("\r",e[0][y][1][1])+M;break;case 4:Pe=rr(" ",e[0][y][1][1])+Pe;break;case 5:Pe=rr("\r",e[0][y][1][1])+Pe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}l.push(M+l.pop()+Pe);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":p={c:w[1][1],r:w[1][0]};var ke={c:r.c,r:r.r};if(n.sharedf[tt(p)]){var Ne=n.sharedf[tt(p)];l.push(qr(Ne,o,ke,n,i))}else{var Oe=!1;for(u=0;u!=n.arrayf.length;++u)if(h=n.arrayf[u],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){l.push(qr(h[1],o,ke,n,i)),Oe=!0;break}Oe||l.push(w[1])}break;case"PtgArray":l.push("{"+GL(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&ue.indexOf(e[0][C][0])==-1){w=e[0][y];var te=!0;switch(w[1][0]){case 4:te=!1;case 0:A=rr(" ",w[1][1]);break;case 5:te=!1;case 1:A=rr("\r",w[1][1]);break;default:if(A="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((te?A:"")+l.pop()+(te?"":A)),y=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function KL(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],nn(e,t-2)];var l=Gu(e,o,r);return t!==o+i&&(s=Wu(e,t-o-i,l,r)),e.l=n,[l,s]}function XL(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],nn(e,t-2)];var l=Gu(e,o,r);return t!==o+i&&(s=Wu(e,t-o-i,l,r)),e.l=n,[l,s]}function qL(e,t,r,n){var i=e.l+t,s=Gu(e,n,r),o;return i!==e.l&&(o=Wu(e,i-e.l,s,r)),[s,o]}function YL(e,t,r){var n=e.l+t,i,s=e.read_shift(2),o=Gu(e,s,r);return s==65535?[[],nn(e,t-2)]:(t!==s+2&&(i=Wu(e,n-s-2,o,r)),[o,i])}function JL(e){var t;if(gs(e,e.l+6)!==65535)return[Qr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function bd(e,t,r){var n=e.l+t,i=es(e);r.biff==2&&++e.l;var s=JL(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=XL(e,n-e.l,r);return{cell:i,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function L0(e,t,r){var n=e.read_shift(4),i=Gu(e,n,r),s=e.read_shift(4),o=s>0?Wu(e,s,i,r):null;return[i,o]}var QL=L0,D0=L0,eD=L0,tD=L0,rD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ew={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},nD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ux(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Md(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Wc={},cl={};function Gc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Tw(e,t,r,n,i,s){try{n.cellNF&&(e.z=at[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Lr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(at[t]==null&&za(i4[t]||"General",t),e.t==="e")e.w=e.w||co[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=vu(e.v);else if(e.t==="d"){var o=gn(e.v);(o|0)===o?e.w=o.toString(10):e.w=vu(o)}else{if(e.v===void 0)return"";e.w=qa(e.v,cl)}else e.t==="d"?e.w=di(t,gn(e.v),cl):e.w=di(t,e.v,cl)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=$h(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=$h(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function iD(e,t){var r=nr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=xt(r))}var sD=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,aD=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,oD=/<(?:\w:)?hyperlink [^>]*>/mg,lD=/"(\w*:\w*)"/,cD=/<(?:\w:)?col\b[^>]*[\/]?>/g,uD=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,fD=/<(?:\w:)?pageMargins[^>]*\/>/g,ww=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,hD=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,dD=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function pD(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",m=e.match(aD);m?(h=e.slice(0,m.index),p=e.slice(m.index+m[0].length)):h=p=e;var _=h.match(ww);_?Zg(_[0],l,i,r):(_=h.match(hD))&&mD(_[0],_[1]||"",l,i,r);var x=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var E=h.slice(x,x+50).match(lD);E&&iD(l,E[1])}var y=h.match(dD);y&&y[1]&&ED(y[1],i);var A=[];if(t.cellStyles){var C=h.match(cD);C&&vD(A,C)}m&&TD(m[1],l,t,u,s,o);var k=p.match(uD);k&&(l["!autofilter"]=xD(k[0]));var w=[],V=p.match(sD);if(V)for(x=0;x!=V.length;++x)w[x]=nr(V[x].slice(V[x].indexOf('"')+1));var Q=p.match(oD);Q&&gD(l,Q,n);var X=p.match(fD);if(X&&(l["!margins"]=_D(Ke(X[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=xt(u)),t.sheetRows>0&&l["!ref"]){var S=nr(l["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>u.e.r&&(S.e.r=u.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>u.e.c&&(S.e.c=u.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),l["!fullref"]=l["!ref"],l["!ref"]=xt(S))}return A.length>0&&(l["!cols"]=A),w.length>0&&(l["!merges"]=w),l}function Zg(e,t,r,n){var i=Ke(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=wt(Ut(i.codeName)))}function mD(e,t,r,n,i){Zg(e.slice(0,e.indexOf(">")),r,n,i)}function gD(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Ke(Ut(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+wt(s.location))):(s.Target="#"+wt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=nr(s.ref),u=l.s.r;u<=l.e.r;++u)for(var h=l.s.c;h<=l.e.c;++h){var p=tt({c:h,r:u});n?(e[u]||(e[u]=[]),e[u][h]||(e[u][h]={t:"z",v:void 0}),e[u][h].l=s):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=s)}}}function _D(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function vD(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Ke(t[n],!0);i.hidden&&(i.hidden=Wt(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Gg(i.width)),El(i);s<=o;)e[s++]=Vr(i)}}function xD(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var yD=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ED(e,t){t.Views||(t.Views=[{}]),(e.match(yD)||[]).forEach(function(r,n){var i=Ke(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Wt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var TD=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=xu("v"),o=xu("f");return function(u,h,p,m,_,x){for(var E=0,y="",A=[],C=[],k=0,w=0,V=0,Q="",X,S,R=0,P=0,D,F,b=0,M=0,Pe=Array.isArray(x.CellXf),ke,Ne=[],Oe=[],ue=Array.isArray(h),te=[],de={},Ae=!1,j=!!p.sheetStubs,H=u.split(t),J=0,q=H.length;J!=q;++J){y=H[J].trim();var re=y.length;if(re!==0){var ge=0;e:for(E=0;E<re;++E)switch(y[E]){case">":if(y[E-1]!="/"){++E;break e}if(p&&p.cellStyles){if(S=Ke(y.slice(ge,E),!0),R=S.r!=null?parseInt(S.r,10):R+1,P=-1,p.sheetRows&&p.sheetRows<R)continue;de={},Ae=!1,S.ht&&(Ae=!0,de.hpt=parseFloat(S.ht),de.hpx=wu(de.hpt)),S.hidden=="1"&&(Ae=!0,de.hidden=!0),S.outlineLevel!=null&&(Ae=!0,de.level=+S.outlineLevel),Ae&&(te[R-1]=de)}break;case"<":ge=E;break}if(ge>=E)break;if(S=Ke(y.slice(ge,E),!0),R=S.r!=null?parseInt(S.r,10):R+1,P=-1,!(p.sheetRows&&p.sheetRows<R)){m.s.r>R-1&&(m.s.r=R-1),m.e.r<R-1&&(m.e.r=R-1),p&&p.cellStyles&&(de={},Ae=!1,S.ht&&(Ae=!0,de.hpt=parseFloat(S.ht),de.hpx=wu(de.hpt)),S.hidden=="1"&&(Ae=!0,de.hidden=!0),S.outlineLevel!=null&&(Ae=!0,de.level=+S.outlineLevel),Ae&&(te[R-1]=de)),A=y.slice(E).split(e);for(var ye=0;ye!=A.length&&A[ye].trim().charAt(0)=="<";++ye);for(A=A.slice(ye),E=0;E!=A.length;++E)if(y=A[E].trim(),y.length!==0){if(C=y.match(r),k=E,w=0,V=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,C!=null&&C.length===2){for(k=0,Q=C[1],w=0;w!=Q.length&&!((V=Q.charCodeAt(w)-64)<1||V>26);++w)k=26*k+V;--k,P=k}else++P;for(w=0;w!=y.length&&y.charCodeAt(w)!==62;++w);if(++w,S=Ke(y.slice(0,w),!0),S.r||(S.r=tt({r:R-1,c:P})),Q=y.slice(w),X={t:""},(C=Q.match(s))!=null&&C[1]!==""&&(X.v=wt(C[1])),p.cellFormula){if((C=Q.match(o))!=null&&C[1]!==""){if(X.f=wt(Ut(C[1])).replace(/\r\n/g,`
`),p.xlfn||(X.f=ax(X.f)),C[0].indexOf('t="array"')>-1)X.F=(Q.match(i)||[])[1],X.F.indexOf(":")>-1&&Ne.push([nr(X.F),X.F]);else if(C[0].indexOf('t="shared"')>-1){F=Ke(C[0]);var Se=wt(Ut(C[1]));p.xlfn||(Se=ax(Se)),Oe[parseInt(F.si,10)]=[F,Se,S.r]}}else(C=Q.match(/<f[^>]*\/>/))&&(F=Ke(C[0]),Oe[F.si]&&(X.f=LO(Oe[F.si][1],Oe[F.si][2],S.r)));var ve=dn(S.r);for(w=0;w<Ne.length;++w)ve.r>=Ne[w][0].s.r&&ve.r<=Ne[w][0].e.r&&ve.c>=Ne[w][0].s.c&&ve.c<=Ne[w][0].e.c&&(X.F=Ne[w][1])}if(S.t==null&&X.v===void 0)if(X.f||X.F)X.v=0,X.t="n";else if(j)X.t="z";else continue;else X.t=S.t||"n";switch(m.s.c>P&&(m.s.c=P),m.e.c<P&&(m.e.c=P),X.t){case"n":if(X.v==""||X.v==null){if(!j)continue;X.t="z"}else X.v=parseFloat(X.v);break;case"s":if(typeof X.v>"u"){if(!j)continue;X.t="z"}else D=Wc[parseInt(X.v,10)],X.v=D.t,X.r=D.r,p.cellHTML&&(X.h=D.h);break;case"str":X.t="s",X.v=X.v!=null?Ut(X.v):"",p.cellHTML&&(X.h=Dg(X.v));break;case"inlineStr":C=Q.match(n),X.t="s",C!=null&&(D=Wg(C[1]))?(X.v=D.t,p.cellHTML&&(X.h=D.h)):X.v="";break;case"b":X.v=Wt(X.v);break;case"d":p.cellDates?X.v=Lr(X.v,1):(X.v=gn(Lr(X.v,1)),X.t="n");break;case"e":(!p||p.cellText!==!1)&&(X.w=X.v),X.v=WT[X.v];break}if(b=M=0,ke=null,Pe&&S.s!==void 0&&(ke=x.CellXf[S.s],ke!=null&&(ke.numFmtId!=null&&(b=ke.numFmtId),p.cellStyles&&ke.fillId!=null&&(M=ke.fillId))),Tw(X,b,M,p,_,x),p.cellDates&&Pe&&X.t=="n"&&Ll(at[b])&&(X.t="d",X.v=N0(X.v)),S.cm&&p.xlmeta){var Ye=(p.xlmeta.Cell||[])[+S.cm-1];Ye&&Ye.type=="XLDAPR"&&(X.D=!0)}if(ue){var Y=dn(S.r);h[Y.r]||(h[Y.r]=[]),h[Y.r][Y.c]=X}else h[S.r]=X}}}}te.length>0&&(h["!rows"]=te)}}();function wD(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var AD=lo;function SD(){}function ID(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=K4(e),r}function CD(e){var t=pi(e);return[t]}function kD(e){var t=oo(e);return[t]}function RD(e){var t=pi(e),r=e.read_shift(1);return[t,r,"b"]}function PD(e){var t=oo(e),r=e.read_shift(1);return[t,r,"b"]}function ND(e){var t=pi(e),r=e.read_shift(1);return[t,r,"e"]}function OD(e){var t=oo(e),r=e.read_shift(1);return[t,r,"e"]}function LD(e){var t=pi(e),r=e.read_shift(4);return[t,r,"s"]}function DD(e){var t=oo(e),r=e.read_shift(4);return[t,r,"s"]}function FD(e){var t=pi(e),r=Qr(e);return[t,r,"n"]}function Aw(e){var t=oo(e),r=Qr(e);return[t,r,"n"]}function bD(e){var t=pi(e),r=zg(e);return[t,r,"n"]}function MD(e){var t=oo(e),r=zg(e);return[t,r,"n"]}function BD(e){var t=pi(e),r=Ug(e);return[t,r,"is"]}function UD(e){var t=pi(e),r=tn(e);return[t,r,"str"]}function VD(e){var t=oo(e),r=tn(e);return[t,r,"str"]}function zD(e,t,r){var n=e.l+t,i=pi(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(r.cellFormula){e.l+=2;var l=D0(e,n-e.l,r);o[3]=qr(l,null,i,r.supbooks,r)}else e.l=n;return o}function jD(e,t,r){var n=e.l+t,i=pi(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(r.cellFormula){e.l+=2;var l=D0(e,n-e.l,r);o[3]=qr(l,null,i,r.supbooks,r)}else e.l=n;return o}function HD(e,t,r){var n=e.l+t,i=pi(e);i.r=r["!row"];var s=Qr(e),o=[i,s,"n"];if(r.cellFormula){e.l+=2;var l=D0(e,n-e.l,r);o[3]=qr(l,null,i,r.supbooks,r)}else e.l=n;return o}function WD(e,t,r){var n=e.l+t,i=pi(e);i.r=r["!row"];var s=tn(e),o=[i,s,"str"];if(r.cellFormula){e.l+=2;var l=D0(e,n-e.l,r);o[3]=qr(l,null,i,r.supbooks,r)}else e.l=n;return o}var GD=lo;function $D(e,t){var r=e.l+t,n=lo(e),i=Vg(e),s=tn(e),o=tn(e),l=tn(e);e.l=r;var u={rfx:n,relId:i,loc:s,display:l};return o&&(u.Tooltip=o),u}function ZD(){}function KD(e,t,r){var n=e.l+t,i=zT(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var l=QL(e,n-e.l,r);o[1]=l}else e.l=n;return o}function XD(e,t,r){var n=e.l+t,i=lo(e),s=[i];if(r.cellFormula){var o=tD(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}var qD=["left","right","top","bottom","header","footer"];function YD(e){var t={};return qD.forEach(function(r){t[r]=Qr(e)}),t}function JD(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function QD(){}function eF(){}function tF(e,t,r,n,i,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var u=l.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,_=!1,x,E,y,A,C,k,w,V,Q,X=[];l.biff=12,l["!row"]=0;var S=0,R=!1,P=[],D={},F=l.supbooks||i.supbooks||[[]];if(F.sharedf=D,F.arrayf=P,F.SheetNames=i.SheetNames||i.Sheets.map(function(ue){return ue.name}),!l.supbooks&&(l.supbooks=F,i.Names))for(var b=0;b<i.Names.length;++b)F[0][b+1]=i.Names[b];var M=[],Pe=[],ke=!1;Xh[16]={n:"BrtShortReal",f:Aw};var Ne;if(Ns(e,function(te,de,Ae){if(!_)switch(Ae){case 148:h=te;break;case 0:x=te,l.sheetRows&&l.sheetRows<=x.r&&(_=!0),V=zr(A=x.r),l["!row"]=x.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=wu(te.hpt)),Pe[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:te[2]},te[2]){case"n":E.v=te[1];break;case"s":w=Wc[te[1]],E.v=w.t,E.r=w.r;break;case"b":E.v=!!te[1];break;case"e":E.v=te[1],l.cellText!==!1&&(E.w=co[E.v]);break;case"str":E.t="s",E.v=te[1];break;case"is":E.t="s",E.v=te[1].t;break}if((y=o.CellXf[te[0].iStyleRef])&&Tw(E,y.numFmtId,null,l,s,o),C=te[0].c==-1?C+1:te[0].c,l.dense?(u[A]||(u[A]=[]),u[A][C]=E):u[Tr(C)+V]=E,l.cellFormula){for(R=!1,S=0;S<P.length;++S){var j=P[S];x.r>=j[0].s.r&&x.r<=j[0].e.r&&C>=j[0].s.c&&C<=j[0].e.c&&(E.F=xt(j[0]),R=!0)}!R&&te.length>3&&(E.f=te[3])}if(p.s.r>x.r&&(p.s.r=x.r),p.s.c>C&&(p.s.c=C),p.e.r<x.r&&(p.e.r=x.r),p.e.c<C&&(p.e.c=C),l.cellDates&&y&&E.t=="n"&&Ll(at[y.numFmtId])){var H=ba(E.v);H&&(E.t="d",E.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}Ne&&(Ne.type=="XLDAPR"&&(E.D=!0),Ne=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;E={t:"z",v:void 0},C=te[0].c==-1?C+1:te[0].c,l.dense?(u[A]||(u[A]=[]),u[A][C]=E):u[Tr(C)+V]=E,p.s.r>x.r&&(p.s.r=x.r),p.s.c>C&&(p.s.c=C),p.e.r<x.r&&(p.e.r=x.r),p.e.c<C&&(p.e.c=C),Ne&&(Ne.type=="XLDAPR"&&(E.D=!0),Ne=void 0);break;case 176:X.push(te);break;case 49:Ne=((l.xlmeta||{}).Cell||[])[te-1];break;case 494:var J=n["!id"][te.relId];for(J?(te.Target=J.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=J):te.relId==""&&(te.Target="#"+te.loc),A=te.rfx.s.r;A<=te.rfx.e.r;++A)for(C=te.rfx.s.c;C<=te.rfx.e.c;++C)l.dense?(u[A]||(u[A]=[]),u[A][C]||(u[A][C]={t:"z",v:void 0}),u[A][C].l=te):(k=tt({c:C,r:A}),u[k]||(u[k]={t:"z",v:void 0}),u[k].l=te);break;case 426:if(!l.cellFormula)break;P.push(te),Q=l.dense?u[A][C]:u[Tr(C)+V],Q.f=qr(te[1],p,{r:x.r,c:C},F,l),Q.F=xt(te[0]);break;case 427:if(!l.cellFormula)break;D[tt(te[0].s)]=te[1],Q=l.dense?u[A][C]:u[Tr(C)+V],Q.f=qr(te[1],p,{r:x.r,c:C},F,l);break;case 60:if(!l.cellStyles)break;for(;te.e>=te.s;)M[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},ke||(ke=!0,Gg(te.w/256)),El(M[te.e+1]);break;case 161:u["!autofilter"]={ref:xt(te)};break;case 476:u["!margins"]=te;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),te.name&&(i.Sheets[r].CodeName=te.name),(te.above||te.left)&&(u["!outline"]={above:te.above,left:te.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),te.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!de.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+Ae.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=xt(h||p)),l.sheetRows&&u["!ref"]){var Oe=nr(u["!ref"]);l.sheetRows<=+Oe.e.r&&(Oe.e.r=l.sheetRows-1,Oe.e.r>p.e.r&&(Oe.e.r=p.e.r),Oe.e.r<Oe.s.r&&(Oe.s.r=Oe.e.r),Oe.e.c>p.e.c&&(Oe.e.c=p.e.c),Oe.e.c<Oe.s.c&&(Oe.s.c=Oe.e.c),u["!fullref"]=u["!ref"],u["!ref"]=xt(Oe))}return X.length>0&&(u["!merges"]=X),M.length>0&&(u["!cols"]=M),Pe.length>0&&(u["!rows"]=Pe),u}function rF(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=wt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function nF(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,u=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var _=rF(m);p.s.r=p.s.c=0,p.e.c=l,h=Tr(l),_[0].forEach(function(x,E){o[h+zr(E)]={t:"n",v:x,z:_[1]},u=E}),p.e.r<u&&(p.e.r=u),++l}),l>0&&(o["!ref"]=xt(p)),o}function iF(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(ww);return l&&Zg(l[0],s,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function sF(e,t){e.l+=10;var r=tn(e);return{name:r}}function aF(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ns(e,function(u,h,p){switch(p){case 550:s["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Sw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],oF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],lF=[],cF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function fx(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Wt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function hx(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Wt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Iw(e){hx(e.WBProps,Sw),hx(e.CalcPr,cF),fx(e.WBView,oF),fx(e.Sheets,lF),cl.date1904=Wt(e.WBProps.date1904)}var uF="][*?/\\".split("");function fF(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return uF.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var hF=/<\w+:workbook/;function dF(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(sn,function(u,h){var p=Ke(u);switch(Qi(p[0])){case"<?xml":break;case"<workbook":u.match(hF)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=p[i];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Sw.forEach(function(m){if(p[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=Wt(p[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(p[m[0]],10);break;default:r.WBProps[m[0]]=p[m[0]]}}),p.codeName&&(r.WBProps.CodeName=Ut(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=wt(Ut(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Ut(p.name),p.comment&&(s.Comment=p.comment),p.localSheetId&&(s.Sheet=+p.localSheetId),Wt(p.hidden||"0")&&(s.Hidden=!0),o=h+u.length;break;case"</definedName>":s.Ref=wt(Ut(e.slice(o,h))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return u}),N4.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Iw(r),r}function pF(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Jp(e),r.name=tn(e),r}function mF(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?tn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function gF(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function _F(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=X4(e),o=eD(e,0,r),l=Vg(e);e.l=n;var u={Name:s,Ptg:o};return i<268435455&&(u.Sheet=i),l&&(u.Comment=l),u}function vF(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],Xh[16]={n:"BrtFRTArchID$",f:gF},Ns(e,function(u,h,p){switch(p){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=qr(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,u]):o[0]=[p,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(p),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!h.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},t),Iw(r),r.Names=s,r.supbooks=o,r}function xF(e,t,r){return t.slice(-4)===".bin"?vF(e,r):dF(e,r)}function yF(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?tF(e,n,r,i,s,o,l):pD(e,n,r,i,s,o,l)}function EF(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?aF(e,n,r,i,s):iF(e,n,r,i,s)}function TF(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?PO():NO()}function wF(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?kO():RO()}function AF(e,t,r,n){return t.slice(-4)===".bin"?G3(e,r,n):U3(e,r,n)}function SF(e,t,r){return hw(e,r)}function IF(e,t,r){return t.slice(-4)===".bin"?o3(e,r):s3(e,r)}function CF(e,t,r){return t.slice(-4)===".bin"?SO(e,r):yO(e,r)}function kF(e,t,r){return t.slice(-4)===".bin"?_O(e):mO(e)}function RF(e,t,r,n){return r.slice(-4)===".bin"?vO(e,t,r,n):void 0}function PF(e,t,r){return t.slice(-4)===".bin"?dO(e,t,r):pO(e,t,r)}var Cw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,kw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ti(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(Cw),s,o,l,u;if(i)for(u=0;u!=i.length;++u)s=i[u].match(kw),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function NF(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Cw),i,s,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(kw),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var $c;function OF(e,t){var r=$c[e]||wt(e);return r==="General"?qa(t):di(r,t)}function LF(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Wt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Lr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[wt(t)]=i}function DF(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||co[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=vu(e.v):e.w=qa(e.v):e.w=OF(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=$c[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ll(n)){var i=ba(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function FF(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=L3[n.Pattern]||n.Pattern)}e[t.ID]=t}function bF(e,t,r,n,i,s,o,l,u,h){var p="General",m=n.StyleID,_={};h=h||{};var x=[],E=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);s[m]!==void 0&&(s[m].nf&&(p=s[m].nf),s[m].Interior&&x.push(s[m].Interior),!!s[m].Parent);)m=s[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Wt(e);break;case"String":n.t="s",n.r=Dv(wt(e)),n.v=e.indexOf("<")>-1?wt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Lr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=wt(e):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=WT[e],h.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Dv(t||e));break}if(DF(n,p,h),h.cellFormula!==!1)if(n.Formula){var y=wt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=ll(y,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ll("RC:RC",i):n.ArrayRange&&(n.F=ll(n.ArrayRange,i),u.push([nr(n.F),n.F]))}else for(E=0;E<u.length;++E)i.r>=u[E][0].s.r&&i.r<=u[E][0].e.r&&i.c>=u[E][0].s.c&&i.c<=u[E][0].e.c&&(n.F=u[E][1]);h.cellStyles&&(x.forEach(function(A){!_.patternType&&A.patternType&&(_.patternType=A.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function MF(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Bd(e,t){var r=t||{};gT();var n=Ec(Fg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ut(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Vr(r);return o.type="string",Eu.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(be){i.indexOf("<"+be)>=0&&(s=!0)}),s)return $F(n,r);$c={"General Number":"General","General Date":at[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":at[15],"Short Date":at[14],"Long Time":at[19],"Medium Time":at[18],"Short Time":at[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:at[2],Standard:at[4],Percent:at[10],Scientific:at[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],h,p={},m=[],_=r.dense?[]:{},x="",E={},y={},A=Ti('<Data ss:Type="String">'),C=0,k=0,w=0,V={s:{r:2e6,c:2e6},e:{r:0,c:0}},Q={},X={},S="",R=0,P=[],D={},F={},b=0,M=[],Pe=[],ke={},Ne=[],Oe,ue=!1,te=[],de=[],Ae={},j=0,H=0,J={Sheets:[],WBProps:{date1904:!1}},q={};yu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";l=yu.exec(n);)switch(l[3]=(re=l[3]).toLowerCase()){case"data":if(re=="data"){if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?bF(n.slice(C,l.index),S,A,u[u.length-1][0]=="comment"?ke:E,{c:k,r:w},Q,Ne[k],y,te,r):(S="",A=Ti(l[0]),C=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Pe.length>0&&(E.c=Pe),(!r.sheetRows||r.sheetRows>w)&&E.v!==void 0&&(r.dense?(_[w]||(_[w]=[]),_[w][k]=E):_[Tr(k)+zr(w)]=E),E.HRef&&(E.l={Target:wt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(j=k+(parseInt(E.MergeAcross,10)|0),H=w+(parseInt(E.MergeDown,10)|0),P.push({s:{c:k,r:w},e:{c:j,r:H}})),!r.sheetStubs)E.MergeAcross?k=j+1:++k;else if(E.MergeAcross||E.MergeDown){for(var ge=k;ge<=j;++ge)for(var ye=w;ye<=H;++ye)(ge>k||ye>w)&&(r.dense?(_[ye]||(_[ye]=[]),_[ye][ge]={t:"z"}):_[Tr(ge)+zr(ye)]={t:"z"});k=j+1}else++k;else E=NF(l[0]),E.Index&&(k=+E.Index-1),k<V.s.c&&(V.s.c=k),k>V.e.c&&(V.e.c=k),l[0].slice(-2)==="/>"&&++k,Pe=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<V.s.r&&(V.s.r=w),w>V.e.r&&(V.e.r=w),l[0].slice(-2)==="/>"&&(y=Ti(l[0]),y.Index&&(w=+y.Index-1)),k=0,++w):(y=Ti(l[0]),y.Index&&(w=+y.Index-1),Ae={},(y.AutoFitHeight=="0"||y.Height)&&(Ae.hpx=parseInt(y.Height,10),Ae.hpt=fw(Ae.hpx),de[w]=Ae),y.Hidden=="1"&&(Ae.hidden=!0,de[w]=Ae));break;case"worksheet":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"));m.push(x),V.s.r<=V.e.r&&V.s.c<=V.e.c&&(_["!ref"]=xt(V),r.sheetRows&&r.sheetRows<=V.e.r&&(_["!fullref"]=_["!ref"],V.e.r=r.sheetRows-1,_["!ref"]=xt(V))),P.length&&(_["!merges"]=P),Ne.length>0&&(_["!cols"]=Ne),de.length>0&&(_["!rows"]=de),p[x]=_}else V={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=k=0,u.push([l[3],!1]),h=Ti(l[0]),x=wt(h.Name),_=r.dense?[]:{},P=[],te=[],de=[],q={name:x,Hidden:0},J.Sheets.push(q);break;case"table":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),Ne=[],ue=!1}break;case"style":l[1]==="/"?FF(Q,X,r):X=Ti(l[0]);break;case"numberformat":X.nf=wt(Ti(l[0]).Format||"General"),$c[X.nf]&&(X.nf=$c[X.nf]);for(var Se=0;Se!=392&&at[Se]!=X.nf;++Se);if(Se==392){for(Se=57;Se!=392;++Se)if(at[Se]==null){za(X.nf,Se);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Oe=Ti(l[0]),Oe.Hidden&&(Oe.hidden=!0,delete Oe.Hidden),Oe.Width&&(Oe.wpx=parseInt(Oe.Width,10)),!ue&&Oe.wpx>10){ue=!0,hn=cw;for(var ve=0;ve<Ne.length;++ve)Ne[ve]&&El(Ne[ve])}ue&&El(Oe),Ne[Oe.Index-1||Ne.length]=Oe;for(var Ye=0;Ye<+Oe.Span;++Ye)Ne[Ne.length]=Vr(Oe);break;case"namedrange":if(l[1]==="/")break;J.Names||(J.Names=[]);var Y=Ke(l[0]),yt={Name:Y.Name,Ref:ll(Y.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(yt.Sheet=J.Sheets.length-1),J.Names.push(yt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?S+=n.slice(R,l.index):R=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;X.Interior=Ti(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?yP(D,re,n.slice(b,l.index)):b=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"));MF(ke),Pe.push(ke)}else u.push([l[3],!1]),h=Ti(l[0]),ke={a:h.Author};break;case"autofilter":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var He=Ti(l[0]);_["!autofilter"]={ref:ll(He.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return vx(n,r);var ot=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ot=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ot=!1}break;case"excelworkbook":switch(l[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ot=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:ot=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(b,l.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else b=l.index+l[0].length;break;case"header":_["!margins"]||Gc(_["!margins"]={},"xlml"),isNaN(+Ke(l[0]).Margin)||(_["!margins"].header=+Ke(l[0]).Margin);break;case"footer":_["!margins"]||Gc(_["!margins"]={},"xlml"),isNaN(+Ke(l[0]).Margin)||(_["!margins"].footer=+Ke(l[0]).Margin);break;case"pagemargins":var ne=Ke(l[0]);_["!margins"]||Gc(_["!margins"]={},"xlml"),isNaN(+ne.Top)||(_["!margins"].top=+ne.Top),isNaN(+ne.Left)||(_["!margins"].left=+ne.Left),isNaN(+ne.Right)||(_["!margins"].right=+ne.Right),isNaN(+ne.Bottom)||(_["!margins"].bottom=+ne.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ot=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ot=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ot=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ot=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ot=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ot=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ot=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ot=!1}break;case"smarttags":break;default:ot=!1;break}if(ot||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?LF(F,re,M,n.slice(b,l.index)):(M=l,b=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var fe={};return!r.bookSheets&&!r.bookProps&&(fe.Sheets=p),fe.SheetNames=m,fe.Workbook=J,fe.SSF=Vr(at),fe.Props=D,fe.Custprops=F,fe}function rm(e,t){switch(qg(t=t||{}),t.type||"base64"){case"base64":return Bd($n(e),t);case"binary":case"buffer":case"file":return Bd(e,t);case"array":return Bd(ao(e),t)}}function BF(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=J4(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Q4(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var UF=[60,1084,2066,2165,2175];function VF(e,t,r,n,i){var s=n,o=[],l=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),r.l+=s;for(var u=gs(r,r.l),h=nm[u],p=0;h!=null&&UF.indexOf(u)>-1;)s=gs(r,r.l+2),p=r.l+4,u==2066?p+=4:(u==2165||u==2175)&&(p+=12),l=r.slice(p,r.l+4+s),o.push(l),r.l+=4+s,h=nm[u=gs(r,r.l)];var m=Ks(o);Mr(m,0);var _=0;m.lens=[];for(var x=0;x<o.length;++x)m.lens.push(_),_+=o[x].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,i)}function ji(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=at[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||co[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=vu(e.v):e.w=qa(e.v):e.w=di(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Ll(at[n]||String(n))){var i=ba(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Gf(e,t,r){return{v:e,ixfe:t,t:r}}function zF(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},o={},l=null,u=[],h="",p={},m,_="",x,E,y,A,C={},k=[],w,V,Q=[],X=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},P=function(Re){return Re<8?ja[Re]:Re<64&&X[Re-8]||ja[Re]},D=function(Re,it,At){var lt=it.XF.data;if(!(!lt||!lt.patternType||!At||!At.cellStyles)){it.s={},it.s.patternType=lt.patternType;var cr;(cr=Tu(P(lt.icvFore)))&&(it.s.fgColor={rgb:cr}),(cr=Tu(P(lt.icvBack)))&&(it.s.bgColor={rgb:cr})}},F=function(Re,it,At){if(!(Ae>1)&&!(At.sheetRows&&Re.r>=At.sheetRows)){if(At.cellStyles&&it.XF&&it.XF.data&&D(Re,it,At),delete it.ixfe,delete it.XF,m=Re,_=tt(Re),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<o.s.r&&(o.s.r=Re.r),Re.c<o.s.c&&(o.s.c=Re.c),Re.r+1>o.e.r&&(o.e.r=Re.r+1),Re.c+1>o.e.c&&(o.e.c=Re.c+1),At.cellFormula&&it.f){for(var lt=0;lt<k.length;++lt)if(!(k[lt][0].s.c>Re.c||k[lt][0].s.r>Re.r)&&!(k[lt][0].e.c<Re.c||k[lt][0].e.r<Re.r)){it.F=xt(k[lt][0]),(k[lt][0].s.c!=Re.c||k[lt][0].s.r!=Re.r)&&delete it.f,it.f&&(it.f=""+qr(k[lt][1],o,Re,te,b));break}}At.dense?(i[Re.r]||(i[Re.r]=[]),i[Re.r][Re.c]=it):i[_]=it}},b={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(b.password=t.password);var M,Pe=[],ke=[],Ne=[],Oe=[],ue=!1,te=[];te.SheetNames=b.snames,te.sharedf=b.sharedf,te.arrayf=b.arrayf,te.names=[],te.XTI=[];var de=0,Ae=0,j=0,H=[],J=[],q;b.codepage=1200,ki(1200);for(var re=!1;e.l<e.length-1;){var ge=e.l,ye=e.read_shift(2);if(ye===0&&de===10)break;var Se=e.l===e.length?0:e.read_shift(2),ve=nm[ye];if(ve&&ve.f){if(t.bookSheets&&de===133&&ye!==133)break;if(de=ye,ve.r===2||ve.r==12){var Ye=e.read_shift(2);if(Se-=2,!b.enc&&Ye!==ye&&((Ye&255)<<8|Ye>>8)!==ye)throw new Error("rt mismatch: "+Ye+"!="+ye);ve.r==12&&(e.l+=10,Se-=10)}var Y={};if(ye===10?Y=ve.f(e,Se,b):Y=VF(ye,ve,e,Se,b),Ae==0&&[9,521,1033,2057].indexOf(de)===-1)continue;switch(ye){case 34:r.opts.Date1904=S.WBProps.date1904=Y;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(b.enc||(e.l=0),b.enc=Y,!t.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=Y;break;case 66:var yt=Number(Y);switch(yt){case 21010:yt=1200;break;case 32768:yt=1e4;break;case 32769:yt=1252;break}ki(b.codepage=yt),re=!0;break;case 317:b.rrtabid=Y;break;case 25:b.winlocked=Y;break;case 439:r.opts.RefreshAll=Y;break;case 12:r.opts.CalcCount=Y;break;case 16:r.opts.CalcDelta=Y;break;case 17:r.opts.CalcIter=Y;break;case 13:r.opts.CalcMode=Y;break;case 14:r.opts.CalcPrecision=Y;break;case 95:r.opts.CalcSaveRecalc=Y;break;case 15:b.CalcRefMode=Y;break;case 2211:r.opts.FullCalc=Y;break;case 129:Y.fDialog&&(i["!type"]="dialog"),Y.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),Y.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:Q.push(Y);break;case 430:te.push([Y]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(Y);break;case 24:case 536:q={Name:Y.Name,Ref:qr(Y.rgce,o,null,te,b)},Y.itab>0&&(q.Sheet=Y.itab-1),te.names.push(q),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(J[Y.itab-1]={ref:xt(Y.rgce[0][0][1][2])});break;case 22:b.ExternCount=Y;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(Y),te.XTI=te.XTI.concat(Y);break;case 2196:if(b.biff<8)break;q!=null&&(q.Comment=Y[1]);break;case 18:i["!protect"]=Y;break;case 19:Y!==0&&b.WTF&&console.error("Password verifier: "+Y);break;case 133:s[Y.pos]=Y,b.snames.push(Y.name);break;case 10:{if(--Ae)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=xt(o),t.sheetRows&&t.sheetRows<=o.e.r){var He=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=xt(o),o.e.r=He}o.e.r++,o.e.c++}Pe.length>0&&(i["!merges"]=Pe),ke.length>0&&(i["!objects"]=ke),Ne.length>0&&(i["!cols"]=Ne),Oe.length>0&&(i["!rows"]=Oe),S.Sheets.push(R)}h===""?p=i:n[h]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[ye]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),b.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(b.biff=5,re=!0,ki(b.codepage=28591)),b.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(b.biff=2),Ae++)break;if(i=t.dense?[]:{},b.biff<8&&!re&&(re=!0,ki(b.codepage=t.codepage||1252)),b.biff<5||Y.BIFFVer==0&&Y.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ot={pos:e.l-Se,name:h};s[ot.pos]=ot,b.snames.push(h)}else h=(s[ge]||{name:""}).name;Y.dt==32&&(i["!type"]="chart"),Y.dt==64&&(i["!type"]="macro"),Pe=[],ke=[],b.arrayf=k=[],Ne=[],Oe=[],ue=!1,R={Hidden:(s[ge]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[Y.r]||[])[Y.c]:i[tt({c:Y.c,r:Y.r})])&&++Y.c,w={ixfe:Y.ixfe,XF:Q[Y.ixfe]||{},v:Y.val,t:"n"},j>0&&(w.z=H[w.ixfe>>8&63]),ji(w,t,r.opts.Date1904),F({c:Y.c,r:Y.r},w,t);break;case 5:case 517:w={ixfe:Y.ixfe,XF:Q[Y.ixfe],v:Y.val,t:Y.t},j>0&&(w.z=H[w.ixfe>>8&63]),ji(w,t,r.opts.Date1904),F({c:Y.c,r:Y.r},w,t);break;case 638:w={ixfe:Y.ixfe,XF:Q[Y.ixfe],v:Y.rknum,t:"n"},j>0&&(w.z=H[w.ixfe>>8&63]),ji(w,t,r.opts.Date1904),F({c:Y.c,r:Y.r},w,t);break;case 189:for(var ne=Y.c;ne<=Y.C;++ne){var fe=Y.rkrec[ne-Y.c][0];w={ixfe:fe,XF:Q[fe],v:Y.rkrec[ne-Y.c][1],t:"n"},j>0&&(w.z=H[w.ixfe>>8&63]),ji(w,t,r.opts.Date1904),F({c:ne,r:Y.r},w,t)}break;case 6:case 518:case 1030:{if(Y.val=="String"){l=Y;break}if(w=Gf(Y.val,Y.cell.ixfe,Y.tt),w.XF=Q[w.ixfe],t.cellFormula){var be=Y.formula;if(be&&be[0]&&be[0][0]&&be[0][0][0]=="PtgExp"){var Xe=be[0][0][1][0],qe=be[0][0][1][1],mt=tt({r:Xe,c:qe});C[mt]?w.f=""+qr(Y.formula,o,Y.cell,te,b):w.F=((t.dense?(i[Xe]||[])[qe]:i[mt])||{}).F}else w.f=""+qr(Y.formula,o,Y.cell,te,b)}j>0&&(w.z=H[w.ixfe>>8&63]),ji(w,t,r.opts.Date1904),F(Y.cell,w,t),l=Y}break;case 7:case 519:if(l)l.val=Y,w=Gf(Y,l.cell.ixfe,"s"),w.XF=Q[w.ixfe],t.cellFormula&&(w.f=""+qr(l.formula,o,l.cell,te,b)),j>0&&(w.z=H[w.ixfe>>8&63]),ji(w,t,r.opts.Date1904),F(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(Y);var Lt=tt(Y[0].s);if(x=t.dense?(i[Y[0].s.r]||[])[Y[0].s.c]:i[Lt],t.cellFormula&&x){if(!l||!Lt||!x)break;x.f=""+qr(Y[1],o,Y[0],te,b),x.F=xt(Y[0])}}break;case 1212:{if(!t.cellFormula)break;if(_){if(!l)break;C[tt(l.cell)]=Y[0],x=t.dense?(i[l.cell.r]||[])[l.cell.c]:i[tt(l.cell)],(x||{}).f=""+qr(Y[0],o,m,te,b)}}break;case 253:w=Gf(u[Y.isst].t,Y.ixfe,"s"),u[Y.isst].h&&(w.h=u[Y.isst].h),w.XF=Q[w.ixfe],j>0&&(w.z=H[w.ixfe>>8&63]),ji(w,t,r.opts.Date1904),F({c:Y.c,r:Y.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:Y.ixfe,XF:Q[Y.ixfe],t:"z"},j>0&&(w.z=H[w.ixfe>>8&63]),ji(w,t,r.opts.Date1904),F({c:Y.c,r:Y.r},w,t));break;case 190:if(t.sheetStubs)for(var ir=Y.c;ir<=Y.C;++ir){var Qt=Y.ixfe[ir-Y.c];w={ixfe:Qt,XF:Q[Qt],t:"z"},j>0&&(w.z=H[w.ixfe>>8&63]),ji(w,t,r.opts.Date1904),F({c:ir,r:Y.r},w,t)}break;case 214:case 516:case 4:w=Gf(Y.val,Y.ixfe,"s"),w.XF=Q[w.ixfe],j>0&&(w.z=H[w.ixfe>>8&63]),ji(w,t,r.opts.Date1904),F({c:Y.c,r:Y.r},w,t);break;case 0:case 512:Ae===1&&(o=Y);break;case 252:u=Y;break;case 1054:if(b.biff==4){H[j++]=Y[1];for(var Dr=0;Dr<j+163&&at[Dr]!=Y[1];++Dr);Dr>=163&&za(Y[1],j+163)}else za(Y[1],Y[0]);break;case 30:{H[j++]=Y;for(var ct=0;ct<j+163&&at[ct]!=Y;++ct);ct>=163&&za(Y,j+163)}break;case 229:Pe=Pe.concat(Y);break;case 93:ke[Y.cmo[0]]=b.lastobj=Y;break;case 438:b.lastobj.TxO=Y;break;case 127:b.lastobj.ImData=Y;break;case 440:for(A=Y[0].s.r;A<=Y[0].e.r;++A)for(y=Y[0].s.c;y<=Y[0].e.c;++y)x=t.dense?(i[A]||[])[y]:i[tt({c:y,r:A})],x&&(x.l=Y[1]);break;case 2048:for(A=Y[0].s.r;A<=Y[0].e.r;++A)for(y=Y[0].s.c;y<=Y[0].e.c;++y)x=t.dense?(i[A]||[])[y]:i[tt({c:y,r:A})],x&&x.l&&(x.l.Tooltip=Y[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;x=t.dense?(i[Y[0].r]||[])[Y[0].c]:i[tt(Y[0])];var Dt=ke[Y[2]];x||(t.dense?(i[Y[0].r]||(i[Y[0].r]=[]),x=i[Y[0].r][Y[0].c]={t:"z"}):x=i[tt(Y[0])]={t:"z"},o.e.r=Math.max(o.e.r,Y[0].r),o.s.r=Math.min(o.s.r,Y[0].r),o.e.c=Math.max(o.e.c,Y[0].c),o.s.c=Math.min(o.s.c,Y[0].c)),x.c||(x.c=[]),E={a:Y[1],t:Dt.TxO.t},x.c.push(E)}break;case 2173:cO(Q[Y.ixfe],Y.ext);break;case 125:{if(!b.cellStyles)break;for(;Y.e>=Y.s;)Ne[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},ue||(ue=!0,Gg(Y.w/256)),El(Ne[Y.e+1])}break;case 520:{var bt={};Y.level!=null&&(Oe[Y.r]=bt,bt.level=Y.level),Y.hidden&&(Oe[Y.r]=bt,bt.hidden=!0),Y.hpt&&(Oe[Y.r]=bt,bt.hpt=Y.hpt,bt.hpx=wu(Y.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Gc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ye]]=Y;break;case 161:i["!margins"]||Gc(i["!margins"]={}),i["!margins"].header=Y.header,i["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(S.Views[0].RTL=!0);break;case 146:X=Y;break;case 2198:M=Y;break;case 140:V=Y;break;case 442:h?R.CodeName=Y||R.name:S.WBProps.CodeName=Y||"ThisWorkbook";break}}else ve||console.error("Missing Info for XLS Record 0x"+ye.toString(16)),e.l+=Se}return r.SheetNames=qi(s).sort(function(Ir,Re){return Number(Ir)-Number(Re)}).map(function(Ir){return s[Ir].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&J.forEach(function(Ir,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=Ir}),r.Strings=u,r.SSF=Vr(at),b.enc&&(r.Encryption=b.enc),M&&(r.Themes=M),r.Metadata={},V!==void 0&&(r.Metadata.Country=V),te.names.length>0&&(S.Names=te.names),r.Workbook=S,r}var dx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function jF(e,t,r){var n=vt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=qv(n,sP,dx.DSI);for(var s in i)t[s]=i[s]}catch(h){if(r.WTF)throw h}var o=vt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=qv(o,aP,dx.SI);for(var u in l)t[u]==null&&(t[u]=l[u])}catch(h){if(r.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&($T(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Rw(e,t){t||(t={}),qg(t),iT(),t.codepage&&kg(t.codepage);var r,n;if(e.FullPaths){if(vt.find(e,"/encryption"))throw new Error("File is password-protected");r=vt.find(e,"!CompObj"),n=vt.find(e,"/Workbook")||vt.find(e,"/Book")}else{switch(t.type){case"base64":e=Ci($n(e));break;case"binary":e=Ci(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Mr(e,0),n={content:e}}var i,s;if(r&&BF(r),t.bookProps&&!t.bookSheets)i={};else{var o=pt?"buffer":"array";if(n&&n.content)i=zF(n.content,t);else if((s=vt.find(e,"PerfectOffice_MAIN"))&&s.content)i=Hc.to_workbook(s.content,(t.type=o,t));else if((s=vt.find(e,"NativeContent_MAIN"))&&s.content)i=Hc.to_workbook(s.content,(t.type=o,t));else throw(s=vt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&vt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=CO(e))}var l={};return e.FullPaths&&jF(e,l,t),i.Props=i.Custprops=l,t.bookFiles&&(i.cfb=e),i}var Xh={0:{f:wD},1:{f:CD},2:{f:bD},3:{f:ND},4:{f:RD},5:{f:FD},6:{f:UD},7:{f:LD},8:{f:WD},9:{f:HD},10:{f:zD},11:{f:jD},12:{f:kD},13:{f:MD},14:{f:OD},15:{f:PD},16:{f:Aw},17:{f:VD},18:{f:DD},19:{f:Ug},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_F},40:{},42:{},43:{f:z3},44:{f:V3},45:{f:j3},46:{f:W3},47:{f:H3},48:{},49:{f:G4},50:{},51:{f:fO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:iw},62:{f:BD},63:{f:gO},64:{f:QD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:nn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:JD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ID},148:{f:AD,p:16},151:{f:ZD},152:{},153:{f:mF},154:{},155:{},156:{f:pF},157:{},158:{},159:{T:1,f:a3},160:{T:-1},161:{T:1,f:lo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:uO},336:{T:-1},337:{f:hO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Jp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:nw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:KD},427:{f:XD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:YD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:SD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:$D},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Jp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:AO},633:{T:1},634:{T:-1},635:{T:1,f:wO},636:{T:-1},637:{f:Z4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:sF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:eF},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},nm={6:{f:bd},10:{f:Hs},12:{f:mr},13:{f:mr},14:{f:ar},15:{f:ar},16:{f:Qr},17:{f:ar},18:{f:ar},19:{f:mr},20:{f:ex},21:{f:ex},23:{f:nw},24:{f:rx},25:{f:ar},26:{},27:{},28:{f:EN},29:{},34:{f:ar},35:{f:tx},38:{f:Qr},39:{f:Qr},40:{f:Qr},41:{f:Qr},42:{f:ar},43:{f:ar},47:{f:S3},49:{f:rN},51:{f:mr},60:{},61:{f:QP},64:{f:ar},65:{f:tN},66:{f:mr},77:{},80:{},81:{},82:{},85:{f:mr},89:{},90:{},91:{},92:{f:GP},93:{f:wN},94:{},95:{f:ar},96:{},97:{},99:{f:ar},125:{f:iw},128:{f:hN},129:{f:$P},130:{f:mr},131:{f:ar},132:{f:ar},133:{f:ZP},134:{},140:{f:RN},141:{f:mr},144:{},146:{f:NN},151:{},152:{},153:{},154:{},155:{},156:{f:mr},157:{},158:{},160:{f:bN},161:{f:LN},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:lN},190:{f:cN},193:{f:Hs},197:{},198:{},199:{},200:{},201:{},202:{f:ar},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:mr},220:{},221:{f:ar},222:{},224:{f:fN},225:{f:WP},226:{f:Hs},227:{},229:{f:TN},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:KP},253:{f:nN},255:{f:XP},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:YT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ar},353:{f:Hs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:pN},431:{f:ar},432:{},433:{},434:{},437:{},438:{f:IN},439:{f:ar},440:{f:CN},441:{},442:{f:ju},443:{},444:{f:mr},445:{},446:{},448:{f:Hs},449:{f:JP,r:2},450:{f:Hs},512:{f:Jv},513:{f:FN},515:{f:dN},516:{f:iN},517:{f:Qv},519:{f:MN},520:{f:qP},523:{},545:{f:nx},549:{f:Yv},566:{},574:{f:eN},638:{f:oN},659:{},1048:{},1054:{f:sN},1084:{},1212:{f:vN},2048:{f:kN},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:jf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Hs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:ON,r:12},2173:{f:lO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ar,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_N,r:12},2197:{},2198:{f:rO,r:12},2199:{},2200:{},2201:{},2202:{f:xN,r:12},2203:{f:Hs},2204:{},2205:{},2206:{},2207:{},2211:{f:YP},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:mr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:DN},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:PN},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Jv},1:{},2:{f:zN},3:{f:VN},4:{f:UN},5:{f:Qv},7:{f:jN},8:{},9:{f:jf},11:{},22:{f:mr},30:{f:aN},31:{},32:{},33:{f:nx},36:{},37:{f:Yv},50:{f:HN},62:{},52:{},67:{},68:{f:mr},69:{},86:{},126:{},127:{f:BN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:WN},223:{},234:{},354:{},421:{},518:{f:bd},521:{f:jf},536:{f:rx},547:{f:tx},561:{},579:{},1030:{f:bd},1033:{f:jf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function wi(e,t,r,n){var i=t;if(!isNaN(i)){var s=(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&BT(r)&&e.push(r)}}function px(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,l=s&&s.index||e.length,u=d4(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,m=0,_=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(o=0;o<u.length;++o){var y=u[o].trim(),A=y.slice(0,3).toLowerCase();if(A=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}p=0;continue}if(!(A!="<td"&&A!="<th")){var C=y.split(/<\/t[dh]>/i);for(l=0;l<C.length;++l){var k=C[l].trim();if(k.match(/<t[dh]/i)){for(var w=k,V=0;w.charAt(0)=="<"&&(V=w.indexOf(">"))>-1;)w=w.slice(V+1);for(var Q=0;Q<E.length;++Q){var X=E[Q];X.s.c==p&&X.s.r<h&&h<=X.e.r&&(p=X.e.c+1,Q=-1)}var S=Ke(k.slice(0,k.indexOf(">")));_=S.colspan?+S.colspan:1,((m=+S.rowspan)>1||_>1)&&E.push({s:{r:h,c:p},e:{r:h+(m||1)-1,c:p+_-1}});var R=S.t||S["data-t"]||"";if(!w.length){p+=_;continue}if(w=ST(w),x.s.r>h&&(x.s.r=h),x.e.r<h&&(x.e.r=h),x.s.c>p&&(x.s.c=p),x.e.c<p&&(x.e.c=p),!w.length){p+=_;continue}var P={t:"s",v:w};r.raw||!w.trim().length||R=="s"||(w==="TRUE"?P={t:"b",v:!0}:w==="FALSE"?P={t:"b",v:!1}:isNaN(Oi(w))?isNaN(yl(w).getDate())||(P={t:"d",v:Lr(w)},r.cellDates||(P={t:"n",v:gn(P.v)}),P.z=r.dateNF||at[14]):P={t:"n",v:Oi(w)}),r.dense?(n[h]||(n[h]=[]),n[h][p]=P):n[tt({r:h,c:p})]=P,p+=_}}}}return n["!ref"]=xt(x),E.length&&(n["!merges"]=E),n}function HF(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,u=0,h=0;h<i.length;++h)if(!(i[h].s.r>r||i[h].s.c>o)&&!(i[h].e.r<r||i[h].e.c<o)){if(i[h].s.r<r||i[h].s.c<o){l=-1;break}l=i[h].e.r-i[h].s.r+1,u=i[h].e.c-i[h].s.c+1;break}if(!(l<0)){var p=tt({r,c:o}),m=n.dense?(e[r]||[])[o]:e[p],_=m&&m.v!=null&&(m.h||Dg(m.w||(Ss(m),m.w)||""))||"",x={};l>1&&(x.rowspan=l),u>1&&(x.colspan=u),n.editable?_='<span contenteditable="true">'+_+"</span>":m&&(x["data-t"]=m&&m.t||"z",m.v!=null&&(x["data-v"]=m.v),m.z!=null&&(x["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+m.l.Target+'">'+_+"</a>")),x.id=(n.id||"sjs")+"-"+p,s.push(R4("td",_,x))}}var E="<tr>";return E+s.join("")+"</tr>"}var WF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',GF="</body></html>";function $F(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Aa(px(r[0],t),t);var n=Jg();return r.forEach(function(i,s){Qg(n,px(i,t),"Sheet"+(s+1))}),n}function ZF(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function KF(e,t){var r=t||{},n=r.header!=null?r.header:WF,i=r.footer!=null?r.footer:GF,s=[n],o=Dl(e["!ref"]);r.dense=Array.isArray(e),s.push(ZF(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(HF(e,o,l,r));return s.push("</table>"+i),s.join("")}function Pw(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?dn(n.origin):n.origin;i=o.r,s=o.c}var l=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,l.length),h={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var p=Dl(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),i==-1&&(h.e.r=i=p.e.r+1)}var m=[],_=0,x=e["!rows"]||(e["!rows"]=[]),E=0,y=0,A=0,C=0,k=0,w=0;for(e["!cols"]||(e["!cols"]=[]);E<l.length&&y<u;++E){var V=l[E];if(mx(V)){if(n.display)continue;x[y]={hidden:!0}}var Q=V.children;for(A=C=0;A<Q.length;++A){var X=Q[A];if(!(n.display&&mx(X))){var S=X.hasAttribute("data-v")?X.getAttribute("data-v"):X.hasAttribute("v")?X.getAttribute("v"):ST(X.innerHTML),R=X.getAttribute("data-z")||X.getAttribute("z");for(_=0;_<m.length;++_){var P=m[_];P.s.c==C+s&&P.s.r<y+i&&y+i<=P.e.r&&(C=P.e.c+1-s,_=-1)}w=+X.getAttribute("colspan")||1,((k=+X.getAttribute("rowspan")||1)>1||w>1)&&m.push({s:{r:y+i,c:C+s},e:{r:y+i+(k||1)-1,c:C+s+(w||1)-1}});var D={t:"s",v:S},F=X.getAttribute("data-t")||X.getAttribute("t")||"";S!=null&&(S.length==0?D.t=F||"z":n.raw||S.trim().length==0||F=="s"||(S==="TRUE"?D={t:"b",v:!0}:S==="FALSE"?D={t:"b",v:!1}:isNaN(Oi(S))?isNaN(yl(S).getDate())||(D={t:"d",v:Lr(S)},n.cellDates||(D={t:"n",v:gn(D.v)}),D.z=n.dateNF||at[14]):D={t:"n",v:Oi(S)})),D.z===void 0&&R!=null&&(D.z=R);var b="",M=X.getElementsByTagName("A");if(M&&M.length)for(var Pe=0;Pe<M.length&&!(M[Pe].hasAttribute("href")&&(b=M[Pe].getAttribute("href"),b.charAt(0)!="#"));++Pe);b&&b.charAt(0)!="#"&&(D.l={Target:b}),n.dense?(e[y+i]||(e[y+i]=[]),e[y+i][C+s]=D):e[tt({c:C+s,r:y+i})]=D,h.e.c<C+s&&(h.e.c=C+s),C+=w}}++y}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),h.e.r=Math.max(h.e.r,y-1+i),e["!ref"]=xt(h),y>=u&&(e["!fullref"]=xt((h.e.r=l.length-E+y-1+i,h))),e}function Nw(e,t){var r=t||{},n=r.dense?[]:{};return Pw(n,e,t)}function XF(e,t){return Aa(Nw(e,t),t)}function mx(e){var t="",r=qF(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function qF(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function YF(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=wt(t.replace(/<[^>]*>/g,""));return[r]}var gx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ow(e,t){var r=t||{},n=Fg(e),i=[],s,o,l={name:""},u="",h=0,p,m,_={},x=[],E=r.dense?[]:{},y,A,C={value:""},k="",w=0,V=[],Q=-1,X=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,P={},D=[],F={},b=0,M=0,Pe=[],ke=1,Ne=1,Oe=[],ue={Names:[]},te={},de=["",""],Ae=[],j={},H="",J=0,q=!1,re=!1,ge=0;for(yu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=yu.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?E["!ref"]=xt(S):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(E["!fullref"]=E["!ref"],S.e.r=r.sheetRows-1,E["!ref"]=xt(S)),D.length&&(E["!merges"]=D),Pe.length&&(E["!rows"]=Pe),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),x.push(p.name),_[p.name]=E,re=!1):y[0].charAt(y[0].length-2)!=="/"&&(p=Ke(y[0],!1),Q=X=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,E=r.dense?[]:{},D=[],Pe=[],re=!0);break;case"table-row-group":y[1]==="/"?--R:++R;break;case"table-row":case"":if(y[1]==="/"){Q+=ke,ke=1;break}if(m=Ke(y[0],!1),m.?Q=m.-1:Q==-1&&(Q=0),ke=+m["number-rows-repeated"]||1,ke<10)for(ge=0;ge<ke;++ge)R>0&&(Pe[Q+ge]={level:R});X=-1;break;case"covered-table-cell":y[1]!=="/"&&++X,r.sheetStubs&&(r.dense?(E[Q]||(E[Q]=[]),E[Q][X]={t:"z"}):E[tt({r:Q,c:X})]={t:"z"}),k="",V=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++X,C=Ke(y[0],!1),Ne=parseInt(C["number-columns-repeated"]||"1",10),A={t:"z",v:null},C.formula&&r.cellFormula!=!1&&(A.f=ux(wt(C.formula))),(C.||C["value-type"])=="string"&&(A.t="s",A.v=wt(C["string-value"]||""),r.dense?(E[Q]||(E[Q]=[]),E[Q][X]=A):E[tt({r:Q,c:X})]=A),X+=Ne-1;else if(y[1]!=="/"){++X,k="",w=0,V=[],Ne=1;var ye=ke?Q+ke-1:Q;if(X>S.e.c&&(S.e.c=X),X<S.s.c&&(S.s.c=X),Q<S.s.r&&(S.s.r=Q),ye>S.e.r&&(S.e.r=ye),C=Ke(y[0],!1),Ae=[],j={},A={t:C.||C["value-type"],v:null},r.cellFormula)if(C.formula&&(C.formula=wt(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(b=parseInt(C["number-matrix-rows-spanned"],10)||0,M=parseInt(C["number-matrix-columns-spanned"],10)||0,F={s:{r:Q,c:X},e:{r:Q+b-1,c:X+M-1}},A.F=xt(F),Oe.push([F,A.F])),C.formula)A.f=ux(C.formula);else for(ge=0;ge<Oe.length;++ge)Q>=Oe[ge][0].s.r&&Q<=Oe[ge][0].e.r&&X>=Oe[ge][0].s.c&&X<=Oe[ge][0].e.c&&(A.F=Oe[ge][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(b=parseInt(C["number-rows-spanned"],10)||0,M=parseInt(C["number-columns-spanned"],10)||0,F={s:{r:Q,c:X},e:{r:Q+b-1,c:X+M-1}},D.push(F)),C["number-columns-repeated"]&&(Ne=parseInt(C["number-columns-repeated"],10)),A.t){case"boolean":A.t="b",A.v=Wt(C["boolean-value"]);break;case"float":A.t="n",A.v=parseFloat(C.value);break;case"percentage":A.t="n",A.v=parseFloat(C.value);break;case"currency":A.t="n",A.v=parseFloat(C.value);break;case"date":A.t="d",A.v=Lr(C["date-value"]),r.cellDates||(A.t="n",A.v=gn(A.v)),A.z="m/d/yy";break;case"time":A.t="n",A.v=u4(C["time-value"])/86400,r.cellDates&&(A.t="d",A.v=N0(A.v)),A.z="HH:MM:SS";break;case"number":A.t="n",A.v=parseFloat(C.);break;default:if(A.t==="string"||A.t==="text"||!A.t)A.t="s",C["string-value"]!=null&&(k=wt(C["string-value"]),V=[]);else throw new Error("Unsupported value type "+A.t)}}else{if(q=!1,A.t==="s"&&(A.v=k||"",V.length&&(A.R=V),q=w==0),te.Target&&(A.l=te),Ae.length>0&&(A.c=Ae,Ae=[]),k&&r.cellText!==!1&&(A.w=k),q&&(A.t="z",delete A.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=Q))for(var Se=0;Se<ke;++Se){if(Ne=parseInt(C["number-columns-repeated"]||"1",10),r.dense)for(E[Q+Se]||(E[Q+Se]=[]),E[Q+Se][X]=Se==0?A:Vr(A);--Ne>0;)E[Q+Se][X+Ne]=Vr(A);else for(E[tt({r:Q+Se,c:X})]=A;--Ne>0;)E[tt({r:Q+Se,c:X+Ne})]=Vr(A);S.e.c<=X&&(S.e.c=X)}Ne=parseInt(C["number-columns-repeated"]||"1",10),X+=Ne-1,Ne=0,A={},k="",V=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s;j.t=k,V.length&&(j.R=V),j.a=H,Ae.push(j)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);H="",J=0,k="",w=0,V=[];break;case"creator":y[1]==="/"?H=n.slice(J,y.index):J=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);k="",w=0,V=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(P[l.name]=u,(s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&(u="",l=Ke(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ke(y[0],!1),u+=gx[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ke(y[0],!1),u+=gx[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(h,y.index);break}else h=y.index+y[0].length;break;case"named-range":o=Ke(y[0],!1),de=Md(o["cell-range-address"]);var ve={Name:o.name,Ref:de[0]+"!"+de[1]};re&&(ve.Sheet=x.length),ue.Names.push(ve);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!C||!C["string-value"])){var Ye=YF(n.slice(w,y.index));k=(k.length>0?k+`
`:"")+Ye[0]}else Ke(y[0],!1),w=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{de=Md(Ke(y[0])["target-range-address"]),_[de[0]]["!autofilter"]={ref:de[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(te=Ke(y[0],!1),!te.href)break;te.Target=wt(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(de=Md(te.Target.slice(1)),te.Target="#"+de[0]+"!"+de[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var Y={Sheets:_,SheetNames:x,Workbook:ue};return r.bookSheets&&delete Y.Sheets,Y}function _x(e,t){t=t||{},si(e,"META-INF/manifest.xml")&&dP(pr(e,"META-INF/manifest.xml"),t);var r=Vn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Ow(Ut(r),t);return si(e,"meta.xml")&&(n.Props=GT(pr(e,"meta.xml"))),n}function vx(e,t){return Ow(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Kg(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function im(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ut(ao(e))}function sm(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function xx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function JF(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Au(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ar(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function en(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Au(e,r),s=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(s){case 0:{for(var u=r[0];e[r[0]++]>=128;);l=e.slice(u,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Au(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var h={data:l,type:s};t[i]==null?t[i]=[h]:t[i].push(h)}return t}function Xg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function QF(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Au(e,n),s=en(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Ar(s[1][0].data),messages:[]};s[2].forEach(function(l){var u=en(l.data),h=Ar(u[3][0].data);o.messages.push({meta:u,data:e.slice(n[0],n[0]+h)}),n[0]+=h}),(t=s[3])!=null&&t[0]&&(o.merge=Ar(s[3][0].data)>>>0>0),r.push(o)}return r}function eb(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Au(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,h=0;if(s==1?(h=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(h=(t[r[0]++]>>2)+1,s==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[sm(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(h>=u)for(i.push(i[0].slice(-u)),h-=u;h>=i[i.length-1].length;)i.push(i[i.length-1]),h-=i[i.length-1].length;i.push(i[0].slice(-u,-u+h))}}var p=sm(i);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function tb(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(eb(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return sm(t)}function rb(e,t,r,n){var i=Kg(e),s=i.getUint32(4,!0),o=(n>1?12:8)+xx(s&(n>1?3470:398))*4,l=-1,u=-1,h=NaN,p=new Date(2001,0,1);s&512&&(l=i.getUint32(o,!0),o+=4),o+=xx(s&(n>1?12288:4096))*4,s&16&&(u=i.getUint32(o,!0),o+=4),s&32&&(h=i.getFloat64(o,!0),o+=8),s&64&&(p.setTime(p.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:h};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(u>-1)m={t:"s",v:t[u]};else if(!isNaN(h))m={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function nb(e,t,r){var n=Kg(e),i=n.getUint32(8,!0),s=12,o=-1,l=-1,u=NaN,h=NaN,p=new Date(2001,0,1);i&1&&(u=JF(e,s),s+=16),i&2&&(h=n.getFloat64(s,!0),s+=8),i&4&&(p.setTime(p.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(l=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return m}function ib(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return rb(e,t,r,e[0]);case 5:return nb(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ca(e){var t=en(e);return Au(t[1][0].data)}function yx(e,t){var r=en(t.data),n=Ar(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var l=en(o.data),u=Ar(l[1][0].data)>>>0;switch(n){case 1:s[u]=im(l[3][0].data);break;case 8:{var h=e[ca(l[9][0].data)][0],p=en(h.data),m=e[ca(p[1][0].data)][0],_=Ar(m.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var x=en(m.data);s[u]=x[3].map(function(E){return im(E.data)}).join("")}break}}),s}function sb(e,t){var r,n,i,s,o,l,u,h,p,m,_,x,E,y,A=en(e),C=Ar(A[1][0].data)>>>0,k=Ar(A[2][0].data)>>>0,w=((n=(r=A[8])==null?void 0:r[0])==null?void 0:n.data)&&Ar(A[8][0].data)>0||!1,V,Q;if((s=(i=A[7])==null?void 0:i[0])!=null&&s.data&&t!=0)V=(l=(o=A[7])==null?void 0:o[0])==null?void 0:l.data,Q=(h=(u=A[6])==null?void 0:u[0])==null?void 0:h.data;else if((m=(p=A[4])==null?void 0:p[0])!=null&&m.data&&t!=1)V=(x=(_=A[4])==null?void 0:_[0])==null?void 0:x.data,Q=(y=(E=A[3])==null?void 0:E[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var X=w?4:1,S=Kg(V),R=[],P=0;P<V.length/2;++P){var D=S.getUint16(P*2,!0);D<65535&&R.push([P,D])}if(R.length!=k)throw"Expected ".concat(k," cells, found ").concat(R.length);var F=[];for(P=0;P<R.length-1;++P)F[R[P][0]]=Q.subarray(R[P][1]*X,R[P+1][1]*X);return R.length>=1&&(F[R[R.length-1][0]]=Q.subarray(R[R.length-1][1]*X)),{R:C,cells:F}}function ab(e,t){var r,n=en(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Ar(n[7][0].data)>>>0>0?1:0:-1,s=Xg(n[5],function(o){return sb(o,i)});return{nrows:Ar(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(u,h){if(o[l.R][h])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(h));o[l.R][h]=u}),o},[])}}function ob(e,t,r){var n,i=en(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ar(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Ar(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=xt(s);var o=en(i[4][0].data),l=yx(e,e[ca(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?yx(e,e[ca(o[17][0].data)][0]):[],h=en(o[3][0].data),p=0;h[1].forEach(function(m){var _=en(m.data),x=e[ca(_[2][0].data)][0],E=Ar(x.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var y=ab(e,x);y.data.forEach(function(A,C){A.forEach(function(k,w){var V=tt({r:p+C,c:w}),Q=ib(k,l,u);Q&&(r[V]=Q)})}),p+=y.nrows})}function lb(e,t){var r=en(t.data),n={"!ref":"A1"},i=e[ca(r[2][0].data)],s=Ar(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return ob(e,i[0],n),n}function cb(e,t){var r,n=en(t.data),i={name:(r=n[1])!=null&&r[0]?im(n[1][0].data):"",sheets:[]},s=Xg(n[2],ca);return s.forEach(function(o){e[o].forEach(function(l){var u=Ar(l.meta[1][0].data);u==6e3&&i.sheets.push(lb(e,l))})}),i}function ub(e,t){var r=Jg(),n=en(t.data),i=Xg(n[1],ca);if(i.forEach(function(s){e[s].forEach(function(o){var l=Ar(o.meta[1][0].data);if(l==2){var u=cb(e,o);u.sheets.forEach(function(h,p){Qg(r,h,p==0?u.name:u.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ud(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h;try{h=tb(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var p;try{p=QF(h)}catch(m){return console.log("## "+(m.message||m))}p.forEach(function(m){s[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Ar(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(u){s[u].forEach(function(h){var p=Ar(h.meta[1][0].data)>>>0;if(p==1)if(!l)l=h;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return ub(s,l)}function fb(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function qg(e){fb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function hb(e){return Qo.WS.indexOf(e)>-1?"sheet":e==Qo.CS?"chart":e==Qo.DS?"dialog":e==Qo.MS?"macro":e&&e.length?e:"sheet"}function db(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,hb(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function pb(e,t,r,n,i,s,o,l,u,h,p,m){try{s[n]=zc(Vn(e,r,!0),t);var _=pr(e,t),x;switch(l){case"sheet":x=yF(_,t,i,u,s[n],h,p,m);break;case"chart":if(x=EF(_,t,i,u,s[n],h,p,m),!x||!x["!drawel"])break;var E=wc(x["!drawel"].Target,t),y=Qp(E),A=xO(Vn(e,E,!0),zc(Vn(e,y,!0),E)),C=wc(A,E),k=Qp(C);x=nF(Vn(e,C,!0),C,u,zc(Vn(e,k,!0),C),h,x);break;case"macro":x=TF(_,t,i,u,s[n],h,p,m);break;case"dialog":x=wF(_,t,i,u,s[n],h,p,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=x;var w=[];s&&s[n]&&qi(s[n]).forEach(function(V){var Q="";if(s[n][V].Type==Qo.CMNT){Q=wc(s[n][V].Target,t);var X=CF(pr(e,Q,!0),Q,u);if(!X||!X.length)return;sx(x,X,!1)}s[n][V].Type==Qo.TCMNT&&(Q=wc(s[n][V].Target,t),w=w.concat(EO(pr(e,Q,!0),u)))}),w&&w.length&&sx(x,w,!0,u.people||[])}catch(V){if(u.WTF)throw V}}function ni(e){return e.charAt(0)=="/"?e.slice(1):e}function mb(e,t){if(gT(),t=t||{},qg(t),si(e,"META-INF/manifest.xml")||si(e,"objectdata.xml"))return _x(e,t);if(si(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ud<"u"){if(e.FileIndex)return Ud(e);var r=vt.utils.cfb_new();return Ov(e).forEach(function(Pe){g4(r,Pe,m4(e,Pe))}),Ud(r)}throw new Error("Unsupported NUMBERS file")}if(!si(e,"[Content_Types].xml"))throw si(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):si(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Ov(e),i=fP(Vn(e,"[Content_Types].xml")),s=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",pr(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!pr(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},h={};if(!t.bookSheets&&!t.bookProps){if(Wc=[],i.sst)try{Wc=IF(pr(e,ni(i.sst)),i.sst,t)}catch(Pe){if(t.WTF)throw Pe}t.cellStyles&&i.themes.length&&(u=SF(Vn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(h=AF(pr(e,ni(i.style)),i.style,u,t))}i.links.map(function(Pe){try{var ke=zc(Vn(e,Qp(ni(Pe))),Pe);return RF(pr(e,ni(Pe)),ke,Pe,t)}catch{}});var p=xF(pr(e,ni(i.workbooks[0])),i.workbooks[0],t),m={},_="";i.coreprops.length&&(_=pr(e,ni(i.coreprops[0]),!0),_&&(m=GT(_)),i.extprops.length!==0&&(_=pr(e,ni(i.extprops[0]),!0),_&&gP(_,m,t)));var x={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(_=Vn(e,ni(i.custprops[0]),!0),_&&(x=vP(_,t)));var E={};if((t.bookSheets||t.bookProps)&&(p.Sheets?o=p.Sheets.map(function(ke){return ke.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(E.Props=m,E.Custprops=x),t.bookSheets&&typeof o<"u"&&(E.SheetNames=o),t.bookSheets?E.SheetNames:t.bookProps))return E;o={};var y={};t.bookDeps&&i.calcchain&&(y=kF(pr(e,ni(i.calcchain)),i.calcchain));var A=0,C={},k,w;{var V=p.Sheets;m.Worksheets=V.length,m.SheetNames=[];for(var Q=0;Q!=V.length;++Q)m.SheetNames[Q]=V[Q].name}var X=s?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),R=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");si(e,R)||(R="xl/_rels/workbook."+X+".rels");var P=zc(Vn(e,R,!0),R.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=PF(pr(e,ni(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=TO(pr(e,ni(i.people[0])),t)),P&&(P=db(P,p.Sheets));var D=pr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(A=0;A!=m.Worksheets;++A){var F="sheet";if(P&&P[A]?(k="xl/"+P[A][1].replace(/[\/]?xl\//,""),si(e,k)||(k=P[A][1]),si(e,k)||(k=R.replace(/_rels\/.*$/,"")+P[A][1]),F=P[A][2]):(k="xl/worksheets/sheet"+(A+1-D)+"."+X,k=k.replace(/sheet0\./,"sheet.")),w=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(A!=t.sheets)continue e;break;case"string":if(m.SheetNames[A].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var b=!1,M=0;M!=t.sheets.length;++M)typeof t.sheets[M]=="number"&&t.sheets[M]==A&&(b=1),typeof t.sheets[M]=="string"&&t.sheets[M].toLowerCase()==m.SheetNames[A].toLowerCase()&&(b=1);if(!b)continue e}}pb(e,k,w,m.SheetNames[A],A,C,o,F,t,p,u,h)}return E={Directory:i,Workbook:p,Props:m,Custprops:x,Deps:y,Sheets:o,SheetNames:m.SheetNames,Strings:Wc,Styles:h,Themes:u,SSF:Vr(at)},t&&t.bookFiles&&(e.files?(E.keys=n,E.files=e.files):(E.keys=[],E.files={},e.FullPaths.forEach(function(Pe,ke){Pe=Pe.replace(/^Root Entry[\/]/,""),E.keys.push(Pe),E.files[Pe]=e.FileIndex[ke]}))),t&&t.bookVBA&&(i.vba.length>0?E.vbaraw=pr(e,ni(i.vba[0]),!0):i.defaults&&i.defaults.bin===IO&&(E.vbaraw=pr(e,"xl/vbaProject.bin",!0))),E}function gb(e,t){var r=t||{},n="Workbook",i=vt.find(e,n);try{if(n="/!DataSpaces/Version",i=vt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l3(i.content),n="/!DataSpaces/DataSpaceMap",i=vt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=u3(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=vt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=f3(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=vt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);d3(i.content)}catch{}if(n="/EncryptionInfo",i=vt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=p3(i.content);if(n="/EncryptedPackage",i=vt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Yg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=$n(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function _b(e,t){return vt.find(e,"EncryptedPackage")?gb(e,t):Rw(e,t)}function vb(e,t){var r,n=e,i=t||{};return i.type||(i.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),r=TT(n,i),mb(r,i)}function Lw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return rm(e.slice(r),t);default:break e}return Eu.to_workbook(e,t)}function xb(e,t){var r="",n=Yg(e,t);switch(t.type){case"base64":r=$n(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ya(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ut(r)),t.type="binary",Lw(r,t)}function yb(e,t){var r=e;return t.type=="base64"&&(r=$n(r)),r=_u.utils.decode(1200,r.slice(2),"str"),t.type="binary",Lw(r,t)}function Eb(e){return e.match(/[^\x00-\x7F]/)?Ac(e):e}function Vd(e,t,r,n){return n?(r.type="string",Eu.to_workbook(e,r)):Eu.to_workbook(t,r)}function am(e,t){iT();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return am(new Uint8Array(e),(r=Vr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),cl={},r.dateNF&&(cl.dateNF=r.dateNF),r.type||(r.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=pt?"buffer":"binary",n=l4(e),typeof Uint8Array<"u"&&!pt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Eb(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Vr(r),r.type="array",am(Rg(n),r)}switch((i=Yg(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return _b(vt.read(n,r),r);break;case 9:if(i[1]<=8)return Rw(n,r);break;case 60:return rm(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return XN(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return ZN.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?vb(n,r):Vd(e,n,r,s);case 239:return i[3]===60?rm(n,r):Vd(e,n,r,s);case 255:if(i[1]===254)return yb(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Hc.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Hc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ix.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return I3.to_workbook(n,r);break;case 10:case 13:case 32:return xb(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return GN.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?ix.to_workbook(n,r):Vd(e,n,r,s)}function Tb(e,t,r,n,i,s,o,l){var u=zr(r),h=l.defval,p=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,_=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!o||e[r])for(var x=t.s.c;x<=t.e.c;++x){var E=o?e[r][x]:e[n[x]+u];if(E===void 0||E.t===void 0){if(h===void 0)continue;s[x]!=null&&(_[s[x]]=h);continue}var y=E.v;switch(E.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(s[x]!=null){if(y==null)if(E.t=="e"&&y===null)_[s[x]]=null;else if(h!==void 0)_[s[x]]=h;else if(p&&y===null)_[s[x]]=null;else continue;else _[s[x]]=p&&(E.t!=="n"||E.t==="n"&&l.rawNumbers!==!1)?y:Ss(E,y,l);y!=null&&(m=!1)}}return{row:_,isempty:m}}function om(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof p){case"string":u=nr(p);break;case"number":u=nr(e["!ref"]),u.s.r=p;break;default:u=p}n>0&&(i=0);var m=zr(u.s.r),_=[],x=[],E=0,y=0,A=Array.isArray(e),C=u.s.r,k=0,w={};A&&!e[C]&&(e[C]=[]);var V=h.skipHidden&&e["!cols"]||[],Q=h.skipHidden&&e["!rows"]||[];for(k=u.s.c;k<=u.e.c;++k)if(!(V[k]||{}).hidden)switch(_[k]=Tr(k),r=A?e[C][k]:e[_[k]+m],n){case 1:s[k]=k-u.s.c;break;case 2:s[k]=_[k];break;case 3:s[k]=h.header[k-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Ss(r,null,h),y=w[o]||0,!y)w[o]=1;else{do l=o+"_"+y++;while(w[l]);w[o]=y,w[l]=1}s[k]=l}for(C=u.s.r+i;C<=u.e.r;++C)if(!(Q[C]||{}).hidden){var X=Tb(e,u,C,_,n,s,A,h);(X.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(x[E++]=X.row)}return x.length=E,x}var Ex=/"/g;function wb(e,t,r,n,i,s,o,l){for(var u=!0,h=[],p="",m=zr(r),_=t.s.c;_<=t.e.c;++_)if(n[_]){var x=l.dense?(e[r]||[])[_]:e[n[_]+m];if(x==null)p="";else if(x.v!=null){u=!1,p=""+(l.rawNumbers&&x.t=="n"?x.v:Ss(x,null,l));for(var E=0,y=0;E!==p.length;++E)if((y=p.charCodeAt(E))===i||y===s||y===34||l.forceQuotes){p='"'+p.replace(Ex,'""')+'"';break}p=="ID"&&(p='"ID"')}else x.f!=null&&!x.F?(u=!1,p="="+x.f,p.indexOf(",")>=0&&(p='"'+p.replace(Ex,'""')+'"')):p="";h.push(p)}return l.blankrows===!1&&u?null:h.join(o)}function Dw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=nr(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,u=l.charCodeAt(0),h=new RegExp((s=="|"?"\\|":s)+"+$"),p="",m=[];n.dense=Array.isArray(e);for(var _=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(_[E]||{}).hidden||(m[E]=Tr(E));for(var y=0,A=i.s.r;A<=i.e.r;++A)(x[A]||{}).hidden||(p=wb(e,i,A,m,o,u,s,n),p!=null&&(n.strip&&(p=p.replace(h,"")),(p||n.blankrows!==!1)&&r.push((y++?l:"")+p)));return delete n.dense,r.join("")}function Ab(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Dw(e,t);return r}function Sb(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=nr(e["!ref"]),s="",o=[],l,u=[],h=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=Tr(l);for(var p=i.s.r;p<=i.e.r;++p)for(s=zr(p),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+s,r=h?(e[p]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function Fw(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?dn(n.origin):n.origin;o=u.r,l=u.c}var h,p={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var m=nr(s["!ref"]);p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),o==-1&&(o=m.e.r+1,p.e.r=o+t.length-1+i)}else o==-1&&(o=0,p.e.r=t.length-1+i);var _=n.header||[],x=0;t.forEach(function(y,A){qi(y).forEach(function(C){(x=_.indexOf(C))==-1&&(_[x=_.length]=C);var k=y[C],w="z",V="",Q=tt({c:l+x,r:o+A+i});h=Su(s,Q),k&&typeof k=="object"&&!(k instanceof Date)?s[Q]=k:(typeof k=="number"?w="n":typeof k=="boolean"?w="b":typeof k=="string"?w="s":k instanceof Date?(w="d",n.cellDates||(w="n",k=gn(k)),V=n.dateNF||at[14]):k===null&&n.nullError&&(w="e",k=0),h?(h.t=w,h.v=k,delete h.w,delete h.R,V&&(h.z=V)):s[Q]=h={t:w,v:k},V&&(h.z=V))})}),p.e.c=Math.max(p.e.c,l+_.length-1);var E=zr(o);if(i)for(x=0;x<_.length;++x)s[Tr(x+l)+E]={t:"s",v:_[x]};return s["!ref"]=xt(p),s}function Ib(e,t){return Fw(null,e,t)}function Su(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=dn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Su(e,tt(t)):Su(e,tt({r:t,c:r||0}))}function Cb(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Jg(){return{SheetNames:[],Sheets:{}}}function Qg(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(fF(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function kb(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Cb(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Rb(e,t){return e.z=t,e}function bw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Pb(e,t,r){return bw(e,"#"+t,r)}function Nb(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Ob(e,t,r,n){for(var i=typeof t!="string"?t:nr(t),s=typeof t=="string"?t:xt(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var u=Su(e,o,l);u.t="n",u.F=s,delete u.v,o==i.s.r&&l==i.s.c&&(u.f=r,n&&(u.D=!0))}return e}var Lb={encode_col:Tr,encode_row:zr,encode_cell:tt,encode_range:xt,decode_col:Bg,decode_row:Mg,split_cell:W4,decode_cell:dn,decode_range:Dl,format_cell:Ss,sheet_add_aoa:VT,sheet_add_json:Fw,sheet_add_dom:Pw,aoa_to_sheet:Fl,json_to_sheet:Ib,table_to_sheet:Nw,table_to_book:XF,sheet_to_csv:Dw,sheet_to_txt:Ab,sheet_to_json:om,sheet_to_html:KF,sheet_to_formulae:Sb,sheet_to_row_object_array:om,sheet_get_cell:Su,book_new:Jg,book_append_sheet:Qg,book_set_sheet_visibility:kb,cell_set_number_format:Rb,cell_set_hyperlink:bw,cell_set_internal_link:Pb,cell_add_comment:Nb,sheet_set_array_formula:Ob,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Tx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=i&63|128):(i&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=i&63|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=i&63|128)}return t},Db=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[r++];t[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[r++],o=e[r++],l=e[r++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;t[n++]=String.fromCharCode(55296+(u>>10)),t[n++]=String.fromCharCode(56320+(u&1023))}else{const s=e[r++],o=e[r++];t[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},Bw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<e.length;i+=3){const s=e[i],o=i+1<e.length,l=o?e[i+1]:0,u=i+2<e.length,h=u?e[i+2]:0,p=s>>2,m=(s&3)<<4|l>>4;let _=(l&15)<<2|h>>6,x=h&63;u||(x=64,o||(_=64)),n.push(r[p],r[m],r[_],r[x])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Mw(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Db(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<e.length;){const s=r[e.charAt(i++)],l=i<e.length?r[e.charAt(i)]:0;++i;const h=i<e.length?r[e.charAt(i)]:64;++i;const m=i<e.length?r[e.charAt(i)]:64;if(++i,s==null||l==null||h==null||m==null)throw new Fb;const _=s<<2|l>>4;if(n.push(_),h!==64){const x=l<<4&240|h>>2;if(n.push(x),m!==64){const E=h<<6&192|m;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Fb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bb=function(e){const t=Mw(e);return Bw.encodeByteArray(t,!0)},qh=function(e){return bb(e).replace(/\./g,"")},Mb=function(e){try{return Bw.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub=()=>Bb().__FIREBASE_DEFAULTS__,Vb=()=>{if(typeof process>"u"||typeof Tx>"u")return;const e=Tx.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},zb=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Mb(e[1]);return t&&JSON.parse(t)},e_=()=>{try{return Ub()||Vb()||zb()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},jb=e=>{var t,r;return(r=(t=e_())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},Hb=e=>{const t=jb(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},Uw=()=>{var e;return(e=e_())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[qh(JSON.stringify(r)),qh(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $b(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Zb(){var e;const t=(e=e_())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Kb(){return!Zb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Xb(){try{return typeof indexedDB=="object"}catch{return!1}}function qb(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb="FirebaseError";class bl extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=Yb,Object.setPrototypeOf(this,bl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Vw.prototype.create)}}class Vw{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?Jb(s,n):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new bl(i,l,n)}}function Jb(e,t){return e.replace(Qb,(r,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const Qb=/\{\$([^}]+)}/g;function lm(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const i of r){if(!n.includes(i))return!1;const s=e[i],o=t[i];if(wx(s)&&wx(o)){if(!lm(s,o))return!1}else if(s!==o)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function wx(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(e){return e&&e._delegate?e._delegate:e}class Iu{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new Wb;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(r6(t))try{this.getOrInitializeService({instanceIdentifier:Na})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(t=Na){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Na){return this.instances.has(t)}getOptions(t=Na){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(i)}return i}onInit(t,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&t(o,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:t6(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=Na){return this.component?this.component.multipleInstances?t:Na:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function t6(e){return e===Na?void 0:e}function r6(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new e6(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Et||(Et={}));const i6={debug:Et.DEBUG,verbose:Et.VERBOSE,info:Et.INFO,warn:Et.WARN,error:Et.ERROR,silent:Et.SILENT},s6=Et.INFO,a6={[Et.DEBUG]:"log",[Et.VERBOSE]:"log",[Et.INFO]:"info",[Et.WARN]:"warn",[Et.ERROR]:"error"},o6=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),i=a6[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class zw{constructor(t){this.name=t,this._logLevel=s6,this._logHandler=o6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Et))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?i6[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Et.DEBUG,...t),this._logHandler(this,Et.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Et.VERBOSE,...t),this._logHandler(this,Et.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Et.INFO,...t),this._logHandler(this,Et.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Et.WARN,...t),this._logHandler(this,Et.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Et.ERROR,...t),this._logHandler(this,Et.ERROR,...t)}}const l6=(e,t)=>t.some(r=>e instanceof r);let Ax,Sx;function c6(){return Ax||(Ax=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function u6(){return Sx||(Sx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jw=new WeakMap,cm=new WeakMap,Hw=new WeakMap,zd=new WeakMap,t_=new WeakMap;function f6(e){const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{r(ua(e.result)),i()},o=()=>{n(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(r=>{r instanceof IDBCursor&&jw.set(r,e)}).catch(()=>{}),t_.set(t,e),t}function h6(e){if(cm.has(e))return;const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{r(),i()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});cm.set(e,t)}let um={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return cm.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Hw.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ua(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function d6(e){um=e(um)}function p6(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(jd(this),t,...r);return Hw.set(n,t.sort?t.sort():[t]),ua(n)}:u6().includes(e)?function(...t){return e.apply(jd(this),t),ua(jw.get(this))}:function(...t){return ua(e.apply(jd(this),t))}}function m6(e){return typeof e=="function"?p6(e):(e instanceof IDBTransaction&&h6(e),l6(e,c6())?new Proxy(e,um):e)}function ua(e){if(e instanceof IDBRequest)return f6(e);if(zd.has(e))return zd.get(e);const t=m6(e);return t!==e&&(zd.set(e,t),t_.set(t,e)),t}const jd=e=>t_.get(e);function g6(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),l=ua(o);return n&&o.addEventListener("upgradeneeded",u=>{n(ua(o.result),u.oldVersion,u.newVersion,ua(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const _6=["get","getKey","getAll","getAllKeys","count"],v6=["put","add","delete","clear"],Hd=new Map;function Ix(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Hd.get(t))return Hd.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=v6.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||_6.includes(r)))return;const s=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(l.shift())),(await Promise.all([h[r](...l),i&&u.done]))[0]};return Hd.set(t,s),s}d6(e=>({...e,get:(t,r,n)=>Ix(t,r)||e.get(t,r,n),has:(t,r)=>!!Ix(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(y6(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function y6(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const fm="@firebase/app",Cx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs=new zw("@firebase/app"),E6="@firebase/app-compat",T6="@firebase/analytics-compat",w6="@firebase/analytics",A6="@firebase/app-check-compat",S6="@firebase/app-check",I6="@firebase/auth",C6="@firebase/auth-compat",k6="@firebase/database",R6="@firebase/data-connect",P6="@firebase/database-compat",N6="@firebase/functions",O6="@firebase/functions-compat",L6="@firebase/installations",D6="@firebase/installations-compat",F6="@firebase/messaging",b6="@firebase/messaging-compat",M6="@firebase/performance",B6="@firebase/performance-compat",U6="@firebase/remote-config",V6="@firebase/remote-config-compat",z6="@firebase/storage",j6="@firebase/storage-compat",H6="@firebase/firestore",W6="@firebase/vertexai-preview",G6="@firebase/firestore-compat",$6="firebase",Z6="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hm="[DEFAULT]",K6={[fm]:"fire-core",[E6]:"fire-core-compat",[w6]:"fire-analytics",[T6]:"fire-analytics-compat",[S6]:"fire-app-check",[A6]:"fire-app-check-compat",[I6]:"fire-auth",[C6]:"fire-auth-compat",[k6]:"fire-rtdb",[R6]:"fire-data-connect",[P6]:"fire-rtdb-compat",[N6]:"fire-fn",[O6]:"fire-fn-compat",[L6]:"fire-iid",[D6]:"fire-iid-compat",[F6]:"fire-fcm",[b6]:"fire-fcm-compat",[M6]:"fire-perf",[B6]:"fire-perf-compat",[U6]:"fire-rc",[V6]:"fire-rc-compat",[z6]:"fire-gcs",[j6]:"fire-gcs-compat",[H6]:"fire-fst",[G6]:"fire-fst-compat",[W6]:"fire-vertex","fire-js":"fire-js",[$6]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh=new Map,X6=new Map,dm=new Map;function kx(e,t){try{e.container.addComponent(t)}catch(r){Cs.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function Jh(e){const t=e.name;if(dm.has(t))return Cs.debug(`There were multiple attempts to register component ${t}.`),!1;dm.set(t,e);for(const r of Yh.values())kx(r,e);for(const r of X6.values())kx(r,e);return!0}function q6(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fa=new Vw("app","Firebase",Y6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Iu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw fa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6=Z6;function Ww(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:hm,automaticDataCollectionEnabled:!1},t),i=n.name;if(typeof i!="string"||!i)throw fa.create("bad-app-name",{appName:String(i)});if(r||(r=Uw()),!r)throw fa.create("no-options");const s=Yh.get(i);if(s){if(lm(r,s.options)&&lm(n,s.config))return s;throw fa.create("duplicate-app",{appName:i})}const o=new n6(i);for(const u of dm.values())o.addComponent(u);const l=new J6(r,n,o);return Yh.set(i,l),l}function eM(e=hm){const t=Yh.get(e);if(!t&&e===hm&&Uw())return Ww();if(!t)throw fa.create("no-app",{appName:e});return t}function ul(e,t,r){var n;let i=(n=K6[e])!==null&&n!==void 0?n:e;r&&(i+=`-${r}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${t}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Cs.warn(l.join(" "));return}Jh(new Iu(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM="firebase-heartbeat-database",rM=1,Cu="firebase-heartbeat-store";let Wd=null;function Gw(){return Wd||(Wd=g6(tM,rM,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Cu)}catch(r){console.warn(r)}}}}).catch(e=>{throw fa.create("idb-open",{originalErrorMessage:e.message})})),Wd}async function nM(e){try{const r=(await Gw()).transaction(Cu),n=await r.objectStore(Cu).get($w(e));return await r.done,n}catch(t){if(t instanceof bl)Cs.warn(t.message);else{const r=fa.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Cs.warn(r.message)}}}async function Rx(e,t){try{const n=(await Gw()).transaction(Cu,"readwrite");await n.objectStore(Cu).put(t,$w(e)),await n.done}catch(r){if(r instanceof bl)Cs.warn(r.message);else{const n=fa.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Cs.warn(n.message)}}}function $w(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iM=1024,sM=30*24*60*60*1e3;class aM{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new lM(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Px();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=sM}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Cs.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Px(),{heartbeatsToSend:n,unsentEntries:i}=oM(this._heartbeatsCache.heartbeats),s=qh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Cs.warn(r),""}}}function Px(){return new Date().toISOString().substring(0,10)}function oM(e,t=iM){const r=[];let n=e.slice();for(const i of e){const s=r.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Nx(r)>t){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Nx(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class lM{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Xb()?qb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await nM(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Rx(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Rx(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Nx(e){return qh(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(e){Jh(new Iu("platform-logger",t=>new x6(t),"PRIVATE")),Jh(new Iu("heartbeat",t=>new aM(t),"PRIVATE")),ul(fm,Cx,e),ul(fm,Cx,"esm2017"),ul("fire-js","")}cM("");var uM="firebase",fM="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ul(uM,fM,"app");var Ox=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ha,Zw;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(S,R){function P(){}P.prototype=R.prototype,S.D=R.prototype,S.prototype=new P,S.prototype.constructor=S,S.C=function(D,F,b){for(var M=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)M[Pe-2]=arguments[Pe];return R.prototype[F].apply(D,M)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,R,P){P||(P=0);var D=Array(16);if(typeof R=="string")for(var F=0;16>F;++F)D[F]=R.charCodeAt(P++)|R.charCodeAt(P++)<<8|R.charCodeAt(P++)<<16|R.charCodeAt(P++)<<24;else for(F=0;16>F;++F)D[F]=R[P++]|R[P++]<<8|R[P++]<<16|R[P++]<<24;R=S.g[0],P=S.g[1],F=S.g[2];var b=S.g[3],M=R+(b^P&(F^b))+D[0]+3614090360&4294967295;R=P+(M<<7&4294967295|M>>>25),M=b+(F^R&(P^F))+D[1]+3905402710&4294967295,b=R+(M<<12&4294967295|M>>>20),M=F+(P^b&(R^P))+D[2]+606105819&4294967295,F=b+(M<<17&4294967295|M>>>15),M=P+(R^F&(b^R))+D[3]+3250441966&4294967295,P=F+(M<<22&4294967295|M>>>10),M=R+(b^P&(F^b))+D[4]+4118548399&4294967295,R=P+(M<<7&4294967295|M>>>25),M=b+(F^R&(P^F))+D[5]+1200080426&4294967295,b=R+(M<<12&4294967295|M>>>20),M=F+(P^b&(R^P))+D[6]+2821735955&4294967295,F=b+(M<<17&4294967295|M>>>15),M=P+(R^F&(b^R))+D[7]+4249261313&4294967295,P=F+(M<<22&4294967295|M>>>10),M=R+(b^P&(F^b))+D[8]+1770035416&4294967295,R=P+(M<<7&4294967295|M>>>25),M=b+(F^R&(P^F))+D[9]+2336552879&4294967295,b=R+(M<<12&4294967295|M>>>20),M=F+(P^b&(R^P))+D[10]+4294925233&4294967295,F=b+(M<<17&4294967295|M>>>15),M=P+(R^F&(b^R))+D[11]+2304563134&4294967295,P=F+(M<<22&4294967295|M>>>10),M=R+(b^P&(F^b))+D[12]+1804603682&4294967295,R=P+(M<<7&4294967295|M>>>25),M=b+(F^R&(P^F))+D[13]+4254626195&4294967295,b=R+(M<<12&4294967295|M>>>20),M=F+(P^b&(R^P))+D[14]+2792965006&4294967295,F=b+(M<<17&4294967295|M>>>15),M=P+(R^F&(b^R))+D[15]+1236535329&4294967295,P=F+(M<<22&4294967295|M>>>10),M=R+(F^b&(P^F))+D[1]+4129170786&4294967295,R=P+(M<<5&4294967295|M>>>27),M=b+(P^F&(R^P))+D[6]+3225465664&4294967295,b=R+(M<<9&4294967295|M>>>23),M=F+(R^P&(b^R))+D[11]+643717713&4294967295,F=b+(M<<14&4294967295|M>>>18),M=P+(b^R&(F^b))+D[0]+3921069994&4294967295,P=F+(M<<20&4294967295|M>>>12),M=R+(F^b&(P^F))+D[5]+3593408605&4294967295,R=P+(M<<5&4294967295|M>>>27),M=b+(P^F&(R^P))+D[10]+38016083&4294967295,b=R+(M<<9&4294967295|M>>>23),M=F+(R^P&(b^R))+D[15]+3634488961&4294967295,F=b+(M<<14&4294967295|M>>>18),M=P+(b^R&(F^b))+D[4]+3889429448&4294967295,P=F+(M<<20&4294967295|M>>>12),M=R+(F^b&(P^F))+D[9]+568446438&4294967295,R=P+(M<<5&4294967295|M>>>27),M=b+(P^F&(R^P))+D[14]+3275163606&4294967295,b=R+(M<<9&4294967295|M>>>23),M=F+(R^P&(b^R))+D[3]+4107603335&4294967295,F=b+(M<<14&4294967295|M>>>18),M=P+(b^R&(F^b))+D[8]+1163531501&4294967295,P=F+(M<<20&4294967295|M>>>12),M=R+(F^b&(P^F))+D[13]+2850285829&4294967295,R=P+(M<<5&4294967295|M>>>27),M=b+(P^F&(R^P))+D[2]+4243563512&4294967295,b=R+(M<<9&4294967295|M>>>23),M=F+(R^P&(b^R))+D[7]+1735328473&4294967295,F=b+(M<<14&4294967295|M>>>18),M=P+(b^R&(F^b))+D[12]+2368359562&4294967295,P=F+(M<<20&4294967295|M>>>12),M=R+(P^F^b)+D[5]+4294588738&4294967295,R=P+(M<<4&4294967295|M>>>28),M=b+(R^P^F)+D[8]+2272392833&4294967295,b=R+(M<<11&4294967295|M>>>21),M=F+(b^R^P)+D[11]+1839030562&4294967295,F=b+(M<<16&4294967295|M>>>16),M=P+(F^b^R)+D[14]+4259657740&4294967295,P=F+(M<<23&4294967295|M>>>9),M=R+(P^F^b)+D[1]+2763975236&4294967295,R=P+(M<<4&4294967295|M>>>28),M=b+(R^P^F)+D[4]+1272893353&4294967295,b=R+(M<<11&4294967295|M>>>21),M=F+(b^R^P)+D[7]+4139469664&4294967295,F=b+(M<<16&4294967295|M>>>16),M=P+(F^b^R)+D[10]+3200236656&4294967295,P=F+(M<<23&4294967295|M>>>9),M=R+(P^F^b)+D[13]+681279174&4294967295,R=P+(M<<4&4294967295|M>>>28),M=b+(R^P^F)+D[0]+3936430074&4294967295,b=R+(M<<11&4294967295|M>>>21),M=F+(b^R^P)+D[3]+3572445317&4294967295,F=b+(M<<16&4294967295|M>>>16),M=P+(F^b^R)+D[6]+76029189&4294967295,P=F+(M<<23&4294967295|M>>>9),M=R+(P^F^b)+D[9]+3654602809&4294967295,R=P+(M<<4&4294967295|M>>>28),M=b+(R^P^F)+D[12]+3873151461&4294967295,b=R+(M<<11&4294967295|M>>>21),M=F+(b^R^P)+D[15]+530742520&4294967295,F=b+(M<<16&4294967295|M>>>16),M=P+(F^b^R)+D[2]+3299628645&4294967295,P=F+(M<<23&4294967295|M>>>9),M=R+(F^(P|~b))+D[0]+4096336452&4294967295,R=P+(M<<6&4294967295|M>>>26),M=b+(P^(R|~F))+D[7]+1126891415&4294967295,b=R+(M<<10&4294967295|M>>>22),M=F+(R^(b|~P))+D[14]+2878612391&4294967295,F=b+(M<<15&4294967295|M>>>17),M=P+(b^(F|~R))+D[5]+4237533241&4294967295,P=F+(M<<21&4294967295|M>>>11),M=R+(F^(P|~b))+D[12]+1700485571&4294967295,R=P+(M<<6&4294967295|M>>>26),M=b+(P^(R|~F))+D[3]+2399980690&4294967295,b=R+(M<<10&4294967295|M>>>22),M=F+(R^(b|~P))+D[10]+4293915773&4294967295,F=b+(M<<15&4294967295|M>>>17),M=P+(b^(F|~R))+D[1]+2240044497&4294967295,P=F+(M<<21&4294967295|M>>>11),M=R+(F^(P|~b))+D[8]+1873313359&4294967295,R=P+(M<<6&4294967295|M>>>26),M=b+(P^(R|~F))+D[15]+4264355552&4294967295,b=R+(M<<10&4294967295|M>>>22),M=F+(R^(b|~P))+D[6]+2734768916&4294967295,F=b+(M<<15&4294967295|M>>>17),M=P+(b^(F|~R))+D[13]+1309151649&4294967295,P=F+(M<<21&4294967295|M>>>11),M=R+(F^(P|~b))+D[4]+4149444226&4294967295,R=P+(M<<6&4294967295|M>>>26),M=b+(P^(R|~F))+D[11]+3174756917&4294967295,b=R+(M<<10&4294967295|M>>>22),M=F+(R^(b|~P))+D[2]+718787259&4294967295,F=b+(M<<15&4294967295|M>>>17),M=P+(b^(F|~R))+D[9]+3951481745&4294967295,S.g[0]=S.g[0]+R&4294967295,S.g[1]=S.g[1]+(F+(M<<21&4294967295|M>>>11))&4294967295,S.g[2]=S.g[2]+F&4294967295,S.g[3]=S.g[3]+b&4294967295}n.prototype.u=function(S,R){R===void 0&&(R=S.length);for(var P=R-this.blockSize,D=this.B,F=this.h,b=0;b<R;){if(F==0)for(;b<=P;)i(this,S,b),b+=this.blockSize;if(typeof S=="string"){for(;b<R;)if(D[F++]=S.charCodeAt(b++),F==this.blockSize){i(this,D),F=0;break}}else for(;b<R;)if(D[F++]=S[b++],F==this.blockSize){i(this,D),F=0;break}}this.h=F,this.o+=R},n.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var R=1;R<S.length-8;++R)S[R]=0;var P=8*this.o;for(R=S.length-8;R<S.length;++R)S[R]=P&255,P/=256;for(this.u(S),S=Array(16),R=P=0;4>R;++R)for(var D=0;32>D;D+=8)S[P++]=this.g[R]>>>D&255;return S};function s(S,R){var P=l;return Object.prototype.hasOwnProperty.call(P,S)?P[S]:P[S]=R(S)}function o(S,R){this.h=R;for(var P=[],D=!0,F=S.length-1;0<=F;F--){var b=S[F]|0;D&&b==R||(P[F]=b,D=!1)}this.g=P}var l={};function u(S){return-128<=S&&128>S?s(S,function(R){return new o([R|0],0>R?-1:0)}):new o([S|0],0>S?-1:0)}function h(S){if(isNaN(S)||!isFinite(S))return m;if(0>S)return A(h(-S));for(var R=[],P=1,D=0;S>=P;D++)R[D]=S/P|0,P*=4294967296;return new o(R,0)}function p(S,R){if(S.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(S.charAt(0)=="-")return A(p(S.substring(1),R));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=h(Math.pow(R,8)),D=m,F=0;F<S.length;F+=8){var b=Math.min(8,S.length-F),M=parseInt(S.substring(F,F+b),R);8>b?(b=h(Math.pow(R,b)),D=D.j(b).add(h(M))):(D=D.j(P),D=D.add(h(M)))}return D}var m=u(0),_=u(1),x=u(16777216);e=o.prototype,e.m=function(){if(y(this))return-A(this).m();for(var S=0,R=1,P=0;P<this.g.length;P++){var D=this.i(P);S+=(0<=D?D:4294967296+D)*R,R*=4294967296}return S},e.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(E(this))return"0";if(y(this))return"-"+A(this).toString(S);for(var R=h(Math.pow(S,6)),P=this,D="";;){var F=V(P,R).g;P=C(P,F.j(R));var b=((0<P.g.length?P.g[0]:P.h)>>>0).toString(S);if(P=F,E(P))return b+D;for(;6>b.length;)b="0"+b;D=b+D}},e.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function E(S){if(S.h!=0)return!1;for(var R=0;R<S.g.length;R++)if(S.g[R]!=0)return!1;return!0}function y(S){return S.h==-1}e.l=function(S){return S=C(this,S),y(S)?-1:E(S)?0:1};function A(S){for(var R=S.g.length,P=[],D=0;D<R;D++)P[D]=~S.g[D];return new o(P,~S.h).add(_)}e.abs=function(){return y(this)?A(this):this},e.add=function(S){for(var R=Math.max(this.g.length,S.g.length),P=[],D=0,F=0;F<=R;F++){var b=D+(this.i(F)&65535)+(S.i(F)&65535),M=(b>>>16)+(this.i(F)>>>16)+(S.i(F)>>>16);D=M>>>16,b&=65535,M&=65535,P[F]=M<<16|b}return new o(P,P[P.length-1]&-2147483648?-1:0)};function C(S,R){return S.add(A(R))}e.j=function(S){if(E(this)||E(S))return m;if(y(this))return y(S)?A(this).j(A(S)):A(A(this).j(S));if(y(S))return A(this.j(A(S)));if(0>this.l(x)&&0>S.l(x))return h(this.m()*S.m());for(var R=this.g.length+S.g.length,P=[],D=0;D<2*R;D++)P[D]=0;for(D=0;D<this.g.length;D++)for(var F=0;F<S.g.length;F++){var b=this.i(D)>>>16,M=this.i(D)&65535,Pe=S.i(F)>>>16,ke=S.i(F)&65535;P[2*D+2*F]+=M*ke,k(P,2*D+2*F),P[2*D+2*F+1]+=b*ke,k(P,2*D+2*F+1),P[2*D+2*F+1]+=M*Pe,k(P,2*D+2*F+1),P[2*D+2*F+2]+=b*Pe,k(P,2*D+2*F+2)}for(D=0;D<R;D++)P[D]=P[2*D+1]<<16|P[2*D];for(D=R;D<2*R;D++)P[D]=0;return new o(P,0)};function k(S,R){for(;(S[R]&65535)!=S[R];)S[R+1]+=S[R]>>>16,S[R]&=65535,R++}function w(S,R){this.g=S,this.h=R}function V(S,R){if(E(R))throw Error("division by zero");if(E(S))return new w(m,m);if(y(S))return R=V(A(S),R),new w(A(R.g),A(R.h));if(y(R))return R=V(S,A(R)),new w(A(R.g),R.h);if(30<S.g.length){if(y(S)||y(R))throw Error("slowDivide_ only works with positive integers.");for(var P=_,D=R;0>=D.l(S);)P=Q(P),D=Q(D);var F=X(P,1),b=X(D,1);for(D=X(D,2),P=X(P,2);!E(D);){var M=b.add(D);0>=M.l(S)&&(F=F.add(P),b=M),D=X(D,1),P=X(P,1)}return R=C(S,F.j(R)),new w(F,R)}for(F=m;0<=S.l(R);){for(P=Math.max(1,Math.floor(S.m()/R.m())),D=Math.ceil(Math.log(P)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),b=h(P),M=b.j(R);y(M)||0<M.l(S);)P-=D,b=h(P),M=b.j(R);E(b)&&(b=_),F=F.add(b),S=C(S,M)}return new w(F,S)}e.A=function(S){return V(this,S).h},e.and=function(S){for(var R=Math.max(this.g.length,S.g.length),P=[],D=0;D<R;D++)P[D]=this.i(D)&S.i(D);return new o(P,this.h&S.h)},e.or=function(S){for(var R=Math.max(this.g.length,S.g.length),P=[],D=0;D<R;D++)P[D]=this.i(D)|S.i(D);return new o(P,this.h|S.h)},e.xor=function(S){for(var R=Math.max(this.g.length,S.g.length),P=[],D=0;D<R;D++)P[D]=this.i(D)^S.i(D);return new o(P,this.h^S.h)};function Q(S){for(var R=S.g.length+1,P=[],D=0;D<R;D++)P[D]=S.i(D)<<1|S.i(D-1)>>>31;return new o(P,S.h)}function X(S,R){var P=R>>5;R%=32;for(var D=S.g.length-P,F=[],b=0;b<D;b++)F[b]=0<R?S.i(b+P)>>>R|S.i(b+P+1)<<32-R:S.i(b+P);return new o(F,S.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Zw=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=p,Ha=o}).apply(typeof Ox<"u"?Ox:typeof self<"u"?self:typeof window<"u"?window:{});var $f=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Kw,Sc,Xw,lh,pm,qw,Yw,Jw;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,v,I){return f==Array.prototype||f==Object.prototype||(f[v]=I.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof $f=="object"&&$f];for(var v=0;v<f.length;++v){var I=f[v];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var n=r(this);function i(f,v){if(v)e:{var I=n;f=f.split(".");for(var B=0;B<f.length-1;B++){var ie=f[B];if(!(ie in I))break e;I=I[ie]}f=f[f.length-1],B=I[f],v=v(B),v!=B&&v!=null&&t(I,f,{configurable:!0,writable:!0,value:v})}}function s(f,v){f instanceof String&&(f+="");var I=0,B=!1,ie={next:function(){if(!B&&I<f.length){var pe=I++;return{value:v(pe,f[pe]),done:!1}}return B=!0,{done:!0,value:void 0}}};return ie[Symbol.iterator]=function(){return ie},ie}i("Array.prototype.values",function(f){return f||function(){return s(this,function(v,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(f){var v=typeof f;return v=v!="object"?v:f?Array.isArray(f)?"array":v:"null",v=="array"||v=="object"&&typeof f.length=="number"}function h(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function p(f,v,I){return f.call.apply(f.bind,arguments)}function m(f,v,I){if(!f)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var ie=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ie,B),f.apply(v,ie)}}return function(){return f.apply(v,arguments)}}function _(f,v,I){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,_.apply(null,arguments)}function x(f,v){var I=Array.prototype.slice.call(arguments,1);return function(){var B=I.slice();return B.push.apply(B,arguments),f.apply(this,B)}}function E(f,v){function I(){}I.prototype=v.prototype,f.aa=v.prototype,f.prototype=new I,f.prototype.constructor=f,f.Qb=function(B,ie,pe){for(var De=Array(arguments.length-2),kt=2;kt<arguments.length;kt++)De[kt-2]=arguments[kt];return v.prototype[ie].apply(B,De)}}function y(f){const v=f.length;if(0<v){const I=Array(v);for(let B=0;B<v;B++)I[B]=f[B];return I}return[]}function A(f,v){for(let I=1;I<arguments.length;I++){const B=arguments[I];if(u(B)){const ie=f.length||0,pe=B.length||0;f.length=ie+pe;for(let De=0;De<pe;De++)f[ie+De]=B[De]}else f.push(B)}}class C{constructor(v,I){this.i=v,this.j=I,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function k(f){return/^[\s\xa0]*$/.test(f)}function w(){var f=l.navigator;return f&&(f=f.userAgent)?f:""}function V(f){return V[" "](f),f}V[" "]=function(){};var Q=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function X(f,v,I){for(const B in f)v.call(I,f[B],B,f)}function S(f,v){for(const I in f)v.call(void 0,f[I],I,f)}function R(f){const v={};for(const I in f)v[I]=f[I];return v}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(f,v){let I,B;for(let ie=1;ie<arguments.length;ie++){B=arguments[ie];for(I in B)f[I]=B[I];for(let pe=0;pe<P.length;pe++)I=P[pe],Object.prototype.hasOwnProperty.call(B,I)&&(f[I]=B[I])}}function F(f){var v=1;f=f.split(":");const I=[];for(;0<v&&f.length;)I.push(f.shift()),v--;return f.length&&I.push(f.join(":")),I}function b(f){l.setTimeout(()=>{throw f},0)}function M(){var f=te;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class Pe{constructor(){this.h=this.g=null}add(v,I){const B=ke.get();B.set(v,I),this.h?this.h.next=B:this.g=B,this.h=B}}var ke=new C(()=>new Ne,f=>f.reset());class Ne{constructor(){this.next=this.g=this.h=null}set(v,I){this.h=v,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let Oe,ue=!1,te=new Pe,de=()=>{const f=l.Promise.resolve(void 0);Oe=()=>{f.then(Ae)}};var Ae=()=>{for(var f;f=M();){try{f.h.call(f.g)}catch(I){b(I)}var v=ke;v.j(f),100>v.h&&(v.h++,f.next=v.g,v.g=f)}ue=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var J=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const I=()=>{};l.addEventListener("test",I,v),l.removeEventListener("test",I,v)}catch{}return f}();function q(f,v){if(H.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var I=this.type=f.type,B=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget){if(Q){e:{try{V(v.nodeName);var ie=!0;break e}catch{}ie=!1}ie||(v=null)}}else I=="mouseover"?v=f.fromElement:I=="mouseout"&&(v=f.toElement);this.relatedTarget=v,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:re[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&q.aa.h.call(this)}}E(q,H);var re={2:"touch",3:"pen",4:"mouse"};q.prototype.h=function(){q.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ge="closure_listenable_"+(1e6*Math.random()|0),ye=0;function Se(f,v,I,B,ie){this.listener=f,this.proxy=null,this.src=v,this.type=I,this.capture=!!B,this.ha=ie,this.key=++ye,this.da=this.fa=!1}function ve(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Ye(f){this.src=f,this.g={},this.h=0}Ye.prototype.add=function(f,v,I,B,ie){var pe=f.toString();f=this.g[pe],f||(f=this.g[pe]=[],this.h++);var De=yt(f,v,B,ie);return-1<De?(v=f[De],I||(v.fa=!1)):(v=new Se(v,this.src,pe,!!B,ie),v.fa=I,f.push(v)),v};function Y(f,v){var I=v.type;if(I in f.g){var B=f.g[I],ie=Array.prototype.indexOf.call(B,v,void 0),pe;(pe=0<=ie)&&Array.prototype.splice.call(B,ie,1),pe&&(ve(v),f.g[I].length==0&&(delete f.g[I],f.h--))}}function yt(f,v,I,B){for(var ie=0;ie<f.length;++ie){var pe=f[ie];if(!pe.da&&pe.listener==v&&pe.capture==!!I&&pe.ha==B)return ie}return-1}var He="closure_lm_"+(1e6*Math.random()|0),ot={};function ne(f,v,I,B,ie){if(Array.isArray(v)){for(var pe=0;pe<v.length;pe++)ne(f,v[pe],I,B,ie);return null}return I=Dr(I),f&&f[ge]?f.K(v,I,h(B)?!!B.capture:!1,ie):fe(f,v,I,!1,B,ie)}function fe(f,v,I,B,ie,pe){if(!v)throw Error("Invalid event type");var De=h(ie)?!!ie.capture:!!ie,kt=ir(f);if(kt||(f[He]=kt=new Ye(f)),I=kt.add(v,I,B,De,pe),I.proxy)return I;if(B=be(),I.proxy=B,B.src=f,B.listener=I,f.addEventListener)J||(ie=De),ie===void 0&&(ie=!1),f.addEventListener(v.toString(),B,ie);else if(f.attachEvent)f.attachEvent(mt(v.toString()),B);else if(f.addListener&&f.removeListener)f.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return I}function be(){function f(I){return v.call(f.src,f.listener,I)}const v=Lt;return f}function Xe(f,v,I,B,ie){if(Array.isArray(v))for(var pe=0;pe<v.length;pe++)Xe(f,v[pe],I,B,ie);else B=h(B)?!!B.capture:!!B,I=Dr(I),f&&f[ge]?(f=f.i,v=String(v).toString(),v in f.g&&(pe=f.g[v],I=yt(pe,I,B,ie),-1<I&&(ve(pe[I]),Array.prototype.splice.call(pe,I,1),pe.length==0&&(delete f.g[v],f.h--)))):f&&(f=ir(f))&&(v=f.g[v.toString()],f=-1,v&&(f=yt(v,I,B,ie)),(I=-1<f?v[f]:null)&&qe(I))}function qe(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[ge])Y(v.i,f);else{var I=f.type,B=f.proxy;v.removeEventListener?v.removeEventListener(I,B,f.capture):v.detachEvent?v.detachEvent(mt(I),B):v.addListener&&v.removeListener&&v.removeListener(B),(I=ir(v))?(Y(I,f),I.h==0&&(I.src=null,v[He]=null)):ve(f)}}}function mt(f){return f in ot?ot[f]:ot[f]="on"+f}function Lt(f,v){if(f.da)f=!0;else{v=new q(v,this);var I=f.listener,B=f.ha||f.src;f.fa&&qe(f),f=I.call(B,v)}return f}function ir(f){return f=f[He],f instanceof Ye?f:null}var Qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Dr(f){return typeof f=="function"?f:(f[Qt]||(f[Qt]=function(v){return f.handleEvent(v)}),f[Qt])}function ct(){j.call(this),this.i=new Ye(this),this.M=this,this.F=null}E(ct,j),ct.prototype[ge]=!0,ct.prototype.removeEventListener=function(f,v,I,B){Xe(this,f,v,I,B)};function Dt(f,v){var I,B=f.F;if(B)for(I=[];B;B=B.F)I.push(B);if(f=f.M,B=v.type||v,typeof v=="string")v=new H(v,f);else if(v instanceof H)v.target=v.target||f;else{var ie=v;v=new H(B,f),D(v,ie)}if(ie=!0,I)for(var pe=I.length-1;0<=pe;pe--){var De=v.g=I[pe];ie=bt(De,B,!0,v)&&ie}if(De=v.g=f,ie=bt(De,B,!0,v)&&ie,ie=bt(De,B,!1,v)&&ie,I)for(pe=0;pe<I.length;pe++)De=v.g=I[pe],ie=bt(De,B,!1,v)&&ie}ct.prototype.N=function(){if(ct.aa.N.call(this),this.i){var f=this.i,v;for(v in f.g){for(var I=f.g[v],B=0;B<I.length;B++)ve(I[B]);delete f.g[v],f.h--}}this.F=null},ct.prototype.K=function(f,v,I,B){return this.i.add(String(f),v,!1,I,B)},ct.prototype.L=function(f,v,I,B){return this.i.add(String(f),v,!0,I,B)};function bt(f,v,I,B){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();for(var ie=!0,pe=0;pe<v.length;++pe){var De=v[pe];if(De&&!De.da&&De.capture==I){var kt=De.listener,ur=De.ha||De.src;De.fa&&Y(f.i,De),ie=kt.call(ur,B)!==!1&&ie}}return ie&&!B.defaultPrevented}function Ir(f,v,I){if(typeof f=="function")I&&(f=_(f,I));else if(f&&typeof f.handleEvent=="function")f=_(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:l.setTimeout(f,v||0)}function Re(f){f.g=Ir(()=>{f.g=null,f.i&&(f.i=!1,Re(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class it extends j{constructor(v,I){super(),this.m=v,this.l=I,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Re(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function At(f){j.call(this),this.h=f,this.g={}}E(At,j);var lt=[];function cr(f){X(f.g,function(v,I){this.g.hasOwnProperty(I)&&qe(v)},f),f.g={}}At.prototype.N=function(){At.aa.N.call(this),cr(this)},At.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xn=l.JSON.stringify,an=l.JSON.parse,on=class{stringify(f){return l.JSON.stringify(f,void 0)}parse(f){return l.JSON.parse(f,void 0)}};function Pn(){}Pn.prototype.h=null;function Nn(f){return f.h||(f.h=f.i())}function Di(){}var Fi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Os(){H.call(this,"d")}E(Os,H);function bi(){H.call(this,"c")}E(bi,H);var mi={},po=null;function Ls(){return po=po||new ct}mi.La="serverreachability";function mo(f){H.call(this,mi.La,f)}E(mo,H);function ts(f){const v=Ls();Dt(v,new mo(v))}mi.STAT_EVENT="statevent";function Ds(f,v){H.call(this,mi.STAT_EVENT,f),this.stat=v}E(Ds,H);function _r(f){const v=Ls();Dt(v,new Ds(v,f))}mi.Ma="timingevent";function go(f,v){H.call(this,mi.Ma,f),this.size=v}E(go,H);function gi(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){f()},v)}function rs(){this.g=!0}rs.prototype.xa=function(){this.g=!1};function yn(f,v,I,B,ie,pe){f.info(function(){if(f.g)if(pe)for(var De="",kt=pe.split("&"),ur=0;ur<kt.length;ur++){var gt=kt[ur].split("=");if(1<gt.length){var Ot=gt[0];gt=gt[1];var Kt=Ot.split("_");De=2<=Kt.length&&Kt[1]=="type"?De+(Ot+"="+gt+"&"):De+(Ot+"=redacted&")}}else De=null;else De=pe;return"XMLHTTP REQ ("+B+") [attempt "+ie+"]: "+v+`
`+I+`
`+De})}function ze(f,v,I,B,ie,pe,De){f.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+ie+"]: "+v+`
`+I+`
`+pe+" "+De})}function N(f,v,I,B){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+U(f,I)+(B?" "+B:"")})}function W(f,v){f.info(function(){return"TIMEOUT: "+v})}rs.prototype.info=function(){};function U(f,v){if(!f.g)return v;if(!v)return null;try{var I=JSON.parse(v);if(I){for(f=0;f<I.length;f++)if(Array.isArray(I[f])){var B=I[f];if(!(2>B.length)){var ie=B[1];if(Array.isArray(ie)&&!(1>ie.length)){var pe=ie[0];if(pe!="noop"&&pe!="stop"&&pe!="close")for(var De=1;De<ie.length;De++)ie[De]=""}}}}return xn(I)}catch{return v}}var z={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},G={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},K;function se(){}E(se,Pn),se.prototype.g=function(){return new XMLHttpRequest},se.prototype.i=function(){return{}},K=new se;function me(f,v,I,B){this.j=f,this.i=v,this.l=I,this.R=B||1,this.U=new At(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oe}function oe(){this.i=null,this.g="",this.h=!1}var le={},ce={};function Te(f,v,I){f.L=1,f.v=Yn(er(v)),f.m=I,f.P=!0,Le(f,null)}function Le(f,v){f.F=Date.now(),Fe(f),f.A=er(f.v);var I=f.A,B=f.R;Array.isArray(B)||(B=[String(B)]),Qu(I.i,"t",B),f.C=0,I=f.j.J,f.h=new oe,f.g=of(f.j,I?v:null,!f.m),0<f.O&&(f.M=new it(_(f.Y,f,f.g),f.O)),v=f.U,I=f.g,B=f.ca;var ie="readystatechange";Array.isArray(ie)||(ie&&(lt[0]=ie.toString()),ie=lt);for(var pe=0;pe<ie.length;pe++){var De=ne(I,ie[pe],B||v.handleEvent,!1,v.h||v);if(!De)break;v.g[De.key]=De}v=f.H?R(f.H):{},f.m?(f.u||(f.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,v)):(f.u="GET",f.g.ea(f.A,f.u,null,v)),ts(),yn(f.i,f.u,f.A,f.l,f.R,f.m)}me.prototype.ca=function(f){f=f.target;const v=this.M;v&&ln(f)==3?v.j():this.Y(f)},me.prototype.Y=function(f){try{if(f==this.g)e:{const Kt=ln(this.g);var v=this.g.Ba();const Vs=this.g.Z();if(!(3>Kt)&&(Kt!=3||this.g&&(this.h.h||this.g.oa()||Jl(this.g)))){this.J||Kt!=4||v==7||(v==8||0>=Vs?ts(3):ts(2)),Ct(this);var I=this.g.Z();this.X=I;t:if(Me(this)){var B=Jl(this.g);f="";var ie=B.length,pe=ln(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Mt(this),It(this);var De="";break t}this.h.i=new l.TextDecoder}for(v=0;v<ie;v++)this.h.h=!0,f+=this.h.i.decode(B[v],{stream:!(pe&&v==ie-1)});B.length=0,this.h.g+=f,this.C=0,De=this.h.g}else De=this.g.oa();if(this.o=I==200,ze(this.i,this.u,this.A,this.l,this.R,Kt,I),this.o){if(this.T&&!this.K){t:{if(this.g){var kt,ur=this.g;if((kt=ur.g?ur.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(kt)){var gt=kt;break t}}gt=null}if(I=gt)N(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,On(this,I);else{this.o=!1,this.s=3,_r(12),Mt(this),It(this);break e}}if(this.P){I=!0;let sr;for(;!this.J&&this.C<De.length;)if(sr=Ie(this,De),sr==ce){Kt==4&&(this.s=4,_r(14),I=!1),N(this.i,this.l,null,"[Incomplete Response]");break}else if(sr==le){this.s=4,_r(15),N(this.i,this.l,De,"[Invalid Chunk]"),I=!1;break}else N(this.i,this.l,sr,null),On(this,sr);if(Me(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Kt!=4||De.length!=0||this.h.h||(this.s=1,_r(16),I=!1),this.o=this.o&&I,!I)N(this.i,this.l,De,"[Invalid Chunked Response]"),Mt(this),It(this);else if(0<De.length&&!this.W){this.W=!0;var Ot=this.j;Ot.g==this&&Ot.ba&&!Ot.M&&(Ot.j.info("Great, no buffering proxy detected. Bytes received: "+De.length),So(Ot),Ot.M=!0,_r(11))}}else N(this.i,this.l,De,null),On(this,De);Kt==4&&Mt(this),this.o&&!this.J&&(Kt==4?ec(this.j,this):(this.o=!1,Fe(this)))}else Y0(this.g),I==400&&0<De.indexOf("Unknown SID")?(this.s=3,_r(12)):(this.s=0,_r(13)),Mt(this),It(this)}}}catch{}finally{}};function Me(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function Ie(f,v){var I=f.C,B=v.indexOf(`
`,I);return B==-1?ce:(I=Number(v.substring(I,B)),isNaN(I)?le:(B+=1,B+I>v.length?ce:(v=v.slice(B,B+I),f.C=B+I,v)))}me.prototype.cancel=function(){this.J=!0,Mt(this)};function Fe(f){f.S=Date.now()+f.I,Ze(f,f.I)}function Ze(f,v){if(f.B!=null)throw Error("WatchDog timer not null");f.B=gi(_(f.ba,f),v)}function Ct(f){f.B&&(l.clearTimeout(f.B),f.B=null)}me.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(W(this.i,this.A),this.L!=2&&(ts(),_r(17)),Mt(this),this.s=2,It(this)):Ze(this,this.S-f)};function It(f){f.j.G==0||f.J||ec(f.j,f)}function Mt(f){Ct(f);var v=f.M;v&&typeof v.ma=="function"&&v.ma(),f.M=null,cr(f.U),f.g&&(v=f.g,f.g=null,v.abort(),v.ma())}function On(f,v){try{var I=f.j;if(I.G!=0&&(I.g==f||Je(I.h,f))){if(!f.K&&Je(I.h,f)&&I.G==3){try{var B=I.Da.g.parse(v)}catch{B=null}if(Array.isArray(B)&&B.length==3){var ie=B;if(ie[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<f.F)Co(I),wo(I);else break e;Ao(I),_r(18)}}else I.za=ie[1],0<I.za-I.T&&37500>ie[2]&&I.F&&I.v==0&&!I.C&&(I.C=gi(_(I.Za,I),6e3));if(1>=Xn(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else os(I,11)}else if((f.K||I.g==f)&&Co(I),!k(v))for(ie=I.Da.g.parse(v),v=0;v<ie.length;v++){let gt=ie[v];if(I.T=gt[0],gt=gt[1],I.G==2)if(gt[0]=="c"){I.K=gt[1],I.ia=gt[2];const Ot=gt[3];Ot!=null&&(I.la=Ot,I.j.info("VER="+I.la));const Kt=gt[4];Kt!=null&&(I.Aa=Kt,I.j.info("SVER="+I.Aa));const Vs=gt[5];Vs!=null&&typeof Vs=="number"&&0<Vs&&(B=1.5*Vs,I.L=B,I.j.info("backChannelRequestTimeoutMs_="+B)),B=I;const sr=f.g;if(sr){const Ro=sr.g?sr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ro){var pe=B.h;pe.g||Ro.indexOf("spdy")==-1&&Ro.indexOf("quic")==-1&&Ro.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(Ft(pe,pe.h),pe.h=null))}if(B.D){const Ui=sr.g?sr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ui&&(B.ya=Ui,Qe(B.I,B.D,Ui))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-f.F,I.j.info("Handshake RTT: "+I.R+"ms")),B=I;var De=f;if(B.qa=ko(B,B.J?B.ia:null,B.W),De.K){Ia(B.h,De);var kt=De,ur=B.L;ur&&(kt.I=ur),kt.B&&(Ct(kt),Fe(kt)),B.g=De}else yi(B);0<I.i.length&&Us(I)}else gt[0]!="stop"&&gt[0]!="close"||os(I,7);else I.G==3&&(gt[0]=="stop"||gt[0]=="close"?gt[0]=="stop"?os(I,7):To(I):gt[0]!="noop"&&I.l&&I.l.ta(gt),I.v=0)}}ts(4)}catch{}}var Ln=class{constructor(f,v){this.g=f,this.map=v}};function _i(f){this.l=f||10,l.PerformanceNavigationTiming?(f=l.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Dn(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Xn(f){return f.h?1:f.g?f.g.size:0}function Je(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function Ft(f,v){f.g?f.g.add(v):f.h=v}function Ia(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}_i.prototype.cancel=function(){if(this.i=ns(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function ns(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const I of f.g.values())v=v.concat(I.D);return v}return y(f.i)}function Fs(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(u(f)){for(var v=[],I=f.length,B=0;B<I;B++)v.push(f[B]);return v}v=[],I=0;for(B in f)v[I++]=f[B];return v}function Vl(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(u(f)||typeof f=="string"){var v=[];f=f.length;for(var I=0;I<f;I++)v.push(I);return v}v=[],I=0;for(const B in f)v[I++]=B;return v}}}function st(f,v){if(f.forEach&&typeof f.forEach=="function")f.forEach(v,void 0);else if(u(f)||typeof f=="string")Array.prototype.forEach.call(f,v,void 0);else for(var I=Vl(f),B=Fs(f),ie=B.length,pe=0;pe<ie;pe++)v.call(void 0,B[pe],I&&I[pe],f)}var jt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zl(f,v){if(f){f=f.split("&");for(var I=0;I<f.length;I++){var B=f[I].indexOf("="),ie=null;if(0<=B){var pe=f[I].substring(0,B);ie=f[I].substring(B+1)}else pe=f[I];v(pe,ie?decodeURIComponent(ie.replace(/\+/g," ")):"")}}}function qn(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof qn){this.h=f.h,_o(this,f.j),this.o=f.o,this.g=f.g,is(this,f.s),this.l=f.l;var v=f.i,I=new ss;I.i=v.i,v.g&&(I.g=new Map(v.g),I.h=v.h),Mi(this,I),this.m=f.m}else f&&(v=String(f).match(jt))?(this.h=!1,_o(this,v[1]||"",!0),this.o=vi(v[2]||""),this.g=vi(v[3]||"",!0),is(this,v[4]),this.l=vi(v[5]||"",!0),Mi(this,v[6]||"",!0),this.m=vi(v[7]||"")):(this.h=!1,this.i=new ss(null,this.h))}qn.prototype.toString=function(){var f=[],v=this.j;v&&f.push(xi(v,bs,!0),":");var I=this.g;return(I||v=="file")&&(f.push("//"),(v=this.o)&&f.push(xi(v,bs,!0),"@"),f.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&f.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&f.push("/"),f.push(xi(I,I.charAt(0)=="/"?Wl:Hl,!0))),(I=this.i.toString())&&f.push("?",I),(I=this.m)&&f.push("#",xi(I,Gl)),f.join("")};function er(f){return new qn(f)}function _o(f,v,I){f.j=I?vi(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function is(f,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);f.s=v}else f.s=null}function Mi(f,v,I){v instanceof ss?(f.i=v,Jn(f.i,f.h)):(I||(v=xi(v,vo)),f.i=new ss(v,f.h))}function Qe(f,v,I){f.i.set(v,I)}function Yn(f){return Qe(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function vi(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function xi(f,v,I){return typeof f=="string"?(f=encodeURI(f).replace(v,jl),I&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function jl(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var bs=/[#\/\?@]/g,Hl=/[#\?:]/g,Wl=/[#\?]/g,vo=/[#\?@]/g,Gl=/#/g;function ss(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function Fn(f){f.g||(f.g=new Map,f.h=0,f.i&&zl(f.i,function(v,I){f.add(decodeURIComponent(v.replace(/\+/g," ")),I)}))}e=ss.prototype,e.add=function(f,v){Fn(this),this.i=null,f=Ge(this,f);var I=this.g.get(f);return I||this.g.set(f,I=[]),I.push(v),this.h+=1,this};function $l(f,v){Fn(f),v=Ge(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function xo(f,v){return Fn(f),v=Ge(f,v),f.g.has(v)}e.forEach=function(f,v){Fn(this),this.g.forEach(function(I,B){I.forEach(function(ie){f.call(v,ie,B,this)},this)},this)},e.na=function(){Fn(this);const f=Array.from(this.g.values()),v=Array.from(this.g.keys()),I=[];for(let B=0;B<v.length;B++){const ie=f[B];for(let pe=0;pe<ie.length;pe++)I.push(v[B])}return I},e.V=function(f){Fn(this);let v=[];if(typeof f=="string")xo(this,f)&&(v=v.concat(this.g.get(Ge(this,f))));else{f=Array.from(this.g.values());for(let I=0;I<f.length;I++)v=v.concat(f[I])}return v},e.set=function(f,v){return Fn(this),this.i=null,f=Ge(this,f),xo(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},e.get=function(f,v){return f?(f=this.V(f),0<f.length?String(f[0]):v):v};function Qu(f,v,I){$l(f,v),0<I.length&&(f.i=null,f.g.set(Ge(f,v),y(I)),f.h+=I.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(var I=0;I<v.length;I++){var B=v[I];const pe=encodeURIComponent(String(B)),De=this.V(B);for(B=0;B<De.length;B++){var ie=pe;De[B]!==""&&(ie+="="+encodeURIComponent(String(De[B]))),f.push(ie)}}return this.i=f.join("&")};function Ge(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function Jn(f,v){v&&!f.j&&(Fn(f),f.i=null,f.g.forEach(function(I,B){var ie=B.toLowerCase();B!=ie&&($l(this,B),Qu(this,ie,I))},f)),f.j=v}function Nt(f,v){const I=new rs;if(l.Image){const B=new Image;B.onload=x(Qn,I,"TestLoadImage: loaded",!0,v,B),B.onerror=x(Qn,I,"TestLoadImage: error",!1,v,B),B.onabort=x(Qn,I,"TestLoadImage: abort",!1,v,B),B.ontimeout=x(Qn,I,"TestLoadImage: timeout",!1,v,B),l.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=f}else v(!1)}function ef(f,v){const I=new rs,B=new AbortController,ie=setTimeout(()=>{B.abort(),Qn(I,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:B.signal}).then(pe=>{clearTimeout(ie),pe.ok?Qn(I,"TestPingServer: ok",!0,v):Qn(I,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ie),Qn(I,"TestPingServer: error",!1,v)})}function Qn(f,v,I,B,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),B(I)}catch{}}function Zl(){this.g=new on}function Kl(f,v,I){const B=I||"";try{st(f,function(ie,pe){let De=ie;h(ie)&&(De=xn(ie)),v.push(B+pe+"="+encodeURIComponent(De))})}catch(ie){throw v.push(B+"type="+encodeURIComponent("_badmap")),ie}}function ei(f){this.l=f.Ub||null,this.j=f.eb||!1}E(ei,Pn),ei.prototype.g=function(){return new Ms(this.l,this.j)},ei.prototype.i=function(f){return function(){return f}}({});function Ms(f,v){ct.call(this),this.D=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Ms,ct),e=Ms.prototype,e.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=v,this.readyState=1,bn(this)},e.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(v.body=f),(this.D||l).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zt(this)),this.readyState=0},e.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,bn(this)),this.g&&(this.readyState=3,bn(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Bs(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Bs(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}e.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?Zt(this):bn(this),this.readyState==3&&Bs(this)}},e.Ra=function(f){this.g&&(this.response=this.responseText=f,Zt(this))},e.Qa=function(f){this.g&&(this.response=f,Zt(this))},e.ga=function(){this.g&&Zt(this)};function Zt(f){f.readyState=4,f.l=null,f.j=null,f.v=null,bn(f)}e.setRequestHeader=function(f,v){this.u.append(f,v)},e.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var I=v.next();!I.done;)I=I.value,f.push(I[0]+": "+I[1]),I=v.next();return f.join(`\r
`)};function bn(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Ms.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Xl(f){let v="";return X(f,function(I,B){v+=B,v+=":",v+=I,v+=`\r
`}),v}function yo(f,v,I){e:{for(B in I){var B=!1;break e}B=!0}B||(I=Xl(I),typeof f=="string"?I!=null&&encodeURIComponent(String(I)):Qe(f,v,I))}function Ht(f){ct.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Ht,ct);var tf=/^https?$/i,ql=["POST","PUT"];e=Ht.prototype,e.Ha=function(f){this.J=f},e.ea=function(f,v,I,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():K.g(),this.v=this.o?Nn(this.o):Nn(K),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(pe){rf(this,pe);return}if(f=I||"",I=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var ie in B)I.set(ie,B[ie]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const pe of B.keys())I.set(pe,B.get(pe));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(I.keys()).find(pe=>pe.toLowerCase()=="content-type"),ie=l.FormData&&f instanceof l.FormData,!(0<=Array.prototype.indexOf.call(ql,v,void 0))||B||ie||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,De]of I)this.g.setRequestHeader(pe,De);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{En(this),this.u=!0,this.g.send(f),this.u=!1}catch(pe){rf(this,pe)}};function rf(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.m=5,Yl(f),Eo(f)}function Yl(f){f.A||(f.A=!0,Dt(f,"complete"),Dt(f,"error"))}e.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Dt(this,"complete"),Dt(this,"abort"),Eo(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Eo(this,!0)),Ht.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?ft(this):this.bb())},e.bb=function(){ft(this)};function ft(f){if(f.h&&typeof o<"u"&&(!f.v[1]||ln(f)!=4||f.Z()!=2)){if(f.u&&ln(f)==4)Ir(f.Ea,0,f);else if(Dt(f,"readystatechange"),ln(f)==4){f.h=!1;try{const De=f.Z();e:switch(De){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var I;if(!(I=v)){var B;if(B=De===0){var ie=String(f.D).match(jt)[1]||null;!ie&&l.self&&l.self.location&&(ie=l.self.location.protocol.slice(0,-1)),B=!tf.test(ie?ie.toLowerCase():"")}I=B}if(I)Dt(f,"complete"),Dt(f,"success");else{f.m=6;try{var pe=2<ln(f)?f.g.statusText:""}catch{pe=""}f.l=pe+" ["+f.Z()+"]",Yl(f)}}finally{Eo(f)}}}}function Eo(f,v){if(f.g){En(f);const I=f.g,B=f.v[0]?()=>{}:null;f.g=null,f.v=null,v||Dt(f,"ready");try{I.onreadystatechange=B}catch{}}}function En(f){f.I&&(l.clearTimeout(f.I),f.I=null)}e.isActive=function(){return!!this.g};function ln(f){return f.g?f.g.readyState:0}e.Z=function(){try{return 2<ln(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),an(v)}};function Jl(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Y0(f){const v={};f=(f.g&&2<=ln(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<f.length;B++){if(k(f[B]))continue;var I=F(f[B]);const ie=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const pe=v[ie]||[];v[ie]=pe,pe.push(I)}S(v,function(B){return B.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function as(f,v,I){return I&&I.internalChannelParams&&I.internalChannelParams[f]||v}function nf(f){this.Aa=0,this.i=[],this.j=new rs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=as("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=as("baseRetryDelayMs",5e3,f),this.cb=as("retryDelaySeedMs",1e4,f),this.Wa=as("forwardChannelMaxRetries",2,f),this.wa=as("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new _i(f&&f.concurrentRequestLimit),this.Da=new Zl,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=nf.prototype,e.la=8,e.G=1,e.connect=function(f,v,I,B){_r(0),this.W=f,this.H=v||{},I&&B!==void 0&&(this.H.OSID=I,this.H.OAID=B),this.F=this.X,this.I=ko(this,null,this.W),Us(this)};function To(f){if(sf(f),f.G==3){var v=f.U++,I=er(f.I);if(Qe(I,"SID",f.K),Qe(I,"RID",v),Qe(I,"TYPE","terminate"),Ca(f,I),v=new me(f,f.j,v),v.L=2,v.v=Yn(er(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(v.v.toString(),"")}catch{}!I&&l.Image&&(new Image().src=v.v,I=!0),I||(v.g=of(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Fe(v)}af(f)}function wo(f){f.g&&(So(f),f.g.cancel(),f.g=null)}function sf(f){wo(f),f.u&&(l.clearTimeout(f.u),f.u=null),Co(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&l.clearTimeout(f.s),f.s=null)}function Us(f){if(!Dn(f.h)&&!f.s){f.s=!0;var v=f.Ga;Oe||de(),ue||(Oe(),ue=!0),te.add(v,f),f.B=0}}function J0(f,v){return Xn(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=v.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=gi(_(f.Ga,f,v),tc(f,f.B)),f.B++,!0)}e.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const ie=new me(this,this.j,f);let pe=this.o;if(this.S&&(pe?(pe=R(pe),D(pe,this.S)):pe=this.S),this.m!==null||this.O||(ie.H=pe,pe=null),this.P)e:{for(var v=0,I=0;I<this.i.length;I++){t:{var B=this.i[I];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(v+=B,4096<v){v=I;break e}if(v===4096||I===this.i.length-1){v=I+1;break e}}v=1e3}else v=1e3;v=Ql(this,ie,v),I=er(this.I),Qe(I,"RID",f),Qe(I,"CVER",22),this.D&&Qe(I,"X-HTTP-Session-Id",this.D),Ca(this,I),pe&&(this.O?v="headers="+encodeURIComponent(String(Xl(pe)))+"&"+v:this.m&&yo(I,this.m,pe)),Ft(this.h,ie),this.Ua&&Qe(I,"TYPE","init"),this.P?(Qe(I,"$req",v),Qe(I,"SID","null"),ie.T=!0,Te(ie,I,null)):Te(ie,I,v),this.G=2}}else this.G==3&&(f?Mn(this,f):this.i.length==0||Dn(this.h)||Mn(this))};function Mn(f,v){var I;v?I=v.l:I=f.U++;const B=er(f.I);Qe(B,"SID",f.K),Qe(B,"RID",I),Qe(B,"AID",f.T),Ca(f,B),f.m&&f.o&&yo(B,f.m,f.o),I=new me(f,f.j,I,f.B+1),f.m===null&&(I.H=f.o),v&&(f.i=v.D.concat(f.i)),v=Ql(f,I,1e3),I.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Ft(f.h,I),Te(I,B,v)}function Ca(f,v){f.H&&X(f.H,function(I,B){Qe(v,B,I)}),f.l&&st({},function(I,B){Qe(v,B,I)})}function Ql(f,v,I){I=Math.min(f.i.length,I);var B=f.l?_(f.l.Na,f.l,f):null;e:{var ie=f.i;let pe=-1;for(;;){const De=["count="+I];pe==-1?0<I?(pe=ie[0].g,De.push("ofs="+pe)):pe=0:De.push("ofs="+pe);let kt=!0;for(let ur=0;ur<I;ur++){let gt=ie[ur].g;const Ot=ie[ur].map;if(gt-=pe,0>gt)pe=Math.max(0,ie[ur].g-100),kt=!1;else try{Kl(Ot,De,"req"+gt+"_")}catch{B&&B(Ot)}}if(kt){B=De.join("&");break e}}}return f=f.i.splice(0,I),v.D=f,B}function yi(f){if(!f.g&&!f.u){f.Y=1;var v=f.Fa;Oe||de(),ue||(Oe(),ue=!0),te.add(v,f),f.v=0}}function Ao(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=gi(_(f.Fa,f),tc(f,f.v)),f.v++,!0)}e.Fa=function(){if(this.u=null,Io(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=gi(_(this.ab,this),f)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_r(10),wo(this),Io(this))};function So(f){f.A!=null&&(l.clearTimeout(f.A),f.A=null)}function Io(f){f.g=new me(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var v=er(f.qa);Qe(v,"RID","rpc"),Qe(v,"SID",f.K),Qe(v,"AID",f.T),Qe(v,"CI",f.F?"0":"1"),!f.F&&f.ja&&Qe(v,"TO",f.ja),Qe(v,"TYPE","xmlhttp"),Ca(f,v),f.m&&f.o&&yo(v,f.m,f.o),f.L&&(f.g.I=f.L);var I=f.g;f=f.ia,I.L=1,I.v=Yn(er(v)),I.m=null,I.P=!0,Le(I,f)}e.Za=function(){this.C!=null&&(this.C=null,wo(this),Ao(this),_r(19))};function Co(f){f.C!=null&&(l.clearTimeout(f.C),f.C=null)}function ec(f,v){var I=null;if(f.g==v){Co(f),So(f),f.g=null;var B=2}else if(Je(f.h,v))I=v.D,Ia(f.h,v),B=1;else return;if(f.G!=0){if(v.o)if(B==1){I=v.m?v.m.length:0,v=Date.now()-v.F;var ie=f.B;B=Ls(),Dt(B,new go(B,I)),Us(f)}else yi(f);else if(ie=v.s,ie==3||ie==0&&0<v.X||!(B==1&&J0(f,v)||B==2&&Ao(f)))switch(I&&0<I.length&&(v=f.h,v.i=v.i.concat(I)),ie){case 1:os(f,5);break;case 4:os(f,10);break;case 3:os(f,6);break;default:os(f,2)}}}function tc(f,v){let I=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(I*=2),I*v}function os(f,v){if(f.j.info("Error code "+v),v==2){var I=_(f.fb,f),B=f.Xa;const ie=!B;B=new qn(B||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||_o(B,"https"),Yn(B),ie?Nt(B.toString(),I):ef(B.toString(),I)}else _r(2);f.G=0,f.l&&f.l.sa(v),af(f),sf(f)}e.fb=function(f){f?(this.j.info("Successfully pinged google.com"),_r(2)):(this.j.info("Failed to ping google.com"),_r(1))};function af(f){if(f.G=0,f.ka=[],f.l){const v=ns(f.h);(v.length!=0||f.i.length!=0)&&(A(f.ka,v),A(f.ka,f.i),f.h.i.length=0,y(f.i),f.i.length=0),f.l.ra()}}function ko(f,v,I){var B=I instanceof qn?er(I):new qn(I);if(B.g!="")v&&(B.g=v+"."+B.g),is(B,B.s);else{var ie=l.location;B=ie.protocol,v=v?v+"."+ie.hostname:ie.hostname,ie=+ie.port;var pe=new qn(null);B&&_o(pe,B),v&&(pe.g=v),ie&&is(pe,ie),I&&(pe.l=I),B=pe}return I=f.D,v=f.ya,I&&v&&Qe(B,I,v),Qe(B,"VER",f.la),Ca(f,B),B}function of(f,v,I){if(v&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Ca&&!f.pa?new Ht(new ei({eb:I})):new Ht(f.pa),v.Ha(f.J),v}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function rc(){}e=rc.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function ka(){}ka.prototype.g=function(f,v){return new Cr(f,v)};function Cr(f,v){ct.call(this),this.g=new nf(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(f?f["X-WebChannel-Client-Profile"]=v.va:f={"X-WebChannel-Client-Profile":v.va}),this.g.S=f,(f=v&&v.Sb)&&!k(f)&&(this.g.m=f),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!k(v)&&(this.g.D=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new ti(this)}E(Cr,ct),Cr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Cr.prototype.close=function(){To(this.g)},Cr.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var I={};I.__data__=f,f=I}else this.u&&(I={},I.__data__=xn(f),f=I);v.i.push(new Ln(v.Ya++,f)),v.G==3&&Us(v)},Cr.prototype.N=function(){this.g.l=null,delete this.j,To(this.g),delete this.g,Cr.aa.N.call(this)};function Bi(f){Os.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const I in v){f=I;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}E(Bi,Os);function lf(){bi.call(this),this.status=1}E(lf,bi);function ti(f){this.g=f}E(ti,rc),ti.prototype.ua=function(){Dt(this.g,"a")},ti.prototype.ta=function(f){Dt(this.g,new Bi(f))},ti.prototype.sa=function(f){Dt(this.g,new lf)},ti.prototype.ra=function(){Dt(this.g,"b")},ka.prototype.createWebChannel=ka.prototype.g,Cr.prototype.send=Cr.prototype.o,Cr.prototype.open=Cr.prototype.m,Cr.prototype.close=Cr.prototype.close,Jw=function(){return new ka},Yw=function(){return Ls()},qw=mi,pm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},z.NO_ERROR=0,z.TIMEOUT=8,z.HTTP_ERROR=6,lh=z,G.COMPLETE="complete",Xw=G,Di.EventType=Fi,Fi.OPEN="a",Fi.CLOSE="b",Fi.ERROR="c",Fi.MESSAGE="d",ct.prototype.listen=ct.prototype.K,Sc=Di,Ht.prototype.listenOnce=Ht.prototype.L,Ht.prototype.getLastError=Ht.prototype.Ka,Ht.prototype.getLastErrorCode=Ht.prototype.Ba,Ht.prototype.getStatus=Ht.prototype.Z,Ht.prototype.getResponseJson=Ht.prototype.Oa,Ht.prototype.getResponseText=Ht.prototype.oa,Ht.prototype.send=Ht.prototype.ea,Ht.prototype.setWithCredentials=Ht.prototype.Ha,Kw=Ht}).apply(typeof $f<"u"?$f:typeof self<"u"?self:typeof window<"u"?window:{});const Lx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Xr.UNAUTHENTICATED=new Xr(null),Xr.GOOGLE_CREDENTIALS=new Xr("google-credentials-uid"),Xr.FIRST_PARTY=new Xr("first-party-uid"),Xr.MOCK_USER=new Xr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ml="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa=new zw("@firebase/firestore");function mc(){return Qa.logLevel}function Ve(e,...t){if(Qa.logLevel<=Et.DEBUG){const r=t.map(r_);Qa.debug(`Firestore (${Ml}): ${e}`,...r)}}function ks(e,...t){if(Qa.logLevel<=Et.ERROR){const r=t.map(r_);Qa.error(`Firestore (${Ml}): ${e}`,...r)}}function Tl(e,...t){if(Qa.logLevel<=Et.WARN){const r=t.map(r_);Qa.warn(`Firestore (${Ml}): ${e}`,...r)}}function r_(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function et(e="Unexpected state"){const t=`FIRESTORE (${Ml}) INTERNAL ASSERTION FAILED: `+e;throw ks(t),new Error(t)}function Pt(e,t){e||et()}function nt(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class je extends bl{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class hM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(Xr.UNAUTHENTICATED))}shutdown(){}}class dM{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class pM{constructor(t){this.t=t,this.currentUser=Xr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){Pt(this.o===void 0);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let s=new ys;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ys,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=s;t.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{Ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ys)}},0),o()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(Ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Pt(typeof n.accessToken=="string"),new Qw(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Pt(t===null||typeof t=="string"),new Xr(t)}}class mM{constructor(t,r,n){this.l=t,this.h=r,this.P=n,this.type="FirstParty",this.user=Xr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class gM{constructor(t,r,n){this.l=t,this.h=r,this.P=n}getToken(){return Promise.resolve(new mM(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(Xr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class _M{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vM{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){Pt(this.o===void 0);const n=s=>{s.error!=null&&Ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Ve("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>n(s))};const i=s=>{Ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(Pt(typeof r.token=="string"),this.R=r.token,new _M(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xM(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=xM(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=t.charAt(i[s]%t.length))}return n}}function St(e,t){return e<t?-1:e>t?1:0}function wl(e,t,r){return e.length===t.length&&e.every((n,i)=>r(n,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new je(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new je(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new je(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new je(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Sr.fromMillis(Date.now())}static fromDate(t){return Sr.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*r));return new Sr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?St(this.nanoseconds,t.nanoseconds):St(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(t){this.timestamp=t}static fromTimestamp(t){return new rt(t)}static min(){return new rt(new Sr(0,0))}static max(){return new rt(new Sr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(t,r,n){r===void 0?r=0:r>t.length&&et(),n===void 0?n=t.length-r:n>t.length-r&&et(),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return ku.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof ku?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let i=0;i<n;i++){const s=t.get(i),o=r.get(i);if(s<o)return-1;if(s>o)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class $t extends ku{construct(t,r,n){return new $t(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new je(Ee.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new $t(r)}static emptyPath(){return new $t([])}}const yM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Br extends ku{construct(t,r,n){return new Br(t,r,n)}static isValidIdentifier(t){return yM.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Br.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Br(["__name__"])}static fromServerFormat(t){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new je(Ee.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;i<t.length;){const l=t[i];if(l==="\\"){if(i+1===t.length)throw new je(Ee.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new je(Ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(n+=l,i++):(s(),i++)}if(s(),o)throw new je(Ee.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Br(r)}static emptyPath(){return new Br([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(t){this.path=t}static fromPath(t){return new We($t.fromString(t))}static fromName(t){return new We($t.fromString(t).popFirst(5))}static empty(){return new We($t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&$t.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return $t.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new We(new $t(t.slice()))}}function EM(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,i=rt.fromTimestamp(n===1e9?new Sr(r+1,0):new Sr(r,n));return new _a(i,We.empty(),t)}function TM(e){return new _a(e.readTime,e.key,-1)}class _a{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new _a(rt.min(),We.empty(),-1)}static max(){return new _a(rt.max(),We.empty(),-1)}}function wM(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=We.comparator(e.documentKey,t.documentKey),r!==0?r:St(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class SM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $u(e){if(e.code!==Ee.FAILED_PRECONDITION||e.message!==AM)throw e;Ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&et(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new we((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof we?r:we.resolve(r)}catch(r){return we.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):we.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):we.reject(r)}static resolve(t){return new we((r,n)=>{r(t)})}static reject(t){return new we((r,n)=>{n(t)})}static waitFor(t){return new we((r,n)=>{let i=0,s=0,o=!1;t.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&r()},u=>n(u))}),o=!0,s===i&&r()})}static or(t){let r=we.resolve(!1);for(const n of t)r=r.next(i=>i?we.resolve(i):n());return r}static forEach(t,r){const n=[];return t.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(t,r){return new we((n,i)=>{const s=t.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;r(t[h]).next(p=>{o[h]=p,++l,l===s&&n(o)},p=>i(p))}})}static doWhile(t,r){return new we((n,i)=>{const s=()=>{t()===!0?r().next(()=>{s()},i):n()};s()})}}function IM(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Zu(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}n_.oe=-1;function F0(e){return e==null}function Qh(e){return e===0&&1/e==-1/0}function CM(e){return typeof e=="number"&&Number.isInteger(e)&&!Qh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function fo(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function tA(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(t,r){this.comparator=t,this.root=r||br.EMPTY}insert(t,r){return new Jt(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,br.BLACK,null,null))}remove(t){return new Jt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,br.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Zf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Zf(this.root,t,this.comparator,!1)}getReverseIterator(){return new Zf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Zf(this.root,t,this.comparator,!0)}}class Zf{constructor(t,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=r?n(t.key,r):1,r&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class br{constructor(t,r,n,i,s){this.key=t,this.value=r,this.color=n??br.RED,this.left=i??br.EMPTY,this.right=s??br.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,i,s){return new br(t??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(t,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return br.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,i=this;if(r(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(t,i.key)===0){if(i.right.isEmpty())return br.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,br.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,br.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw et();const t=this.left.check();if(t!==this.right.check())throw et();return t+(this.isRed()?0:1)}}br.EMPTY=null,br.RED=!0,br.BLACK=!1;br.EMPTY=new class{constructor(){this.size=0}get key(){throw et()}get value(){throw et()}get color(){throw et()}get left(){throw et()}get right(){throw et()}copy(t,r,n,i,s){return this}insert(t,r,n){return new br(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(t){this.comparator=t,this.data=new Jt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;r(i.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new Fx(this.data.getIterator())}getIteratorFrom(t){return new Fx(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof jr)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new jr(this.comparator);return r.data=t,r}}class Fx{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(t){this.fields=t,t.sort(Br.comparator)}static empty(){return new jn([])}unionWith(t){let r=new jr(Br.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new jn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return wl(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new rA("Invalid base64 string: "+s):s}}(t);return new Wr(r)}static fromUint8Array(t){const r=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(t);return new Wr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return St(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Wr.EMPTY_BYTE_STRING=new Wr("");const kM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function va(e){if(Pt(!!e),typeof e=="string"){let t=0;const r=kM.exec(e);if(Pt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),t=Number(i)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:or(e.seconds),nanos:or(e.nanos)}}function or(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function eo(e){return typeof e=="string"?Wr.fromBase64String(e):Wr.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function s_(e){const t=e.mapValue.fields.__previous_value__;return i_(t)?s_(t):t}function Ru(e){const t=va(e.mapValue.fields.__local_write_time__.timestampValue);return new Sr(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RM{constructor(t,r,n,i,s,o,l,u,h){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Pu{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new Pu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Pu&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kf={mapValue:{}};function to(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?i_(e)?4:NM(e)?9007199254740991:PM(e)?10:11:et()}function Yi(e,t){if(e===t)return!0;const r=to(e);if(r!==to(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ru(e).isEqual(Ru(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=va(i.timestampValue),l=va(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return eo(i.bytesValue).isEqual(eo(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return or(i.geoPointValue.latitude)===or(s.geoPointValue.latitude)&&or(i.geoPointValue.longitude)===or(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return or(i.integerValue)===or(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=or(i.doubleValue),l=or(s.doubleValue);return o===l?Qh(o)===Qh(l):isNaN(o)&&isNaN(l)}return!1}(e,t);case 9:return wl(e.arrayValue.values||[],t.arrayValue.values||[],Yi);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(Dx(o)!==Dx(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Yi(o[u],l[u])))return!1;return!0}(e,t);default:return et()}}function Nu(e,t){return(e.values||[]).find(r=>Yi(r,t))!==void 0}function Al(e,t){if(e===t)return 0;const r=to(e),n=to(t);if(r!==n)return St(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return St(e.booleanValue,t.booleanValue);case 2:return function(s,o){const l=or(s.integerValue||s.doubleValue),u=or(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(e,t);case 3:return bx(e.timestampValue,t.timestampValue);case 4:return bx(Ru(e),Ru(t));case 5:return St(e.stringValue,t.stringValue);case 6:return function(s,o){const l=eo(s),u=eo(o);return l.compareTo(u)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=St(l[h],u[h]);if(p!==0)return p}return St(l.length,u.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const l=St(or(s.latitude),or(o.latitude));return l!==0?l:St(or(s.longitude),or(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Mx(e.arrayValue,t.arrayValue);case 10:return function(s,o){var l,u,h,p;const m=s.fields||{},_=o.fields||{},x=(l=m.value)===null||l===void 0?void 0:l.arrayValue,E=(u=_.value)===null||u===void 0?void 0:u.arrayValue,y=St(((h=x==null?void 0:x.values)===null||h===void 0?void 0:h.length)||0,((p=E==null?void 0:E.values)===null||p===void 0?void 0:p.length)||0);return y!==0?y:Mx(x,E)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===Kf.mapValue&&o===Kf.mapValue)return 0;if(s===Kf.mapValue)return 1;if(o===Kf.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let m=0;m<u.length&&m<p.length;++m){const _=St(u[m],p[m]);if(_!==0)return _;const x=Al(l[u[m]],h[p[m]]);if(x!==0)return x}return St(u.length,p.length)}(e.mapValue,t.mapValue);default:throw et()}}function bx(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return St(e,t);const r=va(e),n=va(t),i=St(r.seconds,n.seconds);return i!==0?i:St(r.nanos,n.nanos)}function Mx(e,t){const r=e.values||[],n=t.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=Al(r[i],n[i]);if(s)return s}return St(r.length,n.length)}function Sl(e){return mm(e)}function mm(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=va(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return eo(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return We.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=mm(s);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const o of n)s?s=!1:i+=",",i+=`${o}:${mm(r.fields[o])}`;return i+"}"}(e.mapValue):et()}function gm(e){return!!e&&"integerValue"in e}function a_(e){return!!e&&"arrayValue"in e}function Bx(e){return!!e&&"nullValue"in e}function Ux(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ch(e){return!!e&&"mapValue"in e}function PM(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Zc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return fo(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=Zc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=Zc(e.arrayValue.values[r]);return t}return Object.assign({},e)}function NM(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(t){this.value=t}static empty(){return new Sn({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!ch(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=Zc(r)}setAll(t){let r=Br.emptyPath(),n={},i=[];t.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=l.popLast()}o?n[l.lastSegment()]=Zc(o):i.push(l.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(t){const r=this.field(t.popLast());ch(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return Yi(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=r.mapValue.fields[t.get(n)];ch(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(t,r,n){fo(r,(i,s)=>t[i]=s);for(const i of n)delete t[i]}clone(){return new Sn(Zc(this.value))}}function nA(e){const t=[];return fo(e.fields,(r,n)=>{const i=new Br([r]);if(ch(n)){const s=nA(n.mapValue).fields;if(s.length===0)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)}),new jn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(t,r,n,i,s,o,l){this.key=t,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(t){return new Jr(t,0,rt.min(),rt.min(),rt.min(),Sn.empty(),0)}static newFoundDocument(t,r,n,i){return new Jr(t,1,r,rt.min(),n,i,0)}static newNoDocument(t,r){return new Jr(t,2,r,rt.min(),rt.min(),Sn.empty(),0)}static newUnknownDocument(t,r){return new Jr(t,3,r,rt.min(),rt.min(),Sn.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Sn.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Jr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Jr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(t,r){this.position=t,this.inclusive=r}}function Vx(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(s.field.isKeyField()?n=We.comparator(We.fromName(o.referenceValue),r.key):n=Al(o,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function zx(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!Yi(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{constructor(t,r="asc"){this.field=t,this.dir=r}}function OM(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{}class yr extends iA{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new DM(t,r,n):r==="array-contains"?new MM(t,n):r==="in"?new BM(t,n):r==="not-in"?new UM(t,n):r==="array-contains-any"?new VM(t,n):new yr(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new FM(t,n):new bM(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Al(r,this.value)):r!==null&&to(this.value)===to(r)&&this.matchesComparison(Al(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return et()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ji extends iA{constructor(t,r){super(),this.filters=t,this.op=r,this.ae=null}static create(t,r){return new Ji(t,r)}matches(t){return sA(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function sA(e){return e.op==="and"}function aA(e){return LM(e)&&sA(e)}function LM(e){for(const t of e.filters)if(t instanceof Ji)return!1;return!0}function _m(e){if(e instanceof yr)return e.field.canonicalString()+e.op.toString()+Sl(e.value);if(aA(e))return e.filters.map(t=>_m(t)).join(",");{const t=e.filters.map(r=>_m(r)).join(",");return`${e.op}(${t})`}}function oA(e,t){return e instanceof yr?function(n,i){return i instanceof yr&&n.op===i.op&&n.field.isEqual(i.field)&&Yi(n.value,i.value)}(e,t):e instanceof Ji?function(n,i){return i instanceof Ji&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,o,l)=>s&&oA(o,i.filters[l]),!0):!1}(e,t):void et()}function lA(e){return e instanceof yr?function(r){return`${r.field.canonicalString()} ${r.op} ${Sl(r.value)}`}(e):e instanceof Ji?function(r){return r.op.toString()+" {"+r.getFilters().map(lA).join(" ,")+"}"}(e):"Filter"}class DM extends yr{constructor(t,r,n){super(t,r,n),this.key=We.fromName(n.referenceValue)}matches(t){const r=We.comparator(t.key,this.key);return this.matchesComparison(r)}}class FM extends yr{constructor(t,r){super(t,"in",r),this.keys=cA("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class bM extends yr{constructor(t,r){super(t,"not-in",r),this.keys=cA("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function cA(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>We.fromName(n.referenceValue))}class MM extends yr{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return a_(r)&&Nu(r.arrayValue,this.value)}}class BM extends yr{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&Nu(this.value.arrayValue,r)}}class UM extends yr{constructor(t,r){super(t,"not-in",r)}matches(t){if(Nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!Nu(this.value.arrayValue,r)}}class VM extends yr{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!a_(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Nu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(t,r=null,n=[],i=[],s=null,o=null,l=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function jx(e,t=null,r=[],n=[],i=null,s=null,o=null){return new zM(e,t,r,n,i,s,o)}function o_(e){const t=nt(e);if(t.ue===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>_m(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),F0(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>Sl(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>Sl(n)).join(",")),t.ue=r}return t.ue}function l_(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!OM(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!oA(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!zx(e.startAt,t.startAt)&&zx(e.endAt,t.endAt)}function vm(e){return We.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(t,r=null,n=[],i=[],s=null,o="F",l=null,u=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function jM(e,t,r,n,i,s,o,l){return new b0(e,t,r,n,i,s,o,l)}function c_(e){return new b0(e)}function Hx(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function HM(e){return e.collectionGroup!==null}function Kc(e){const t=nt(e);if(t.ce===null){t.ce=[];const r=new Set;for(const s of t.explicitOrderBy)t.ce.push(s),r.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new jr(Br.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(t).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||t.ce.push(new t0(s,n))}),r.has(Br.keyField().canonicalString())||t.ce.push(new t0(Br.keyField(),n))}return t.ce}function Ki(e){const t=nt(e);return t.le||(t.le=WM(t,Kc(e))),t.le}function WM(e,t){if(e.limitType==="F")return jx(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new t0(i.field,s)});const r=e.endAt?new e0(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new e0(e.startAt.position,e.startAt.inclusive):null;return jx(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function xm(e,t,r){return new b0(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function M0(e,t){return l_(Ki(e),Ki(t))&&e.limitType===t.limitType}function uA(e){return`${o_(Ki(e))}|lt:${e.limitType}`}function Mo(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>lA(i)).join(", ")}]`),F0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Sl(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Sl(i)).join(",")),`Target(${n})`}(Ki(e))}; limitType=${e.limitType})`}function B0(e,t){return t.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):We.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(e,t)&&function(n,i){for(const s of Kc(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(n,i){return!(n.startAt&&!function(o,l,u){const h=Vx(o,l,u);return o.inclusive?h<=0:h<0}(n.startAt,Kc(n),i)||n.endAt&&!function(o,l,u){const h=Vx(o,l,u);return o.inclusive?h>=0:h>0}(n.endAt,Kc(n),i))}(e,t)}function GM(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function fA(e){return(t,r)=>{let n=!1;for(const i of Kc(e)){const s=$M(i,t,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function $M(e,t,r){const n=e.field.isKeyField()?We.comparator(t.key,r.key):function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?Al(u,h):et()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return et()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,r]);i.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){fo(this.inner,(r,n)=>{for(const[i,s]of n)t(i,s)})}isEmpty(){return tA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZM=new Jt(We.comparator);function Rs(){return ZM}const hA=new Jt(We.comparator);function Ic(...e){let t=hA;for(const r of e)t=t.insert(r.key,r);return t}function dA(e){let t=hA;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function Ma(){return Xc()}function pA(){return Xc()}function Xc(){return new Bl(e=>e.toString(),(e,t)=>e.isEqual(t))}const KM=new Jt(We.comparator),XM=new jr(We.comparator);function dt(...e){let t=XM;for(const r of e)t=t.add(r);return t}const qM=new jr(St);function YM(){return qM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qh(t)?"-0":t}}function mA(e){return{integerValue:""+e}}function JM(e,t){return CM(t)?mA(t):u_(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(){this._=void 0}}function QM(e,t,r){return e instanceof r0?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&i_(s)&&(s=s_(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(r,t):e instanceof Ou?_A(e,t):e instanceof Lu?vA(e,t):function(i,s){const o=gA(i,s),l=Wx(o)+Wx(i.Pe);return gm(o)&&gm(i.Pe)?mA(l):u_(i.serializer,l)}(e,t)}function e8(e,t,r){return e instanceof Ou?_A(e,t):e instanceof Lu?vA(e,t):r}function gA(e,t){return e instanceof n0?function(n){return gm(n)||function(s){return!!s&&"doubleValue"in s}(n)}(t)?t:{integerValue:0}:null}class r0 extends U0{}class Ou extends U0{constructor(t){super(),this.elements=t}}function _A(e,t){const r=xA(t);for(const n of e.elements)r.some(i=>Yi(i,n))||r.push(n);return{arrayValue:{values:r}}}class Lu extends U0{constructor(t){super(),this.elements=t}}function vA(e,t){let r=xA(t);for(const n of e.elements)r=r.filter(i=>!Yi(i,n));return{arrayValue:{values:r}}}class n0 extends U0{constructor(t,r){super(),this.serializer=t,this.Pe=r}}function Wx(e){return or(e.integerValue||e.doubleValue)}function xA(e){return a_(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function t8(e,t){return e.field.isEqual(t.field)&&function(n,i){return n instanceof Ou&&i instanceof Ou||n instanceof Lu&&i instanceof Lu?wl(n.elements,i.elements,Yi):n instanceof n0&&i instanceof n0?Yi(n.Pe,i.Pe):n instanceof r0&&i instanceof r0}(e.transform,t.transform)}class r8{constructor(t,r){this.version=t,this.transformResults=r}}class ui{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new ui}static exists(t){return new ui(void 0,t)}static updateTime(t){return new ui(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function uh(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class V0{}function yA(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new f_(e.key,ui.none()):new Ku(e.key,e.data,ui.none());{const r=e.data,n=Sn.empty();let i=new jr(Br.comparator);for(let s of t.fields)if(!i.has(s)){let o=r.field(s);o===null&&s.length>1&&(s=s.popLast(),o=r.field(s)),o===null?n.delete(s):n.set(s,o),i=i.add(s)}return new Sa(e.key,n,new jn(i.toArray()),ui.none())}}function n8(e,t,r){e instanceof Ku?function(i,s,o){const l=i.value.clone(),u=$x(i.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,r):e instanceof Sa?function(i,s,o){if(!uh(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=$x(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(EA(i)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(e,t,r):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,r)}function qc(e,t,r,n){return e instanceof Ku?function(s,o,l,u){if(!uh(s.precondition,o))return l;const h=s.value.clone(),p=Zx(s.fieldTransforms,u,o);return h.setAll(p),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(e,t,r,n):e instanceof Sa?function(s,o,l,u){if(!uh(s.precondition,o))return l;const h=Zx(s.fieldTransforms,u,o),p=o.data;return p.setAll(EA(s)),p.setAll(h),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(e,t,r,n):function(s,o,l){return uh(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(e,t,r)}function i8(e,t){let r=null;for(const n of e.fieldTransforms){const i=t.data.field(n.field),s=gA(n.transform,i||null);s!=null&&(r===null&&(r=Sn.empty()),r.set(n.field,s))}return r||null}function Gx(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&wl(n,i,(s,o)=>t8(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ku extends V0{constructor(t,r,n,i=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Sa extends V0{constructor(t,r,n,i,s=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function EA(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function $x(e,t,r){const n=new Map;Pt(e.length===r.length);for(let i=0;i<r.length;i++){const s=e[i],o=s.transform,l=t.data.field(s.field);n.set(s.field,e8(o,l,r[i]))}return n}function Zx(e,t,r){const n=new Map;for(const i of e){const s=i.transform,o=r.data.field(i.field);n.set(i.field,QM(s,o,t))}return n}class f_ extends V0{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class s8 extends V0{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a8{constructor(t,r,n,i){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&n8(s,t,n[i])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=qc(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=qc(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=pA();return this.mutations.forEach(i=>{const s=t.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=r.has(i.key)?null:l;const u=yA(o,l);u!==null&&n.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(rt.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),dt())}isEqual(t){return this.batchId===t.batchId&&wl(this.mutations,t.mutations,(r,n)=>Gx(r,n))&&wl(this.baseMutations,t.baseMutations,(r,n)=>Gx(r,n))}}class h_{constructor(t,r,n,i){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(t,r,n){Pt(t.mutations.length===n.length);let i=function(){return KM}();const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new h_(t,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dr,_t;function c8(e){switch(e){default:return et();case Ee.CANCELLED:case Ee.UNKNOWN:case Ee.DEADLINE_EXCEEDED:case Ee.RESOURCE_EXHAUSTED:case Ee.INTERNAL:case Ee.UNAVAILABLE:case Ee.UNAUTHENTICATED:return!1;case Ee.INVALID_ARGUMENT:case Ee.NOT_FOUND:case Ee.ALREADY_EXISTS:case Ee.PERMISSION_DENIED:case Ee.FAILED_PRECONDITION:case Ee.ABORTED:case Ee.OUT_OF_RANGE:case Ee.UNIMPLEMENTED:case Ee.DATA_LOSS:return!0}}function TA(e){if(e===void 0)return ks("GRPC error has no .code"),Ee.UNKNOWN;switch(e){case dr.OK:return Ee.OK;case dr.CANCELLED:return Ee.CANCELLED;case dr.UNKNOWN:return Ee.UNKNOWN;case dr.DEADLINE_EXCEEDED:return Ee.DEADLINE_EXCEEDED;case dr.RESOURCE_EXHAUSTED:return Ee.RESOURCE_EXHAUSTED;case dr.INTERNAL:return Ee.INTERNAL;case dr.UNAVAILABLE:return Ee.UNAVAILABLE;case dr.UNAUTHENTICATED:return Ee.UNAUTHENTICATED;case dr.INVALID_ARGUMENT:return Ee.INVALID_ARGUMENT;case dr.NOT_FOUND:return Ee.NOT_FOUND;case dr.ALREADY_EXISTS:return Ee.ALREADY_EXISTS;case dr.PERMISSION_DENIED:return Ee.PERMISSION_DENIED;case dr.FAILED_PRECONDITION:return Ee.FAILED_PRECONDITION;case dr.ABORTED:return Ee.ABORTED;case dr.OUT_OF_RANGE:return Ee.OUT_OF_RANGE;case dr.UNIMPLEMENTED:return Ee.UNIMPLEMENTED;case dr.DATA_LOSS:return Ee.DATA_LOSS;default:return et()}}(_t=dr||(dr={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u8(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f8=new Ha([4294967295,4294967295],0);function Kx(e){const t=u8().encode(e),r=new Zw;return r.update(t),new Uint8Array(r.digest())}function Xx(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Ha([r,n],0),new Ha([i,s],0)]}class d_{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Cc(`Invalid padding: ${r}`);if(n<0)throw new Cc(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new Cc(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new Cc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*t.length-r,this.Te=Ha.fromNumber(this.Ie)}Ee(t,r,n){let i=t.add(r.multiply(Ha.fromNumber(n)));return i.compare(f8)===1&&(i=new Ha([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const r=Kx(t),[n,i]=Xx(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,i,s);if(!this.de(o))return!1}return!0}static create(t,r,n){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new d_(s,i,r);return n.forEach(l=>o.insert(l)),o}insert(t){if(this.Ie===0)return;const r=Kx(t),[n,i]=Xx(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,i,s);this.Ae(o)}}Ae(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class Cc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(t,r,n,i,s){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const i=new Map;return i.set(t,Xu.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new z0(rt.min(),i,new Jt(St),Rs(),dt())}}class Xu{constructor(t,r,n,i,s){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new Xu(n,r,dt(),dt(),dt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(t,r,n,i){this.Re=t,this.removedTargetIds=r,this.key=n,this.Ve=i}}class wA{constructor(t,r){this.targetId=t,this.me=r}}class AA{constructor(t,r,n=Wr.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=i}}class qx{constructor(){this.fe=0,this.ge=Jx(),this.pe=Wr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=dt(),r=dt(),n=dt();return this.ge.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:et()}}),new Xu(this.pe,this.ye,t,r,n)}Ce(){this.we=!1,this.ge=Jx()}Fe(t,r){this.we=!0,this.ge=this.ge.insert(t,r)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,Pt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class h8{constructor(t){this.Le=t,this.Be=new Map,this.ke=Rs(),this.qe=Yx(),this.Qe=new Jt(St)}Ke(t){for(const r of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(r,t.Ve):this.Ue(r,t.key,t.Ve);for(const r of t.removedTargetIds)this.Ue(r,t.key,t.Ve)}We(t){this.forEachTarget(t,r=>{const n=this.Ge(r);switch(t.state){case 0:this.ze(r)&&n.De(t.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(t.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(t.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(t.resumeToken));break;default:et()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(t){const r=t.targetId,n=t.me.count,i=this.Je(r);if(i){const s=i.target;if(vm(s))if(n===0){const o=new We(s.path);this.Ue(r,o,Jr.newNoDocument(o,rt.min()))}else Pt(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(t),u=l?this.Xe(l,t,o):1;if(u!==0){this.je(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,h)}}}}}Ze(t){const r=t.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let o,l;try{o=eo(n).toUint8Array()}catch(u){if(u instanceof rA)return Tl("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new d_(o,i,s)}catch(u){return Tl(u instanceof Cc?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(t,r,n){return r.me.count===n-this.nt(t,r.targetId)?0:2}nt(t,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(l)||(this.Ue(r,s,null),i++)}),i}rt(t){const r=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&vm(l.target)){const u=new We(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Jr.newNoDocument(u,t))}s.be&&(r.set(o,s.ve()),s.Ce())}});let n=dt();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(t));const i=new z0(t,r,this.Qe,this.ke,n);return this.ke=Rs(),this.qe=Yx(),this.Qe=new Jt(St),i}$e(t,r){if(!this.ze(t))return;const n=this.it(t,r.key)?2:0;this.Ge(t).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(t))}Ue(t,r,n){if(!this.ze(t))return;const i=this.Ge(t);this.it(t,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(t)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(t){this.Be.delete(t)}Ye(t){const r=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let r=this.Be.get(t);return r||(r=new qx,this.Be.set(t,r)),r}st(t){let r=this.qe.get(t);return r||(r=new jr(St),this.qe=this.qe.insert(t,r)),r}ze(t){const r=this.Je(t)!==null;return r||Ve("WatchChangeAggregator","Detected inactive target",t),r}Je(t){const r=this.Be.get(t);return r&&r.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new qx),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.Ue(t,r,null)})}it(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function Yx(){return new Jt(We.comparator)}function Jx(){return new Jt(We.comparator)}const d8={asc:"ASCENDING",desc:"DESCENDING"},p8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},m8={and:"AND",or:"OR"};class g8{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function ym(e,t){return e.useProto3Json||F0(t)?t:{value:t}}function i0(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function SA(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function _8(e,t){return i0(e,t.toTimestamp())}function Xi(e){return Pt(!!e),rt.fromTimestamp(function(r){const n=va(r);return new Sr(n.seconds,n.nanos)}(e))}function p_(e,t){return Em(e,t).canonicalString()}function Em(e,t){const r=function(i){return new $t(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?r:r.child(t)}function IA(e){const t=$t.fromString(e);return Pt(NA(t)),t}function Tm(e,t){return p_(e.databaseId,t.path)}function Gd(e,t){const r=IA(t);if(r.get(1)!==e.databaseId.projectId)throw new je(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new je(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new We(kA(r))}function CA(e,t){return p_(e.databaseId,t)}function v8(e){const t=IA(e);return t.length===4?$t.emptyPath():kA(t)}function wm(e){return new $t(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function kA(e){return Pt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function Qx(e,t,r){return{name:Tm(e,t),fields:r.value.mapValue.fields}}function x8(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:et()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(h,p){return h.useProto3Json?(Pt(p===void 0||typeof p=="string"),Wr.fromBase64String(p||"")):(Pt(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Wr.fromUint8Array(p||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&function(h){const p=h.code===void 0?Ee.UNKNOWN:TA(h.code);return new je(p,h.message||"")}(o);r=new AA(n,i,s,l||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const i=Gd(e,n.document.name),s=Xi(n.document.updateTime),o=n.document.createTime?Xi(n.document.createTime):rt.min(),l=new Sn({mapValue:{fields:n.document.fields}}),u=Jr.newFoundDocument(i,s,o,l),h=n.targetIds||[],p=n.removedTargetIds||[];r=new fh(h,p,u.key,u)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const i=Gd(e,n.document),s=n.readTime?Xi(n.readTime):rt.min(),o=Jr.newNoDocument(i,s),l=n.removedTargetIds||[];r=new fh([],l,o.key,o)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const i=Gd(e,n.document),s=n.removedTargetIds||[];r=new fh([],s,i,null)}else{if(!("filter"in t))return et();{t.filter;const n=t.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,o=new l8(i,s),l=n.targetId;r=new wA(l,o)}}return r}function y8(e,t){let r;if(t instanceof Ku)r={update:Qx(e,t.key,t.value)};else if(t instanceof f_)r={delete:Tm(e,t.key)};else if(t instanceof Sa)r={update:Qx(e,t.key,t.data),updateMask:R8(t.fieldMask)};else{if(!(t instanceof s8))return et();r={verify:Tm(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof r0)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ou)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Lu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof n0)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw et()}(0,n))),t.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:_8(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:et()}(e,t.precondition)),r}function E8(e,t){return e&&e.length>0?(Pt(t!==void 0),e.map(r=>function(i,s){let o=i.updateTime?Xi(i.updateTime):Xi(s);return o.isEqual(rt.min())&&(o=Xi(s)),new r8(o,i.transformResults||[])}(r,t))):[]}function T8(e,t){return{documents:[CA(e,t.path)]}}function w8(e,t){const r={structuredQuery:{}},n=t.path;let i;t.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=CA(e,i);const s=function(h){if(h.length!==0)return PA(Ji.create(h,"and"))}(t.filters);s&&(r.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(p=>function(_){return{field:Bo(_.field),direction:I8(_.dir)}}(p))}(t.orderBy);o&&(r.structuredQuery.orderBy=o);const l=ym(e,t.limit);return l!==null&&(r.structuredQuery.limit=l),t.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(t.endAt)),{_t:r,parent:i}}function A8(e){let t=v8(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Pt(n===1);const p=r.from[0];p.allDescendants?i=p.collectionId:t=t.child(p.collectionId)}let s=[];r.where&&(s=function(m){const _=RA(m);return _ instanceof Ji&&aA(_)?_.getFilters():[_]}(r.where));let o=[];r.orderBy&&(o=function(m){return m.map(_=>function(E){return new t0(Uo(E.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(_))}(r.orderBy));let l=null;r.limit&&(l=function(m){let _;return _=typeof m=="object"?m.value:m,F0(_)?null:_}(r.limit));let u=null;r.startAt&&(u=function(m){const _=!!m.before,x=m.values||[];return new e0(x,_)}(r.startAt));let h=null;return r.endAt&&(h=function(m){const _=!m.before,x=m.values||[];return new e0(x,_)}(r.endAt)),jM(t,i,o,s,l,"F",u,h)}function S8(e,t){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return et()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function RA(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Uo(r.unaryFilter.field);return yr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Uo(r.unaryFilter.field);return yr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Uo(r.unaryFilter.field);return yr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Uo(r.unaryFilter.field);return yr.create(o,"!=",{nullValue:"NULL_VALUE"});default:return et()}}(e):e.fieldFilter!==void 0?function(r){return yr.create(Uo(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return et()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return Ji.create(r.compositeFilter.filters.map(n=>RA(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return et()}}(r.compositeFilter.op))}(e):et()}function I8(e){return d8[e]}function C8(e){return p8[e]}function k8(e){return m8[e]}function Bo(e){return{fieldPath:e.canonicalString()}}function Uo(e){return Br.fromServerFormat(e.fieldPath)}function PA(e){return e instanceof yr?function(r){if(r.op==="=="){if(Ux(r.value))return{unaryFilter:{field:Bo(r.field),op:"IS_NAN"}};if(Bx(r.value))return{unaryFilter:{field:Bo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Ux(r.value))return{unaryFilter:{field:Bo(r.field),op:"IS_NOT_NAN"}};if(Bx(r.value))return{unaryFilter:{field:Bo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bo(r.field),op:C8(r.op),value:r.value}}}(e):e instanceof Ji?function(r){const n=r.getFilters().map(i=>PA(i));return n.length===1?n[0]:{compositeFilter:{op:k8(r.op),filters:n}}}(e):et()}function R8(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function NA(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(t,r,n,i,s=rt.min(),o=rt.min(),l=Wr.EMPTY_BYTE_STRING,u=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(t){return new ea(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new ea(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ea(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ea(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P8{constructor(t){this.ct=t}}function N8(e){const t=A8({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?xm(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O8{constructor(){this.un=new L8}addToCollectionParentIndex(t,r){return this.un.add(r),we.resolve()}getCollectionParents(t,r){return we.resolve(this.un.getEntries(r))}addFieldIndex(t,r){return we.resolve()}deleteFieldIndex(t,r){return we.resolve()}deleteAllFieldIndexes(t){return we.resolve()}createTargetIndexes(t,r){return we.resolve()}getDocumentsMatchingTarget(t,r){return we.resolve(null)}getIndexType(t,r){return we.resolve(0)}getFieldIndexes(t,r){return we.resolve([])}getNextCollectionGroupToUpdate(t){return we.resolve(null)}getMinOffset(t,r){return we.resolve(_a.min())}getMinOffsetFromCollectionGroup(t,r){return we.resolve(_a.min())}updateCollectionGroup(t,r,n){return we.resolve()}updateIndexEntries(t,r){return we.resolve()}}class L8{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),i=this.index[r]||new jr($t.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(t){const r=t.lastSegment(),n=t.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(t){return(this.index[t]||new jr($t.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new Il(0)}static kn(){return new Il(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D8{constructor(){this.changes=new Bl(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Jr.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?we.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F8{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b8{constructor(t,r,n,i){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(t,r))).next(i=>(n!==null&&qc(n.mutation,i,jn.empty(),Sr.now()),i))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,dt()).next(()=>n))}getLocalViewOfDocuments(t,r,n=dt()){const i=Ma();return this.populateOverlays(t,i,r).next(()=>this.computeViews(t,r,i,n).next(s=>{let o=Ic();return s.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(t,r){const n=Ma();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,dt()))}populateOverlays(t,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((o,l)=>{r.set(o,l)})})}computeViews(t,r,n,i){let s=Rs();const o=Xc(),l=function(){return Xc()}();return r.forEach((u,h)=>{const p=n.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof Sa)?s=s.insert(h.key,h):p!==void 0?(o.set(h.key,p.mutation.getFieldMask()),qc(p.mutation,h,p.mutation.getFieldMask(),Sr.now())):o.set(h.key,jn.empty())}),this.recalculateAndSaveOverlays(t,s).next(u=>(u.forEach((h,p)=>o.set(h,p)),r.forEach((h,p)=>{var m;return l.set(h,new F8(p,(m=o.get(h))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(t,r){const n=Xc();let i=new Jt((o,l)=>o-l),s=dt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(o=>{for(const l of o)l.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let p=n.get(u)||jn.empty();p=l.applyToLocalView(h,p),n.set(u,p);const m=(i.get(l.batchId)||dt()).add(u);i=i.insert(l.batchId,m)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,m=pA();p.forEach(_=>{if(!s.has(_)){const x=yA(r.get(_),n.get(_));x!==null&&m.set(_,x),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(t,h,m))}return we.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,i){return function(o){return We.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):HM(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,i):this.getDocumentsMatchingCollectionQuery(t,r,n,i)}getNextDocuments(t,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,i-s.size):we.resolve(Ma());let l=-1,u=s;return o.next(h=>we.forEach(h,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(p)?we.resolve():this.remoteDocumentCache.getEntry(t,p).next(_=>{u=u.insert(p,_)}))).next(()=>this.populateOverlays(t,h,s)).next(()=>this.computeViews(t,u,h,dt())).next(p=>({batchId:l,changes:dA(p)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new We(r)).next(n=>{let i=Ic();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(t,r,n,i){const s=r.collectionGroup;let o=Ic();return this.indexManager.getCollectionParents(t,s).next(l=>we.forEach(l,u=>{const h=function(m,_){return new b0(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(r,u.child(s));return this.getDocumentsMatchingCollectionQuery(t,h,n,i).next(p=>{p.forEach((m,_)=>{o=o.insert(m,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,s,i))).next(o=>{s.forEach((u,h)=>{const p=h.getKey();o.get(p)===null&&(o=o.insert(p,Jr.newInvalidDocument(p)))});let l=Ic();return o.forEach((u,h)=>{const p=s.get(u);p!==void 0&&qc(p.mutation,h,jn.empty(),Sr.now()),B0(r,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M8{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,r){return we.resolve(this.hr.get(r))}saveBundleMetadata(t,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Xi(i.createTime)}}(r)),we.resolve()}getNamedQuery(t,r){return we.resolve(this.Pr.get(r))}saveNamedQuery(t,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:N8(i.bundledQuery),readTime:Xi(i.readTime)}}(r)),we.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B8{constructor(){this.overlays=new Jt(We.comparator),this.Ir=new Map}getOverlay(t,r){return we.resolve(this.overlays.get(r))}getOverlays(t,r){const n=Ma();return we.forEach(r,i=>this.getOverlay(t,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((i,s)=>{this.ht(t,r,s)}),we.resolve()}removeOverlaysForBatchId(t,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),we.resolve()}getOverlaysForCollection(t,r,n){const i=Ma(),s=r.length+1,o=new We(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>n&&i.set(u.getKey(),u)}return we.resolve(i)}getOverlaysForCollectionGroup(t,r,n,i){let s=new Jt((h,p)=>h-p);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let p=s.get(h.largestBatchId);p===null&&(p=Ma(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=Ma(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=i)););return we.resolve(l)}ht(t,r,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new o8(r,n));let s=this.Ir.get(r);s===void 0&&(s=dt(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U8{constructor(){this.sessionToken=Wr.EMPTY_BYTE_STRING}getSessionToken(t){return we.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,we.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(){this.Tr=new jr(Pr.Er),this.dr=new jr(Pr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,r){const n=new Pr(t,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.Vr(new Pr(t,r))}mr(t,r){t.forEach(n=>this.removeReference(n,r))}gr(t){const r=new We(new $t([])),n=new Pr(r,t),i=new Pr(r,t+1),s=[];return this.dr.forEachInRange([n,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const r=new We(new $t([])),n=new Pr(r,t),i=new Pr(r,t+1);let s=dt();return this.dr.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(t){const r=new Pr(t,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class Pr{constructor(t,r){this.key=t,this.wr=r}static Er(t,r){return We.comparator(t.key,r.key)||St(t.wr,r.wr)}static Ar(t,r){return St(t.wr,r.wr)||We.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V8{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new jr(Pr.Er)}checkEmpty(t){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new a8(s,r,n,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new Pr(l.key,s)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast());return we.resolve(o)}lookupMutationBatch(t,r){return we.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return we.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new Pr(r,0),i=new Pr(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],o=>{const l=this.Dr(o.wr);s.push(l)}),we.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new jr(St);return r.forEach(i=>{const s=new Pr(i,0),o=new Pr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{n=n.add(l.wr)})}),we.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,i=n.length+1;let s=n;We.isDocumentKey(s)||(s=s.child(""));const o=new Pr(new We(s),0);let l=new jr(St);return this.br.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(l=l.add(u.wr)),!0)},o),we.resolve(this.Cr(l))}Cr(t){const r=[];return t.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(t,r){Pt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return we.forEach(r.mutations,i=>{const s=new Pr(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.br=n})}On(t){}containsKey(t,r){const n=new Pr(r,0),i=this.br.firstAfterOrEqual(n);return we.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,we.resolve()}Fr(t,r){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const r=this.vr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z8{constructor(t){this.Mr=t,this.docs=function(){return new Jt(We.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return we.resolve(n?n.document.mutableCopy():Jr.newInvalidDocument(r))}getEntries(t,r){let n=Rs();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Jr.newInvalidDocument(i))}),we.resolve(n)}getDocumentsMatchingQuery(t,r,n,i){let s=Rs();const o=r.path,l=new We(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||wM(TM(p),n)<=0||(i.has(p.key)||B0(r,p))&&(s=s.insert(p.key,p.mutableCopy()))}return we.resolve(s)}getAllFromCollectionGroup(t,r,n,i){et()}Or(t,r){return we.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new j8(this)}getSize(t){return we.resolve(this.size)}}class j8 extends D8{constructor(t){super(),this.cr=t}applyChanges(t){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(t,i)):this.cr.removeEntry(n)}),we.waitFor(r)}getFromCache(t,r){return this.cr.getEntry(t,r)}getAllFromCache(t,r){return this.cr.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(t){this.persistence=t,this.Nr=new Bl(r=>o_(r),l_),this.lastRemoteSnapshotVersion=rt.min(),this.highestTargetId=0,this.Lr=0,this.Br=new m_,this.targetCount=0,this.kr=Il.Bn()}forEachTarget(t,r){return this.Nr.forEach((n,i)=>r(i)),we.resolve()}getLastRemoteSnapshotVersion(t){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return we.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),we.resolve()}Kn(t){this.Nr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.kr=new Il(r),this.highestTargetId=r),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,r){return this.Kn(r),this.targetCount+=1,we.resolve()}updateTargetData(t,r){return this.Kn(r),we.resolve()}removeTargetData(t,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,we.resolve()}removeTargets(t,r,n){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(t,l.targetId)),i++)}),we.waitFor(s).next(()=>i)}getTargetCount(t){return we.resolve(this.targetCount)}getTargetData(t,r){const n=this.Nr.get(r)||null;return we.resolve(n)}addMatchingKeys(t,r,n){return this.Br.Rr(r,n),we.resolve()}removeMatchingKeys(t,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(o=>{s.push(i.markPotentiallyOrphaned(t,o))}),we.waitFor(s)}removeMatchingKeysForTargetId(t,r){return this.Br.gr(r),we.resolve()}getMatchingKeysForTargetId(t,r){const n=this.Br.yr(r);return we.resolve(n)}containsKey(t,r){return we.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W8{constructor(t,r){this.qr={},this.overlays={},this.Qr=new n_(0),this.Kr=!1,this.Kr=!0,this.$r=new U8,this.referenceDelegate=t(this),this.Ur=new H8(this),this.indexManager=new O8,this.remoteDocumentCache=function(i){return new z8(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new P8(r),this.Gr=new M8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new B8,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.qr[t.toKey()];return n||(n=new V8(r,this.referenceDelegate),this.qr[t.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,r,n){Ve("MemoryPersistence","Starting transaction:",t);const i=new G8(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(t,r){return we.or(Object.values(this.qr).map(n=>()=>n.containsKey(t,r)))}}class G8 extends SM{constructor(t){super(),this.currentSequenceNumber=t}}class g_{constructor(t){this.persistence=t,this.Jr=new m_,this.Yr=null}static Zr(t){return new g_(t)}get Xr(){if(this.Yr)return this.Yr;throw et()}addReference(t,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),we.resolve()}removeReference(t,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),we.resolve()}markPotentiallyOrphaned(t,r){return this.Xr.add(r.toString()),we.resolve()}removeTarget(t,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(t,r))}zr(){this.Yr=new Set}jr(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.Xr,n=>{const i=We.fromPath(n);return this.ei(t,i).next(s=>{s||r.removeEntry(i,rt.min())})}).next(()=>(this.Yr=null,r.apply(t)))}updateLimboDocument(t,r){return this.ei(t,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(t){return 0}ei(t,r){return we.or([()=>we.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Hr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(t,r,n,i){this.targetId=t,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(t,r){let n=dt(),i=dt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new __(t,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z8{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Kb()?8:IM($b())>0?6:4}()}initialize(t,r){this.Ji=t,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(t,r,n,i){const s={result:null};return this.Yi(t,r).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(t,r,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new $8;return this.Xi(t,r,o).next(l=>{if(s.result=l,this.zi)return this.es(t,r,o,l.size)})}).next(()=>s.result)}es(t,r,n,i){return n.documentReadCount<this.ji?(mc()<=Et.DEBUG&&Ve("QueryEngine","SDK will not create cache indexes for query:",Mo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),we.resolve()):(mc()<=Et.DEBUG&&Ve("QueryEngine","Query:",Mo(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(mc()<=Et.DEBUG&&Ve("QueryEngine","The SDK decides to create cache indexes for query:",Mo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ki(r))):we.resolve())}Yi(t,r){if(Hx(r))return we.resolve(null);let n=Ki(r);return this.indexManager.getIndexType(t,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=xm(r,null,"F"),n=Ki(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(s=>{const o=dt(...s);return this.Ji.getDocuments(t,o).next(l=>this.indexManager.getMinOffset(t,n).next(u=>{const h=this.ts(r,l);return this.ns(r,h,o,u.readTime)?this.Yi(t,xm(r,null,"F")):this.rs(t,h,r,u)}))})))}Zi(t,r,n,i){return Hx(r)||i.isEqual(rt.min())?we.resolve(null):this.Ji.getDocuments(t,n).next(s=>{const o=this.ts(r,s);return this.ns(r,o,n,i)?we.resolve(null):(mc()<=Et.DEBUG&&Ve("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Mo(r)),this.rs(t,o,r,EM(i,-1)).next(l=>l))})}ts(t,r){let n=new jr(fA(t));return r.forEach((i,s)=>{B0(t,s)&&(n=n.add(s))}),n}ns(t,r,n,i){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const s=t.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(t,r,n){return mc()<=Et.DEBUG&&Ve("QueryEngine","Using full collection scan to execute query:",Mo(r)),this.Ji.getDocumentsMatchingQuery(t,r,_a.min(),n)}rs(t,r,n,i){return this.Ji.getDocumentsMatchingQuery(t,n,i).next(s=>(r.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K8{constructor(t,r,n,i){this.persistence=t,this.ss=r,this.serializer=i,this.os=new Jt(St),this._s=new Bl(s=>o_(s),l_),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(n)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new b8(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.os))}}function X8(e,t,r,n){return new K8(e,t,r,n)}async function OA(e,t){const r=nt(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(t),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let u=dt();for(const h of i){o.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of s){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return r.localDocuments.getDocuments(n,u).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:l}))})})}function q8(e,t){const r=nt(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=t.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const m=h.batch,_=m.keys();let x=we.resolve();return _.forEach(E=>{x=x.next(()=>p.getEntry(u,E)).next(y=>{const A=h.docVersions.get(E);Pt(A!==null),y.version.compareTo(A)<0&&(m.applyToRemoteDocument(y,h),y.isValidDocument()&&(y.setReadTime(h.commitVersion),p.addEntry(y)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(u,m))}(r,n,t,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=dt();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(t))).next(()=>r.localDocuments.getDocuments(n,i))})}function LA(e){const t=nt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Ur.getLastRemoteSnapshotVersion(r))}function Y8(e,t){const r=nt(e),n=t.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const l=[];t.targetChanges.forEach((p,m)=>{const _=i.get(m);if(!_)return;l.push(r.Ur.removeMatchingKeys(s,p.removedDocuments,m).next(()=>r.Ur.addMatchingKeys(s,p.addedDocuments,m)));let x=_.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(m)!==null?x=x.withResumeToken(Wr.EMPTY_BYTE_STRING,rt.min()).withLastLimboFreeSnapshotVersion(rt.min()):p.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(p.resumeToken,n)),i=i.insert(m,x),function(y,A,C){return y.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(_,x,p)&&l.push(r.Ur.updateTargetData(s,x))});let u=Rs(),h=dt();if(t.documentUpdates.forEach(p=>{t.resolvedLimboDocuments.has(p)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(J8(s,o,t.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!n.isEqual(rt.min())){const p=r.Ur.getLastRemoteSnapshotVersion(s).next(m=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(p)}return we.waitFor(l).next(()=>o.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(r.os=i,s))}function J8(e,t,r){let n=dt(),i=dt();return r.forEach(s=>n=n.add(s)),t.getEntries(e,n).next(s=>{let o=Rs();return r.forEach((l,u)=>{const h=s.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(rt.min())?(t.removeEntry(l,u.readTime),o=o.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(l,u)):Ve("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:o,Is:i}})}function Q8(e,t){const r=nt(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function e5(e,t){const r=nt(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,t).next(s=>s?(i=s,we.resolve(i)):r.Ur.allocateTargetId(n).next(o=>(i=new ea(t,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(t,n.targetId)),n})}async function Am(e,t,r){const n=nt(e),i=n.os.get(t),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Zu(o))throw o;Ve("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}n.os=n.os.remove(t),n._s.delete(i.target)}function ey(e,t,r){const n=nt(e);let i=rt.min(),s=dt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,p){const m=nt(u),_=m._s.get(p);return _!==void 0?we.resolve(m.os.get(_)):m.Ur.getTargetData(h,p)}(n,o,Ki(t)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{s=u})}).next(()=>n.ss.getDocumentsMatchingQuery(o,t,r?i:rt.min(),r?s:dt())).next(l=>(t5(n,GM(t),l),{documents:l,Ts:s})))}function t5(e,t,r){let n=e.us.get(t)||rt.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),e.us.set(t,n)}class ty{constructor(){this.activeTargetIds=YM()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class r5{constructor(){this.so=new ty,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t,r=!0){return r&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,r,n){this.oo[t]=r}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new ty,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n5{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ve("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){Ve("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xf=null;function $d(){return Xf===null?Xf=function(){return 268435456+Math.round(2147483648*Math.random())}():Xf++,"0x"+Xf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s5{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr="WebChannelConnection";class a5 extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,o){const l=$d(),u=this.xo(r,n.toUriEncodedString());Ve("RestConnection",`Sending RPC '${r}' ${l}:`,u,i);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,s,o),this.No(r,u,h,i).then(p=>(Ve("RestConnection",`Received RPC '${r}' ${l}: `,p),p),p=>{throw Tl("RestConnection",`RPC '${r}' ${l} failed with error: `,p,"url: ",u,"request:",i),p})}Lo(r,n,i,s,o,l){return this.Mo(r,n,i,s,o)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ml}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>r[o]=s),i&&i.headers.forEach((s,o)=>r[o]=s)}xo(r,n){const i=i5[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,r,n,i){const s=$d();return new Promise((o,l)=>{const u=new Kw;u.setWithCredentials(!0),u.listenOnce(Xw.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case lh.NO_ERROR:const p=u.getResponseJson();Ve(Kr,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(p)),o(p);break;case lh.TIMEOUT:Ve(Kr,`RPC '${t}' ${s} timed out`),l(new je(Ee.DEADLINE_EXCEEDED,"Request time out"));break;case lh.HTTP_ERROR:const m=u.getStatus();if(Ve(Kr,`RPC '${t}' ${s} failed with status:`,m,"response text:",u.getResponseText()),m>0){let _=u.getResponseJson();Array.isArray(_)&&(_=_[0]);const x=_==null?void 0:_.error;if(x&&x.status&&x.message){const E=function(A){const C=A.toLowerCase().replace(/_/g,"-");return Object.values(Ee).indexOf(C)>=0?C:Ee.UNKNOWN}(x.status);l(new je(E,x.message))}else l(new je(Ee.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new je(Ee.UNAVAILABLE,"Connection failed."));break;default:et()}}finally{Ve(Kr,`RPC '${t}' ${s} completed.`)}});const h=JSON.stringify(i);Ve(Kr,`RPC '${t}' ${s} sending request:`,i),u.send(r,"POST",h,n,15)})}Bo(t,r,n){const i=$d(),s=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Jw(),l=Yw(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const p=s.join("");Ve(Kr,`Creating RPC '${t}' stream ${i}: ${p}`,u);const m=o.createWebChannel(p,u);let _=!1,x=!1;const E=new s5({Io:A=>{x?Ve(Kr,`Not sending because RPC '${t}' stream ${i} is closed:`,A):(_||(Ve(Kr,`Opening RPC '${t}' stream ${i} transport.`),m.open(),_=!0),Ve(Kr,`RPC '${t}' stream ${i} sending:`,A),m.send(A))},To:()=>m.close()}),y=(A,C,k)=>{A.listen(C,w=>{try{k(w)}catch(V){setTimeout(()=>{throw V},0)}})};return y(m,Sc.EventType.OPEN,()=>{x||(Ve(Kr,`RPC '${t}' stream ${i} transport opened.`),E.yo())}),y(m,Sc.EventType.CLOSE,()=>{x||(x=!0,Ve(Kr,`RPC '${t}' stream ${i} transport closed`),E.So())}),y(m,Sc.EventType.ERROR,A=>{x||(x=!0,Tl(Kr,`RPC '${t}' stream ${i} transport errored:`,A),E.So(new je(Ee.UNAVAILABLE,"The operation could not be completed")))}),y(m,Sc.EventType.MESSAGE,A=>{var C;if(!x){const k=A.data[0];Pt(!!k);const w=k,V=w.error||((C=w[0])===null||C===void 0?void 0:C.error);if(V){Ve(Kr,`RPC '${t}' stream ${i} received error:`,V);const Q=V.status;let X=function(P){const D=dr[P];if(D!==void 0)return TA(D)}(Q),S=V.message;X===void 0&&(X=Ee.INTERNAL,S="Unknown error status: "+Q+" with message "+V.message),x=!0,E.So(new je(X,S)),m.close()}else Ve(Kr,`RPC '${t}' stream ${i} received:`,k),E.bo(k)}}),y(l,qw.STAT_EVENT,A=>{A.stat===pm.PROXY?Ve(Kr,`RPC '${t}' stream ${i} detected buffering proxy`):A.stat===pm.NOPROXY&&Ve(Kr,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.wo()},0),E}}function Zd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0(e){return new g8(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(t,r,n=1e3,i=1.5,s=6e4){this.ui=t,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Ve("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(t,r,n,i,s,o,l,u){this.ui=t,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new DA(t,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():r&&r.code===Ee.RESOURCE_EXHAUSTED?(ks(r.toString()),ks("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(r)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{t(()=>{const i=new je(Ee.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(t,r){const n=this.h_(this.Yo);this.stream=this.T_(t,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return Ve("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return r=>{this.ui.enqueueAndForget(()=>this.Yo===t?r():(Ve("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class o5 extends FA{constructor(t,r,n,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,o),this.serializer=s}T_(t,r){return this.connection.Bo("Listen",t,r)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const r=x8(this.serializer,t),n=function(s){if(!("targetChange"in s))return rt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?rt.min():o.readTime?Xi(o.readTime):rt.min()}(t);return this.listener.d_(r,n)}A_(t){const r={};r.database=wm(this.serializer),r.addTarget=function(s,o){let l;const u=o.target;if(l=vm(u)?{documents:T8(s,u)}:{query:w8(s,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=SA(s,o.resumeToken);const h=ym(s,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo(rt.min())>0){l.readTime=i0(s,o.snapshotVersion.toTimestamp());const h=ym(s,o.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,t);const n=S8(this.serializer,t);n&&(r.labels=n),this.a_(r)}R_(t){const r={};r.database=wm(this.serializer),r.removeTarget=t,this.a_(r)}}class l5 extends FA{constructor(t,r,n,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,r){return this.connection.Bo("Write",t,r)}E_(t){return Pt(!!t.streamToken),this.lastStreamToken=t.streamToken,Pt(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){Pt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const r=E8(t.writeResults,t.commitTime),n=Xi(t.commitTime);return this.listener.g_(n,r)}p_(){const t={};t.database=wm(this.serializer),this.a_(t)}m_(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>y8(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5 extends class{}{constructor(t,r,n,i){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new je(Ee.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(t,Em(r,n),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new je(Ee.UNKNOWN,s.toString())})}Lo(t,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(t,Em(r,n),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new je(Ee.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class u5{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ks(r),this.D_=!1):Ve("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(t,r,n,i,s){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{n.enqueueAndForget(async()=>{ho(this)&&(Ve("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=nt(u);h.L_.add(4),await qu(h),h.q_.set("Unknown"),h.L_.delete(4),await H0(h)}(this))})}),this.q_=new u5(n,i)}}async function H0(e){if(ho(e))for(const t of e.B_)await t(!0)}async function qu(e){for(const t of e.B_)await t(!1)}function bA(e,t){const r=nt(e);r.N_.has(t.targetId)||(r.N_.set(t.targetId,t),E_(r)?y_(r):Ul(r).r_()&&x_(r,t))}function v_(e,t){const r=nt(e),n=Ul(r);r.N_.delete(t),n.r_()&&MA(r,t),r.N_.size===0&&(n.r_()?n.o_():ho(r)&&r.q_.set("Unknown"))}function x_(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(rt.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Ul(e).A_(t)}function MA(e,t){e.Q_.xe(t),Ul(e).R_(t)}function y_(e){e.Q_=new h8({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Ul(e).start(),e.q_.v_()}function E_(e){return ho(e)&&!Ul(e).n_()&&e.N_.size>0}function ho(e){return nt(e).L_.size===0}function BA(e){e.Q_=void 0}async function h5(e){e.q_.set("Online")}async function d5(e){e.N_.forEach((t,r)=>{x_(e,t)})}async function p5(e,t){BA(e),E_(e)?(e.q_.M_(t),y_(e)):e.q_.set("Unknown")}async function m5(e,t,r){if(e.q_.set("Online"),t instanceof AA&&t.state===2&&t.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(e,t)}catch(n){Ve("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await s0(e,n)}else if(t instanceof fh?e.Q_.Ke(t):t instanceof wA?e.Q_.He(t):e.Q_.We(t),!r.isEqual(rt.min()))try{const n=await LA(e.localStore);r.compareTo(n)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=s.N_.get(h);p&&s.N_.set(h,p.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,h)=>{const p=s.N_.get(u);if(!p)return;s.N_.set(u,p.withResumeToken(Wr.EMPTY_BYTE_STRING,p.snapshotVersion)),MA(s,u);const m=new ea(p.target,u,h,p.sequenceNumber);x_(s,m)}),s.remoteSyncer.applyRemoteEvent(l)}(e,r)}catch(n){Ve("RemoteStore","Failed to raise snapshot:",n),await s0(e,n)}}async function s0(e,t,r){if(!Zu(t))throw t;e.L_.add(1),await qu(e),e.q_.set("Offline"),r||(r=()=>LA(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Ve("RemoteStore","Retrying IndexedDB access"),await r(),e.L_.delete(1),await H0(e)})}function UA(e,t){return t().catch(r=>s0(e,r,t))}async function W0(e){const t=nt(e),r=xa(t);let n=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;g5(t);)try{const i=await Q8(t.localStore,n);if(i===null){t.O_.length===0&&r.o_();break}n=i.batchId,_5(t,i)}catch(i){await s0(t,i)}VA(t)&&zA(t)}function g5(e){return ho(e)&&e.O_.length<10}function _5(e,t){e.O_.push(t);const r=xa(e);r.r_()&&r.V_&&r.m_(t.mutations)}function VA(e){return ho(e)&&!xa(e).n_()&&e.O_.length>0}function zA(e){xa(e).start()}async function v5(e){xa(e).p_()}async function x5(e){const t=xa(e);for(const r of e.O_)t.m_(r.mutations)}async function y5(e,t,r){const n=e.O_.shift(),i=h_.from(n,t,r);await UA(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await W0(e)}async function E5(e,t){t&&xa(e).V_&&await async function(n,i){if(function(o){return c8(o)&&o!==Ee.ABORTED}(i.code)){const s=n.O_.shift();xa(n).s_(),await UA(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await W0(n)}}(e,t),VA(e)&&zA(e)}async function ny(e,t){const r=nt(e);r.asyncQueue.verifyOperationInProgress(),Ve("RemoteStore","RemoteStore received new credentials");const n=ho(r);r.L_.add(3),await qu(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.L_.delete(3),await H0(r)}async function T5(e,t){const r=nt(e);t?(r.L_.delete(2),await H0(r)):t||(r.L_.add(2),await qu(r),r.q_.set("Unknown"))}function Ul(e){return e.K_||(e.K_=function(r,n,i){const s=nt(r);return s.w_(),new o5(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Eo:h5.bind(null,e),Ro:d5.bind(null,e),mo:p5.bind(null,e),d_:m5.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),E_(e)?y_(e):e.q_.set("Unknown")):(await e.K_.stop(),BA(e))})),e.K_}function xa(e){return e.U_||(e.U_=function(r,n,i){const s=nt(r);return s.w_(),new l5(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:v5.bind(null,e),mo:E5.bind(null,e),f_:x5.bind(null,e),g_:y5.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await W0(e)):(await e.U_.stop(),e.O_.length>0&&(Ve("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))})),e.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(t,r,n,i,s){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,i,s){const o=Date.now()+n,l=new T_(t,r,o,i,s);return l.start(n),l}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new je(Ee.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function w_(e,t){if(ks("AsyncQueue",`${t}: ${e}`),Zu(e))return new je(Ee.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(t){this.comparator=t?(r,n)=>t(r,n)||We.comparator(r.key,n.key):(r,n)=>We.comparator(r.key,n.key),this.keyedMap=Ic(),this.sortedSet=new Jt(this.comparator)}static emptySet(t){return new fl(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof fl)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new fl;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(){this.W_=new Jt(We.comparator)}track(t){const r=t.doc.key,n=this.W_.get(r);n?t.type!==0&&n.type===3?this.W_=this.W_.insert(r,t):t.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.W_=this.W_.remove(r):t.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):et():this.W_=this.W_.insert(r,t)}G_(){const t=[];return this.W_.inorderTraversal((r,n)=>{t.push(n)}),t}}class Cl{constructor(t,r,n,i,s,o,l,u,h){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,r,n,i,s){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new Cl(t,r,fl.emptySet(r),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&M0(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class A5{constructor(){this.queries=sy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=nt(r),s=i.queries;i.queries=sy(),s.forEach((o,l)=>{for(const u of l.j_)u.onError(n)})})(this,new je(Ee.ABORTED,"Firestore shutting down"))}}function sy(){return new Bl(e=>uA(e),M0)}async function jA(e,t){const r=nt(e);let n=3;const i=t.query;let s=r.queries.get(i);s?!s.H_()&&t.J_()&&(n=2):(s=new w5,n=t.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(o){const l=w_(o,`Initialization of query '${Mo(t.query)}' failed`);return void t.onError(l)}r.queries.set(i,s),s.j_.push(t),t.Z_(r.onlineState),s.z_&&t.X_(s.z_)&&A_(r)}async function HA(e,t){const r=nt(e),n=t.query;let i=3;const s=r.queries.get(n);if(s){const o=s.j_.indexOf(t);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=t.J_()?0:1:!s.H_()&&t.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function S5(e,t){const r=nt(e);let n=!1;for(const i of t){const s=i.query,o=r.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(n=!0);o.z_=i}}n&&A_(r)}function I5(e,t,r){const n=nt(e),i=n.queries.get(t);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(t)}function A_(e){e.Y_.forEach(t=>{t.next()})}var Sm,ay;(ay=Sm||(Sm={})).ea="default",ay.Cache="cache";class WA{constructor(t,r,n){this.query=t,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(t){if(!this.options.includeMetadataChanges){const n=[];for(const i of t.docChanges)i.type!==3&&n.push(i);t=new Cl(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.na?this.ia(t)&&(this.ta.next(t),r=!0):this.sa(t,this.onlineState)&&(this.oa(t),r=!0),this.ra=t,r}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),r=!0),r}sa(t,r){if(!t.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(t){t=Cl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==Sm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(t){this.key=t}}class $A{constructor(t){this.key=t}}class C5{constructor(t,r){this.query=t,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=dt(),this.mutatedKeys=dt(),this.Aa=fA(t),this.Ra=new fl(this.Aa)}get Va(){return this.Ta}ma(t,r){const n=r?r.fa:new iy,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((p,m)=>{const _=i.get(p),x=B0(this.query,m)?m:null,E=!!_&&this.mutatedKeys.has(_.key),y=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let A=!1;_&&x?_.data.isEqual(x.data)?E!==y&&(n.track({type:3,doc:x}),A=!0):this.ga(_,x)||(n.track({type:2,doc:x}),A=!0,(u&&this.Aa(x,u)>0||h&&this.Aa(x,h)<0)&&(l=!0)):!_&&x?(n.track({type:0,doc:x}),A=!0):_&&!x&&(n.track({type:1,doc:_}),A=!0,(u||h)&&(l=!0)),A&&(x?(o=o.add(x),s=y?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),n.track({type:1,doc:p})}return{Ra:o,fa:n,ns:l,mutatedKeys:s}}ga(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n,i){const s=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const o=t.fa.G_();o.sort((p,m)=>function(x,E){const y=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return et()}};return y(x)-y(E)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(n),i=i!=null&&i;const l=r&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,h=u!==this.Ea;return this.Ea=u,o.length!==0||h?{snapshot:new Cl(this.query,t.Ra,s,o,t.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new iy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=dt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return t.forEach(n=>{this.da.has(n)||r.push(new $A(n))}),this.da.forEach(n=>{t.has(n)||r.push(new GA(n))}),r}ba(t){this.Ta=t.Ts,this.da=dt();const r=this.ma(t.documents);return this.applyChanges(r,!0)}Da(){return Cl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class k5{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class R5{constructor(t){this.key=t,this.va=!1}}class P5{constructor(t,r,n,i,s,o){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Bl(l=>uA(l),M0),this.Ma=new Map,this.xa=new Set,this.Oa=new Jt(We.comparator),this.Na=new Map,this.La=new m_,this.Ba={},this.ka=new Map,this.qa=Il.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function N5(e,t,r=!0){const n=JA(e);let i;const s=n.Fa.get(t);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await ZA(n,t,r,!0),i}async function O5(e,t){const r=JA(e);await ZA(r,t,!0,!1)}async function ZA(e,t,r,n){const i=await e5(e.localStore,Ki(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,r);let l;return n&&(l=await L5(e,t,s,o==="current",i.resumeToken)),e.isPrimaryClient&&r&&bA(e.remoteStore,i),l}async function L5(e,t,r,n,i){e.Ka=(m,_,x)=>async function(y,A,C,k){let w=A.view.ma(C);w.ns&&(w=await ey(y.localStore,A.query,!1).then(({documents:S})=>A.view.ma(S,w)));const V=k&&k.targetChanges.get(A.targetId),Q=k&&k.targetMismatches.get(A.targetId)!=null,X=A.view.applyChanges(w,y.isPrimaryClient,V,Q);return ly(y,A.targetId,X.wa),X.snapshot}(e,m,_,x);const s=await ey(e.localStore,t,!0),o=new C5(t,s.Ts),l=o.ma(s.documents),u=Xu.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",i),h=o.applyChanges(l,e.isPrimaryClient,u);ly(e,r,h.wa);const p=new k5(t,r,o);return e.Fa.set(t,p),e.Ma.has(r)?e.Ma.get(r).push(t):e.Ma.set(r,[t]),h.snapshot}async function D5(e,t,r){const n=nt(e),i=n.Fa.get(t),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(o=>!M0(o,t))),void n.Fa.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Am(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&v_(n.remoteStore,i.targetId),Im(n,i.targetId)}).catch($u)):(Im(n,i.targetId),await Am(n.localStore,i.targetId,!0))}async function F5(e,t){const r=nt(e),n=r.Fa.get(t),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),v_(r.remoteStore,n.targetId))}async function b5(e,t,r){const n=H5(e);try{const i=await function(o,l){const u=nt(o),h=Sr.now(),p=l.reduce((x,E)=>x.add(E.key),dt());let m,_;return u.persistence.runTransaction("Locally write mutations","readwrite",x=>{let E=Rs(),y=dt();return u.cs.getEntries(x,p).next(A=>{E=A,E.forEach((C,k)=>{k.isValidDocument()||(y=y.add(C))})}).next(()=>u.localDocuments.getOverlayedDocuments(x,E)).next(A=>{m=A;const C=[];for(const k of l){const w=i8(k,m.get(k.key).overlayedDocument);w!=null&&C.push(new Sa(k.key,w,nA(w.value.mapValue),ui.exists(!0)))}return u.mutationQueue.addMutationBatch(x,h,C,l)}).next(A=>{_=A;const C=A.applyToLocalDocumentSet(m,y);return u.documentOverlayCache.saveOverlays(x,A.batchId,C)})}).then(()=>({batchId:_.batchId,changes:dA(m)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(i.batchId),function(o,l,u){let h=o.Ba[o.currentUser.toKey()];h||(h=new Jt(St)),h=h.insert(l,u),o.Ba[o.currentUser.toKey()]=h}(n,i.batchId,r),await Yu(n,i.changes),await W0(n.remoteStore)}catch(i){const s=w_(i,"Failed to persist write");r.reject(s)}}async function KA(e,t){const r=nt(e);try{const n=await Y8(r.localStore,t);t.targetChanges.forEach((i,s)=>{const o=r.Na.get(s);o&&(Pt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Pt(o.va):i.removedDocuments.size>0&&(Pt(o.va),o.va=!1))}),await Yu(r,n,t)}catch(n){await $u(n)}}function oy(e,t,r){const n=nt(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,o)=>{const l=o.view.Z_(t);l.snapshot&&i.push(l.snapshot)}),function(o,l){const u=nt(o);u.onlineState=l;let h=!1;u.queries.forEach((p,m)=>{for(const _ of m.j_)_.Z_(l)&&(h=!0)}),h&&A_(u)}(n.eventManager,t),i.length&&n.Ca.d_(i),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function M5(e,t,r){const n=nt(e);n.sharedClientState.updateQueryState(t,"rejected",r);const i=n.Na.get(t),s=i&&i.key;if(s){let o=new Jt(We.comparator);o=o.insert(s,Jr.newNoDocument(s,rt.min()));const l=dt().add(s),u=new z0(rt.min(),new Map,new Jt(St),o,l);await KA(n,u),n.Oa=n.Oa.remove(s),n.Na.delete(t),S_(n)}else await Am(n.localStore,t,!1).then(()=>Im(n,t,r)).catch($u)}async function B5(e,t){const r=nt(e),n=t.batch.batchId;try{const i=await q8(r.localStore,t);qA(r,n,null),XA(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Yu(r,i)}catch(i){await $u(i)}}async function U5(e,t,r){const n=nt(e);try{const i=await function(o,l){const u=nt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(m=>(Pt(m!==null),p=m.keys(),u.mutationQueue.removeMutationBatch(h,m))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(n.localStore,t);qA(n,t,r),XA(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await Yu(n,i)}catch(i){await $u(i)}}function XA(e,t){(e.ka.get(t)||[]).forEach(r=>{r.resolve()}),e.ka.delete(t)}function qA(e,t,r){const n=nt(e);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(t);s&&(r?s.reject(r):s.resolve(),i=i.remove(t)),n.Ba[n.currentUser.toKey()]=i}}function Im(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Ma.get(t))e.Fa.delete(n),r&&e.Ca.$a(n,r);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(n=>{e.La.containsKey(n)||YA(e,n)})}function YA(e,t){e.xa.delete(t.path.canonicalString());const r=e.Oa.get(t);r!==null&&(v_(e.remoteStore,r),e.Oa=e.Oa.remove(t),e.Na.delete(r),S_(e))}function ly(e,t,r){for(const n of r)n instanceof GA?(e.La.addReference(n.key,t),V5(e,n)):n instanceof $A?(Ve("SyncEngine","Document no longer in limbo: "+n.key),e.La.removeReference(n.key,t),e.La.containsKey(n.key)||YA(e,n.key)):et()}function V5(e,t){const r=t.key,n=r.path.canonicalString();e.Oa.get(r)||e.xa.has(n)||(Ve("SyncEngine","New document in limbo: "+r),e.xa.add(n),S_(e))}function S_(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const r=new We($t.fromString(t)),n=e.qa.next();e.Na.set(n,new R5(r)),e.Oa=e.Oa.insert(r,n),bA(e.remoteStore,new ea(Ki(c_(r.path)),n,"TargetPurposeLimboResolution",n_.oe))}}async function Yu(e,t,r){const n=nt(e),i=[],s=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,u)=>{o.push(n.Ka(u,t,r).then(h=>{var p;if((h||r)&&n.isPrimaryClient){const m=h?!h.fromCache:(p=r==null?void 0:r.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;n.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(h){i.push(h);const m=__.Wi(u.targetId,h);s.push(m)}}))}),await Promise.all(o),n.Ca.d_(i),await async function(u,h){const p=nt(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>we.forEach(h,_=>we.forEach(_.$i,x=>p.persistence.referenceDelegate.addReference(m,_.targetId,x)).next(()=>we.forEach(_.Ui,x=>p.persistence.referenceDelegate.removeReference(m,_.targetId,x)))))}catch(m){if(!Zu(m))throw m;Ve("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const _=m.targetId;if(!m.fromCache){const x=p.os.get(_),E=x.snapshotVersion,y=x.withLastLimboFreeSnapshotVersion(E);p.os=p.os.insert(_,y)}}}(n.localStore,s))}async function z5(e,t){const r=nt(e);if(!r.currentUser.isEqual(t)){Ve("SyncEngine","User change. New user:",t.toKey());const n=await OA(r.localStore,t);r.currentUser=t,function(s,o){s.ka.forEach(l=>{l.forEach(u=>{u.reject(new je(Ee.CANCELLED,o))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await Yu(r,n.hs)}}function j5(e,t){const r=nt(e),n=r.Na.get(t);if(n&&n.va)return dt().add(n.key);{let i=dt();const s=r.Ma.get(t);if(!s)return i;for(const o of s){const l=r.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function JA(e){const t=nt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=KA.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=j5.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=M5.bind(null,t),t.Ca.d_=S5.bind(null,t.eventManager),t.Ca.$a=I5.bind(null,t.eventManager),t}function H5(e){const t=nt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=B5.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=U5.bind(null,t),t}class a0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=j0(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),await this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)}ja(t,r){return null}Ha(t,r){return null}za(t){return X8(this.persistence,new Z8,t.initialUser,this.serializer)}Ga(t){return new W8(g_.Zr,this.serializer)}Wa(t){return new r5}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}a0.provider={build:()=>new a0};class Cm{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>oy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=z5.bind(null,this.syncEngine),await T5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new A5}()}createDatastore(t){const r=j0(t.databaseInfo.databaseId),n=function(s){return new a5(s)}(t.databaseInfo);return function(s,o,l,u){return new c5(s,o,l,u)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,i,s,o,l){return new f5(n,i,s,o,l)}(this.localStore,this.datastore,t.asyncQueue,r=>oy(this.syncEngine,r,0),function(){return ry.D()?new ry:new n5}())}createSyncEngine(t,r){return function(i,s,o,l,u,h,p){const m=new P5(i,s,o,l,u,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(i){const s=nt(i);Ve("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await qu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Cm.provider={build:()=>new Cm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ya(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ya(this.observer.error,t):ks("Uncaught Error in snapshot listener:",t.toString()))}Za(){this.muted=!0}Ya(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{constructor(t,r,n,i,s){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Xr.UNAUTHENTICATED,this.clientId=eA.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{Ve("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Ve("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=w_(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function Kd(e,t){e.asyncQueue.verifyOperationInProgress(),Ve("FirestoreClient","Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async i=>{n.isEqual(i)||(await OA(t.localStore,i),n=i)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function cy(e,t){e.asyncQueue.verifyOperationInProgress();const r=await G5(e);Ve("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(n=>ny(t.remoteStore,n)),e.setAppCheckTokenChangeListener((n,i)=>ny(t.remoteStore,i)),e._onlineComponents=t}async function G5(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ve("FirestoreClient","Using user provided OfflineComponentProvider");try{await Kd(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(i){return i.name==="FirebaseError"?i.code===Ee.FAILED_PRECONDITION||i.code===Ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Tl("Error using user provided cache. Falling back to memory cache: "+r),await Kd(e,new a0)}}else Ve("FirestoreClient","Using default OfflineComponentProvider"),await Kd(e,new a0);return e._offlineComponents}async function eS(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ve("FirestoreClient","Using user provided OnlineComponentProvider"),await cy(e,e._uninitializedComponentsProvider._online)):(Ve("FirestoreClient","Using default OnlineComponentProvider"),await cy(e,new Cm))),e._onlineComponents}function $5(e){return eS(e).then(t=>t.syncEngine)}async function tS(e){const t=await eS(e),r=t.eventManager;return r.onListen=N5.bind(null,t.syncEngine),r.onUnlisten=D5.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=O5.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=F5.bind(null,t.syncEngine),r}function Z5(e,t,r={}){const n=new ys;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,h){const p=new QA({next:_=>{p.Za(),o.enqueueAndForget(()=>HA(s,m));const x=_.docs.has(l);!x&&_.fromCache?h.reject(new je(Ee.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&_.fromCache&&u&&u.source==="server"?h.reject(new je(Ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new WA(c_(l.path),p,{includeMetadataChanges:!0,_a:!0});return jA(s,m)}(await tS(e),e.asyncQueue,t,r,n)),n.promise}function K5(e,t,r={}){const n=new ys;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,h){const p=new QA({next:_=>{p.Za(),o.enqueueAndForget(()=>HA(s,m)),_.fromCache&&u.source==="server"?h.reject(new je(Ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new WA(l,p,{includeMetadataChanges:!0,_a:!0});return jA(s,m)}(await tS(e),e.asyncQueue,t,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(e,t,r){if(!r)throw new je(Ee.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function X5(e,t,r,n){if(t===!0&&n===!0)throw new je(Ee.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function fy(e){if(!We.isDocumentKey(e))throw new je(Ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function hy(e){if(We.isDocumentKey(e))throw new je(Ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function I_(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":et()}function ya(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new je(Ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=I_(e);throw new je(Ee.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new je(Ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new je(Ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}X5("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rS((n=t.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new je(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new je(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new je(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class G0{constructor(t,r,n,i){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new je(Ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new je(Ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dy(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new hM;switch(n.type){case"firstParty":return new gM(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new je(Ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=uy.get(r);n&&(Ve("ComponentProvider","Removing Datastore"),uy.delete(r),n.terminate())}(this),Promise.resolve()}}function q5(e,t,r,n={}){var i;const s=(e=ya(e,G0))._getSettings(),o=`${t}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Tl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let l,u;if(typeof n.mockUserToken=="string")l=n.mockUserToken,u=Xr.MOCK_USER;else{l=Gb(n.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new je(Ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Xr(h)}e._authCredentials=new dM(new Qw(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new $0(this.firestore,t,this._query)}}class Wn{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ha(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Wn(this.firestore,t,this._key)}}class ha extends $0{constructor(t,r,n){super(t,r,c_(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Wn(this.firestore,null,new We(t))}withConverter(t){return new ha(this.firestore,t,this._path)}}function Yc(e,t,...r){if(e=Is(e),nS("collection","path",t),e instanceof G0){const n=$t.fromString(t,...r);return hy(n),new ha(e,null,n)}{if(!(e instanceof Wn||e instanceof ha))throw new je(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child($t.fromString(t,...r));return hy(n),new ha(e.firestore,null,n)}}function hh(e,t,...r){if(e=Is(e),arguments.length===1&&(t=eA.newId()),nS("doc","path",t),e instanceof G0){const n=$t.fromString(t,...r);return fy(n),new Wn(e,null,new We(n))}{if(!(e instanceof Wn||e instanceof ha))throw new je(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child($t.fromString(t,...r));return fy(n),new Wn(e.firestore,e instanceof ha?e.converter:null,new We(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new DA(this,"async_queue_retry"),this.Vu=()=>{const n=Zd();n&&Ve("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=t;const r=Zd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const r=Zd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ys;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!Zu(t))throw t;Ve("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const r=this.mu.then(()=>(this.du=!0,t().catch(n=>{this.Eu=n,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw ks("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(t,r,n){this.fu(),this.Ru.indexOf(t)>-1&&(r=0);const i=T_.createAndSchedule(this,t,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&et()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const r of this.Tu)if(r.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const r=this.Tu.indexOf(t);this.Tu.splice(r,1)}}class Ju extends G0{constructor(t,r,n,i){super(t,r,n,i),this.type="firestore",this._queue=new py,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new py(t),this._firestoreClient=void 0,await t}}}function Y5(e,t){const r=typeof e=="object"?e:eM(),n=typeof e=="string"?e:"(default)",i=q6(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=Hb("firestore");s&&q5(i,...s)}return i}function Z0(e){if(e._terminated)throw new je(Ee.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||J5(e),e._firestoreClient}function J5(e){var t,r,n;const i=e._freezeSettings(),s=function(l,u,h,p){return new RM(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,rS(p.experimentalLongPollingOptions),p.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new W5(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new kl(Wr.fromBase64String(t))}catch(r){throw new je(Ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new kl(Wr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new je(Ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Br(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new je(Ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new je(Ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return St(this._lat,t._lat)||St(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q5=/^__.*__$/;class e9{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new Sa(t,this.data,this.fieldMask,r,this.fieldTransforms):new Ku(t,this.data,r,this.fieldTransforms)}}class iS{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return new Sa(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function sS(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw et()}}class P_{constructor(t,r,n,i,s,o){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(t){return new P_(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),i=this.Fu({path:n,xu:!1});return i.Ou(t),i}Nu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(t){return this.Fu({path:void 0,xu:!0})}Bu(t){return o0(t,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ou(this.path.get(t))}Ou(t){if(t.length===0)throw this.Bu("Document fields must not be empty");if(sS(this.Cu)&&Q5.test(t))throw this.Bu('Document fields cannot begin and end with "__"')}}class t9{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||j0(t)}Qu(t,r,n,i=!1){return new P_({Cu:t,methodName:r,qu:n,path:Br.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function aS(e){const t=e._freezeSettings(),r=j0(e._databaseId);return new t9(e._databaseId,!!t.ignoreUndefinedProperties,r)}function oS(e,t,r,n,i,s={}){const o=e.Qu(s.merge||s.mergeFields?2:0,t,r,i);N_("Data must be an object, but it was:",o,n);const l=lS(n,o);let u,h;if(s.merge)u=new jn(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const _=km(t,m,r);if(!o.contains(_))throw new je(Ee.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);uS(p,_)||p.push(_)}u=new jn(p),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new e9(new Sn(l),u,h)}class X0 extends C_{_toFieldTransform(t){if(t.Cu!==2)throw t.Cu===1?t.Bu(`${this._methodName}() can only appear at the top level of your update data`):t.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof X0}}function r9(e,t,r,n){const i=e.Qu(1,t,r);N_("Data must be an object, but it was:",i,n);const s=[],o=Sn.empty();fo(n,(u,h)=>{const p=O_(t,u,r);h=Is(h);const m=i.Nu(p);if(h instanceof X0)s.push(p);else{const _=q0(h,m);_!=null&&(s.push(p),o.set(p,_))}});const l=new jn(s);return new iS(o,l,i.fieldTransforms)}function n9(e,t,r,n,i,s){const o=e.Qu(1,t,r),l=[km(t,n,r)],u=[i];if(s.length%2!=0)throw new je(Ee.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)l.push(km(t,s[_])),u.push(s[_+1]);const h=[],p=Sn.empty();for(let _=l.length-1;_>=0;--_)if(!uS(h,l[_])){const x=l[_];let E=u[_];E=Is(E);const y=o.Nu(x);if(E instanceof X0)h.push(x);else{const A=q0(E,y);A!=null&&(h.push(x),p.set(x,A))}}const m=new jn(h);return new iS(p,m,o.fieldTransforms)}function q0(e,t){if(cS(e=Is(e)))return N_("Unsupported field value:",t,e),lS(e,t);if(e instanceof C_)return function(n,i){if(!sS(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&t.Cu!==4)throw t.Bu("Nested arrays are not supported");return function(n,i){const s=[];let o=0;for(const l of n){let u=q0(l,i.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(e,t)}return function(n,i){if((n=Is(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return JM(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Sr.fromDate(n);return{timestampValue:i0(i.serializer,s)}}if(n instanceof Sr){const s=new Sr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:i0(i.serializer,s)}}if(n instanceof k_)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof kl)return{bytesValue:SA(i.serializer,n._byteString)};if(n instanceof Wn){const s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:p_(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof R_)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return u_(l.serializer,u)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${I_(n)}`)}(e,t)}function lS(e,t){const r={};return tA(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):fo(e,(n,i)=>{const s=q0(i,t.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function cS(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Sr||e instanceof k_||e instanceof kl||e instanceof Wn||e instanceof C_||e instanceof R_)}function N_(e,t,r){if(!cS(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=I_(r);throw n==="an object"?t.Bu(e+" a custom object"):t.Bu(e+" "+n)}}function km(e,t,r){if((t=Is(t))instanceof K0)return t._internalPath;if(typeof t=="string")return O_(e,t);throw o0("Field path arguments must be of type string or ",e,!1,void 0,r)}const i9=new RegExp("[~\\*/\\[\\]]");function O_(e,t,r){if(t.search(i9)>=0)throw o0(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new K0(...t.split("."))._internalPath}catch{throw o0(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function o0(e,t,r,n,i){const s=n&&!n.isEmpty(),o=i!==void 0;let l=`Function ${t}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${n}`),o&&(u+=` in document ${i}`),u+=")"),new je(Ee.INVALID_ARGUMENT,l+e+u)}function uS(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(t,r,n,i,s){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Wn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new s9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(hS("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class s9 extends fS{data(){return super.data()}}function hS(e,t){return typeof t=="string"?O_(e,t):t instanceof K0?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a9(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new je(Ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class o9{convertValue(t,r="none"){switch(to(t)){case 0:return null;case 1:return t.booleanValue;case 2:return or(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(eo(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw et()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return fo(t,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(t){var r,n,i;const s=(i=(n=(r=t.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>or(o.doubleValue));return new R_(s)}convertGeoPoint(t){return new k_(or(t.latitude),or(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=s_(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Ru(t));default:return null}}convertTimestamp(t){const r=va(t);return new Sr(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=$t.fromString(t);Pt(NA(n));const i=new Pu(n.get(1),n.get(3)),s=new We(n.popFirst(5));return i.isEqual(r)||ks(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class pS extends fS{constructor(t,r,n,i,s,o){super(t,r,n,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new dh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(hS("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class dh extends pS{data(t={}){return super.data(t)}}class l9{constructor(t,r,n,i){this._firestore=t,this._userDataWriter=r,this._snapshot=i,this.metadata=new kc(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new dh(this._firestore,this._userDataWriter,n.key,n,new kc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new je(Ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const u=new dh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new kc(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new dh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new kc(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),p=o.indexOf(l.doc.key)),{type:c9(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function c9(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return et()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u9(e){e=ya(e,Wn);const t=ya(e.firestore,Ju);return Z5(Z0(t),e._key).then(r=>h9(t,e,r))}class mS extends o9{constructor(t){super(),this.firestore=t}convertBytes(t){return new kl(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new Wn(this.firestore,null,r)}}function Rm(e){e=ya(e,$0);const t=ya(e.firestore,Ju),r=Z0(t),n=new mS(t);return a9(e._query),K5(r,e._query).then(i=>new l9(t,n,e,i))}function f9(e,t,r){e=ya(e,Wn);const n=ya(e.firestore,Ju),i=dS(e.converter,t,r);return gS(n,[oS(aS(n),"setDoc",e._key,i,e.converter!==null,r).toMutation(e._key,ui.none())])}function gS(e,t){return function(n,i){const s=new ys;return n.asyncQueue.enqueueAndForget(async()=>b5(await $5(n),i,s)),s.promise}(Z0(e),t)}function h9(e,t,r){const n=r.docs.get(t._key),i=new mS(e);return new pS(e,i,t._key,n,new kc(r.hasPendingWrites,r.fromCache),t.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{constructor(t,r){this._firestore=t,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=aS(t)}set(t,r,n){this._verifyNotCommitted();const i=Xd(t,this._firestore),s=dS(i.converter,r,n),o=oS(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,ui.none())),this}update(t,r,n,...i){this._verifyNotCommitted();const s=Xd(t,this._firestore);let o;return o=typeof(r=Is(r))=="string"||r instanceof K0?n9(this._dataReader,"WriteBatch.update",s._key,r,n,i):r9(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(o.toMutation(s._key,ui.exists(!0))),this}delete(t){this._verifyNotCommitted();const r=Xd(t,this._firestore);return this._mutations=this._mutations.concat(new f_(r._key,ui.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new je(Ee.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Xd(e,t){if((e=Is(e)).firestore!==t)throw new je(Ee.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _S(e){return Z0(e=ya(e,Ju)),new d9(e,t=>gS(e,t))}(function(t,r=!0){(function(i){Ml=i})(Q6),Jh(new Iu("firestore",(n,{instanceIdentifier:i,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new Ju(new pM(n.getProvider("auth-internal")),new vM(n.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new je(Ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pu(h.options.projectId,p)}(o,i),o);return s=Object.assign({useFetchStreams:r},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),ul(Lx,"4.7.3",t),ul(Lx,"4.7.3","esm2017")})();const p9={apiKey:"AIzaSyBH--1LKAUn0oBTbVX6W_YOkrXhkBjNork",authDomain:"mapainternos.firebaseapp.com",projectId:"mapainternos",storageBucket:"mapainternos.firebasestorage.app",messagingSenderId:"433575120554",appId:"1:433575120554:web:309328a519284a9f818ad3",measurementId:"G-FW611VFQGL"},m9=Ww(p9),ds=Y5(m9),g9=`
  body { margin: 0; background-color: #0f172a; color: #e2e8f0; font-family: 'Segoe UI', sans-serif; }
  
  .custom-scrollbar::-webkit-scrollbar { width: 6px; }
  .custom-scrollbar::-webkit-scrollbar-track { background: #1e293b; }
  .custom-scrollbar::-webkit-scrollbar-thumb { background: #475569; border-radius: 10px; }
  .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #64748b; }
  
  .leaflet-tooltip.label-mapa {
    background-color: rgba(15, 23, 42, 0.95);
    border: 1px solid #3b82f6;
    color: #fff;
    font-weight: 700;
    font-size: 11px;
    border-radius: 6px;
    padding: 2px 8px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    backdrop-filter: blur(4px);
  }
  .leaflet-tooltip-bottom:before { border-bottom-color: rgba(15, 23, 42, 0.95); }
  
  .fade-in { animation: fadeIn 0.4s ease-out; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

  .chart-bar-bg { background: #334155; border-radius: 4px; height: 8px; overflow: hidden; width: 100%; margin-top: 4px; }
  .chart-bar-fill { height: 100%; border-radius: 4px; transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
`,hl={"RIS 1":"#10b981","RIS 2":"#facc15","RIS 3":"#f97316","RIS 4":"#3b82f6","RIS 5":"#ef4444","RIS 6":"#8b5cf6","RIS 7":"#ec4899",DEFAULT:"#64748b"},vS={LIMA:"RIS 1","CERCADO DE LIMA":"RIS 1",BRENA:"RIS 2",BREA:"RIS 2","JESUS MARIA":"RIS 2","PUEBLO LIBRE":"RIS 2","MAGDALENA DEL MAR":"RIS 3","SAN MIGUEL":"RIS 3",LINCE:"RIS 4","SAN ISIDRO":"RIS 4",MIRAFLORES:"RIS 4","SAN BORJA":"RIS 4",SURQUILLO:"RIS 4","LA VICTORIA":"RIS 5","SAN LUIS":"RIS 5","EL AGUSTINO":"RIS 5","SANTA ANITA":"RIS 5","SAN JUAN DE LURIGANCHO":"RIS 6",RIMAC:"RIS 7",INDEPENDENCIA:"RIS 7",COMAS:"RIS 7"},_9=Object.keys(vS).sort(),v9=e=>{const t=Object.keys(hl).find(r=>(e||"").toUpperCase().includes(r));return t?hl[t]:hl.DEFAULT},x9={claro:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",oscuro:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",satelite:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"},el=e=>e?String(e).toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^A-Z0-9 ]/g,"").trim():"",y9=(e,t)=>{const r=el(e).replace(/\s+/g,""),n=el(t).replace(/\s+/g,"");return r===n?1:r.includes(n)||n.includes(r)?.95:0},my=e=>e?typeof e=="number"?new Date(Math.round((e-25569)*86400*1e3)).toLocaleDateString("es-PE",{day:"2-digit",month:"2-digit",year:"numeric"}):String(e).trim():"",gy=e=>!e.startsWith("HS ")&&!e.startsWith("INST ")&&!e.startsWith("HOSPITAL")&&!e.startsWith("INSTITUTO"),E9=["PRIVADA DEL NORTE","CSAR VALLEJO","MAYOR DE SAN MARCOS","SAN MARTIN DE PORRES","PERUANA CAYETANO HEREDIA","CONTINENTAL","NORBERT WIENER","CIENTIFICA DEL SUR","RICARDO PALMA","CIENCIAS Y HUMANIDADES","DANIEL ALCIDES CARRION","FEDERICO VILLARREAL","TECNOLGICA DEL PER","SAN JUAN BAUTISTA","MARIA AUXILIADORA","PERUANA DE CIENCIAS APLICADAS","LE CORDON BLEU","ENRIQUE GUZMAN Y VALLE","CATOLICA SEDES SAPIENTIAE","PERUANA UNION","PIURA","ALTIPLANO DE PUNO","HERMILIO VALDIZAN"],T9=["OBSTETRICIA","ENFERMERIA","PSICOLOGA","MEDICINA HUMANA","LABORATORIO CLINICO Y ANATOMIA PATOLOGICA","NUTRICION","ODONTOLOGA","BIOLOGIA","RADIOLOGIA","TERAPIA FISICA Y REHABILITACIN","TERAPIA OCUPACIONAL","TERAPIA DE LENGUAJE","OPTOMETRA"],_y=e=>{const t=e.toUpperCase();return t.includes("PRIMERA")||t.includes("1RA")||t==="1"?1:t.includes("SEGUNDA")||t.includes("2DA")||t==="2"?2:t.includes("TERCERA")||t.includes("3RA")||t==="3"?3:99},gc=[{id:"r1_1",ris:"RIS 1",nombre:"CS CONDE DE LA VEGA",lat:-12.038921,lng:-77.050464,distrito:"CERCADO DE LIMA"},{id:"r1_2",ris:"RIS 1",nombre:"CS CONTROL DE ZOONOSIS",lat:-12.049798,lng:-77.06224,distrito:"CERCADO DE LIMA"},{id:"r1_3",ris:"RIS 1",nombre:"CS ITS Y VIH RAUL PATRUCCO PUIG",lat:-12.052736,lng:-77.022955,distrito:"LA VICTORIA"},{id:"r1_4",ris:"RIS 1",nombre:"CS JUAN PEREZ CARRANZA",lat:-12.053413,lng:-77.022688,distrito:"LA VICTORIA"},{id:"r1_5",ris:"RIS 1",nombre:"CS MIRONES",lat:-12.050879,lng:-77.067292,distrito:"CERCADO DE LIMA"},{id:"r1_6",ris:"RIS 1",nombre:"CS MIRONES BAJO",lat:-12.050897,lng:-77.067321,distrito:"CERCADO DE LIMA"},{id:"r1_7",ris:"RIS 1",nombre:"CS SAN SEBASTIAN",lat:-12.042331,lng:-77.038673,distrito:"CERCADO DE LIMA"},{id:"r1_8",ris:"RIS 1",nombre:"CS UNIDAD VECINAL N3",lat:-12.051273,lng:-77.08233,distrito:"CERCADO DE LIMA"},{id:"r1_9",ris:"RIS 1",nombre:"CS VILLA MARIA DEL PERPETUO SOCORRO",lat:-12.037751,lng:-77.054586,distrito:"CERCADO DE LIMA"},{id:"r1_11",ris:"RIS 1",nombre:"CSMC MIRONES BAJO",lat:-12.037769,lng:-77.081481,distrito:"CERCADO DE LIMA"},{id:"r1_12",ris:"RIS 1",nombre:"CSMC SAN MARCOS",lat:-12.055392,lng:-77.082387,distrito:"PUEBLO LIBRE"},{id:"r1_13",ris:"RIS 1",nombre:"PS PALERMO",lat:-12.040929,lng:-77.068914,distrito:"CERCADO DE LIMA"},{id:"r1_14",ris:"RIS 1",nombre:"PS RESCATE",lat:-12.041065,lng:-77.062272,distrito:"CERCADO DE LIMA"},{id:"r1_15",ris:"RIS 1",nombre:"PS SANTA ROSA",lat:-12.044848,lng:-77.111266,distrito:"CALLAO"},{id:"r2_1",ris:"RIS 2",nombre:"CS BREA",lat:-12.063762,lng:-77.057869,distrito:"BREA"},{id:"r2_2",ris:"RIS 2",nombre:"CS CHACRA COLORADA",lat:-12.053863,lng:-77.048067,distrito:"BREA"},{id:"r2_3",ris:"RIS 2",nombre:"CS HUACA PANDO",lat:-12.061594,lng:-77.083254,distrito:"PUEBLO LIBRE"},{id:"r2_4",ris:"RIS 2",nombre:"CS JESUS MARIA",lat:-12.077688,lng:-77.053306,distrito:"JESUS MARIA"},{id:"r2_5",ris:"RIS 2",nombre:"CS SAN MIGUEL",lat:-12.081167,lng:-77.09853,distrito:"SAN MIGUEL"},{id:"r2_6",ris:"RIS 2",nombre:"CSM EXCELENCIA SAN MIGUEL",lat:-12.081396,lng:-77.101266,distrito:"SAN MIGUEL"},{id:"r2_7",ris:"RIS 2",nombre:"CSMC HONORIO DELGADO",lat:-12.069174,lng:-77.058068,distrito:"BREA"},{id:"r2_8",ris:"RIS 2",nombre:"CSMC JESUS MARIA",lat:-12.07406,lng:-77.043524,distrito:"JESUS MARIA"},{id:"r2_9",ris:"RIS 2",nombre:"CSMC MAGDALENA",lat:-12.088394,lng:-77.063122,distrito:"MAGDALENA DEL MAR"},{id:"r2_10",ris:"RIS 2",nombre:"CSMI MAGDALENA",lat:-12.088383,lng:-77.06876,distrito:"MAGDALENA DEL MAR"},{id:"r2_11",ris:"RIS 2",nombre:"LABORATORIO REFERENCIAL",lat:-12.088656,lng:-77.067946,distrito:"MAGDALENA DEL MAR"},{id:"r3_1",ris:"RIS 3",nombre:"CS LINCE",lat:-12.081669,lng:-77.031994,distrito:"LINCE"},{id:"r3_2",ris:"RIS 3",nombre:"CS SAM ATANACIO DE PEDREGAL",lat:-12.1209,lng:-76.998887,distrito:"SURQUILLO"},{id:"r3_3",ris:"RIS 3",nombre:"CS SAN ISIDRO",lat:-12.106575,lng:-77.05512,distrito:"SAN ISIDRO"},{id:"r3_4",ris:"RIS 3",nombre:"CS SANTA CRUZ MIRAFLORES",lat:-12.118628,lng:-77.036754,distrito:"MIRAFLORES"},{id:"r3_5",ris:"RIS 3",nombre:"CS VILLA VICTORIA PORVENIR",lat:-12.10857,lng:-77.012094,distrito:"SURQUILLO"},{id:"r3_6",ris:"RIS 3",nombre:"CSMC SAN BORJA",lat:-12.108779,lng:-77.00647,distrito:"SAN BORJA"},{id:"r3_7",ris:"RIS 3",nombre:"CSMC SAN ISIDRO",lat:-12.107595,lng:-77.050509,distrito:"SAN ISIDRO"},{id:"r3_8",ris:"RIS 3",nombre:"CSMC SURQUILLO",lat:-12.118613,lng:-77.019213,distrito:"SURQUILLO"},{id:"r3_9",ris:"RIS 3",nombre:"CSMI SURQUILLO",lat:-12.118262,lng:-77.022244,distrito:"SURQUILLO"},{id:"r4_1",ris:"RIS 4",nombre:"CS EL PINO",lat:-12.066881,lng:-76.998619,distrito:"EL AGUSTINO"},{id:"r4_2",ris:"RIS 4",nombre:"CS MAX ARIAS SCHREIBER",lat:-12.059194,lng:-77.032271,distrito:"LA VICTORIA"},{id:"r4_3",ris:"RIS 4",nombre:"CS SAN COSME",lat:-12.061765,lng:-77.006846,distrito:"LA VICTORIA"},{id:"r4_4",ris:"RIS 4",nombre:"CS SAN LUIS",lat:-12.07445,lng:-76.997255,distrito:"SAN LUIS"},{id:"r4_5",ris:"RIS 4",nombre:"CS TODOS LOS SANTOS SAN BORJA",lat:-12.101842,lng:-76.993428,distrito:"SAN BORJA"},{id:"r4_6",ris:"RIS 4",nombre:"CSMC LA VICTORIA",lat:-12.071107,lng:-77.013469,distrito:"LA VICTORIA"},{id:"r4_7",ris:"RIS 4",nombre:"CSMC SAN COSME",lat:-12.061978,lng:-77.005306,distrito:"LA VICTORIA"},{id:"r4_8",ris:"RIS 4",nombre:"CSMI EL PORVENIR",lat:-12.067469,lng:-77.020826,distrito:"LA VICTORIA"},{id:"r4_9",ris:"RIS 4",nombre:"PS EL PINO",lat:-12.06586,lng:-77.002467,distrito:"EL AGUSTINO"},{id:"r4_10",ris:"RIS 4",nombre:"PS JARDN ROSA DE SANTA MARA",lat:-12.044257,lng:-77.01443,distrito:"EL AGUSTINO"},{id:"r4_11",ris:"RIS 4",nombre:"PS SAN JUAN MASIAS",lat:-12.084071,lng:-77.00246,distrito:"SAN LUIS"},{id:"r5_1",ris:"RIS 5",nombre:"CS CAJA DE AGUA",lat:-12.026599,lng:-77.014879,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_2",ris:"RIS 5",nombre:"CS CAMPOY",lat:-12.016004,lng:-76.965389,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_3",ris:"RIS 5",nombre:"CS CHACARILLA DE OTERO",lat:-12.020881,lng:-77.006867,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_4",ris:"RIS 5",nombre:"CS DANIEL ALCIDES CARRION",lat:-12.023003,lng:-76.977023,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_5",ris:"RIS 5",nombre:"CS LA HUAYRONA",lat:-11.993822,lng:-77.00658,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_6",ris:"RIS 5",nombre:"CS LA LIBERTAD",lat:-12.003994,lng:-76.995829,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_7",ris:"RIS 5",nombre:"CS MANGOMARCA",lat:-12.010634,lng:-76.979585,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_8",ris:"RIS 5",nombre:"CS SAN FERNANDO",lat:-12.0023,lng:-77.010607,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_9",ris:"RIS 5",nombre:"CS SANTA FE DE TOTORITA",lat:-11.996876,lng:-76.996041,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_10",ris:"RIS 5",nombre:"CS SANTA ROSA DE LIMA",lat:-12.005101,lng:-77.016472,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_11",ris:"RIS 5",nombre:"CS ZARATE",lat:-12.022964,lng:-76.994557,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_12",ris:"RIS 5",nombre:"CSMC JAVIER MARIATEGUI",lat:-12.017147,lng:-77.000884,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_13",ris:"RIS 5",nombre:"CSMC MANGOMARCA",lat:-12.019114,lng:-76.984995,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_14",ris:"RIS 5",nombre:"CSMC VILLA CAMPOY",lat:-12.007232,lng:-76.965202,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_15",ris:"RIS 5",nombre:"PS 15 DE ENERO",lat:-12.010915,lng:-77.01859,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_16",ris:"RIS 5",nombre:"PS AZCARRUNZ ALTO",lat:-12.017052,lng:-77.000957,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_1",ris:"RIS 6",nombre:"CS BAYOVAR",lat:-11.951986,lng:-76.991581,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_2",ris:"RIS 6",nombre:"CS GANIMENDES",lat:-11.983037,lng:-77.011447,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_3",ris:"RIS 6",nombre:"CS HUASCAR II",lat:-11.966623,lng:-77.010997,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_4",ris:"RIS 6",nombre:"CS HUASCAR XV",lat:-11.955447,lng:-77.002372,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_5",ris:"RIS 6",nombre:"CS MEDALLA MILAGROSA",lat:-11.976887,lng:-77.006001,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_6",ris:"RIS 6",nombre:"CS SAN HILARION",lat:-11.995438,lng:-77.01583,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_7",ris:"RIS 6",nombre:"CSMC JAIME ZUBIETA",lat:-11.962834,lng:-76.98873,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_8",ris:"RIS 6",nombre:"CSMC NUEVO PER",lat:-12.0029,lng:-77.018166,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_9",ris:"RIS 6",nombre:"PS AYACUCHO",lat:-11.987161,lng:-77.017107,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_10",ris:"RIS 6",nombre:"PS PROYECTOS ESPECIALES",lat:-11.955769,lng:-76.992456,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_11",ris:"RIS 6",nombre:"PS SAGRADA FAMILIA",lat:-11.976341,lng:-76.988859,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_1",ris:"RIS 7",nombre:"CS 10 DE OCTUBRE",lat:-11.944904,lng:-76.987643,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_2",ris:"RIS 7",nombre:"CS CRUZ DE MOTUPE",lat:-11.940364,lng:-76.974795,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_3",ris:"RIS 7",nombre:"CS ENRIQUE MONTENEGRO",lat:-11.937029,lng:-76.971134,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_4",ris:"RIS 7",nombre:"CS JAIME ZUBIETA",lat:-11.963164,lng:-76.988935,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_5",ris:"RIS 7",nombre:"CS JOSE CARLOS MARIATEGUI",lat:-11.94384,lng:-76.984472,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_6",ris:"RIS 7",nombre:"CS JUAN PABLO II",lat:-11.952272,lng:-77.077927,distrito:"SAN MARTIN DE PORRES"},{id:"r7_7",ris:"RIS 7",nombre:"CS SANTA MARIA",lat:-11.964929,lng:-76.975984,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_8",ris:"RIS 7",nombre:"PS CESAR VALLEJO",lat:-11.939452,lng:-76.965759,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_9",ris:"RIS 7",nombre:"PS JOSE CARLOS MARIATEGUI V ETAPA",lat:-11.931092,lng:-76.990411,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_10",ris:"RIS 7",nombre:"PS MARISCAL CACERES",lat:-11.949206,lng:-76.98108,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_11",ris:"RIS 7",nombre:"PS TUPAC AMARU II",lat:-11.955745,lng:-76.975792,distrito:"SAN JUAN DE LURIGANCHO"}],w9=({center:e,zoom:t})=>{const r=J2();return _e.useEffect(()=>{r.flyTo(e,t,{duration:1.5})},[e,t,r]),null},vy=({data:e})=>{const t=Wa.useMemo(()=>{const n={},i={};e.forEach(o=>{var l;(l=o.detallesVisuales)==null||l.forEach(u=>{const h=u.carrera||"OTROS",p=u.universidad||"OTROS";n[h]=(n[h]||0)+1,i[p]=(i[p]||0)+1})});const s=(o,l)=>l[1]-o[1];return{carreras:Object.entries(n).sort(s),universidades:Object.entries(i).sort(s)}},[e]),r=(n,i,s,o)=>Z.jsxs("div",{style:{marginBottom:"8px",display:"flex",alignItems:"center",fontSize:"11px"},children:[Z.jsx("div",{style:{width:"120px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"#94a3b8",textAlign:"right",paddingRight:"10px"},children:n}),Z.jsx("div",{style:{flex:1,background:"#334155",height:"8px",borderRadius:"4px",overflow:"hidden"},children:Z.jsx("div",{style:{width:`${i/s*100}%`,background:o,height:"100%",borderRadius:"4px"}})}),Z.jsx("div",{style:{width:"30px",paddingLeft:"10px",fontWeight:"700",color:"#f1f5f9"},children:i})]},n);return e.length===0?Z.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#64748b",fontSize:"12px"},children:"No hay datos para mostrar."}):Z.jsxs("div",{className:"fade-in",children:[Z.jsxs("div",{style:{marginBottom:"20px"},children:[Z.jsx("h4",{style:{color:"#3b82f6",fontSize:"10px",fontWeight:"800",textTransform:"uppercase",marginBottom:"10px",borderBottom:"1px solid #334155",paddingBottom:"5px"},children:"Por Carrera"}),t.carreras.map(([n,i])=>r(n,i,t.carreras[0][1],"#3b82f6"))]}),Z.jsxs("div",{children:[Z.jsx("h4",{style:{color:"#10b981",fontSize:"10px",fontWeight:"800",textTransform:"uppercase",marginBottom:"10px",borderBottom:"1px solid #334155",paddingBottom:"5px"},children:"Por Universidad"}),t.universidades.map(([n,i])=>r(n,i,t.universidades[0][1],"#10b981"))]})]})},A9=()=>{const e=j2();_e.useEffect(()=>{const H=document.createElement("style");return H.innerHTML=g9,document.head.appendChild(H),()=>{document.head.removeChild(H)}},[]);const[t,r]=_e.useState(null),[n,i]=_e.useState([-12.05,-77.06]),[s,o]=_e.useState(12),[l,u]=_e.useState("oscuro"),[h,p]=_e.useState("lista"),[m,_]=_e.useState("todos"),[x,E]=_e.useState("todos"),[y,A]=_e.useState(""),[C,k]=_e.useState("todas"),[w,V]=_e.useState("todas"),[Q,X]=_e.useState([]),[S,R]=_e.useState(null),[P,D]=_e.useState([]),[F,b]=_e.useState([]),M=_e.useRef(null);_e.useEffect(()=>{fetch("https://raw.githubusercontent.com/yurivilc/peru-geojson/master/lima_callao_distritos.geojson").then(H=>H.json()).then(H=>r(H)).catch(console.error),Ne()},[]);const Pe=H=>{const J=H.properties.NOMBDIST||H.properties.NOMB_DIST||"",q=el(J),re=vS[q]||"DEFAULT",ge=hl[re],ye=(m==="todos"||re===m)&&(x==="todos"||q===el(x));return{fillColor:ge,weight:re!=="DEFAULT"?1:.5,opacity:1,color:"white",fillOpacity:ye?.5:.1}},ke=H=>{const J=new Set,q=new Set;H.forEach(re=>{var ge;return(ge=re.detalles)==null?void 0:ge.forEach(ye=>{ye.universidad&&ye.universidad!=="SIN UNIVERSIDAD"&&J.add(ye.universidad),ye.carrera&&ye.carrera!=="SIN CARRERA"&&q.add(ye.carrera)})}),D(Array.from(J).sort()),b(Array.from(q).sort())},Ne=async()=>{try{const J=(await Rm(Yc(ds,"centros"))).docs.map(ge=>({id:ge.id,...ge.data(),detalles:ge.data().detalles||[]})),q={};J.forEach(ge=>{q[ge.nombre]=ge});let re=gc.map(ge=>{const ye=q[ge.nombre];return ye?{...ge,...ye}:{...ge,cantidad:0,detalles:[]}});J.forEach(ge=>{re.find(ye=>ye.nombre===ge.nombre)||re.push(ge)}),X(re),ke(re)}catch(H){console.error("Error:",H),X(gc.map(J=>({...J,cantidad:0,detalles:[]})))}},Oe=async H=>{var re;const J=(re=H.target.files)==null?void 0:re[0];if(!J)return;const q=new FileReader;q.onload=async ge=>{var ye;try{const Se=(ye=ge.target)==null?void 0:ye.result,ve=am(Se,{type:"array"}),Ye=ve.Sheets[ve.SheetNames[0]],Y=Lb.sheet_to_json(Ye,{defval:""});if(Y.length===0){alert("Excel vaco.");return}const yt=Y[0],He=Object.keys(yt),ot=He.find(Re=>Re.includes("DNI")),ne=He.find(Re=>Re.includes("SEDE")&&Re.includes("DOCENTE"));if(!ne||!ot){alert(" Error de columnas.");return}const fe={},be=He.find(Re=>Re.includes("ESTABLECIMIENTO")),Xe=He.find(Re=>Re.includes("NOMBRE_ROTACION")),qe=He.find(Re=>Re.includes("CARRERA")),mt=He.find(Re=>Re.includes("UNIVERSIDAD")),Lt=He.find(Re=>Re.includes("FACULTAD")),ir=He.find(Re=>Re.includes("FECHA")&&Re.includes("INICIO")),Qt=He.find(Re=>Re.includes("FECHA")&&(Re.includes("FIN")||Re.includes("TERMINO"))),Dr=He.find(Re=>Re==="TIPO");Y.forEach(Re=>{const it=String(Re[ot]).trim(),At=String(Re[ne]).trim(),lt=be?String(Re[be]).trim():At,cr=Xe?String(Re[Xe]).trim():"Rotacin",xn=qe?String(Re[qe]).trim().toUpperCase():"SIN CARRERA",an=mt?String(Re[mt]).trim().toUpperCase():"SIN UNIVERSIDAD",on=Lt?String(Re[Lt]).trim():"",Pn=ir?my(Re[ir]):"",Nn=Qt?my(Re[Qt]):"",Di=Dr?String(Re[Dr]):"";!it||it==="undefined"||(fe[it]||(fe[it]={dni:it,carrera:xn,universidad:an,facultad:on,rotaciones:[]}),fe[it].rotaciones.push({nombre:cr,establecimiento:lt,fechaInicio:Pn,fechaFin:Nn,tipo:Di}))});const ct={};gc.forEach(Re=>{ct[Re.nombre]={...Re,cantidad:0,detalles:[]}});let Dt=0,bt=0;const Ir=new Set;if(Y.forEach(Re=>{const it=String(Re[ot]).trim(),At=String(Re[ne]).trim();if(!it||!At)return;let lt="",cr=!1;const xn=gc.find(an=>el(an.nombre)===el(At));if(xn)lt=xn.nombre,cr=!0;else{let an=0,on="";gc.forEach(Pn=>{const Nn=y9(At,Pn.nombre);Nn>.7&&Nn>an&&(an=Nn,on=Pn.nombre)}),on&&(lt=on,cr=!0)}if(cr||(lt=At,ct[lt]||(ct[lt]={id:`auto_${Math.random().toString(36).substr(2,9)}`,ris:"HOSPITALES",nombre:lt,lat:-12.046374,lng:-77.042793,cantidad:0,detalles:[],sinCoordenadas:!0},bt++)),fe[it]){const an=`${lt}-${it}`;Ir.has(an)||(ct[lt].detalles||(ct[lt].detalles=[]),ct[lt].cantidad+=1,ct[lt].detalles.push(fe[it]),Ir.add(an),Dt++)}}),confirm(`Procesamiento Finalizado:
 Total Internos: ${Dt}
 Centros Nuevos: ${bt}

Subir a la nube?`)){const Re=_S(ds);let it=0;for(const At of Object.values(ct))(At.cantidad>0||!At.sinCoordenadas)&&(Re.set(hh(Yc(ds,"centros"),At.nombre.replace(/[\/\s\.]/g,"_")),At),it++),it>=450&&(await Re.commit(),it=0);it>0&&await Re.commit(),alert(" Carga completa."),Ne()}}catch(Se){console.error(Se),alert("Error al procesar.")}},q.readAsArrayBuffer(J)},ue=Q.map(H=>{const q=(H.detalles||[]).filter(re=>{const ge=y===""||re.dni.includes(y),ye=C==="todas"||(re.universidad||"").includes(C),Se=w==="todas"||(re.carrera||"").includes(w);return ge&&ye&&Se}).map(re=>({...re,rotaciones:[...re.rotaciones].sort((ge,ye)=>_y(ge.nombre)-_y(ye.nombre))}));return{...H,cantidadVisual:q.length,detallesVisuales:q}}).filter(H=>{const J=m==="todos"||H.ris&&H.ris.includes(m),q=x==="todos"||H.distrito&&H.distrito===x,re=H.cantidadVisual>0;return y!==""||C!=="todas"||w!=="todas"?J&&q&&re:J&&q}).sort((H,J)=>J.cantidadVisual-H.cantidadVisual),te=ue.reduce((H,J)=>H+J.cantidadVisual,0),de=Q.filter(H=>gy(H.nombre)).length,Ae=ue.filter(H=>gy(H.nombre)&&H.cantidadVisual>0).length,j=(H,J,q)=>{S===H?R(null):(R(H),J!==0&&J!==-12.046374&&(i([J,q]),o(16)))};return Z.jsxs("div",{className:"dashboard-container",style:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"#0f172a",color:"#e2e8f0"},children:[Z.jsxs("div",{style:{background:"#1e293b",padding:"0 24px",height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #334155",zIndex:50},children:[Z.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[Z.jsx("div",{style:{background:"#2563eb",width:"40px",height:"40px",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center"},children:Z.jsx("i",{className:"fas fa-map-marked-alt",style:{fontSize:"20px",color:"white"}})}),Z.jsxs("div",{children:[Z.jsxs("h1",{style:{margin:0,fontSize:"20px",fontWeight:"800",color:"#f8fafc"},children:["GEO",Z.jsx("span",{style:{color:"#3b82f6"},children:"INTERNOS"})," ",Z.jsx("span",{style:{color:"#10b981",fontSize:"14px",border:"1px solid #10b981",padding:"2px 6px",borderRadius:"4px"},children:"2025"})]}),Z.jsx("p",{style:{margin:"2px 0 0 0",fontSize:"11px",opacity:.6},children:"UFDI - DIRIS LIMA CENTRO"})]})]}),Z.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[Z.jsxs("button",{onClick:()=>e("/adjudicacion2026"),style:{background:"transparent",border:"2px solid #8b5cf6",color:"#a78bfa",borderRadius:"6px",padding:"8px 16px",fontWeight:"700",fontSize:"12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},children:["Ir a Adjudicacin 2026 ",Z.jsx("i",{className:"fas fa-arrow-right"})]}),Z.jsx("button",{onClick:()=>{var H;return(H=M.current)==null?void 0:H.click()},style:{background:"#3b82f6",color:"white",border:"none",borderRadius:"6px",padding:"8px 16px",fontWeight:"600",fontSize:"12px",cursor:"pointer"},children:"Actualizar Data 2025"}),Z.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:Oe,style:{display:"none"},ref:M})]})]}),Z.jsxs("div",{style:{padding:"15px 24px",background:"#1e293b",borderBottom:"1px solid #334155",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",alignItems:"center"},children:[Z.jsx("div",{style:{position:"relative"},children:Z.jsx("input",{type:"text",placeholder:"Buscar DNI...",value:y,onChange:H=>A(H.target.value),style:{width:"100%",padding:"8px 8px 8px 12px",borderRadius:"6px",border:"1px solid #334155",background:"#0f172a",color:"white",fontSize:"13px",boxSizing:"border-box"}})}),Z.jsxs("select",{value:x,onChange:H=>E(H.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #334155",background:"#0f172a",color:"white",fontSize:"13px"},children:[" ",Z.jsx("option",{value:"todos",children:" Todos los Distritos"})," ",_9.map(H=>Z.jsx("option",{value:H,children:H},H))," "]}),Z.jsxs("select",{value:C,onChange:H=>k(H.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #334155",background:"#0f172a",color:"white",fontSize:"13px"},children:[" ",Z.jsx("option",{value:"todas",children:" Universidades"})," ",E9.map(H=>Z.jsx("option",{value:H,children:H},H))," "]}),Z.jsxs("select",{value:w,onChange:H=>V(H.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #334155",background:"#0f172a",color:"white",fontSize:"13px"},children:[" ",Z.jsx("option",{value:"todas",children:" Carreras"})," ",T9.map(H=>Z.jsx("option",{value:H,children:H},H))," "]}),Z.jsxs("div",{style:{display:"flex",gap:"2px",background:"#0f172a",padding:"2px",borderRadius:"6px",border:"1px solid #334155"},children:[" ",["todos","RIS 1","RIS 2","RIS 3","RIS 4","RIS 5","RIS 6","RIS 7"].map(H=>Z.jsx("button",{onClick:()=>_(H),style:{flexGrow:1,padding:"6px 4px",fontSize:"10px",fontWeight:"700",border:"none",borderRadius:"4px",cursor:"pointer",background:m===H?hl[H==="todos"?"DEFAULT":H]:"transparent",color:m===H?"white":"#94a3b8"},children:H==="todos"?"ALL":H.replace("RIS ","R")},H))," "]})]}),Z.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[Z.jsx("div",{style:{flex:3,position:"relative",borderRight:"1px solid #334155"},children:Z.jsxs(tT,{center:n,zoom:s,style:{height:"100%",width:"100%",background:"#0f172a"},zoomControl:!1,children:[Z.jsx(w9,{center:n,zoom:s}),Z.jsx(rT,{url:x9[l],attribution:" CARTO"}),t&&Z.jsx(eT,{data:t,style:Pe}),ue.map((H,J)=>{if(H.sinCoordenadas)return null;const q=S===H.nombre,re=hl[H.ris]||"#94a3b8",ge=q||x!=="todos"||C!=="todas"||w!=="todas";return Z.jsxs(Q2,{center:[H.lat,H.lng],pathOptions:{color:q?"white":re,fillColor:q?"transparent":re,fillOpacity:q?0:.8,weight:q?3:0,dashArray:q?"4,4":""},radius:q?12:6,eventHandlers:{click:()=>j(H.nombre,H.lat,H.lng)},children:[ge&&Z.jsxs(Bh,{direction:"top",offset:[0,-10],opacity:1,permanent:!0,className:"label-mapa",children:[" ",H.nombre.replace("CS ","").replace("CSMC ","").replace("PS ","")," (",H.cantidadVisual,") "]}),!ge&&Z.jsxs(Bh,{direction:"top",offset:[0,-5],opacity:1,children:[" ",H.nombre,": ",H.cantidadVisual," "]})]},J)})]})}),Z.jsxs("div",{style:{flex:1,minWidth:"320px",background:"#1e293b",display:"flex",flexDirection:"column"},children:[Z.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #334155"},children:[Z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px"},children:[Z.jsxs("div",{style:{background:"#334155",padding:"12px",borderRadius:"8px",flex:1,marginRight:"10px"},children:[Z.jsx("div",{style:{fontSize:"10px",fontWeight:"700",color:"#94a3b8",textTransform:"uppercase"},children:"Internos"}),Z.jsx("div",{style:{fontSize:"24px",fontWeight:"800",color:"#f8fafc"},children:te})]}),Z.jsxs("div",{style:{background:"#334155",padding:"12px",borderRadius:"8px",flex:1},children:[Z.jsx("div",{style:{fontSize:"10px",fontWeight:"700",color:"#94a3b8",textTransform:"uppercase"},children:"Sedes"}),Z.jsxs("div",{style:{fontSize:"24px",fontWeight:"800",color:"#f8fafc"},children:[Ae," ",Z.jsxs("span",{style:{fontSize:"14px",color:"#64748b"},children:["/ ",de]})]})]})]}),Z.jsxs("div",{style:{display:"flex",background:"#0f172a",borderRadius:"8px",padding:"4px"},children:[Z.jsx("button",{onClick:()=>p("lista"),style:{flex:1,padding:"8px",borderRadius:"6px",border:"none",background:h==="lista"?"#3b82f6":"transparent",color:h==="lista"?"white":"#94a3b8",fontWeight:"700",cursor:"pointer"},children:"LISTA"}),Z.jsx("button",{onClick:()=>p("reportes"),style:{flex:1,padding:"8px",borderRadius:"6px",border:"none",background:h==="reportes"?"#3b82f6":"transparent",color:h==="reportes"?"white":"#94a3b8",fontWeight:"700",cursor:"pointer"},children:"REPORTES"})]})]}),Z.jsx("div",{style:{flex:1,overflowY:"auto",padding:"15px"},className:"custom-scrollbar",children:h==="lista"?ue.map(H=>{var re;const J=S===H.nombre,q=v9(H.ris);return Z.jsxs("div",{style:{marginBottom:"10px",border:`1px solid ${J?q:"#334155"}`,borderRadius:"8px",background:"#0f172a",overflow:"hidden"},children:[Z.jsxs("div",{onClick:()=>j(H.nombre,H.lat,H.lng),style:{padding:"12px 15px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",background:J?`${q}10`:"transparent"},children:[Z.jsxs("div",{style:{overflow:"hidden",flex:1},children:[Z.jsx("div",{style:{fontWeight:"700",color:"#f1f5f9",fontSize:"13px"},children:H.nombre}),Z.jsx("span",{style:{fontSize:"10px",fontWeight:"700",color:q},children:H.ris})]}),Z.jsx("span",{style:{background:"#1e293b",color:"#f8fafc",fontSize:"11px",fontWeight:"700",padding:"2px 8px",borderRadius:"10px",border:"1px solid #334155"},children:H.cantidadVisual})]}),J&&Z.jsxs("div",{style:{padding:"0",background:"#1e293b",borderTop:"1px solid #334155"},children:[H.detallesVisuales&&H.detallesVisuales.length>0&&Z.jsx("div",{style:{padding:"15px",background:"#0f172a",borderBottom:"1px solid #334155"},children:Z.jsx(vy,{data:[H]})}),Z.jsx("div",{style:{padding:"15px"},children:(re=H.detallesVisuales)==null?void 0:re.map((ge,ye)=>Z.jsxs("div",{style:{marginBottom:"10px",paddingBottom:"10px",borderBottom:"1px dashed #334155"},children:[Z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",fontWeight:"700",color:"#f1f5f9",marginBottom:"4px"},children:[Z.jsx("span",{children:ge.dni}),Z.jsx("span",{style:{color:"#60a5fa"},children:ge.carrera})]}),Z.jsx("div",{style:{color:"#94a3b8",fontSize:"10px",marginBottom:"8px"},children:ge.universidad}),Z.jsx("div",{style:{paddingLeft:"8px",borderLeft:"2px solid #334155"},children:ge.rotaciones.map((Se,ve)=>Z.jsxs("div",{style:{fontSize:"11px",marginBottom:"2px",color:"#cbd5e1"},children:[Z.jsxs("b",{style:{color:q},children:[Se.nombre,":"]})," ",Se.establecimiento]},ve))})]},ye))})]})]},H.nombre)}):Z.jsxs("div",{className:"fade-in",children:[Z.jsxs("div",{style:{marginBottom:"10px",fontSize:"12px",color:"#cbd5e1",textAlign:"center",fontStyle:"italic"},children:["Resumen: ",x!=="todos"?x:"Global"]}),Z.jsx(vy,{data:ue})]})})]})]})]})},S9=`
  body { margin: 0; background-color: #2e1065; color: #e2e8f0; font-family: 'Segoe UI', Roboto, sans-serif; }
  
  /* SCROLLBAR */
  .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
  .custom-scrollbar::-webkit-scrollbar-track { background: #1e1b4b; }
  .custom-scrollbar::-webkit-scrollbar-thumb { background: #6366f1; border-radius: 10px; }
  .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #818cf8; }
  
  /* MAPA */
  .leaflet-tooltip.label-mapa {
    background-color: rgba(30, 27, 75, 0.95) !important;
    border: 1px solid #8b5cf6 !important; color: #fff !important;
    font-weight: 700 !important; font-size: 11px !important;
    border-radius: 6px !important; padding: 2px 8px !important;
    box-shadow: 0 4px 12px rgba(0,0,0,0.5) !important;
  }
  .leaflet-tooltip-bottom:before { border-bottom-color: rgba(30, 27, 75, 0.95) !important; }
  
  /* ANIMACIONES */
  .fade-in { animation: fadeIn 0.3s ease-out; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

  /* GRFICOS */
  .chart-row { display: flex; align-items: center; margin-bottom: 10px; }
  .chart-label-container { width: 220px; text-align: right; padding-right: 15px; display: flex; align-items: center; justify-content: flex-end; }
  .chart-label { font-size: 11px; color: #c4b5fd; font-weight: 600; line-height: 1.2; white-space: normal; }
  .chart-track { flex: 1; background: #4c1d95; height: 14px; border-radius: 4px; overflow: hidden; position: relative; }
  .chart-fill { height: 100%; border-radius: 4px; transition: width 0.8s ease; }
  .chart-value { width: 40px; padding-left: 10px; font-weight: 800; color: #e2e8f0; font-size: 12px; }

  /* MODAL MODERN */
  .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.92); display: flex; justify-content: center; align-items: center; z-index: 10000; backdrop-filter: blur(8px); }
  .modal-content { background: #1e1b4b; border-radius: 16px; width: 95%; max-width: 1200px; height: 90vh; border: 1px solid #4338ca; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.7); display: flex; flexDirection: column; overflow: hidden; }
  .modal-header { padding: 20px 25px; background: #312e81; border-bottom: 1px solid #4338ca; display: flex; justify-content: space-between; align-items: center; }
  .modal-body { padding: 25px; overflow-y: auto; flex: 1; background: #0f172a; }
  
  /* GESTIN MANUAL: TARJETAS DE EDICIN */
  .edit-card-container { background: #1e1b4b; border: 1px solid #4338ca; border-radius: 12px; padding: 20px; margin-bottom: 15px; transition: all 0.2s; }
  .edit-card-container:hover { border-color: #6366f1; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
  
  .uni-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px; margin-top: 15px; }
  .uni-item { 
      background: #312e81; border: 1px solid #4c1d95; padding: 10px; border-radius: 8px; 
      display: flex; justify-content: space-between; align-items: center; transition: all 0.2s; 
  }
  .uni-item.active { border-color: #8b5cf6; background: #4338ca; }
  .uni-label { font-size: 11px; color: #cbd5e1; font-weight: 600; width: 120px; line-height: 1.2; }
  
  /* INPUTS PRO */
  .input-modern { background: #0f172a; border: 1px solid #6366f1; color: white; padding: 8px; border-radius: 6px; width: 60px; text-align: center; font-weight: bold; font-size: 13px; }
  .input-modern:focus { outline: none; border-color: #a78bfa; box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2); }
  
  .input-capacidad { background: #4c1d95; border: 2px solid #10b981; color: white; font-size: 16px; width: 80px; padding: 8px; border-radius: 8px; text-align: center; font-weight: 800; }

  /* TIEMPOS ROTACIN */
  .time-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
  .time-card { background: #1e1b4b; border: 1px solid #4338ca; border-radius: 10px; padding: 15px; }
  .time-field { display: flex; align-items: center; justify-content: space-between; margin-top: 8px; background: #0f172a; padding: 6px 10px; border-radius: 6px; }
  .time-icon { font-size: 14px; margin-right: 8px; width: 20px; text-align: center; }

  /* KPI CARDS */
  .kpi-box { background: #312e81; border: 1px solid #4338ca; border-radius: 10px; padding: 12px; flex: 1; text-align: center; position: relative; overflow: hidden; }
  .kpi-label { font-size: 10px; font-weight: 700; color: #a5b4fc; text-transform: uppercase; letter-spacing: 1px; }
  .kpi-number { font-size: 22px; font-weight: 900; color: white; margin-top: 4px; }
  
  .career-select { background-color: #5b21b6; color: white; font-weight: 700; border: 2px solid #a78bfa; box-shadow: 0 0 10px rgba(139, 92, 246, 0.5); padding: 8px 12px; border-radius: 8px; cursor: pointer; }
  
  /* BOTONES */
  .btn-modern { border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 700; display: flex; align-items: center; gap: 6px; transition: all 0.2s; }
  .btn-modern:hover { filter: brightness(1.1); transform: translateY(-1px); }
  .btn-close { background: rgba(255,255,255,0.1); color: #cbd5e1; }
  .btn-save { background: #10b981; color: white; }
  .btn-edit { background: #3b82f6; color: white; }
`,qd=[{id:"TODAS",label:" TODAS LAS CARRERAS"},{id:"MEDICINA",label:"MEDICINA HUMANA"},{id:"ENFERMERIA",label:"ENFERMERA"},{id:"OBSTETRICIA",label:"OBSTETRICIA"},{id:"ODONTOLOGIA",label:"ODONTOLOGA"},{id:"FARMACIA",label:"FARMACIA Y BIOQUMICA"},{id:"NUTRICION",label:"NUTRICIN"},{id:"PSICOLOGIA",label:"PSICOLOGA"},{id:"TRABAJO_SOCIAL",label:"TRABAJO SOCIAL"},{id:"BIOLOGIA",label:"BIOLOGA"},{id:"TM_LABORATORIO",label:"TM: LABORATORIO CLNICO"},{id:"TM_TERAPIA_FISICA",label:"TM: TERAPIA FSICA"},{id:"TM_RADIOLOGIA",label:"TM: RADIOLOGA"},{id:"TM_TERAPIA_OCUPACIONAL",label:"TM: TERAPIA OCUPACIONAL"},{id:"TM_TERAPIA_LENGUAJE",label:"TM: TERAPIA DE LENGUAJE"},{id:"TM_OPTOMETRIA",label:"TM: OPTOMETRA"}],xy=["UNIVERSIDAD NACIONAL MAYOR DE SAN MARCOS","UNIVERSIDAD NACIONAL FEDERICO VILLARREAL","UNIVERSIDAD ENRIQUE GUZMAN Y VALLE","UNIVERSIDAD PERUANA CAYETANO HEREDIA","UNIVERSIDAD SAN MARTIN DE PORRES","UNIVERSIDAD PERUANA UNION","UNIVERSIDAD FEMENINA DEL SAGRADO CORAZON","UNIVERSIDAD CSAR VALLEJO","UNIVERSIDAD PERUANA DE CIENCIAS APLICADAS","UNIVERSIDAD PRIVADA DEL NORTE","UNIVERSIDAD PRIVADA NORBERT WIENER","UNIVERSIDAD SAN JUAN BAUTISTA","UNIVERSIDAD TECNOLGICA DEL PER","UNIVERSIDAD CIENTIFICA DEL SUR","UNIVERSIDAD RICARDO PALMA","UNIVERSIDAD CATOLICA SEDES SAPIENTIAE","UNIVERSIDAD CONTINENTAL","UNIVERSIDAD CIENCIAS Y HUMANIDADES","UNIVERSIDAD MARIA AUXILIADORA","UNIVERSIDAD LE CORDON BLEU","UNIVERSIDAD DE PIURA","UNIVERSIDAD NACIONAL DANIEL ALCIDES CARRION","UNIVERSIDAD NACIONAL HERMILIO VALDIZAN","UNIVERSIDAD NACIONAL DE TRUJILLO","UNIVERSIDAD NACIONAL DEL ALTIPLANO DE PUNO","UNIVERSIDAD FRANKLIN ROOSEVELT","UNIVERSIDAD SAN IGNACIO DE LOYOLA","UNIVERSIDAD JOS FAUSTINO SNCHEZ CARRIN","UNIVERSIDAD DE LIMA"],Vo={"RIS 1":"#10b981","RIS 2":"#facc15","RIS 3":"#f97316","RIS 4":"#3b82f6","RIS 5":"#ef4444","RIS 6":"#8b5cf6","RIS 7":"#ec4899","SIN RIS":"#94a3b8",HOSPITAL:"#f43f5e",INSTITUTO:"#a855f7",DEFAULT:"#64748b"},xS={LIMA:"RIS 1","CERCADO DE LIMA":"RIS 1",BRENA:"RIS 2",BREA:"RIS 2","JESUS MARIA":"RIS 2","PUEBLO LIBRE":"RIS 2","MAGDALENA DEL MAR":"RIS 3","SAN MIGUEL":"RIS 3",LINCE:"RIS 4","SAN ISIDRO":"RIS 4",MIRAFLORES:"RIS 4","SAN BORJA":"RIS 4",SURQUILLO:"RIS 4","LA VICTORIA":"RIS 5","SAN LUIS":"RIS 5","EL AGUSTINO":"RIS 5","SANTA ANITA":"RIS 5","SAN JUAN DE LURIGANCHO":"RIS 6",RIMAC:"RIS 7",INDEPENDENCIA:"RIS 7",COMAS:"RIS 7"},I9=Object.keys(xS).sort(),Yd=(e,t="")=>{const r=t.toUpperCase();if(r.startsWith("HOSPITAL"))return Vo.HOSPITAL;if(r.startsWith("INSTITUTO"))return Vo.INSTITUTO;const n=Object.keys(Vo).find(i=>(e||"").toUpperCase().includes(i));return n?Vo[n]:Vo.DEFAULT},C9={claro:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",oscuro:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",satelite:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"},yy=e=>e?String(e).toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^A-Z0-9 ]/g,"").trim():"",Jd=[{id:"r1_1",ris:"RIS 1",nombre:"CS CONDE DE LA VEGA",lat:-12.038921,lng:-77.050464,distrito:"CERCADO DE LIMA"},{id:"r1_2",ris:"RIS 1",nombre:"CS CONTROL DE ZOONOSIS",lat:-12.049798,lng:-77.06224,distrito:"CERCADO DE LIMA"},{id:"r1_3",ris:"RIS 1",nombre:"CS ITS Y VIH RAUL PATRUCCO PUIG",lat:-12.052736,lng:-77.022955,distrito:"LA VICTORIA"},{id:"r1_4",ris:"RIS 1",nombre:"CS JUAN PEREZ CARRANZA",lat:-12.053413,lng:-77.022688,distrito:"LA VICTORIA"},{id:"r1_5",ris:"RIS 1",nombre:"CS MIRONES",lat:-12.050879,lng:-77.067292,distrito:"CERCADO DE LIMA"},{id:"r1_6",ris:"RIS 1",nombre:"CS MIRONES BAJO",lat:-12.050897,lng:-77.067321,distrito:"CERCADO DE LIMA"},{id:"r1_7",ris:"RIS 1",nombre:"CS SAN SEBASTIAN",lat:-12.042331,lng:-77.038673,distrito:"CERCADO DE LIMA"},{id:"r1_8",ris:"RIS 1",nombre:"CS UNIDAD VECINAL N3",lat:-12.051273,lng:-77.08233,distrito:"CERCADO DE LIMA"},{id:"r1_9",ris:"RIS 1",nombre:"CS VILLA MARIA DEL PERPETUO SOCORRO",lat:-12.037751,lng:-77.054586,distrito:"CERCADO DE LIMA"},{id:"r1_11",ris:"RIS 1",nombre:"CSMC MIRONES BAJO",lat:-12.037769,lng:-77.081481,distrito:"CERCADO DE LIMA"},{id:"r1_12",ris:"RIS 1",nombre:"CSMC SAN MARCOS",lat:-12.055392,lng:-77.082387,distrito:"PUEBLO LIBRE"},{id:"r1_13",ris:"RIS 1",nombre:"PS PALERMO",lat:-12.040929,lng:-77.068914,distrito:"CERCADO DE LIMA"},{id:"r1_14",ris:"RIS 1",nombre:"PS RESCATE",lat:-12.041065,lng:-77.062272,distrito:"CERCADO DE LIMA"},{id:"r1_15",ris:"RIS 1",nombre:"PS SANTA ROSA",lat:-12.044848,lng:-77.111266,distrito:"CALLAO"},{id:"r2_1",ris:"RIS 2",nombre:"CS BREA",lat:-12.063762,lng:-77.057869,distrito:"BREA"},{id:"r2_2",ris:"RIS 2",nombre:"CS CHACRA COLORADA",lat:-12.053863,lng:-77.048067,distrito:"BREA"},{id:"r2_3",ris:"RIS 2",nombre:"CS HUACA PANDO",lat:-12.061594,lng:-77.083254,distrito:"PUEBLO LIBRE"},{id:"r2_4",ris:"RIS 2",nombre:"CS JESUS MARIA",lat:-12.077688,lng:-77.053306,distrito:"JESUS MARIA"},{id:"r2_5",ris:"RIS 2",nombre:"CS SAN MIGUEL",lat:-12.081167,lng:-77.09853,distrito:"SAN MIGUEL"},{id:"r2_6",ris:"RIS 2",nombre:"CSM EXCELENCIA SAN MIGUEL",lat:-12.081396,lng:-77.101266,distrito:"SAN MIGUEL"},{id:"r2_7",ris:"RIS 2",nombre:"CSMC HONORIO DELGADO",lat:-12.069174,lng:-77.058068,distrito:"BREA"},{id:"r2_8",ris:"RIS 2",nombre:"CSMC JESUS MARIA",lat:-12.07406,lng:-77.043524,distrito:"JESUS MARIA"},{id:"r2_9",ris:"RIS 2",nombre:"CSMC MAGDALENA",lat:-12.088394,lng:-77.063122,distrito:"MAGDALENA DEL MAR"},{id:"r2_10",ris:"RIS 2",nombre:"CSMI MAGDALENA",lat:-12.088383,lng:-77.06876,distrito:"MAGDALENA DEL MAR"},{id:"r2_11",ris:"RIS 2",nombre:"LABORATORIO REFERENCIAL",lat:-12.088656,lng:-77.067946,distrito:"MAGDALENA DEL MAR"},{id:"r3_1",ris:"RIS 3",nombre:"CS LINCE",lat:-12.081669,lng:-77.031994,distrito:"LINCE"},{id:"r3_2",ris:"RIS 3",nombre:"CS SAM ATANACIO DE PEDREGAL",lat:-12.1209,lng:-76.998887,distrito:"SURQUILLO"},{id:"r3_3",ris:"RIS 3",nombre:"CS SAN ISIDRO",lat:-12.106575,lng:-77.05512,distrito:"SAN ISIDRO"},{id:"r3_4",ris:"RIS 3",nombre:"CS SANTA CRUZ MIRAFLORES",lat:-12.118628,lng:-77.036754,distrito:"MIRAFLORES"},{id:"r3_5",ris:"RIS 3",nombre:"CS VILLA VICTORIA PORVENIR",lat:-12.10857,lng:-77.012094,distrito:"SURQUILLO"},{id:"r3_6",ris:"RIS 3",nombre:"CSMC SAN BORJA",lat:-12.108779,lng:-77.00647,distrito:"SAN BORJA"},{id:"r3_7",ris:"RIS 3",nombre:"CSMC SAN ISIDRO",lat:-12.107595,lng:-77.050509,distrito:"SAN ISIDRO"},{id:"r3_8",ris:"RIS 3",nombre:"CSMC SURQUILLO",lat:-12.118613,lng:-77.019213,distrito:"SURQUILLO"},{id:"r3_9",ris:"RIS 3",nombre:"CSMI SURQUILLO",lat:-12.118262,lng:-77.022244,distrito:"SURQUILLO"},{id:"r4_1",ris:"RIS 4",nombre:"CS EL PINO",lat:-12.066881,lng:-76.998619,distrito:"EL AGUSTINO"},{id:"r4_2",ris:"RIS 4",nombre:"CS MAX ARIAS SCHREIBER",lat:-12.059194,lng:-77.032271,distrito:"LA VICTORIA"},{id:"r4_3",ris:"RIS 4",nombre:"CS SAN COSME",lat:-12.061765,lng:-77.006846,distrito:"LA VICTORIA"},{id:"r4_4",ris:"RIS 4",nombre:"CS SAN LUIS",lat:-12.07445,lng:-76.997255,distrito:"SAN LUIS"},{id:"r4_5",ris:"RIS 4",nombre:"CS TODOS LOS SANTOS SAN BORJA",lat:-12.101842,lng:-76.993428,distrito:"SAN BORJA"},{id:"r4_6",ris:"RIS 4",nombre:"CSMC LA VICTORIA",lat:-12.071107,lng:-77.013469,distrito:"LA VICTORIA"},{id:"r4_7",ris:"RIS 4",nombre:"CSMC SAN COSME",lat:-12.061978,lng:-77.005306,distrito:"LA VICTORIA"},{id:"r4_8",ris:"RIS 4",nombre:"CSMI EL PORVENIR",lat:-12.067469,lng:-77.020826,distrito:"LA VICTORIA"},{id:"r4_9",ris:"RIS 4",nombre:"PS EL PINO",lat:-12.06586,lng:-77.002467,distrito:"EL AGUSTINO"},{id:"r4_10",ris:"RIS 4",nombre:"PS JARDN ROSA DE SANTA MARA",lat:-12.044257,lng:-77.01443,distrito:"EL AGUSTINO"},{id:"r4_11",ris:"RIS 4",nombre:"PS SAN JUAN MASIAS",lat:-12.084071,lng:-77.00246,distrito:"SAN LUIS"},{id:"r5_1",ris:"RIS 5",nombre:"CS CAJA DE AGUA",lat:-12.026599,lng:-77.014879,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_2",ris:"RIS 5",nombre:"CS CAMPOY",lat:-12.016004,lng:-76.965389,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_3",ris:"RIS 5",nombre:"CS CHACARILLA DE OTERO",lat:-12.020881,lng:-77.006867,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_4",ris:"RIS 5",nombre:"CS DANIEL ALCIDES CARRION",lat:-12.023003,lng:-76.977023,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_5",ris:"RIS 5",nombre:"CS LA HUAYRONA",lat:-11.993822,lng:-77.00658,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_6",ris:"RIS 5",nombre:"CS LA LIBERTAD",lat:-12.003994,lng:-76.995829,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_7",ris:"RIS 5",nombre:"CS MANGOMARCA",lat:-12.010634,lng:-76.979585,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_8",ris:"RIS 5",nombre:"CS SAN FERNANDO",lat:-12.0023,lng:-77.010607,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_9",ris:"RIS 5",nombre:"CS SANTA FE DE TOTORITA",lat:-11.996876,lng:-76.996041,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_10",ris:"RIS 5",nombre:"CS SANTA ROSA DE LIMA",lat:-12.005101,lng:-77.016472,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_11",ris:"RIS 5",nombre:"CS ZARATE",lat:-12.022964,lng:-76.994557,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_12",ris:"RIS 5",nombre:"CSMC JAVIER MARIATEGUI",lat:-12.017147,lng:-77.000884,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_13",ris:"RIS 5",nombre:"CSMC MANGOMARCA",lat:-12.019114,lng:-76.984995,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_14",ris:"RIS 5",nombre:"CSMC VILLA CAMPOY",lat:-12.007232,lng:-76.965202,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_15",ris:"RIS 5",nombre:"PS 15 DE ENERO",lat:-12.010915,lng:-77.01859,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_16",ris:"RIS 5",nombre:"PS AZCARRUNZ ALTO",lat:-12.017052,lng:-77.000957,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_1",ris:"RIS 6",nombre:"CS BAYOVAR",lat:-11.951986,lng:-76.991581,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_2",ris:"RIS 6",nombre:"CS GANIMENDES",lat:-11.983037,lng:-77.011447,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_3",ris:"RIS 6",nombre:"CS HUASCAR II",lat:-11.966623,lng:-77.010997,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_4",ris:"RIS 6",nombre:"CS HUASCAR XV",lat:-11.955447,lng:-77.002372,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_5",ris:"RIS 6",nombre:"CS MEDALLA MILAGROSA",lat:-11.976887,lng:-77.006001,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_6",ris:"RIS 6",nombre:"CS SAN HILARION",lat:-11.995438,lng:-77.01583,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_7",ris:"RIS 6",nombre:"CSMC JAIME ZUBIETA",lat:-11.962834,lng:-76.98873,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_8",ris:"RIS 6",nombre:"CSMC NUEVO PER",lat:-12.0029,lng:-77.018166,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_9",ris:"RIS 6",nombre:"PS AYACUCHO",lat:-11.987161,lng:-77.017107,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_10",ris:"RIS 6",nombre:"PS PROYECTOS ESPECIALES",lat:-11.955769,lng:-76.992456,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_11",ris:"RIS 6",nombre:"PS SAGRADA FAMILIA",lat:-11.976341,lng:-76.988859,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_1",ris:"RIS 7",nombre:"CS 10 DE OCTUBRE",lat:-11.944904,lng:-76.987643,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_2",ris:"RIS 7",nombre:"CS CRUZ DE MOTUPE",lat:-11.940364,lng:-76.974795,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_3",ris:"RIS 7",nombre:"CS ENRIQUE MONTENEGRO",lat:-11.937029,lng:-76.971134,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_4",ris:"RIS 7",nombre:"CS JAIME ZUBIETA",lat:-11.963164,lng:-76.988935,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_5",ris:"RIS 7",nombre:"CS JOSE CARLOS MARIATEGUI",lat:-11.94384,lng:-76.984472,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_6",ris:"RIS 7",nombre:"CS JUAN PABLO II",lat:-11.952272,lng:-77.077927,distrito:"SAN MARTIN DE PORRES"},{id:"r7_7",ris:"RIS 7",nombre:"CS SANTA MARIA",lat:-11.964929,lng:-76.975984,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_8",ris:"RIS 7",nombre:"PS CESAR VALLEJO",lat:-11.939452,lng:-76.965759,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_9",ris:"RIS 7",nombre:"PS JOSE CARLOS MARIATEGUI V ETAPA",lat:-11.931092,lng:-76.990411,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_10",ris:"RIS 7",nombre:"PS MARISCAL CACERES",lat:-11.949206,lng:-76.98108,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_11",ris:"RIS 7",nombre:"PS TUPAC AMARU II",lat:-11.955745,lng:-76.975792,distrito:"SAN JUAN DE LURIGANCHO"},{id:"h_1",ris:"SIN RIS",nombre:"HOSPITAL NACIONAL DOS DE MAYO",lat:-12.056369,lng:-77.016048,distrito:"CERCADO DE LIMA",tipo:"HOSPITAL"},{id:"h_2",ris:"SIN RIS",nombre:"HOSPITAL NACIONAL ARZOBISPO LOAYZA",lat:-12.049516,lng:-77.042667,distrito:"CERCADO DE LIMA",tipo:"HOSPITAL"},{id:"h_3",ris:"SIN RIS",nombre:"HOSPITAL SAN JUAN DE LURIGANCHO",lat:-11.966064,lng:-77.003482,distrito:"SAN JUAN DE LURIGANCHO",tipo:"HOSPITAL"},{id:"h_4",ris:"SIN RIS",nombre:"HOSPITAL NACIONAL SAN BARTOLOME",lat:-12.049583,lng:-77.04211,distrito:"CERCADO DE LIMA",tipo:"HOSPITAL"},{id:"h_5",ris:"SIN RIS",nombre:"HOSPITAL DE EMERGENCIAS JOSE CASIMIRO ULLOA",lat:-12.127835,lng:-77.017796,distrito:"MIRAFLORES",tipo:"HOSPITAL"},{id:"h_6",ris:"SIN RIS",nombre:"HOSPITAL SANTA ROSA",lat:-12.071516,lng:-77.06107,distrito:"PUEBLO LIBRE",tipo:"HOSPITAL"},{id:"h_7",ris:"SIN RIS",nombre:"HOSPITAL VICTOR LARCO HERRERA",lat:-12.097315,lng:-77.064832,distrito:"MAGDALENA DEL MAR",tipo:"HOSPITAL"},{id:"h_8",ris:"SIN RIS",nombre:"HOSPITAL DE EMERGENCIAS PEDITRICAS",lat:-12.058125,lng:-77.021607,distrito:"LA VICTORIA",tipo:"HOSPITAL"},{id:"i_1",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE ENFERMEDADES NEOPLSICAS",lat:-12.11232,lng:-76.998266,distrito:"SAN BORJA",tipo:"INSTITUTO"},{id:"i_2",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE SALUD DEL NIO-BREA",lat:-12.064247,lng:-77.04572,distrito:"BREA",tipo:"INSTITUTO"},{id:"i_3",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE SALUD DEL NIO-SAN BORJA",lat:-12.085823,lng:-76.992491,distrito:"SAN BORJA",tipo:"INSTITUTO"},{id:"i_4",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL MATERNO PERINATAL",lat:-12.052537,lng:-77.022163,distrito:"CERCADO DE LIMA",tipo:"INSTITUTO"},{id:"i_5",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE CIENCIAS NEUROLGICAS",lat:-12.045887,lng:-77.015878,distrito:"CERCADO DE LIMA",tipo:"INSTITUTO"}],k9=({center:e,zoom:t})=>{const r=J2();return _e.useEffect(()=>{r.flyTo(e,t,{duration:1.5})},[e,t,r]),null},R9=({data:e,tiempos:t})=>{const r=e.filter(m=>!m.nombre.startsWith("HOSPITAL")&&!m.nombre.startsWith("INSTITUTO")),n=e.filter(m=>m.nombre.startsWith("HOSPITAL")||m.nombre.startsWith("INSTITUTO")),i=r.reduce((m,_)=>m+_.disponible,0),s=n.reduce((m,_)=>m+_.disponible,0),o=r.reduce((m,_)=>m+_.capacidadTotal,0),l=r.reduce((m,_)=>m+_.cantidad,0),u=o>0?l/o*100:0,h=Wa.useMemo(()=>{const m={};e.forEach(x=>{x.desglose&&x.desglose.forEach(E=>{m[E.universidad]=(m[E.universidad]||0)+E.cantidad})});const _=(x,E)=>E[1]-x[1];return Object.entries(m).sort(_)},[e]);if(e.length===0)return Z.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#a78bfa",fontSize:"14px",fontStyle:"italic"},children:"No hay datos registrados."});const p=h.length>0?h[0][1]:1;return Z.jsxs("div",{className:"fade-in",style:{paddingRight:"10px"},children:[Z.jsxs("h4",{style:{color:"#34d399",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"12px",borderBottom:"1px solid #064e3b",paddingBottom:"5px",letterSpacing:"0.5px"},children:[Z.jsx("i",{className:"fas fa-check-circle mr-2"})," Disponibilidad de Plazas"]}),Z.jsxs("div",{style:{display:"flex",gap:"15px",marginBottom:"25px"},children:[Z.jsxs("div",{className:"kpi-box",style:{background:"#064e3b",borderColor:"#059669"},children:[Z.jsx("div",{className:"kpi-label",style:{color:"#a7f3d0"},children:"Primer Nivel"}),Z.jsx("div",{className:"kpi-number",style:{color:"#34d399"},children:i}),Z.jsx("div",{style:{fontSize:"10px",color:"#6ee7b7"},children:"Vacantes Libres"})]}),Z.jsxs("div",{className:"kpi-box",style:{background:"#4c1d95",borderColor:"#be185d"},children:[Z.jsx("div",{className:"kpi-label",style:{color:"#fda4af"},children:"Hosp. e Inst."}),Z.jsx("div",{className:"kpi-number",style:{color:"#f43f5e"},children:s}),Z.jsx("div",{style:{fontSize:"10px",color:"#fbcfe8"},children:"Vacantes Libres"})]})]}),Z.jsxs("h4",{style:{color:"#60a5fa",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"10px",borderBottom:"1px solid #1e3a8a",paddingBottom:"5px",letterSpacing:"0.5px"},children:[Z.jsx("i",{className:"fas fa-chart-pie mr-2"})," Ocupacin Primer Nivel"]}),Z.jsxs("div",{style:{marginBottom:"25px",background:"#1e1b4b",padding:"15px",borderRadius:"10px",border:"1px solid #312e81"},children:[Z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#cbd5e1",marginBottom:"8px",fontWeight:"600"},children:[Z.jsxs("span",{children:["Usado: ",Z.jsx("b",{style:{color:"#60a5fa"},children:l})]}),Z.jsxs("span",{children:["Total: ",Z.jsx("b",{style:{color:"white"},children:o})]})]}),Z.jsx("div",{style:{width:"100%",height:"16px",background:"#0f172a",borderRadius:"8px",overflow:"hidden",border:"1px solid #334155",position:"relative"},children:Z.jsx("div",{style:{width:`${u}%`,height:"100%",background:"linear-gradient(90deg, #3b82f6, #6366f1)",transition:"width 0.8s cubic-bezier(0.4, 0, 0.2, 1)"}})}),Z.jsxs("div",{style:{textAlign:"right",fontSize:"11px",color:"#a5b4fc",marginTop:"6px",fontWeight:"700"},children:[u.toFixed(1),"% Cubierto"]})]}),t&&Object.keys(t).length>0&&Z.jsxs("div",{style:{marginBottom:"25px"},children:[Z.jsxs("h4",{style:{color:"#fbbf24",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginTop:"10px",borderBottom:"1px solid #78350f",paddingBottom:"5px",letterSpacing:"0.5px"},children:[Z.jsx("i",{className:"fas fa-clock mr-2"})," Tiempos de Rotacin (Meses)"]}),Z.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"10px"},children:Object.entries(t).map(([m,_])=>Z.jsxs("div",{style:{background:"#312e81",padding:"10px",borderRadius:"8px",border:"1px solid #4c1d95"},children:[Z.jsx("div",{style:{fontSize:"10px",fontWeight:"700",color:"#e2e8f0",marginBottom:"5px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:m}),Z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"11px"},children:[Z.jsxs("span",{style:{color:"#34d399"},children:["PN: ",Z.jsx("b",{children:_.mesesPrimerNivel||"-"})]}),Z.jsxs("span",{style:{color:"#f472b6"},children:["H: ",Z.jsx("b",{children:_.mesesHospital||"-"})]})]})]},m))})]}),Z.jsxs("h4",{style:{color:"#a78bfa",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",margin:"10px 0 15px 0",borderBottom:"1px solid #581c87",paddingBottom:"5px",letterSpacing:"0.5px"},children:[Z.jsx("i",{className:"fas fa-university mr-2"})," Asignacin por Universidad"]}),Z.jsx("div",{style:{paddingBottom:"20px"},children:h.map(([m,_])=>Z.jsxs("div",{className:"chart-row",children:[Z.jsx("div",{className:"chart-label-container",children:Z.jsx("span",{className:"chart-label",children:m})}),Z.jsx("div",{className:"chart-track",children:Z.jsx("div",{className:"chart-fill",style:{width:`${_/p*100}%`,background:"linear-gradient(90deg, #7c3aed, #a78bfa)"},children:Z.jsx("span",{className:"chart-value-label",children:_})})}),Z.jsx("div",{className:"chart-total",children:_})]},m))})]})},P9=()=>{var ot;const e=j2();_e.useEffect(()=>{const ne=document.createElement("style");return ne.innerHTML=S9,document.head.appendChild(ne),()=>{document.head.removeChild(ne)}},[]);const[t,r]=_e.useState(null),[n,i]=_e.useState([-12.05,-77.06]),[s,o]=_e.useState(12),[l,u]=_e.useState("oscuro"),[h,p]=_e.useState("lista"),[m,_]=_e.useState("MEDICINA"),[x,E]=_e.useState("todos"),[y,A]=_e.useState("todos"),[C,k]=_e.useState(""),[w,V]=_e.useState([]),[Q,X]=_e.useState(null),[S,R]=_e.useState(!1),[P,D]=_e.useState(null),[F,b]=_e.useState({}),[M,Pe]=_e.useState(0),[ke,Ne]=_e.useState(""),[Oe,ue]=_e.useState(!1),[te,de]=_e.useState({});_e.useEffect(()=>{fetch("https://raw.githubusercontent.com/yurivilc/peru-geojson/master/lima_callao_distritos.geojson").then(ne=>ne.json()).then(ne=>r(ne)).catch(console.error)},[]),_e.useEffect(()=>{(async()=>{m==="TODAS"?await j():(await H(m),await J(m))})()},[m]);const Ae=ne=>{const fe=ne.properties.NOMBDIST||ne.properties.NOMB_DIST||"",be=yy(fe),Xe=xS[be]||"DEFAULT",qe=Vo[Xe],mt=y==="todos"||be===yy(y);return{fillColor:qe,weight:Xe!=="DEFAULT"?1:.5,opacity:1,color:"white",fillOpacity:mt?.5:.1}},j=async()=>{let ne={};Jd.forEach(fe=>{ne[fe.nombre]={...fe,capacidadTotal:0,cantidad:0,desglose:[],disponible:0}});for(const fe of qd)if(fe.id!=="TODAS")try{(await Rm(Yc(ds,`adjudicacion_2026_${fe.id}`))).docs.forEach(Xe=>{const qe=Xe.data();ne[qe.nombre]&&(ne[qe.nombre].capacidadTotal+=qe.capacidadTotal||0,ne[qe.nombre].cantidad+=qe.cantidad||0,ne[qe.nombre].disponible+=qe.disponible||0,qe.desglose&&qe.desglose.forEach(mt=>{ne[qe.nombre].desglose.push({universidad:`${mt.universidad} (${fe.label.substring(0,3)})`,cantidad:mt.cantidad})}))})}catch{}V(Object.values(ne)),de({})},H=async ne=>{try{const fe=`adjudicacion_2026_${ne}`,Xe=(await Rm(Yc(ds,fe))).docs.map(Lt=>({id:Lt.id,...Lt.data()})),qe={};Xe.forEach(Lt=>{qe[Lt.nombre]=Lt});let mt=Jd.map(Lt=>{const ir=qe[Lt.nombre];return ir?{...Lt,...ir}:{...Lt,capacidadTotal:0,desglose:[],disponible:0,cantidad:0}});V(mt)}catch(fe){console.error("Error cargando:",fe),V(Jd.map(be=>({...be,capacidadTotal:0,desglose:[],disponible:0,cantidad:0})))}},J=async ne=>{try{const fe=hh(ds,"config_tiempos_2026",ne),be=await u9(fe);be.exists()?de(be.data()):de({})}catch(fe){console.error("Error loading times:",fe)}},q=async()=>{try{await f9(hh(ds,"config_tiempos_2026",m),te),ue(!1),alert(" Tiempos guardados.")}catch(ne){console.error(ne),alert("Error al guardar.")}},re=(ne,fe,be)=>{de(Xe=>({...Xe,[ne]:{...Xe[ne],[fe]:be}}))},ge=ne=>{D(ne.nombre),Pe(ne.capacidadTotal||0);const fe={};ne.desglose&&ne.desglose.forEach(be=>fe[be.universidad]=be.cantidad),b(fe)},ye=(ne,fe)=>{b(be=>({...be,[ne]:parseInt(fe)||0}))},Se=async()=>{if(!P)return;const ne=w.find(qe=>qe.nombre===P);if(!ne)return;const fe=[];let be=0;if(Object.entries(F).forEach(([qe,mt])=>{mt>0&&(fe.push({universidad:qe,cantidad:mt}),be+=mt)}),be>M&&!confirm(` Cuidado: Asignaste ${be} plazas, pero la oferta es ${M}. Guardar?`))return;const Xe={...ne,capacidadTotal:M,desglose:fe,cantidad:be,disponible:M-be};try{const qe=`adjudicacion_2026_${m}`;await _S(ds).set(hh(Yc(ds,qe),P.replace(/[\/\s\.]/g,"_")),Xe).commit(),V(mt=>mt.map(Lt=>Lt.nombre===P?Xe:Lt)),D(null)}catch(qe){console.error(qe),alert("Error al guardar.")}},ve=w.map(ne=>ne).filter(ne=>{const fe=y==="todos"||ne.distrito&&ne.distrito===y,be=C===""||ne.nombre.includes(C.toUpperCase());let Xe=!0;return x==="HOSP"?Xe=ne.ris==="SIN RIS":x!=="todos"&&(Xe=ne.ris===x),fe&&be&&Xe}).sort((ne,fe)=>fe.capacidadTotal-ne.capacidadTotal),Ye=w.filter(ne=>ne.nombre.includes(ke.toUpperCase())),Y=ve.reduce((ne,fe)=>ne+fe.capacidadTotal,0),yt=ve.reduce((ne,fe)=>ne+fe.disponible,0),He=(ne,fe,be)=>{Q===ne?X(null):(X(ne),fe!==0&&fe!==-12.046374&&(i([fe,be]),o(16)))};return Z.jsxs("div",{className:"dashboard-container",style:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"#2e1065",color:"#e2e8f0"},children:[Z.jsxs("div",{style:{background:"#4c1d95",padding:"0 24px",height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #6d28d9",zIndex:50},children:[Z.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[Z.jsx("div",{style:{background:"#8b5cf6",width:"40px",height:"40px",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center"},children:Z.jsx("i",{className:"fas fa-calendar-check",style:{fontSize:"20px",color:"white"}})}),Z.jsxs("div",{children:[Z.jsxs("h1",{style:{margin:0,fontSize:"20px",fontWeight:"800",color:"#f8fafc"},children:["ADJUDICACIN ",Z.jsx("span",{style:{color:"#a78bfa"},children:"2026"})]}),Z.jsx("p",{style:{margin:"2px 0 0 0",fontSize:"11px",opacity:.6},children:"GESTIN DE PLAZAS"})]})]}),Z.jsxs("div",{style:{display:"flex",gap:"10px"},children:[Z.jsxs("button",{onClick:()=>ue(!0),disabled:m==="TODAS",className:"btn-modern",style:{background:m==="TODAS"?"#4b5563":"#8b5cf6",color:"white"},children:[Z.jsx("i",{className:"fas fa-clock"})," Tiempos"]}),Z.jsxs("button",{onClick:()=>R(!0),disabled:m==="TODAS",className:"btn-modern",style:{background:m==="TODAS"?"#4b5563":"#10b981",color:"white"},children:[Z.jsx("i",{className:"fas fa-edit"})," Gestin Manual"]}),Z.jsxs("button",{onClick:()=>e("/"),className:"btn-modern btn-close",children:[Z.jsx("i",{className:"fas fa-arrow-left"})," Volver 2025"]})]})]}),Z.jsxs("div",{style:{padding:"15px 24px",background:"#4c1d95",borderBottom:"1px solid #6d28d9",display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[Z.jsxs("div",{style:{display:"flex",alignItems:"center",marginRight:"15px"},children:[Z.jsx("span",{style:{fontSize:"12px",color:"#a5b4fc",marginRight:"8px",fontWeight:"700"},children:"CARRERA:"}),Z.jsx("select",{value:m,onChange:ne=>_(ne.target.value),className:"career-select",style:{width:"240px"},children:qd.map(ne=>Z.jsxs("option",{value:ne.id,children:[" ",ne.label]},ne.id))})]}),Z.jsx("div",{style:{position:"relative",flex:1},children:Z.jsx("input",{type:"text",placeholder:"Buscar Sede...",value:C,onChange:ne=>k(ne.target.value.toUpperCase()),style:{width:"100%",padding:"8px 8px 8px 12px",borderRadius:"6px",border:"1px solid #6d28d9",background:"#2e1065",color:"white",fontSize:"13px",boxSizing:"border-box"}})}),Z.jsxs("select",{value:y,onChange:ne=>A(ne.target.value),style:{width:"180px",padding:"8px",borderRadius:"6px",border:"1px solid #6d28d9",background:"#2e1065",color:"white",fontSize:"13px"},children:[" ",Z.jsx("option",{value:"todos",children:" Todos los Distritos"})," ",I9.map(ne=>Z.jsx("option",{value:ne,children:ne},ne))," "]}),Z.jsx("button",{onClick:()=>E(x==="HOSP"?"todos":"HOSP"),className:"btn-modern",style:{background:x==="HOSP"?"#f43f5e":"#2e1065",border:"1px solid #f43f5e"},children:" HOSP/INST"})]}),Oe&&Z.jsx("div",{className:"modal-overlay",children:Z.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",height:"80vh"},children:[Z.jsxs("div",{className:"modal-header",children:[Z.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[Z.jsx("i",{className:"fas fa-clock",style:{color:"#fbbf24",fontSize:"20px"}}),Z.jsx("h3",{style:{margin:0,color:"#fbbf24"},children:"Tiempos de Rotacin (Meses)"})]}),Z.jsx("button",{onClick:()=>ue(!1),className:"close-modal-btn",children:Z.jsx("i",{className:"fas fa-times"})})]}),Z.jsx("div",{className:"modal-body custom-scrollbar",children:Z.jsx("div",{className:"time-grid",children:xy.map(ne=>{var fe,be;return Z.jsxs("div",{className:"time-card",children:[Z.jsx("div",{style:{fontSize:"11px",fontWeight:"700",color:"#e2e8f0",marginBottom:"10px",borderBottom:"1px solid #4c1d95",paddingBottom:"5px",minHeight:"32px",display:"flex",alignItems:"center"},children:ne}),Z.jsxs("div",{className:"time-field",children:[Z.jsx("span",{className:"time-icon",children:""})," ",Z.jsx("span",{style:{fontSize:"11px",color:"#a5b4fc"},children:"Primer Nivel"}),Z.jsx("input",{type:"text",className:"input-meses-card",placeholder:"-",value:((fe=te[ne])==null?void 0:fe.mesesPrimerNivel)||"",onChange:Xe=>re(ne,"mesesPrimerNivel",Xe.target.value)})]}),Z.jsxs("div",{className:"time-field",children:[Z.jsx("span",{className:"time-icon",children:""})," ",Z.jsx("span",{style:{fontSize:"11px",color:"#a5b4fc"},children:"Hospital"}),Z.jsx("input",{type:"text",className:"input-meses-card",placeholder:"-",value:((be=te[ne])==null?void 0:be.mesesHospital)||"",onChange:Xe=>re(ne,"mesesHospital",Xe.target.value)})]})]},ne)})})}),Z.jsx("div",{className:"modal-footer",children:Z.jsx("button",{onClick:q,className:"btn-modern btn-save",children:"GUARDAR CAMBIOS"})})]})}),S&&Z.jsx("div",{className:"modal-overlay",children:Z.jsxs("div",{className:"modal-content",children:[Z.jsxs("div",{className:"modal-header",children:[Z.jsxs("h3",{style:{margin:0,color:"#a78bfa"},children:["Gestin Manual: ",(ot=qd.find(ne=>ne.id===m))==null?void 0:ot.label]}),Z.jsxs("div",{style:{display:"flex",gap:"10px"},children:[Z.jsx("input",{type:"text",placeholder:"Filtrar lista...",value:ke,onChange:ne=>Ne(ne.target.value),className:"input-plaza",style:{width:"200px",textAlign:"left"}}),Z.jsx("button",{onClick:()=>R(!1),className:"close-modal-btn",children:Z.jsx("i",{className:"fas fa-times"})})]})]}),Z.jsx("div",{className:"modal-body custom-scrollbar",children:Ye.map(ne=>Z.jsxs("div",{className:"edit-card-container",children:[Z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px",alignItems:"center"},children:[Z.jsxs("div",{style:{flex:1},children:[Z.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[Z.jsx("i",{className:`fas ${ne.nombre.startsWith("CS")?"fa-clinic-medical":"fa-hospital"}`,style:{color:Yd(ne.ris,ne.tipo)}}),Z.jsx("span",{style:{fontWeight:"700",color:"#e2e8f0",fontSize:"14px"},children:ne.nombre})]}),Z.jsxs("div",{style:{fontSize:"11px",color:"#94a3b8",marginTop:"4px",marginLeft:"26px"},children:["Ofertado: ",Z.jsx("b",{style:{color:"white"},children:ne.capacidadTotal})," | Libre: ",Z.jsx("b",{style:{color:ne.disponible>0?"#34d399":"#f43f5e"},children:ne.disponible})]})]}),Z.jsx("div",{style:{display:"flex",gap:"10px"},children:P===ne.nombre?Z.jsxs(Z.Fragment,{children:[Z.jsx("button",{onClick:()=>D(null),className:"btn-modern btn-close",children:"CERRAR"}),Z.jsx("button",{onClick:Se,className:"btn-modern btn-save",children:"GUARDAR"})]}):Z.jsx("button",{onClick:()=>ge(ne),className:"btn-modern btn-edit",children:"EDITAR"})})]}),P===ne.nombre?Z.jsxs("div",{style:{background:"#0f172a",padding:"20px",borderRadius:"10px",border:"1px solid #6366f1",animation:"fadeIn 0.3s"},children:[Z.jsxs("div",{style:{marginBottom:"20px",display:"flex",alignItems:"center",gap:"15px",borderBottom:"1px solid #334155",paddingBottom:"15px"},children:[Z.jsx("label",{style:{fontSize:"13px",fontWeight:"800",color:"#34d399",textTransform:"uppercase"},children:"Capacidad Total:"}),Z.jsx("input",{type:"number",min:"0",className:"input-total",value:M,onChange:fe=>Pe(parseInt(fe.target.value)||0)})]}),Z.jsx("div",{className:"uni-grid",children:xy.map(fe=>Z.jsxs("div",{className:`uni-item ${F[fe]>0?"active":""}`,children:[Z.jsx("span",{className:"uni-label",title:fe,children:fe}),Z.jsx("input",{type:"number",min:"0",className:"input-plaza",value:F[fe]||"",onChange:be=>ye(fe,be.target.value),placeholder:"0"})]},fe))})]}):Z.jsx("div",{style:{fontSize:"10px",color:"#94a3b8",display:"flex",flexWrap:"wrap",gap:"6px",paddingLeft:"26px",marginTop:"5px"},children:ne.desglose&&ne.desglose.length>0?ne.desglose.map(fe=>Z.jsxs("span",{style:{background:"#4c1d95",padding:"4px 8px",borderRadius:"4px",border:"1px solid #6d28d9",color:"#e2e8f0",display:"flex",alignItems:"center",gap:"5px"},children:[Z.jsx("span",{style:{maxWidth:"150px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:fe.universidad}),Z.jsx("b",{style:{color:"#f472b6",background:"#312e81",padding:"1px 6px",borderRadius:"3px"},children:fe.cantidad})]},fe.universidad)):Z.jsx("span",{style:{opacity:.5,fontStyle:"italic"},children:"Sin asignaciones."})})]},ne.nombre))})]})}),Z.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[Z.jsx("div",{style:{flex:3,position:"relative",borderRight:"1px solid #6d28d9"},children:Z.jsxs(tT,{center:n,zoom:s,style:{height:"100%",width:"100%",background:"#2e1065"},zoomControl:!1,children:[Z.jsx(k9,{center:n,zoom:s}),Z.jsx(rT,{url:C9[l],attribution:" CARTO"}),t&&Z.jsx(eT,{data:t,style:Ae}),ve.map((ne,fe)=>{if(ne.sinCoordenadas)return null;const be=Q===ne.nombre,Xe=Yd(ne.ris,ne.tipo);return Z.jsxs(Q2,{center:[ne.lat,ne.lng],pathOptions:{color:be?"white":Xe,fillColor:be?"transparent":Xe,fillOpacity:be?0:.8,weight:be?3:0,dashArray:be?"4,4":""},radius:be?12:6,eventHandlers:{click:()=>He(ne.nombre,ne.lat,ne.lng)},children:[be&&Z.jsxs(Bh,{direction:"top",offset:[0,-10],opacity:1,permanent:!0,className:"label-mapa",children:[" ",ne.nombre," (Libres: ",ne.disponible,") "]}),!be&&Z.jsxs(Bh,{direction:"top",offset:[0,-5],opacity:1,children:[" ",ne.nombre,": ",ne.disponible," libres "]})]},fe)})]})}),Z.jsxs("div",{style:{flex:1,minWidth:"340px",background:"#4c1d95",display:"flex",flexDirection:"column",boxShadow:"-5px 0 15px rgba(0,0,0,0.2)"},children:[Z.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #6d28d9",background:"#3b0764"},children:[Z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px",gap:"10px"},children:[Z.jsxs("div",{style:{background:"linear-gradient(135deg, #5b21b6, #4c1d95)",padding:"15px",borderRadius:"12px",flex:1,textAlign:"center",boxShadow:"0 4px 10px rgba(91, 33, 182, 0.3)",border:"1px solid #6d28d9"},children:[Z.jsx("div",{style:{fontSize:"11px",fontWeight:"800",color:"#a78bfa",textTransform:"uppercase",letterSpacing:"1px"},children:"Total Ofertado"}),Z.jsx("div",{style:{fontSize:"28px",fontWeight:"900",color:"#f8fafc",marginTop:"5px"},children:Y})]}),Z.jsxs("div",{style:{background:"linear-gradient(135deg, #064e3b, #065f46)",padding:"15px",borderRadius:"12px",flex:1,textAlign:"center",boxShadow:"0 4px 10px rgba(6, 78, 59, 0.3)",border:"1px solid #047857"},children:[Z.jsx("div",{style:{fontSize:"11px",fontWeight:"800",color:"#34d399",textTransform:"uppercase",letterSpacing:"1px"},children:"Disponible Total"}),Z.jsx("div",{style:{fontSize:"28px",fontWeight:"900",color:"#f8fafc",marginTop:"5px"},children:yt})]})]}),Z.jsxs("div",{style:{display:"flex",background:"#2e1065",borderRadius:"8px",padding:"4px"},children:[Z.jsx("button",{onClick:()=>p("lista"),style:{flex:1,padding:"10px",borderRadius:"6px",border:"none",background:h==="lista"?"#8b5cf6":"transparent",color:h==="lista"?"white":"#a78bfa",fontWeight:"700",cursor:"pointer",transition:"all 0.2s"},children:"SEDES"}),Z.jsx("button",{onClick:()=>p("reportes"),style:{flex:1,padding:"10px",borderRadius:"6px",border:"none",background:h==="reportes"?"#8b5cf6":"transparent",color:h==="reportes"?"white":"#a78bfa",fontWeight:"700",cursor:"pointer",transition:"all 0.2s"},children:"GRFICOS"})]})]}),Z.jsx("div",{style:{flex:1,overflowY:"auto",padding:"15px",background:"#4c1d95"},className:"custom-scrollbar",children:h==="lista"?ve.map(ne=>{var Xe;const fe=Q===ne.nombre,be=Yd(ne.ris,ne.tipo);return Z.jsxs("div",{style:{marginBottom:"12px",border:`1px solid ${fe?be:"#6d28d9"}`,borderRadius:"10px",background:"#2e1065",overflow:"hidden",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",transition:"all 0.2s"},children:[Z.jsxs("div",{onClick:()=>He(ne.nombre,ne.lat,ne.lng),style:{padding:"12px 15px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",background:fe?`linear-gradient(90deg, ${be}20, transparent)`:"transparent"},children:[Z.jsxs("div",{style:{overflow:"hidden",flex:1,display:"flex",alignItems:"center",gap:"8px"},children:[Z.jsx("i",{className:"fas fa-map-marker-alt",style:{color:be}}),Z.jsxs("div",{children:[Z.jsx("div",{style:{fontWeight:"700",color:"#f1f5f9",fontSize:"13px"},children:ne.nombre}),Z.jsx("div",{style:{fontSize:"11px",color:"#94a3b8",display:"flex",gap:"10px"},children:Z.jsxs("span",{children:["Capacidad: ",Z.jsx("b",{children:ne.capacidadTotal})]})})]})]}),Z.jsxs("span",{style:{background:ne.disponible>0?"#064e3b":"#450a0a",color:ne.disponible>0?"#34d399":"#fca5a5",fontSize:"11px",fontWeight:"800",padding:"4px 10px",borderRadius:"12px",border:"1px solid #ffffff20",minWidth:"70px",textAlign:"center"},children:[ne.disponible," Libres"]})]}),fe&&Z.jsxs("div",{style:{padding:"15px",background:"#3b0764",borderTop:"1px solid #6d28d9",animation:"fadeIn 0.2s ease-out"},children:[Z.jsxs("div",{style:{fontSize:"11px",color:"#a78bfa",marginBottom:"12px",fontWeight:"800",letterSpacing:"0.5px"},children:["ASIGNADO (",ne.cantidad,"):"]}),(Xe=ne.desglose)==null?void 0:Xe.map((qe,mt)=>Z.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",fontSize:"12px",background:"#4c1d95",padding:"6px 10px",borderRadius:"6px"},children:[Z.jsx("span",{style:{color:"#e2e8f0",fontWeight:"600"},children:qe.universidad}),Z.jsx("div",{style:{textAlign:"right"},children:Z.jsx("span",{style:{fontWeight:"800",color:"#f472b6",display:"block"},children:qe.cantidad})})]},mt)),(!ne.desglose||ne.desglose.length===0)&&Z.jsx("div",{style:{fontSize:"12px",color:"#64748b",fontStyle:"italic",padding:"10px",textAlign:"center",background:"#4c1d95",borderRadius:"6px"},children:"Sin asignaciones registradas."})]})]},ne.nombre)}):Z.jsx("div",{className:"fade-in",children:Z.jsx(R9,{data:ve,tiempos:te})})})]})]})]})};function N9(){return Z.jsx(_R,{children:Z.jsxs(pR,{children:[Z.jsx(Zp,{path:"/",element:Z.jsx(A9,{})}),Z.jsx(Zp,{path:"/adjudicacion2026",element:Z.jsx(P9,{})})]})})}Qd.createRoot(document.getElementById("root")).render(Z.jsx(Wa.StrictMode,{children:Z.jsx(N9,{})}));
