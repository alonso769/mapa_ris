function QS(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var eI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tI(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Cy={exports:{}},h0={},ky={exports:{}},dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mu=Symbol.for("react.element"),rI=Symbol.for("react.portal"),nI=Symbol.for("react.fragment"),iI=Symbol.for("react.strict_mode"),sI=Symbol.for("react.profiler"),aI=Symbol.for("react.provider"),oI=Symbol.for("react.context"),lI=Symbol.for("react.forward_ref"),cI=Symbol.for("react.suspense"),uI=Symbol.for("react.memo"),fI=Symbol.for("react.lazy"),a1=Symbol.iterator;function hI(e){return e===null||typeof e!="object"?null:(e=a1&&e[a1]||e["@@iterator"],typeof e=="function"?e:null)}var Ry={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Py=Object.assign,Ny={};function Ol(e,t,r){this.props=e,this.context=t,this.refs=Ny,this.updater=r||Ry}Ol.prototype.isReactComponent={};Ol.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ol.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Oy(){}Oy.prototype=Ol.prototype;function Fm(e,t,r){this.props=e,this.context=t,this.refs=Ny,this.updater=r||Ry}var bm=Fm.prototype=new Oy;bm.constructor=Fm;Py(bm,Ol.prototype);bm.isPureReactComponent=!0;var o1=Array.isArray,Ly=Object.prototype.hasOwnProperty,Mm={current:null},Dy={key:!0,ref:!0,__self:!0,__source:!0};function Fy(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)Ly.call(t,n)&&!Dy.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];i.children=u}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:Mu,type:e,key:s,ref:o,props:i,_owner:Mm.current}}function dI(e,t){return{$$typeof:Mu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Bm(e){return typeof e=="object"&&e!==null&&e.$$typeof===Mu}function pI(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var l1=/\/+/g;function ld(e,t){return typeof e=="object"&&e!==null&&e.key!=null?pI(""+e.key):t.toString(36)}function eh(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Mu:case rI:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+ld(o,0):n,o1(i)?(r="",e!=null&&(r=e.replace(l1,"$&/")+"/"),eh(i,t,r,"",function(h){return h})):i!=null&&(Bm(i)&&(i=dI(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(l1,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",o1(e))for(var l=0;l<e.length;l++){s=e[l];var u=n+ld(s,l);o+=eh(s,t,r,u,i)}else if(u=hI(e),typeof u=="function")for(e=u.call(e),l=0;!(s=e.next()).done;)s=s.value,u=n+ld(s,l++),o+=eh(s,t,r,u,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Af(e,t,r){if(e==null)return e;var n=[],i=0;return eh(e,n,"","",function(s){return t.call(r,s,i++)}),n}function mI(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Sn={current:null},th={transition:null},gI={ReactCurrentDispatcher:Sn,ReactCurrentBatchConfig:th,ReactCurrentOwner:Mm};function by(){throw Error("act(...) is not supported in production builds of React.")}dt.Children={map:Af,forEach:function(e,t,r){Af(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Af(e,function(){t++}),t},toArray:function(e){return Af(e,function(t){return t})||[]},only:function(e){if(!Bm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};dt.Component=Ol;dt.Fragment=nI;dt.Profiler=sI;dt.PureComponent=Fm;dt.StrictMode=iI;dt.Suspense=cI;dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gI;dt.act=by;dt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Py({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=Mm.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)Ly.call(t,u)&&!Dy.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];n.children=l}return{$$typeof:Mu,type:e.type,key:i,ref:s,props:n,_owner:o}};dt.createContext=function(e){return e={$$typeof:oI,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:aI,_context:e},e.Consumer=e};dt.createElement=Fy;dt.createFactory=function(e){var t=Fy.bind(null,e);return t.type=e,t};dt.createRef=function(){return{current:null}};dt.forwardRef=function(e){return{$$typeof:lI,render:e}};dt.isValidElement=Bm;dt.lazy=function(e){return{$$typeof:fI,_payload:{_status:-1,_result:e},_init:mI}};dt.memo=function(e,t){return{$$typeof:uI,type:e,compare:t===void 0?null:t}};dt.startTransition=function(e){var t=th.transition;th.transition={};try{e()}finally{th.transition=t}};dt.unstable_act=by;dt.useCallback=function(e,t){return Sn.current.useCallback(e,t)};dt.useContext=function(e){return Sn.current.useContext(e)};dt.useDebugValue=function(){};dt.useDeferredValue=function(e){return Sn.current.useDeferredValue(e)};dt.useEffect=function(e,t){return Sn.current.useEffect(e,t)};dt.useId=function(){return Sn.current.useId()};dt.useImperativeHandle=function(e,t,r){return Sn.current.useImperativeHandle(e,t,r)};dt.useInsertionEffect=function(e,t){return Sn.current.useInsertionEffect(e,t)};dt.useLayoutEffect=function(e,t){return Sn.current.useLayoutEffect(e,t)};dt.useMemo=function(e,t){return Sn.current.useMemo(e,t)};dt.useReducer=function(e,t,r){return Sn.current.useReducer(e,t,r)};dt.useRef=function(e){return Sn.current.useRef(e)};dt.useState=function(e){return Sn.current.useState(e)};dt.useSyncExternalStore=function(e,t,r){return Sn.current.useSyncExternalStore(e,t,r)};dt.useTransition=function(){return Sn.current.useTransition()};dt.version="18.3.1";ky.exports=dt;var _e=ky.exports;const Ka=tI(_e),_I=QS({__proto__:null,default:Ka},[_e]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vI=_e,xI=Symbol.for("react.element"),yI=Symbol.for("react.fragment"),EI=Object.prototype.hasOwnProperty,TI=vI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,AI={key:!0,ref:!0,__self:!0,__source:!0};function My(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)EI.call(t,n)&&!AI.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:xI,type:e,key:s,ref:o,props:i,_owner:TI.current}}h0.Fragment=yI;h0.jsx=My;h0.jsxs=My;Cy.exports=h0;var W=Cy.exports,ip={},By={exports:{}},Qn={},Uy={exports:{}},Vy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(fe,te){var de=fe.length;fe.push(te);e:for(;0<de;){var Ee=de-1>>>1,j=fe[Ee];if(0<i(j,te))fe[Ee]=te,fe[de]=j,de=Ee;else break e}}function r(fe){return fe.length===0?null:fe[0]}function n(fe){if(fe.length===0)return null;var te=fe[0],de=fe.pop();if(de!==te){fe[0]=de;e:for(var Ee=0,j=fe.length,re=j>>>1;Ee<re;){var Q=2*(Ee+1)-1,Y=fe[Q],le=Q+1,ye=fe[le];if(0>i(Y,de))le<j&&0>i(ye,Y)?(fe[Ee]=ye,fe[le]=de,Ee=le):(fe[Ee]=Y,fe[Q]=de,Ee=Q);else if(le<j&&0>i(ye,de))fe[Ee]=ye,fe[le]=de,Ee=le;else break e}}return te}function i(fe,te){var de=fe.sortIndex-te.sortIndex;return de!==0?de:fe.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],h=[],p=1,m=null,_=3,v=!1,E=!1,y=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(fe){for(var te=r(h);te!==null;){if(te.callback===null)n(h);else if(te.startTime<=fe)n(h),te.sortIndex=te.expirationTime,t(u,te);else break;te=r(h)}}function U(fe){if(y=!1,A(fe),!E)if(r(u)!==null)E=!0,Re(q);else{var te=r(h);te!==null&&ke(U,te.startTime-fe)}}function q(fe,te){E=!1,y&&(y=!1,k(R),R=-1),v=!0;var de=_;try{for(A(te),m=r(u);m!==null&&(!(m.expirationTime>te)||fe&&!F());){var Ee=m.callback;if(typeof Ee=="function"){m.callback=null,_=m.priorityLevel;var j=Ee(m.expirationTime<=te);te=e.unstable_now(),typeof j=="function"?m.callback=j:m===r(u)&&n(u),A(te)}else n(u);m=r(u)}if(m!==null)var re=!0;else{var Q=r(h);Q!==null&&ke(U,Q.startTime-te),re=!1}return re}finally{m=null,_=de,v=!1}}var K=!1,S=null,R=-1,P=5,D=-1;function F(){return!(e.unstable_now()-D<P)}function b(){if(S!==null){var fe=e.unstable_now();D=fe;var te=!0;try{te=S(!0,fe)}finally{te?M():(K=!1,S=null)}}else K=!1}var M;if(typeof C=="function")M=function(){C(b)};else if(typeof MessageChannel<"u"){var Ce=new MessageChannel,Ie=Ce.port2;Ce.port1.onmessage=b,M=function(){Ie.postMessage(null)}}else M=function(){w(b,0)};function Re(fe){S=fe,K||(K=!0,M())}function ke(fe,te){R=w(function(){fe(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(fe){fe.callback=null},e.unstable_continueExecution=function(){E||v||(E=!0,Re(q))},e.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<fe?Math.floor(1e3/fe):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(fe){switch(_){case 1:case 2:case 3:var te=3;break;default:te=_}var de=_;_=te;try{return fe()}finally{_=de}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(fe,te){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var de=_;_=fe;try{return te()}finally{_=de}},e.unstable_scheduleCallback=function(fe,te,de){var Ee=e.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?Ee+de:Ee):de=Ee,fe){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=de+j,fe={id:p++,callback:te,priorityLevel:fe,startTime:de,expirationTime:j,sortIndex:-1},de>Ee?(fe.sortIndex=de,t(h,fe),r(u)===null&&fe===r(h)&&(y?(k(R),R=-1):y=!0,ke(U,de-Ee))):(fe.sortIndex=j,t(u,fe),E||v||(E=!0,Re(q))),fe},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(fe){var te=_;return function(){var de=_;_=te;try{return fe.apply(this,arguments)}finally{_=de}}}})(Vy);Uy.exports=Vy;var wI=Uy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SI=_e,Yn=wI;function Se(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zy=new Set,tu={};function ao(e,t){gl(e,t),gl(e+"Capture",t)}function gl(e,t){for(tu[e]=t,e=0;e<t.length;e++)zy.add(t[e])}var Is=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sp=Object.prototype.hasOwnProperty,II=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c1={},u1={};function CI(e){return sp.call(u1,e)?!0:sp.call(c1,e)?!1:II.test(e)?u1[e]=!0:(c1[e]=!0,!1)}function kI(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function RI(e,t,r,n){if(t===null||typeof t>"u"||kI(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function In(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var qr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){qr[e]=new In(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];qr[t]=new In(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){qr[e]=new In(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){qr[e]=new In(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){qr[e]=new In(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){qr[e]=new In(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){qr[e]=new In(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){qr[e]=new In(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){qr[e]=new In(e,5,!1,e.toLowerCase(),null,!1,!1)});var Um=/[\-:]([a-z])/g;function Vm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Um,Vm);qr[t]=new In(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Um,Vm);qr[t]=new In(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Um,Vm);qr[t]=new In(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){qr[e]=new In(e,1,!1,e.toLowerCase(),null,!1,!1)});qr.xlinkHref=new In("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){qr[e]=new In(e,1,!1,e.toLowerCase(),null,!0,!0)});function zm(e,t,r,n){var i=qr.hasOwnProperty(t)?qr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(RI(t,r,i,n)&&(r=null),n||i===null?CI(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Fs=SI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wf=Symbol.for("react.element"),Go=Symbol.for("react.portal"),$o=Symbol.for("react.fragment"),jm=Symbol.for("react.strict_mode"),ap=Symbol.for("react.profiler"),jy=Symbol.for("react.provider"),Hy=Symbol.for("react.context"),Hm=Symbol.for("react.forward_ref"),op=Symbol.for("react.suspense"),lp=Symbol.for("react.suspense_list"),Wm=Symbol.for("react.memo"),Zs=Symbol.for("react.lazy"),Wy=Symbol.for("react.offscreen"),f1=Symbol.iterator;function uc(e){return e===null||typeof e!="object"?null:(e=f1&&e[f1]||e["@@iterator"],typeof e=="function"?e:null)}var rr=Object.assign,cd;function yc(e){if(cd===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);cd=t&&t[1]||""}return`
`+cd+e}var ud=!1;function fd(e,t){if(!e||ud)return"";ud=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var n=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){n=h}e.call(t.prototype)}else{try{throw Error()}catch(h){n=h}e()}}catch(h){if(h&&n&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var u=`
`+i[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{ud=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?yc(e):""}function PI(e){switch(e.tag){case 5:return yc(e.type);case 16:return yc("Lazy");case 13:return yc("Suspense");case 19:return yc("SuspenseList");case 0:case 2:case 15:return e=fd(e.type,!1),e;case 11:return e=fd(e.type.render,!1),e;case 1:return e=fd(e.type,!0),e;default:return""}}function cp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $o:return"Fragment";case Go:return"Portal";case ap:return"Profiler";case jm:return"StrictMode";case op:return"Suspense";case lp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Hy:return(e.displayName||"Context")+".Consumer";case jy:return(e._context.displayName||"Context")+".Provider";case Hm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Wm:return t=e.displayName||null,t!==null?t:cp(e.type)||"Memo";case Zs:t=e._payload,e=e._init;try{return cp(e(t))}catch{}}return null}function NI(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cp(t);case 8:return t===jm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function _a(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Gy(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function OI(e){var t=Gy(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Sf(e){e._valueTracker||(e._valueTracker=OI(e))}function $y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Gy(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function vh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function up(e,t){var r=t.checked;return rr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function h1(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=_a(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Zy(e,t){t=t.checked,t!=null&&zm(e,"checked",t,!1)}function fp(e,t){Zy(e,t);var r=_a(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?hp(e,t.type,r):t.hasOwnProperty("defaultValue")&&hp(e,t.type,_a(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function d1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function hp(e,t,r){(t!=="number"||vh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ec=Array.isArray;function sl(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+_a(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function dp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Se(91));return rr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function p1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Se(92));if(Ec(r)){if(1<r.length)throw Error(Se(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:_a(r)}}function Ky(e,t){var r=_a(t.value),n=_a(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function m1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Xy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Xy(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var If,qy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(If=If||document.createElement("div"),If.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=If.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ru(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Oc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},LI=["Webkit","ms","Moz","O"];Object.keys(Oc).forEach(function(e){LI.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Oc[t]=Oc[e]})});function Yy(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Oc.hasOwnProperty(e)&&Oc[e]?(""+t).trim():t+"px"}function Jy(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Yy(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var DI=rr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mp(e,t){if(t){if(DI[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Se(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Se(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Se(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Se(62))}}function gp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _p=null;function Gm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vp=null,al=null,ol=null;function g1(e){if(e=Vu(e)){if(typeof vp!="function")throw Error(Se(280));var t=e.stateNode;t&&(t=_0(t),vp(e.stateNode,e.type,t))}}function Qy(e){al?ol?ol.push(e):ol=[e]:al=e}function eE(){if(al){var e=al,t=ol;if(ol=al=null,g1(e),t)for(e=0;e<t.length;e++)g1(t[e])}}function tE(e,t){return e(t)}function rE(){}var hd=!1;function nE(e,t,r){if(hd)return e(t,r);hd=!0;try{return tE(e,t,r)}finally{hd=!1,(al!==null||ol!==null)&&(rE(),eE())}}function nu(e,t){var r=e.stateNode;if(r===null)return null;var n=_0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Se(231,t,typeof r));return r}var xp=!1;if(Is)try{var fc={};Object.defineProperty(fc,"passive",{get:function(){xp=!0}}),window.addEventListener("test",fc,fc),window.removeEventListener("test",fc,fc)}catch{xp=!1}function FI(e,t,r,n,i,s,o,l,u){var h=Array.prototype.slice.call(arguments,3);try{t.apply(r,h)}catch(p){this.onError(p)}}var Lc=!1,xh=null,yh=!1,yp=null,bI={onError:function(e){Lc=!0,xh=e}};function MI(e,t,r,n,i,s,o,l,u){Lc=!1,xh=null,FI.apply(bI,arguments)}function BI(e,t,r,n,i,s,o,l,u){if(MI.apply(this,arguments),Lc){if(Lc){var h=xh;Lc=!1,xh=null}else throw Error(Se(198));yh||(yh=!0,yp=h)}}function oo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function iE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function _1(e){if(oo(e)!==e)throw Error(Se(188))}function UI(e){var t=e.alternate;if(!t){if(t=oo(e),t===null)throw Error(Se(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return _1(i),e;if(s===n)return _1(i),t;s=s.sibling}throw Error(Se(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(Se(189))}}if(r.alternate!==n)throw Error(Se(190))}if(r.tag!==3)throw Error(Se(188));return r.stateNode.current===r?e:t}function sE(e){return e=UI(e),e!==null?aE(e):null}function aE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=aE(e);if(t!==null)return t;e=e.sibling}return null}var oE=Yn.unstable_scheduleCallback,v1=Yn.unstable_cancelCallback,VI=Yn.unstable_shouldYield,zI=Yn.unstable_requestPaint,hr=Yn.unstable_now,jI=Yn.unstable_getCurrentPriorityLevel,$m=Yn.unstable_ImmediatePriority,lE=Yn.unstable_UserBlockingPriority,Eh=Yn.unstable_NormalPriority,HI=Yn.unstable_LowPriority,cE=Yn.unstable_IdlePriority,d0=null,Yi=null;function WI(e){if(Yi&&typeof Yi.onCommitFiberRoot=="function")try{Yi.onCommitFiberRoot(d0,e,void 0,(e.current.flags&128)===128)}catch{}}var Mi=Math.clz32?Math.clz32:ZI,GI=Math.log,$I=Math.LN2;function ZI(e){return e>>>=0,e===0?32:31-(GI(e)/$I|0)|0}var Cf=64,kf=4194304;function Tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Th(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=Tc(l):(s&=o,s!==0&&(n=Tc(s)))}else o=r&~i,o!==0?n=Tc(o):s!==0&&(n=Tc(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Mi(t),i=1<<r,n|=e[r],t&=~i;return n}function KI(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function XI(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Mi(s),l=1<<o,u=i[o];u===-1?(!(l&r)||l&n)&&(i[o]=KI(l,t)):u<=t&&(e.expiredLanes|=l),s&=~l}}function Ep(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function uE(){var e=Cf;return Cf<<=1,!(Cf&4194240)&&(Cf=64),e}function dd(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Bu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Mi(t),e[t]=r}function qI(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Mi(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function Zm(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Mi(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Ot=0;function fE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var hE,Km,dE,pE,mE,Tp=!1,Rf=[],sa=null,aa=null,oa=null,iu=new Map,su=new Map,qs=[],YI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function x1(e,t){switch(e){case"focusin":case"focusout":sa=null;break;case"dragenter":case"dragleave":aa=null;break;case"mouseover":case"mouseout":oa=null;break;case"pointerover":case"pointerout":iu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":su.delete(t.pointerId)}}function hc(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Vu(t),t!==null&&Km(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function JI(e,t,r,n,i){switch(t){case"focusin":return sa=hc(sa,e,t,r,n,i),!0;case"dragenter":return aa=hc(aa,e,t,r,n,i),!0;case"mouseover":return oa=hc(oa,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return iu.set(s,hc(iu.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,su.set(s,hc(su.get(s)||null,e,t,r,n,i)),!0}return!1}function gE(e){var t=Ma(e.target);if(t!==null){var r=oo(t);if(r!==null){if(t=r.tag,t===13){if(t=iE(r),t!==null){e.blockedOn=t,mE(e.priority,function(){dE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function rh(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ap(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);_p=n,r.target.dispatchEvent(n),_p=null}else return t=Vu(r),t!==null&&Km(t),e.blockedOn=r,!1;t.shift()}return!0}function y1(e,t,r){rh(e)&&r.delete(t)}function QI(){Tp=!1,sa!==null&&rh(sa)&&(sa=null),aa!==null&&rh(aa)&&(aa=null),oa!==null&&rh(oa)&&(oa=null),iu.forEach(y1),su.forEach(y1)}function dc(e,t){e.blockedOn===t&&(e.blockedOn=null,Tp||(Tp=!0,Yn.unstable_scheduleCallback(Yn.unstable_NormalPriority,QI)))}function au(e){function t(i){return dc(i,e)}if(0<Rf.length){dc(Rf[0],e);for(var r=1;r<Rf.length;r++){var n=Rf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(sa!==null&&dc(sa,e),aa!==null&&dc(aa,e),oa!==null&&dc(oa,e),iu.forEach(t),su.forEach(t),r=0;r<qs.length;r++)n=qs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<qs.length&&(r=qs[0],r.blockedOn===null);)gE(r),r.blockedOn===null&&qs.shift()}var ll=Fs.ReactCurrentBatchConfig,Ah=!0;function eC(e,t,r,n){var i=Ot,s=ll.transition;ll.transition=null;try{Ot=1,Xm(e,t,r,n)}finally{Ot=i,ll.transition=s}}function tC(e,t,r,n){var i=Ot,s=ll.transition;ll.transition=null;try{Ot=4,Xm(e,t,r,n)}finally{Ot=i,ll.transition=s}}function Xm(e,t,r,n){if(Ah){var i=Ap(e,t,r,n);if(i===null)Ad(e,t,n,wh,r),x1(e,n);else if(JI(i,e,t,r,n))n.stopPropagation();else if(x1(e,n),t&4&&-1<YI.indexOf(e)){for(;i!==null;){var s=Vu(i);if(s!==null&&hE(s),s=Ap(e,t,r,n),s===null&&Ad(e,t,n,wh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Ad(e,t,n,null,r)}}var wh=null;function Ap(e,t,r,n){if(wh=null,e=Gm(n),e=Ma(e),e!==null)if(t=oo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=iE(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return wh=e,null}function _E(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jI()){case $m:return 1;case lE:return 4;case Eh:case HI:return 16;case cE:return 536870912;default:return 16}default:return 16}}var Qs=null,qm=null,nh=null;function vE(){if(nh)return nh;var e,t=qm,r=t.length,n,i="value"in Qs?Qs.value:Qs.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return nh=i.slice(e,1<n?1-n:void 0)}function ih(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Pf(){return!0}function E1(){return!1}function ei(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Pf:E1,this.isPropagationStopped=E1,this}return rr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Pf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Pf)},persist:function(){},isPersistent:Pf}),t}var Ll={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ym=ei(Ll),Uu=rr({},Ll,{view:0,detail:0}),rC=ei(Uu),pd,md,pc,p0=rr({},Uu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pc&&(pc&&e.type==="mousemove"?(pd=e.screenX-pc.screenX,md=e.screenY-pc.screenY):md=pd=0,pc=e),pd)},movementY:function(e){return"movementY"in e?e.movementY:md}}),T1=ei(p0),nC=rr({},p0,{dataTransfer:0}),iC=ei(nC),sC=rr({},Uu,{relatedTarget:0}),gd=ei(sC),aC=rr({},Ll,{animationName:0,elapsedTime:0,pseudoElement:0}),oC=ei(aC),lC=rr({},Ll,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),cC=ei(lC),uC=rr({},Ll,{data:0}),A1=ei(uC),fC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pC(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=dC[e])?!!t[e]:!1}function Jm(){return pC}var mC=rr({},Uu,{key:function(e){if(e.key){var t=fC[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ih(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?hC[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jm,charCode:function(e){return e.type==="keypress"?ih(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ih(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gC=ei(mC),_C=rr({},p0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),w1=ei(_C),vC=rr({},Uu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jm}),xC=ei(vC),yC=rr({},Ll,{propertyName:0,elapsedTime:0,pseudoElement:0}),EC=ei(yC),TC=rr({},p0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),AC=ei(TC),wC=[9,13,27,32],Qm=Is&&"CompositionEvent"in window,Dc=null;Is&&"documentMode"in document&&(Dc=document.documentMode);var SC=Is&&"TextEvent"in window&&!Dc,xE=Is&&(!Qm||Dc&&8<Dc&&11>=Dc),S1=" ",I1=!1;function yE(e,t){switch(e){case"keyup":return wC.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function EE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Zo=!1;function IC(e,t){switch(e){case"compositionend":return EE(t);case"keypress":return t.which!==32?null:(I1=!0,S1);case"textInput":return e=t.data,e===S1&&I1?null:e;default:return null}}function CC(e,t){if(Zo)return e==="compositionend"||!Qm&&yE(e,t)?(e=vE(),nh=qm=Qs=null,Zo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xE&&t.locale!=="ko"?null:t.data;default:return null}}var kC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function C1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!kC[e.type]:t==="textarea"}function TE(e,t,r,n){Qy(n),t=Sh(t,"onChange"),0<t.length&&(r=new Ym("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Fc=null,ou=null;function RC(e){LE(e,0)}function m0(e){var t=qo(e);if($y(t))return e}function PC(e,t){if(e==="change")return t}var AE=!1;if(Is){var _d;if(Is){var vd="oninput"in document;if(!vd){var k1=document.createElement("div");k1.setAttribute("oninput","return;"),vd=typeof k1.oninput=="function"}_d=vd}else _d=!1;AE=_d&&(!document.documentMode||9<document.documentMode)}function R1(){Fc&&(Fc.detachEvent("onpropertychange",wE),ou=Fc=null)}function wE(e){if(e.propertyName==="value"&&m0(ou)){var t=[];TE(t,ou,e,Gm(e)),nE(RC,t)}}function NC(e,t,r){e==="focusin"?(R1(),Fc=t,ou=r,Fc.attachEvent("onpropertychange",wE)):e==="focusout"&&R1()}function OC(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return m0(ou)}function LC(e,t){if(e==="click")return m0(t)}function DC(e,t){if(e==="input"||e==="change")return m0(t)}function FC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Vi=typeof Object.is=="function"?Object.is:FC;function lu(e,t){if(Vi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!sp.call(t,i)||!Vi(e[i],t[i]))return!1}return!0}function P1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function N1(e,t){var r=P1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=P1(r)}}function SE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?SE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function IE(){for(var e=window,t=vh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=vh(e.document)}return t}function eg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function bC(e){var t=IE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&SE(r.ownerDocument.documentElement,r)){if(n!==null&&eg(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=N1(r,s);var o=N1(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var MC=Is&&"documentMode"in document&&11>=document.documentMode,Ko=null,wp=null,bc=null,Sp=!1;function O1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Sp||Ko==null||Ko!==vh(n)||(n=Ko,"selectionStart"in n&&eg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),bc&&lu(bc,n)||(bc=n,n=Sh(wp,"onSelect"),0<n.length&&(t=new Ym("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ko)))}function Nf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Xo={animationend:Nf("Animation","AnimationEnd"),animationiteration:Nf("Animation","AnimationIteration"),animationstart:Nf("Animation","AnimationStart"),transitionend:Nf("Transition","TransitionEnd")},xd={},CE={};Is&&(CE=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function g0(e){if(xd[e])return xd[e];if(!Xo[e])return e;var t=Xo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in CE)return xd[e]=t[r];return e}var kE=g0("animationend"),RE=g0("animationiteration"),PE=g0("animationstart"),NE=g0("transitionend"),OE=new Map,L1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sa(e,t){OE.set(e,t),ao(t,[e])}for(var yd=0;yd<L1.length;yd++){var Ed=L1[yd],BC=Ed.toLowerCase(),UC=Ed[0].toUpperCase()+Ed.slice(1);Sa(BC,"on"+UC)}Sa(kE,"onAnimationEnd");Sa(RE,"onAnimationIteration");Sa(PE,"onAnimationStart");Sa("dblclick","onDoubleClick");Sa("focusin","onFocus");Sa("focusout","onBlur");Sa(NE,"onTransitionEnd");gl("onMouseEnter",["mouseout","mouseover"]);gl("onMouseLeave",["mouseout","mouseover"]);gl("onPointerEnter",["pointerout","pointerover"]);gl("onPointerLeave",["pointerout","pointerover"]);ao("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ao("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ao("onBeforeInput",["compositionend","keypress","textInput","paste"]);ao("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ao("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ao("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ac="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VC=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ac));function D1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,BI(n,t,void 0,e),e.currentTarget=null}function LE(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==s&&i.isPropagationStopped())break e;D1(i,l,h),s=u}else for(o=0;o<n.length;o++){if(l=n[o],u=l.instance,h=l.currentTarget,l=l.listener,u!==s&&i.isPropagationStopped())break e;D1(i,l,h),s=u}}}if(yh)throw e=yp,yh=!1,yp=null,e}function Wt(e,t){var r=t[Pp];r===void 0&&(r=t[Pp]=new Set);var n=e+"__bubble";r.has(n)||(DE(t,e,2,!1),r.add(n))}function Td(e,t,r){var n=0;t&&(n|=4),DE(r,e,n,t)}var Of="_reactListening"+Math.random().toString(36).slice(2);function cu(e){if(!e[Of]){e[Of]=!0,zy.forEach(function(r){r!=="selectionchange"&&(VC.has(r)||Td(r,!1,e),Td(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Of]||(t[Of]=!0,Td("selectionchange",!1,t))}}function DE(e,t,r,n){switch(_E(t)){case 1:var i=eC;break;case 4:i=tC;break;default:i=Xm}r=i.bind(null,t,r,e),i=void 0,!xp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Ad(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Ma(l),o===null)return;if(u=o.tag,u===5||u===6){n=s=o;continue e}l=l.parentNode}}n=n.return}nE(function(){var h=s,p=Gm(r),m=[];e:{var _=OE.get(e);if(_!==void 0){var v=Ym,E=e;switch(e){case"keypress":if(ih(r)===0)break e;case"keydown":case"keyup":v=gC;break;case"focusin":E="focus",v=gd;break;case"focusout":E="blur",v=gd;break;case"beforeblur":case"afterblur":v=gd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=T1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=iC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=xC;break;case kE:case RE:case PE:v=oC;break;case NE:v=EC;break;case"scroll":v=rC;break;case"wheel":v=AC;break;case"copy":case"cut":case"paste":v=cC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=w1}var y=(t&4)!==0,w=!y&&e==="scroll",k=y?_!==null?_+"Capture":null:_;y=[];for(var C=h,A;C!==null;){A=C;var U=A.stateNode;if(A.tag===5&&U!==null&&(A=U,k!==null&&(U=nu(C,k),U!=null&&y.push(uu(C,U,A)))),w)break;C=C.return}0<y.length&&(_=new v(_,E,null,r,p),m.push({event:_,listeners:y}))}}if(!(t&7)){e:{if(_=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",_&&r!==_p&&(E=r.relatedTarget||r.fromElement)&&(Ma(E)||E[Cs]))break e;if((v||_)&&(_=p.window===p?p:(_=p.ownerDocument)?_.defaultView||_.parentWindow:window,v?(E=r.relatedTarget||r.toElement,v=h,E=E?Ma(E):null,E!==null&&(w=oo(E),E!==w||E.tag!==5&&E.tag!==6)&&(E=null)):(v=null,E=h),v!==E)){if(y=T1,U="onMouseLeave",k="onMouseEnter",C="mouse",(e==="pointerout"||e==="pointerover")&&(y=w1,U="onPointerLeave",k="onPointerEnter",C="pointer"),w=v==null?_:qo(v),A=E==null?_:qo(E),_=new y(U,C+"leave",v,r,p),_.target=w,_.relatedTarget=A,U=null,Ma(p)===h&&(y=new y(k,C+"enter",E,r,p),y.target=A,y.relatedTarget=w,U=y),w=U,v&&E)t:{for(y=v,k=E,C=0,A=y;A;A=Mo(A))C++;for(A=0,U=k;U;U=Mo(U))A++;for(;0<C-A;)y=Mo(y),C--;for(;0<A-C;)k=Mo(k),A--;for(;C--;){if(y===k||k!==null&&y===k.alternate)break t;y=Mo(y),k=Mo(k)}y=null}else y=null;v!==null&&F1(m,_,v,y,!1),E!==null&&w!==null&&F1(m,w,E,y,!0)}}e:{if(_=h?qo(h):window,v=_.nodeName&&_.nodeName.toLowerCase(),v==="select"||v==="input"&&_.type==="file")var q=PC;else if(C1(_))if(AE)q=DC;else{q=OC;var K=NC}else(v=_.nodeName)&&v.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(q=LC);if(q&&(q=q(e,h))){TE(m,q,r,p);break e}K&&K(e,_,h),e==="focusout"&&(K=_._wrapperState)&&K.controlled&&_.type==="number"&&hp(_,"number",_.value)}switch(K=h?qo(h):window,e){case"focusin":(C1(K)||K.contentEditable==="true")&&(Ko=K,wp=h,bc=null);break;case"focusout":bc=wp=Ko=null;break;case"mousedown":Sp=!0;break;case"contextmenu":case"mouseup":case"dragend":Sp=!1,O1(m,r,p);break;case"selectionchange":if(MC)break;case"keydown":case"keyup":O1(m,r,p)}var S;if(Qm)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Zo?yE(e,r)&&(R="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(R="onCompositionStart");R&&(xE&&r.locale!=="ko"&&(Zo||R!=="onCompositionStart"?R==="onCompositionEnd"&&Zo&&(S=vE()):(Qs=p,qm="value"in Qs?Qs.value:Qs.textContent,Zo=!0)),K=Sh(h,R),0<K.length&&(R=new A1(R,e,null,r,p),m.push({event:R,listeners:K}),S?R.data=S:(S=EE(r),S!==null&&(R.data=S)))),(S=SC?IC(e,r):CC(e,r))&&(h=Sh(h,"onBeforeInput"),0<h.length&&(p=new A1("onBeforeInput","beforeinput",null,r,p),m.push({event:p,listeners:h}),p.data=S))}LE(m,t)})}function uu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Sh(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=nu(e,r),s!=null&&n.unshift(uu(e,s,i)),s=nu(e,t),s!=null&&n.push(uu(e,s,i))),e=e.return}return n}function Mo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function F1(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,u=l.alternate,h=l.stateNode;if(u!==null&&u===n)break;l.tag===5&&h!==null&&(l=h,i?(u=nu(r,s),u!=null&&o.unshift(uu(r,u,l))):i||(u=nu(r,s),u!=null&&o.push(uu(r,u,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var zC=/\r\n?/g,jC=/\u0000|\uFFFD/g;function b1(e){return(typeof e=="string"?e:""+e).replace(zC,`
`).replace(jC,"")}function Lf(e,t,r){if(t=b1(t),b1(e)!==t&&r)throw Error(Se(425))}function Ih(){}var Ip=null,Cp=null;function kp(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Rp=typeof setTimeout=="function"?setTimeout:void 0,HC=typeof clearTimeout=="function"?clearTimeout:void 0,M1=typeof Promise=="function"?Promise:void 0,WC=typeof queueMicrotask=="function"?queueMicrotask:typeof M1<"u"?function(e){return M1.resolve(null).then(e).catch(GC)}:Rp;function GC(e){setTimeout(function(){throw e})}function wd(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),au(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);au(t)}function la(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function B1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Dl=Math.random().toString(36).slice(2),qi="__reactFiber$"+Dl,fu="__reactProps$"+Dl,Cs="__reactContainer$"+Dl,Pp="__reactEvents$"+Dl,$C="__reactListeners$"+Dl,ZC="__reactHandles$"+Dl;function Ma(e){var t=e[qi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Cs]||r[qi]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=B1(e);e!==null;){if(r=e[qi])return r;e=B1(e)}return t}e=r,r=e.parentNode}return null}function Vu(e){return e=e[qi]||e[Cs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function qo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Se(33))}function _0(e){return e[fu]||null}var Np=[],Yo=-1;function Ia(e){return{current:e}}function Gt(e){0>Yo||(e.current=Np[Yo],Np[Yo]=null,Yo--)}function jt(e,t){Yo++,Np[Yo]=e.current,e.current=t}var va={},hn=Ia(va),Fn=Ia(!1),Xa=va;function _l(e,t){var r=e.type.contextTypes;if(!r)return va;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function bn(e){return e=e.childContextTypes,e!=null}function Ch(){Gt(Fn),Gt(hn)}function U1(e,t,r){if(hn.current!==va)throw Error(Se(168));jt(hn,t),jt(Fn,r)}function FE(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Se(108,NI(e)||"Unknown",i));return rr({},r,n)}function kh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||va,Xa=hn.current,jt(hn,e),jt(Fn,Fn.current),!0}function V1(e,t,r){var n=e.stateNode;if(!n)throw Error(Se(169));r?(e=FE(e,t,Xa),n.__reactInternalMemoizedMergedChildContext=e,Gt(Fn),Gt(hn),jt(hn,e)):Gt(Fn),jt(Fn,r)}var _s=null,v0=!1,Sd=!1;function bE(e){_s===null?_s=[e]:_s.push(e)}function KC(e){v0=!0,bE(e)}function Ca(){if(!Sd&&_s!==null){Sd=!0;var e=0,t=Ot;try{var r=_s;for(Ot=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}_s=null,v0=!1}catch(i){throw _s!==null&&(_s=_s.slice(e+1)),oE($m,Ca),i}finally{Ot=t,Sd=!1}}return null}var Jo=[],Qo=0,Rh=null,Ph=0,pi=[],mi=0,qa=null,xs=1,ys="";function La(e,t){Jo[Qo++]=Ph,Jo[Qo++]=Rh,Rh=e,Ph=t}function ME(e,t,r){pi[mi++]=xs,pi[mi++]=ys,pi[mi++]=qa,qa=e;var n=xs;e=ys;var i=32-Mi(n)-1;n&=~(1<<i),r+=1;var s=32-Mi(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,xs=1<<32-Mi(t)+i|r<<i|n,ys=s+e}else xs=1<<s|r<<i|n,ys=e}function tg(e){e.return!==null&&(La(e,1),ME(e,1,0))}function rg(e){for(;e===Rh;)Rh=Jo[--Qo],Jo[Qo]=null,Ph=Jo[--Qo],Jo[Qo]=null;for(;e===qa;)qa=pi[--mi],pi[mi]=null,ys=pi[--mi],pi[mi]=null,xs=pi[--mi],pi[mi]=null}var Xn=null,Zn=null,qt=!1,Li=null;function BE(e,t){var r=gi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function z1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xn=e,Zn=la(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xn=e,Zn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=qa!==null?{id:xs,overflow:ys}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=gi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Xn=e,Zn=null,!0):!1;default:return!1}}function Op(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Lp(e){if(qt){var t=Zn;if(t){var r=t;if(!z1(e,t)){if(Op(e))throw Error(Se(418));t=la(r.nextSibling);var n=Xn;t&&z1(e,t)?BE(n,r):(e.flags=e.flags&-4097|2,qt=!1,Xn=e)}}else{if(Op(e))throw Error(Se(418));e.flags=e.flags&-4097|2,qt=!1,Xn=e}}}function j1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xn=e}function Df(e){if(e!==Xn)return!1;if(!qt)return j1(e),qt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!kp(e.type,e.memoizedProps)),t&&(t=Zn)){if(Op(e))throw UE(),Error(Se(418));for(;t;)BE(e,t),t=la(t.nextSibling)}if(j1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Se(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Zn=la(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Zn=null}}else Zn=Xn?la(e.stateNode.nextSibling):null;return!0}function UE(){for(var e=Zn;e;)e=la(e.nextSibling)}function vl(){Zn=Xn=null,qt=!1}function ng(e){Li===null?Li=[e]:Li.push(e)}var XC=Fs.ReactCurrentBatchConfig;function mc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Se(309));var n=r.stateNode}if(!n)throw Error(Se(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Se(284));if(!r._owner)throw Error(Se(290,e))}return e}function Ff(e,t){throw e=Object.prototype.toString.call(t),Error(Se(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function H1(e){var t=e._init;return t(e._payload)}function VE(e){function t(k,C){if(e){var A=k.deletions;A===null?(k.deletions=[C],k.flags|=16):A.push(C)}}function r(k,C){if(!e)return null;for(;C!==null;)t(k,C),C=C.sibling;return null}function n(k,C){for(k=new Map;C!==null;)C.key!==null?k.set(C.key,C):k.set(C.index,C),C=C.sibling;return k}function i(k,C){return k=ha(k,C),k.index=0,k.sibling=null,k}function s(k,C,A){return k.index=A,e?(A=k.alternate,A!==null?(A=A.index,A<C?(k.flags|=2,C):A):(k.flags|=2,C)):(k.flags|=1048576,C)}function o(k){return e&&k.alternate===null&&(k.flags|=2),k}function l(k,C,A,U){return C===null||C.tag!==6?(C=Od(A,k.mode,U),C.return=k,C):(C=i(C,A),C.return=k,C)}function u(k,C,A,U){var q=A.type;return q===$o?p(k,C,A.props.children,U,A.key):C!==null&&(C.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Zs&&H1(q)===C.type)?(U=i(C,A.props),U.ref=mc(k,C,A),U.return=k,U):(U=fh(A.type,A.key,A.props,null,k.mode,U),U.ref=mc(k,C,A),U.return=k,U)}function h(k,C,A,U){return C===null||C.tag!==4||C.stateNode.containerInfo!==A.containerInfo||C.stateNode.implementation!==A.implementation?(C=Ld(A,k.mode,U),C.return=k,C):(C=i(C,A.children||[]),C.return=k,C)}function p(k,C,A,U,q){return C===null||C.tag!==7?(C=Ha(A,k.mode,U,q),C.return=k,C):(C=i(C,A),C.return=k,C)}function m(k,C,A){if(typeof C=="string"&&C!==""||typeof C=="number")return C=Od(""+C,k.mode,A),C.return=k,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case wf:return A=fh(C.type,C.key,C.props,null,k.mode,A),A.ref=mc(k,null,C),A.return=k,A;case Go:return C=Ld(C,k.mode,A),C.return=k,C;case Zs:var U=C._init;return m(k,U(C._payload),A)}if(Ec(C)||uc(C))return C=Ha(C,k.mode,A,null),C.return=k,C;Ff(k,C)}return null}function _(k,C,A,U){var q=C!==null?C.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return q!==null?null:l(k,C,""+A,U);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case wf:return A.key===q?u(k,C,A,U):null;case Go:return A.key===q?h(k,C,A,U):null;case Zs:return q=A._init,_(k,C,q(A._payload),U)}if(Ec(A)||uc(A))return q!==null?null:p(k,C,A,U,null);Ff(k,A)}return null}function v(k,C,A,U,q){if(typeof U=="string"&&U!==""||typeof U=="number")return k=k.get(A)||null,l(C,k,""+U,q);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case wf:return k=k.get(U.key===null?A:U.key)||null,u(C,k,U,q);case Go:return k=k.get(U.key===null?A:U.key)||null,h(C,k,U,q);case Zs:var K=U._init;return v(k,C,A,K(U._payload),q)}if(Ec(U)||uc(U))return k=k.get(A)||null,p(C,k,U,q,null);Ff(C,U)}return null}function E(k,C,A,U){for(var q=null,K=null,S=C,R=C=0,P=null;S!==null&&R<A.length;R++){S.index>R?(P=S,S=null):P=S.sibling;var D=_(k,S,A[R],U);if(D===null){S===null&&(S=P);break}e&&S&&D.alternate===null&&t(k,S),C=s(D,C,R),K===null?q=D:K.sibling=D,K=D,S=P}if(R===A.length)return r(k,S),qt&&La(k,R),q;if(S===null){for(;R<A.length;R++)S=m(k,A[R],U),S!==null&&(C=s(S,C,R),K===null?q=S:K.sibling=S,K=S);return qt&&La(k,R),q}for(S=n(k,S);R<A.length;R++)P=v(S,k,R,A[R],U),P!==null&&(e&&P.alternate!==null&&S.delete(P.key===null?R:P.key),C=s(P,C,R),K===null?q=P:K.sibling=P,K=P);return e&&S.forEach(function(F){return t(k,F)}),qt&&La(k,R),q}function y(k,C,A,U){var q=uc(A);if(typeof q!="function")throw Error(Se(150));if(A=q.call(A),A==null)throw Error(Se(151));for(var K=q=null,S=C,R=C=0,P=null,D=A.next();S!==null&&!D.done;R++,D=A.next()){S.index>R?(P=S,S=null):P=S.sibling;var F=_(k,S,D.value,U);if(F===null){S===null&&(S=P);break}e&&S&&F.alternate===null&&t(k,S),C=s(F,C,R),K===null?q=F:K.sibling=F,K=F,S=P}if(D.done)return r(k,S),qt&&La(k,R),q;if(S===null){for(;!D.done;R++,D=A.next())D=m(k,D.value,U),D!==null&&(C=s(D,C,R),K===null?q=D:K.sibling=D,K=D);return qt&&La(k,R),q}for(S=n(k,S);!D.done;R++,D=A.next())D=v(S,k,R,D.value,U),D!==null&&(e&&D.alternate!==null&&S.delete(D.key===null?R:D.key),C=s(D,C,R),K===null?q=D:K.sibling=D,K=D);return e&&S.forEach(function(b){return t(k,b)}),qt&&La(k,R),q}function w(k,C,A,U){if(typeof A=="object"&&A!==null&&A.type===$o&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case wf:e:{for(var q=A.key,K=C;K!==null;){if(K.key===q){if(q=A.type,q===$o){if(K.tag===7){r(k,K.sibling),C=i(K,A.props.children),C.return=k,k=C;break e}}else if(K.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===Zs&&H1(q)===K.type){r(k,K.sibling),C=i(K,A.props),C.ref=mc(k,K,A),C.return=k,k=C;break e}r(k,K);break}else t(k,K);K=K.sibling}A.type===$o?(C=Ha(A.props.children,k.mode,U,A.key),C.return=k,k=C):(U=fh(A.type,A.key,A.props,null,k.mode,U),U.ref=mc(k,C,A),U.return=k,k=U)}return o(k);case Go:e:{for(K=A.key;C!==null;){if(C.key===K)if(C.tag===4&&C.stateNode.containerInfo===A.containerInfo&&C.stateNode.implementation===A.implementation){r(k,C.sibling),C=i(C,A.children||[]),C.return=k,k=C;break e}else{r(k,C);break}else t(k,C);C=C.sibling}C=Ld(A,k.mode,U),C.return=k,k=C}return o(k);case Zs:return K=A._init,w(k,C,K(A._payload),U)}if(Ec(A))return E(k,C,A,U);if(uc(A))return y(k,C,A,U);Ff(k,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,C!==null&&C.tag===6?(r(k,C.sibling),C=i(C,A),C.return=k,k=C):(r(k,C),C=Od(A,k.mode,U),C.return=k,k=C),o(k)):r(k,C)}return w}var xl=VE(!0),zE=VE(!1),Nh=Ia(null),Oh=null,el=null,ig=null;function sg(){ig=el=Oh=null}function ag(e){var t=Nh.current;Gt(Nh),e._currentValue=t}function Dp(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function cl(e,t){Oh=e,ig=el=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Dn=!0),e.firstContext=null)}function xi(e){var t=e._currentValue;if(ig!==e)if(e={context:e,memoizedValue:t,next:null},el===null){if(Oh===null)throw Error(Se(308));el=e,Oh.dependencies={lanes:0,firstContext:e}}else el=el.next=e;return t}var Ba=null;function og(e){Ba===null?Ba=[e]:Ba.push(e)}function jE(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,og(t)):(r.next=i.next,i.next=r),t.interleaved=r,ks(e,n)}function ks(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ks=!1;function lg(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function HE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ts(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ca(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,At&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,ks(e,r)}return i=n.interleaved,i===null?(t.next=t,og(n)):(t.next=i.next,i.next=t),n.interleaved=t,ks(e,r)}function sh(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Zm(e,r)}}function W1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Lh(e,t,r,n){var i=e.updateQueue;Ks=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,h=u.next;u.next=null,o===null?s=h:o.next=h,o=u;var p=e.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==o&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(s!==null){var m=i.baseState;o=0,p=h=u=null,l=s;do{var _=l.lane,v=l.eventTime;if((n&_)===_){p!==null&&(p=p.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var E=e,y=l;switch(_=t,v=r,y.tag){case 1:if(E=y.payload,typeof E=="function"){m=E.call(v,m,_);break e}m=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=y.payload,_=typeof E=="function"?E.call(v,m,_):E,_==null)break e;m=rr({},m,_);break e;case 2:Ks=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,_=i.effects,_===null?i.effects=[l]:_.push(l))}else v={eventTime:v,lane:_,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=v,u=m):p=p.next=v,o|=_;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;_=l,l=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(p===null&&(u=m),i.baseState=u,i.firstBaseUpdate=h,i.lastBaseUpdate=p,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Ja|=o,e.lanes=o,e.memoizedState=m}}function G1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Se(191,i));i.call(n)}}}var zu={},Ji=Ia(zu),hu=Ia(zu),du=Ia(zu);function Ua(e){if(e===zu)throw Error(Se(174));return e}function cg(e,t){switch(jt(du,t),jt(hu,e),jt(Ji,zu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=pp(t,e)}Gt(Ji),jt(Ji,t)}function yl(){Gt(Ji),Gt(hu),Gt(du)}function WE(e){Ua(du.current);var t=Ua(Ji.current),r=pp(t,e.type);t!==r&&(jt(hu,e),jt(Ji,r))}function ug(e){hu.current===e&&(Gt(Ji),Gt(hu))}var er=Ia(0);function Dh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Id=[];function fg(){for(var e=0;e<Id.length;e++)Id[e]._workInProgressVersionPrimary=null;Id.length=0}var ah=Fs.ReactCurrentDispatcher,Cd=Fs.ReactCurrentBatchConfig,Ya=0,tr=null,wr=null,Br=null,Fh=!1,Mc=!1,pu=0,qC=0;function en(){throw Error(Se(321))}function hg(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Vi(e[r],t[r]))return!1;return!0}function dg(e,t,r,n,i,s){if(Ya=s,tr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ah.current=e===null||e.memoizedState===null?ek:tk,e=r(n,i),Mc){s=0;do{if(Mc=!1,pu=0,25<=s)throw Error(Se(301));s+=1,Br=wr=null,t.updateQueue=null,ah.current=rk,e=r(n,i)}while(Mc)}if(ah.current=bh,t=wr!==null&&wr.next!==null,Ya=0,Br=wr=tr=null,Fh=!1,t)throw Error(Se(300));return e}function pg(){var e=pu!==0;return pu=0,e}function Xi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Br===null?tr.memoizedState=Br=e:Br=Br.next=e,Br}function yi(){if(wr===null){var e=tr.alternate;e=e!==null?e.memoizedState:null}else e=wr.next;var t=Br===null?tr.memoizedState:Br.next;if(t!==null)Br=t,wr=e;else{if(e===null)throw Error(Se(310));wr=e,e={memoizedState:wr.memoizedState,baseState:wr.baseState,baseQueue:wr.baseQueue,queue:wr.queue,next:null},Br===null?tr.memoizedState=Br=e:Br=Br.next=e}return Br}function mu(e,t){return typeof t=="function"?t(e):t}function kd(e){var t=yi(),r=t.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=e;var n=wr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,u=null,h=s;do{var p=h.lane;if((Ya&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),n=h.hasEagerState?h.eagerState:e(n,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=m,o=n):u=u.next=m,tr.lanes|=p,Ja|=p}h=h.next}while(h!==null&&h!==s);u===null?o=n:u.next=l,Vi(n,t.memoizedState)||(Dn=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,tr.lanes|=s,Ja|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Rd(e){var t=yi(),r=t.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);Vi(s,t.memoizedState)||(Dn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function GE(){}function $E(e,t){var r=tr,n=yi(),i=t(),s=!Vi(n.memoizedState,i);if(s&&(n.memoizedState=i,Dn=!0),n=n.queue,mg(XE.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Br!==null&&Br.memoizedState.tag&1){if(r.flags|=2048,gu(9,KE.bind(null,r,n,i,t),void 0,null),Ur===null)throw Error(Se(349));Ya&30||ZE(r,t,i)}return i}function ZE(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=tr.updateQueue,t===null?(t={lastEffect:null,stores:null},tr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function KE(e,t,r,n){t.value=r,t.getSnapshot=n,qE(t)&&YE(e)}function XE(e,t,r){return r(function(){qE(t)&&YE(e)})}function qE(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Vi(e,r)}catch{return!0}}function YE(e){var t=ks(e,1);t!==null&&Bi(t,e,1,-1)}function $1(e){var t=Xi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mu,lastRenderedState:e},t.queue=e,e=e.dispatch=QC.bind(null,tr,e),[t.memoizedState,e]}function gu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=tr.updateQueue,t===null?(t={lastEffect:null,stores:null},tr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function JE(){return yi().memoizedState}function oh(e,t,r,n){var i=Xi();tr.flags|=e,i.memoizedState=gu(1|t,r,void 0,n===void 0?null:n)}function x0(e,t,r,n){var i=yi();n=n===void 0?null:n;var s=void 0;if(wr!==null){var o=wr.memoizedState;if(s=o.destroy,n!==null&&hg(n,o.deps)){i.memoizedState=gu(t,r,s,n);return}}tr.flags|=e,i.memoizedState=gu(1|t,r,s,n)}function Z1(e,t){return oh(8390656,8,e,t)}function mg(e,t){return x0(2048,8,e,t)}function QE(e,t){return x0(4,2,e,t)}function e2(e,t){return x0(4,4,e,t)}function t2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function r2(e,t,r){return r=r!=null?r.concat([e]):null,x0(4,4,t2.bind(null,t,e),r)}function gg(){}function n2(e,t){var r=yi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&hg(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function i2(e,t){var r=yi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&hg(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function s2(e,t,r){return Ya&21?(Vi(r,t)||(r=uE(),tr.lanes|=r,Ja|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Dn=!0),e.memoizedState=r)}function YC(e,t){var r=Ot;Ot=r!==0&&4>r?r:4,e(!0);var n=Cd.transition;Cd.transition={};try{e(!1),t()}finally{Ot=r,Cd.transition=n}}function a2(){return yi().memoizedState}function JC(e,t,r){var n=fa(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},o2(e))l2(t,r);else if(r=jE(e,t,r,n),r!==null){var i=Tn();Bi(r,e,n,i),c2(r,t,n)}}function QC(e,t,r){var n=fa(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(o2(e))l2(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,Vi(l,o)){var u=t.interleaved;u===null?(i.next=i,og(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}r=jE(e,t,i,n),r!==null&&(i=Tn(),Bi(r,e,n,i),c2(r,t,n))}}function o2(e){var t=e.alternate;return e===tr||t!==null&&t===tr}function l2(e,t){Mc=Fh=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function c2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Zm(e,r)}}var bh={readContext:xi,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useInsertionEffect:en,useLayoutEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useMutableSource:en,useSyncExternalStore:en,useId:en,unstable_isNewReconciler:!1},ek={readContext:xi,useCallback:function(e,t){return Xi().memoizedState=[e,t===void 0?null:t],e},useContext:xi,useEffect:Z1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,oh(4194308,4,t2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return oh(4194308,4,e,t)},useInsertionEffect:function(e,t){return oh(4,2,e,t)},useMemo:function(e,t){var r=Xi();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Xi();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=JC.bind(null,tr,e),[n.memoizedState,e]},useRef:function(e){var t=Xi();return e={current:e},t.memoizedState=e},useState:$1,useDebugValue:gg,useDeferredValue:function(e){return Xi().memoizedState=e},useTransition:function(){var e=$1(!1),t=e[0];return e=YC.bind(null,e[1]),Xi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=tr,i=Xi();if(qt){if(r===void 0)throw Error(Se(407));r=r()}else{if(r=t(),Ur===null)throw Error(Se(349));Ya&30||ZE(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Z1(XE.bind(null,n,s,e),[e]),n.flags|=2048,gu(9,KE.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Xi(),t=Ur.identifierPrefix;if(qt){var r=ys,n=xs;r=(n&~(1<<32-Mi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=pu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=qC++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},tk={readContext:xi,useCallback:n2,useContext:xi,useEffect:mg,useImperativeHandle:r2,useInsertionEffect:QE,useLayoutEffect:e2,useMemo:i2,useReducer:kd,useRef:JE,useState:function(){return kd(mu)},useDebugValue:gg,useDeferredValue:function(e){var t=yi();return s2(t,wr.memoizedState,e)},useTransition:function(){var e=kd(mu)[0],t=yi().memoizedState;return[e,t]},useMutableSource:GE,useSyncExternalStore:$E,useId:a2,unstable_isNewReconciler:!1},rk={readContext:xi,useCallback:n2,useContext:xi,useEffect:mg,useImperativeHandle:r2,useInsertionEffect:QE,useLayoutEffect:e2,useMemo:i2,useReducer:Rd,useRef:JE,useState:function(){return Rd(mu)},useDebugValue:gg,useDeferredValue:function(e){var t=yi();return wr===null?t.memoizedState=e:s2(t,wr.memoizedState,e)},useTransition:function(){var e=Rd(mu)[0],t=yi().memoizedState;return[e,t]},useMutableSource:GE,useSyncExternalStore:$E,useId:a2,unstable_isNewReconciler:!1};function Ni(e,t){if(e&&e.defaultProps){t=rr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Fp(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:rr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var y0={isMounted:function(e){return(e=e._reactInternals)?oo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Tn(),i=fa(e),s=Ts(n,i);s.payload=t,r!=null&&(s.callback=r),t=ca(e,s,i),t!==null&&(Bi(t,e,i,n),sh(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Tn(),i=fa(e),s=Ts(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=ca(e,s,i),t!==null&&(Bi(t,e,i,n),sh(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Tn(),n=fa(e),i=Ts(r,n);i.tag=2,t!=null&&(i.callback=t),t=ca(e,i,n),t!==null&&(Bi(t,e,n,r),sh(t,e,n))}};function K1(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!lu(r,n)||!lu(i,s):!0}function u2(e,t,r){var n=!1,i=va,s=t.contextType;return typeof s=="object"&&s!==null?s=xi(s):(i=bn(t)?Xa:hn.current,n=t.contextTypes,s=(n=n!=null)?_l(e,i):va),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=y0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function X1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&y0.enqueueReplaceState(t,t.state,null)}function bp(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},lg(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=xi(s):(s=bn(t)?Xa:hn.current,i.context=_l(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Fp(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&y0.enqueueReplaceState(i,i.state,null),Lh(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function El(e,t){try{var r="",n=t;do r+=PI(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Pd(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Mp(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var nk=typeof WeakMap=="function"?WeakMap:Map;function f2(e,t,r){r=Ts(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Bh||(Bh=!0,Zp=n),Mp(e,t)},r}function h2(e,t,r){r=Ts(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Mp(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Mp(e,t),typeof n!="function"&&(ua===null?ua=new Set([this]):ua.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function q1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new nk;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=_k.bind(null,e,t,r),t.then(e,e))}function Y1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function J1(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ts(-1,1),t.tag=2,ca(r,t,1))),r.lanes|=1),e)}var ik=Fs.ReactCurrentOwner,Dn=!1;function vn(e,t,r,n){t.child=e===null?zE(t,null,r,n):xl(t,e.child,r,n)}function Q1(e,t,r,n,i){r=r.render;var s=t.ref;return cl(t,i),n=dg(e,t,r,n,s,i),r=pg(),e!==null&&!Dn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Rs(e,t,i)):(qt&&r&&tg(t),t.flags|=1,vn(e,t,n,i),t.child)}function ev(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!wg(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,d2(e,t,s,n,i)):(e=fh(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:lu,r(o,n)&&e.ref===t.ref)return Rs(e,t,i)}return t.flags|=1,e=ha(s,n),e.ref=t.ref,e.return=t,t.child=e}function d2(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(lu(s,n)&&e.ref===t.ref)if(Dn=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Dn=!0);else return t.lanes=e.lanes,Rs(e,t,i)}return Bp(e,t,r,n,i)}function p2(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},jt(rl,Wn),Wn|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,jt(rl,Wn),Wn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,jt(rl,Wn),Wn|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,jt(rl,Wn),Wn|=n;return vn(e,t,i,r),t.child}function m2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Bp(e,t,r,n,i){var s=bn(r)?Xa:hn.current;return s=_l(t,s),cl(t,i),r=dg(e,t,r,n,s,i),n=pg(),e!==null&&!Dn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Rs(e,t,i)):(qt&&n&&tg(t),t.flags|=1,vn(e,t,r,i),t.child)}function tv(e,t,r,n,i){if(bn(r)){var s=!0;kh(t)}else s=!1;if(cl(t,i),t.stateNode===null)lh(e,t),u2(t,r,n),bp(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,h=r.contextType;typeof h=="object"&&h!==null?h=xi(h):(h=bn(r)?Xa:hn.current,h=_l(t,h));var p=r.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||u!==h)&&X1(t,o,n,h),Ks=!1;var _=t.memoizedState;o.state=_,Lh(t,n,o,i),u=t.memoizedState,l!==n||_!==u||Fn.current||Ks?(typeof p=="function"&&(Fp(t,r,p,n),u=t.memoizedState),(l=Ks||K1(t,r,l,n,_,u,h))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),o.props=n,o.state=u,o.context=h,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,HE(e,t),l=t.memoizedProps,h=t.type===t.elementType?l:Ni(t.type,l),o.props=h,m=t.pendingProps,_=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=xi(u):(u=bn(r)?Xa:hn.current,u=_l(t,u));var v=r.getDerivedStateFromProps;(p=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||_!==u)&&X1(t,o,n,u),Ks=!1,_=t.memoizedState,o.state=_,Lh(t,n,o,i);var E=t.memoizedState;l!==m||_!==E||Fn.current||Ks?(typeof v=="function"&&(Fp(t,r,v,n),E=t.memoizedState),(h=Ks||K1(t,r,h,n,_,E,u)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,E,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,E,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=E),o.props=n,o.state=E,o.context=u,n=h):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),n=!1)}return Up(e,t,r,n,s,i)}function Up(e,t,r,n,i,s){m2(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&V1(t,r,!1),Rs(e,t,s);n=t.stateNode,ik.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=xl(t,e.child,null,s),t.child=xl(t,null,l,s)):vn(e,t,l,s),t.memoizedState=n.state,i&&V1(t,r,!0),t.child}function g2(e){var t=e.stateNode;t.pendingContext?U1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&U1(e,t.context,!1),cg(e,t.containerInfo)}function rv(e,t,r,n,i){return vl(),ng(i),t.flags|=256,vn(e,t,r,n),t.child}var Vp={dehydrated:null,treeContext:null,retryLane:0};function zp(e){return{baseLanes:e,cachePool:null,transitions:null}}function _2(e,t,r){var n=t.pendingProps,i=er.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),jt(er,i&1),e===null)return Lp(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=A0(o,n,0,null),e=Ha(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=zp(r),t.memoizedState=Vp,e):_g(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return sk(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=ha(i,u),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=ha(l,s):(s=Ha(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?zp(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=Vp,n}return s=e.child,e=s.sibling,n=ha(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function _g(e,t){return t=A0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function bf(e,t,r,n){return n!==null&&ng(n),xl(t,e.child,null,r),e=_g(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function sk(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=Pd(Error(Se(422))),bf(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=A0({mode:"visible",children:n.children},i,0,null),s=Ha(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&xl(t,e.child,null,o),t.child.memoizedState=zp(o),t.memoizedState=Vp,s);if(!(t.mode&1))return bf(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Se(419)),n=Pd(s,n,void 0),bf(e,t,o,n)}if(l=(o&e.childLanes)!==0,Dn||l){if(n=Ur,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ks(e,i),Bi(n,e,i,-1))}return Ag(),n=Pd(Error(Se(421))),bf(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=vk.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Zn=la(i.nextSibling),Xn=t,qt=!0,Li=null,e!==null&&(pi[mi++]=xs,pi[mi++]=ys,pi[mi++]=qa,xs=e.id,ys=e.overflow,qa=t),t=_g(t,n.children),t.flags|=4096,t)}function nv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Dp(e.return,t,r)}function Nd(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function v2(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(vn(e,t,n.children,r),n=er.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&nv(e,r,t);else if(e.tag===19)nv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(jt(er,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Dh(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Nd(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Dh(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Nd(t,!0,r,null,s);break;case"together":Nd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function lh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Rs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ja|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Se(153));if(t.child!==null){for(e=t.child,r=ha(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ha(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function ak(e,t,r){switch(t.tag){case 3:g2(t),vl();break;case 5:WE(t);break;case 1:bn(t.type)&&kh(t);break;case 4:cg(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;jt(Nh,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(jt(er,er.current&1),t.flags|=128,null):r&t.child.childLanes?_2(e,t,r):(jt(er,er.current&1),e=Rs(e,t,r),e!==null?e.sibling:null);jt(er,er.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return v2(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),jt(er,er.current),n)break;return null;case 22:case 23:return t.lanes=0,p2(e,t,r)}return Rs(e,t,r)}var x2,jp,y2,E2;x2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};jp=function(){};y2=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Ua(Ji.current);var s=null;switch(r){case"input":i=up(e,i),n=up(e,n),s=[];break;case"select":i=rr({},i,{value:void 0}),n=rr({},n,{value:void 0}),s=[];break;case"textarea":i=dp(e,i),n=dp(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ih)}mp(r,n);var o;r=null;for(h in i)if(!n.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var l=i[h];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(tu.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in n){var u=n[h];if(l=i!=null?i[h]:void 0,n.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(s||(s=[]),s.push(h,r)),r=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(tu.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&Wt("scroll",e),s||l===u||(s=[])):(s=s||[]).push(h,u))}r&&(s=s||[]).push("style",r);var h=s;(t.updateQueue=h)&&(t.flags|=4)}};E2=function(e,t,r,n){r!==n&&(t.flags|=4)};function gc(e,t){if(!qt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function tn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function ok(e,t,r){var n=t.pendingProps;switch(rg(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(t),null;case 1:return bn(t.type)&&Ch(),tn(t),null;case 3:return n=t.stateNode,yl(),Gt(Fn),Gt(hn),fg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Df(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Li!==null&&(qp(Li),Li=null))),jp(e,t),tn(t),null;case 5:ug(t);var i=Ua(du.current);if(r=t.type,e!==null&&t.stateNode!=null)y2(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Se(166));return tn(t),null}if(e=Ua(Ji.current),Df(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[qi]=t,n[fu]=s,e=(t.mode&1)!==0,r){case"dialog":Wt("cancel",n),Wt("close",n);break;case"iframe":case"object":case"embed":Wt("load",n);break;case"video":case"audio":for(i=0;i<Ac.length;i++)Wt(Ac[i],n);break;case"source":Wt("error",n);break;case"img":case"image":case"link":Wt("error",n),Wt("load",n);break;case"details":Wt("toggle",n);break;case"input":h1(n,s),Wt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Wt("invalid",n);break;case"textarea":p1(n,s),Wt("invalid",n)}mp(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&Lf(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Lf(n.textContent,l,e),i=["children",""+l]):tu.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Wt("scroll",n)}switch(r){case"input":Sf(n),d1(n,s,!0);break;case"textarea":Sf(n),m1(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ih)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Xy(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[qi]=t,e[fu]=n,x2(e,t,!1,!1),t.stateNode=e;e:{switch(o=gp(r,n),r){case"dialog":Wt("cancel",e),Wt("close",e),i=n;break;case"iframe":case"object":case"embed":Wt("load",e),i=n;break;case"video":case"audio":for(i=0;i<Ac.length;i++)Wt(Ac[i],e);i=n;break;case"source":Wt("error",e),i=n;break;case"img":case"image":case"link":Wt("error",e),Wt("load",e),i=n;break;case"details":Wt("toggle",e),i=n;break;case"input":h1(e,n),i=up(e,n),Wt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=rr({},n,{value:void 0}),Wt("invalid",e);break;case"textarea":p1(e,n),i=dp(e,n),Wt("invalid",e);break;default:i=n}mp(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?Jy(e,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&qy(e,u)):s==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&ru(e,u):typeof u=="number"&&ru(e,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(tu.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Wt("scroll",e):u!=null&&zm(e,s,u,o))}switch(r){case"input":Sf(e),d1(e,n,!1);break;case"textarea":Sf(e),m1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+_a(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?sl(e,!!n.multiple,s,!1):n.defaultValue!=null&&sl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Ih)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return tn(t),null;case 6:if(e&&t.stateNode!=null)E2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Se(166));if(r=Ua(du.current),Ua(Ji.current),Df(t)){if(n=t.stateNode,r=t.memoizedProps,n[qi]=t,(s=n.nodeValue!==r)&&(e=Xn,e!==null))switch(e.tag){case 3:Lf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Lf(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[qi]=t,t.stateNode=n}return tn(t),null;case 13:if(Gt(er),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(qt&&Zn!==null&&t.mode&1&&!(t.flags&128))UE(),vl(),t.flags|=98560,s=!1;else if(s=Df(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Se(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Se(317));s[qi]=t}else vl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;tn(t),s=!1}else Li!==null&&(qp(Li),Li=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||er.current&1?Ir===0&&(Ir=3):Ag())),t.updateQueue!==null&&(t.flags|=4),tn(t),null);case 4:return yl(),jp(e,t),e===null&&cu(t.stateNode.containerInfo),tn(t),null;case 10:return ag(t.type._context),tn(t),null;case 17:return bn(t.type)&&Ch(),tn(t),null;case 19:if(Gt(er),s=t.memoizedState,s===null)return tn(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)gc(s,!1);else{if(Ir!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Dh(e),o!==null){for(t.flags|=128,gc(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return jt(er,er.current&1|2),t.child}e=e.sibling}s.tail!==null&&hr()>Tl&&(t.flags|=128,n=!0,gc(s,!1),t.lanes=4194304)}else{if(!n)if(e=Dh(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),gc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!qt)return tn(t),null}else 2*hr()-s.renderingStartTime>Tl&&r!==1073741824&&(t.flags|=128,n=!0,gc(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=hr(),t.sibling=null,r=er.current,jt(er,n?r&1|2:r&1),t):(tn(t),null);case 22:case 23:return Tg(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Wn&1073741824&&(tn(t),t.subtreeFlags&6&&(t.flags|=8192)):tn(t),null;case 24:return null;case 25:return null}throw Error(Se(156,t.tag))}function lk(e,t){switch(rg(t),t.tag){case 1:return bn(t.type)&&Ch(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return yl(),Gt(Fn),Gt(hn),fg(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ug(t),null;case 13:if(Gt(er),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Se(340));vl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Gt(er),null;case 4:return yl(),null;case 10:return ag(t.type._context),null;case 22:case 23:return Tg(),null;case 24:return null;default:return null}}var Mf=!1,on=!1,ck=typeof WeakSet=="function"?WeakSet:Set,ze=null;function tl(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){sr(e,t,n)}else r.current=null}function Hp(e,t,r){try{r()}catch(n){sr(e,t,n)}}var iv=!1;function uk(e,t){if(Ip=Ah,e=IE(),eg(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,u=-1,h=0,p=0,m=e,_=null;t:for(;;){for(var v;m!==r||i!==0&&m.nodeType!==3||(l=o+i),m!==s||n!==0&&m.nodeType!==3||(u=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(v=m.firstChild)!==null;)_=m,m=v;for(;;){if(m===e)break t;if(_===r&&++h===i&&(l=o),_===s&&++p===n&&(u=o),(v=m.nextSibling)!==null)break;m=_,_=m.parentNode}m=v}r=l===-1||u===-1?null:{start:l,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(Cp={focusedElem:e,selectionRange:r},Ah=!1,ze=t;ze!==null;)if(t=ze,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ze=e;else for(;ze!==null;){t=ze;try{var E=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var y=E.memoizedProps,w=E.memoizedState,k=t.stateNode,C=k.getSnapshotBeforeUpdate(t.elementType===t.type?y:Ni(t.type,y),w);k.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var A=t.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch(U){sr(t,t.return,U)}if(e=t.sibling,e!==null){e.return=t.return,ze=e;break}ze=t.return}return E=iv,iv=!1,E}function Bc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Hp(t,r,s)}i=i.next}while(i!==n)}}function E0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Wp(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function T2(e){var t=e.alternate;t!==null&&(e.alternate=null,T2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[qi],delete t[fu],delete t[Pp],delete t[$C],delete t[ZC])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function A2(e){return e.tag===5||e.tag===3||e.tag===4}function sv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||A2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Gp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ih));else if(n!==4&&(e=e.child,e!==null))for(Gp(e,t,r),e=e.sibling;e!==null;)Gp(e,t,r),e=e.sibling}function $p(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for($p(e,t,r),e=e.sibling;e!==null;)$p(e,t,r),e=e.sibling}var jr=null,Oi=!1;function Gs(e,t,r){for(r=r.child;r!==null;)w2(e,t,r),r=r.sibling}function w2(e,t,r){if(Yi&&typeof Yi.onCommitFiberUnmount=="function")try{Yi.onCommitFiberUnmount(d0,r)}catch{}switch(r.tag){case 5:on||tl(r,t);case 6:var n=jr,i=Oi;jr=null,Gs(e,t,r),jr=n,Oi=i,jr!==null&&(Oi?(e=jr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):jr.removeChild(r.stateNode));break;case 18:jr!==null&&(Oi?(e=jr,r=r.stateNode,e.nodeType===8?wd(e.parentNode,r):e.nodeType===1&&wd(e,r),au(e)):wd(jr,r.stateNode));break;case 4:n=jr,i=Oi,jr=r.stateNode.containerInfo,Oi=!0,Gs(e,t,r),jr=n,Oi=i;break;case 0:case 11:case 14:case 15:if(!on&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Hp(r,t,o),i=i.next}while(i!==n)}Gs(e,t,r);break;case 1:if(!on&&(tl(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){sr(r,t,l)}Gs(e,t,r);break;case 21:Gs(e,t,r);break;case 22:r.mode&1?(on=(n=on)||r.memoizedState!==null,Gs(e,t,r),on=n):Gs(e,t,r);break;default:Gs(e,t,r)}}function av(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new ck),t.forEach(function(n){var i=xk.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ki(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:jr=l.stateNode,Oi=!1;break e;case 3:jr=l.stateNode.containerInfo,Oi=!0;break e;case 4:jr=l.stateNode.containerInfo,Oi=!0;break e}l=l.return}if(jr===null)throw Error(Se(160));w2(s,o,i),jr=null,Oi=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(h){sr(i,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)S2(t,e),t=t.sibling}function S2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ki(t,e),$i(e),n&4){try{Bc(3,e,e.return),E0(3,e)}catch(y){sr(e,e.return,y)}try{Bc(5,e,e.return)}catch(y){sr(e,e.return,y)}}break;case 1:ki(t,e),$i(e),n&512&&r!==null&&tl(r,r.return);break;case 5:if(ki(t,e),$i(e),n&512&&r!==null&&tl(r,r.return),e.flags&32){var i=e.stateNode;try{ru(i,"")}catch(y){sr(e,e.return,y)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Zy(i,s),gp(l,o);var h=gp(l,s);for(o=0;o<u.length;o+=2){var p=u[o],m=u[o+1];p==="style"?Jy(i,m):p==="dangerouslySetInnerHTML"?qy(i,m):p==="children"?ru(i,m):zm(i,p,m,h)}switch(l){case"input":fp(i,s);break;case"textarea":Ky(i,s);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?sl(i,!!s.multiple,v,!1):_!==!!s.multiple&&(s.defaultValue!=null?sl(i,!!s.multiple,s.defaultValue,!0):sl(i,!!s.multiple,s.multiple?[]:"",!1))}i[fu]=s}catch(y){sr(e,e.return,y)}}break;case 6:if(ki(t,e),$i(e),n&4){if(e.stateNode===null)throw Error(Se(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(y){sr(e,e.return,y)}}break;case 3:if(ki(t,e),$i(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{au(t.containerInfo)}catch(y){sr(e,e.return,y)}break;case 4:ki(t,e),$i(e);break;case 13:ki(t,e),$i(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(yg=hr())),n&4&&av(e);break;case 22:if(p=r!==null&&r.memoizedState!==null,e.mode&1?(on=(h=on)||p,ki(t,e),on=h):ki(t,e),$i(e),n&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!p&&e.mode&1)for(ze=e,p=e.child;p!==null;){for(m=ze=p;ze!==null;){switch(_=ze,v=_.child,_.tag){case 0:case 11:case 14:case 15:Bc(4,_,_.return);break;case 1:tl(_,_.return);var E=_.stateNode;if(typeof E.componentWillUnmount=="function"){n=_,r=_.return;try{t=n,E.props=t.memoizedProps,E.state=t.memoizedState,E.componentWillUnmount()}catch(y){sr(n,r,y)}}break;case 5:tl(_,_.return);break;case 22:if(_.memoizedState!==null){lv(m);continue}}v!==null?(v.return=_,ze=v):lv(m)}p=p.sibling}e:for(p=null,m=e;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Yy("display",o))}catch(y){sr(e,e.return,y)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(y){sr(e,e.return,y)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:ki(t,e),$i(e),n&4&&av(e);break;case 21:break;default:ki(t,e),$i(e)}}function $i(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(A2(r)){var n=r;break e}r=r.return}throw Error(Se(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(ru(i,""),n.flags&=-33);var s=sv(e);$p(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=sv(e);Gp(e,l,o);break;default:throw Error(Se(161))}}catch(u){sr(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function fk(e,t,r){ze=e,I2(e)}function I2(e,t,r){for(var n=(e.mode&1)!==0;ze!==null;){var i=ze,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Mf;if(!o){var l=i.alternate,u=l!==null&&l.memoizedState!==null||on;l=Mf;var h=on;if(Mf=o,(on=u)&&!h)for(ze=i;ze!==null;)o=ze,u=o.child,o.tag===22&&o.memoizedState!==null?cv(i):u!==null?(u.return=o,ze=u):cv(i);for(;s!==null;)ze=s,I2(s),s=s.sibling;ze=i,Mf=l,on=h}ov(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ze=s):ov(e)}}function ov(e){for(;ze!==null;){var t=ze;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:on||E0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!on)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Ni(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&G1(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}G1(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&au(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}on||t.flags&512&&Wp(t)}catch(_){sr(t,t.return,_)}}if(t===e){ze=null;break}if(r=t.sibling,r!==null){r.return=t.return,ze=r;break}ze=t.return}}function lv(e){for(;ze!==null;){var t=ze;if(t===e){ze=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ze=r;break}ze=t.return}}function cv(e){for(;ze!==null;){var t=ze;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{E0(4,t)}catch(u){sr(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(u){sr(t,i,u)}}var s=t.return;try{Wp(t)}catch(u){sr(t,s,u)}break;case 5:var o=t.return;try{Wp(t)}catch(u){sr(t,o,u)}}}catch(u){sr(t,t.return,u)}if(t===e){ze=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ze=l;break}ze=t.return}}var hk=Math.ceil,Mh=Fs.ReactCurrentDispatcher,vg=Fs.ReactCurrentOwner,_i=Fs.ReactCurrentBatchConfig,At=0,Ur=null,Er=null,$r=0,Wn=0,rl=Ia(0),Ir=0,_u=null,Ja=0,T0=0,xg=0,Uc=null,On=null,yg=0,Tl=1/0,gs=null,Bh=!1,Zp=null,ua=null,Bf=!1,ea=null,Uh=0,Vc=0,Kp=null,ch=-1,uh=0;function Tn(){return At&6?hr():ch!==-1?ch:ch=hr()}function fa(e){return e.mode&1?At&2&&$r!==0?$r&-$r:XC.transition!==null?(uh===0&&(uh=uE()),uh):(e=Ot,e!==0||(e=window.event,e=e===void 0?16:_E(e.type)),e):1}function Bi(e,t,r,n){if(50<Vc)throw Vc=0,Kp=null,Error(Se(185));Bu(e,r,n),(!(At&2)||e!==Ur)&&(e===Ur&&(!(At&2)&&(T0|=r),Ir===4&&Ys(e,$r)),Mn(e,n),r===1&&At===0&&!(t.mode&1)&&(Tl=hr()+500,v0&&Ca()))}function Mn(e,t){var r=e.callbackNode;XI(e,t);var n=Th(e,e===Ur?$r:0);if(n===0)r!==null&&v1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&v1(r),t===1)e.tag===0?KC(uv.bind(null,e)):bE(uv.bind(null,e)),WC(function(){!(At&6)&&Ca()}),r=null;else{switch(fE(n)){case 1:r=$m;break;case 4:r=lE;break;case 16:r=Eh;break;case 536870912:r=cE;break;default:r=Eh}r=D2(r,C2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function C2(e,t){if(ch=-1,uh=0,At&6)throw Error(Se(327));var r=e.callbackNode;if(ul()&&e.callbackNode!==r)return null;var n=Th(e,e===Ur?$r:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Vh(e,n);else{t=n;var i=At;At|=2;var s=R2();(Ur!==e||$r!==t)&&(gs=null,Tl=hr()+500,ja(e,t));do try{mk();break}catch(l){k2(e,l)}while(!0);sg(),Mh.current=s,At=i,Er!==null?t=0:(Ur=null,$r=0,t=Ir)}if(t!==0){if(t===2&&(i=Ep(e),i!==0&&(n=i,t=Xp(e,i))),t===1)throw r=_u,ja(e,0),Ys(e,n),Mn(e,hr()),r;if(t===6)Ys(e,n);else{if(i=e.current.alternate,!(n&30)&&!dk(i)&&(t=Vh(e,n),t===2&&(s=Ep(e),s!==0&&(n=s,t=Xp(e,s))),t===1))throw r=_u,ja(e,0),Ys(e,n),Mn(e,hr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Se(345));case 2:Da(e,On,gs);break;case 3:if(Ys(e,n),(n&130023424)===n&&(t=yg+500-hr(),10<t)){if(Th(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Tn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Rp(Da.bind(null,e,On,gs),t);break}Da(e,On,gs);break;case 4:if(Ys(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Mi(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=hr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hk(n/1960))-n,10<n){e.timeoutHandle=Rp(Da.bind(null,e,On,gs),n);break}Da(e,On,gs);break;case 5:Da(e,On,gs);break;default:throw Error(Se(329))}}}return Mn(e,hr()),e.callbackNode===r?C2.bind(null,e):null}function Xp(e,t){var r=Uc;return e.current.memoizedState.isDehydrated&&(ja(e,t).flags|=256),e=Vh(e,t),e!==2&&(t=On,On=r,t!==null&&qp(t)),e}function qp(e){On===null?On=e:On.push.apply(On,e)}function dk(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Vi(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ys(e,t){for(t&=~xg,t&=~T0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Mi(t),n=1<<r;e[r]=-1,t&=~n}}function uv(e){if(At&6)throw Error(Se(327));ul();var t=Th(e,0);if(!(t&1))return Mn(e,hr()),null;var r=Vh(e,t);if(e.tag!==0&&r===2){var n=Ep(e);n!==0&&(t=n,r=Xp(e,n))}if(r===1)throw r=_u,ja(e,0),Ys(e,t),Mn(e,hr()),r;if(r===6)throw Error(Se(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Da(e,On,gs),Mn(e,hr()),null}function Eg(e,t){var r=At;At|=1;try{return e(t)}finally{At=r,At===0&&(Tl=hr()+500,v0&&Ca())}}function Qa(e){ea!==null&&ea.tag===0&&!(At&6)&&ul();var t=At;At|=1;var r=_i.transition,n=Ot;try{if(_i.transition=null,Ot=1,e)return e()}finally{Ot=n,_i.transition=r,At=t,!(At&6)&&Ca()}}function Tg(){Wn=rl.current,Gt(rl)}function ja(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,HC(r)),Er!==null)for(r=Er.return;r!==null;){var n=r;switch(rg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ch();break;case 3:yl(),Gt(Fn),Gt(hn),fg();break;case 5:ug(n);break;case 4:yl();break;case 13:Gt(er);break;case 19:Gt(er);break;case 10:ag(n.type._context);break;case 22:case 23:Tg()}r=r.return}if(Ur=e,Er=e=ha(e.current,null),$r=Wn=t,Ir=0,_u=null,xg=T0=Ja=0,On=Uc=null,Ba!==null){for(t=0;t<Ba.length;t++)if(r=Ba[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Ba=null}return e}function k2(e,t){do{var r=Er;try{if(sg(),ah.current=bh,Fh){for(var n=tr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Fh=!1}if(Ya=0,Br=wr=tr=null,Mc=!1,pu=0,vg.current=null,r===null||r.return===null){Ir=1,_u=t,Er=null;break}e:{var s=e,o=r.return,l=r,u=t;if(t=$r,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var _=p.alternate;_?(p.updateQueue=_.updateQueue,p.memoizedState=_.memoizedState,p.lanes=_.lanes):(p.updateQueue=null,p.memoizedState=null)}var v=Y1(o);if(v!==null){v.flags&=-257,J1(v,o,l,s,t),v.mode&1&&q1(s,h,t),t=v,u=h;var E=t.updateQueue;if(E===null){var y=new Set;y.add(u),t.updateQueue=y}else E.add(u);break e}else{if(!(t&1)){q1(s,h,t),Ag();break e}u=Error(Se(426))}}else if(qt&&l.mode&1){var w=Y1(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),J1(w,o,l,s,t),ng(El(u,l));break e}}s=u=El(u,l),Ir!==4&&(Ir=2),Uc===null?Uc=[s]:Uc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var k=f2(s,u,t);W1(s,k);break e;case 1:l=u;var C=s.type,A=s.stateNode;if(!(s.flags&128)&&(typeof C.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(ua===null||!ua.has(A)))){s.flags|=65536,t&=-t,s.lanes|=t;var U=h2(s,l,t);W1(s,U);break e}}s=s.return}while(s!==null)}N2(r)}catch(q){t=q,Er===r&&r!==null&&(Er=r=r.return);continue}break}while(!0)}function R2(){var e=Mh.current;return Mh.current=bh,e===null?bh:e}function Ag(){(Ir===0||Ir===3||Ir===2)&&(Ir=4),Ur===null||!(Ja&268435455)&&!(T0&268435455)||Ys(Ur,$r)}function Vh(e,t){var r=At;At|=2;var n=R2();(Ur!==e||$r!==t)&&(gs=null,ja(e,t));do try{pk();break}catch(i){k2(e,i)}while(!0);if(sg(),At=r,Mh.current=n,Er!==null)throw Error(Se(261));return Ur=null,$r=0,Ir}function pk(){for(;Er!==null;)P2(Er)}function mk(){for(;Er!==null&&!VI();)P2(Er)}function P2(e){var t=L2(e.alternate,e,Wn);e.memoizedProps=e.pendingProps,t===null?N2(e):Er=t,vg.current=null}function N2(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=lk(r,t),r!==null){r.flags&=32767,Er=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ir=6,Er=null;return}}else if(r=ok(r,t,Wn),r!==null){Er=r;return}if(t=t.sibling,t!==null){Er=t;return}Er=t=e}while(t!==null);Ir===0&&(Ir=5)}function Da(e,t,r){var n=Ot,i=_i.transition;try{_i.transition=null,Ot=1,gk(e,t,r,n)}finally{_i.transition=i,Ot=n}return null}function gk(e,t,r,n){do ul();while(ea!==null);if(At&6)throw Error(Se(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Se(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(qI(e,s),e===Ur&&(Er=Ur=null,$r=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Bf||(Bf=!0,D2(Eh,function(){return ul(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=_i.transition,_i.transition=null;var o=Ot;Ot=1;var l=At;At|=4,vg.current=null,uk(e,r),S2(r,e),bC(Cp),Ah=!!Ip,Cp=Ip=null,e.current=r,fk(r),zI(),At=l,Ot=o,_i.transition=s}else e.current=r;if(Bf&&(Bf=!1,ea=e,Uh=i),s=e.pendingLanes,s===0&&(ua=null),WI(r.stateNode),Mn(e,hr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Bh)throw Bh=!1,e=Zp,Zp=null,e;return Uh&1&&e.tag!==0&&ul(),s=e.pendingLanes,s&1?e===Kp?Vc++:(Vc=0,Kp=e):Vc=0,Ca(),null}function ul(){if(ea!==null){var e=fE(Uh),t=_i.transition,r=Ot;try{if(_i.transition=null,Ot=16>e?16:e,ea===null)var n=!1;else{if(e=ea,ea=null,Uh=0,At&6)throw Error(Se(331));var i=At;for(At|=4,ze=e.current;ze!==null;){var s=ze,o=s.child;if(ze.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(ze=h;ze!==null;){var p=ze;switch(p.tag){case 0:case 11:case 15:Bc(8,p,s)}var m=p.child;if(m!==null)m.return=p,ze=m;else for(;ze!==null;){p=ze;var _=p.sibling,v=p.return;if(T2(p),p===h){ze=null;break}if(_!==null){_.return=v,ze=_;break}ze=v}}}var E=s.alternate;if(E!==null){var y=E.child;if(y!==null){E.child=null;do{var w=y.sibling;y.sibling=null,y=w}while(y!==null)}}ze=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ze=o;else e:for(;ze!==null;){if(s=ze,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Bc(9,s,s.return)}var k=s.sibling;if(k!==null){k.return=s.return,ze=k;break e}ze=s.return}}var C=e.current;for(ze=C;ze!==null;){o=ze;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,ze=A;else e:for(o=C;ze!==null;){if(l=ze,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:E0(9,l)}}catch(q){sr(l,l.return,q)}if(l===o){ze=null;break e}var U=l.sibling;if(U!==null){U.return=l.return,ze=U;break e}ze=l.return}}if(At=i,Ca(),Yi&&typeof Yi.onPostCommitFiberRoot=="function")try{Yi.onPostCommitFiberRoot(d0,e)}catch{}n=!0}return n}finally{Ot=r,_i.transition=t}}return!1}function fv(e,t,r){t=El(r,t),t=f2(e,t,1),e=ca(e,t,1),t=Tn(),e!==null&&(Bu(e,1,t),Mn(e,t))}function sr(e,t,r){if(e.tag===3)fv(e,e,r);else for(;t!==null;){if(t.tag===3){fv(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ua===null||!ua.has(n))){e=El(r,e),e=h2(t,e,1),t=ca(t,e,1),e=Tn(),t!==null&&(Bu(t,1,e),Mn(t,e));break}}t=t.return}}function _k(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Tn(),e.pingedLanes|=e.suspendedLanes&r,Ur===e&&($r&r)===r&&(Ir===4||Ir===3&&($r&130023424)===$r&&500>hr()-yg?ja(e,0):xg|=r),Mn(e,t)}function O2(e,t){t===0&&(e.mode&1?(t=kf,kf<<=1,!(kf&130023424)&&(kf=4194304)):t=1);var r=Tn();e=ks(e,t),e!==null&&(Bu(e,t,r),Mn(e,r))}function vk(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),O2(e,r)}function xk(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Se(314))}n!==null&&n.delete(t),O2(e,r)}var L2;L2=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Fn.current)Dn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Dn=!1,ak(e,t,r);Dn=!!(e.flags&131072)}else Dn=!1,qt&&t.flags&1048576&&ME(t,Ph,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;lh(e,t),e=t.pendingProps;var i=_l(t,hn.current);cl(t,r),i=dg(null,t,n,e,i,r);var s=pg();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,bn(n)?(s=!0,kh(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,lg(t),i.updater=y0,t.stateNode=i,i._reactInternals=t,bp(t,n,e,r),t=Up(null,t,n,!0,s,r)):(t.tag=0,qt&&s&&tg(t),vn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(lh(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=Ek(n),e=Ni(n,e),i){case 0:t=Bp(null,t,n,e,r);break e;case 1:t=tv(null,t,n,e,r);break e;case 11:t=Q1(null,t,n,e,r);break e;case 14:t=ev(null,t,n,Ni(n.type,e),r);break e}throw Error(Se(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ni(n,i),Bp(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ni(n,i),tv(e,t,n,i,r);case 3:e:{if(g2(t),e===null)throw Error(Se(387));n=t.pendingProps,s=t.memoizedState,i=s.element,HE(e,t),Lh(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=El(Error(Se(423)),t),t=rv(e,t,n,r,i);break e}else if(n!==i){i=El(Error(Se(424)),t),t=rv(e,t,n,r,i);break e}else for(Zn=la(t.stateNode.containerInfo.firstChild),Xn=t,qt=!0,Li=null,r=zE(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(vl(),n===i){t=Rs(e,t,r);break e}vn(e,t,n,r)}t=t.child}return t;case 5:return WE(t),e===null&&Lp(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,kp(n,i)?o=null:s!==null&&kp(n,s)&&(t.flags|=32),m2(e,t),vn(e,t,o,r),t.child;case 6:return e===null&&Lp(t),null;case 13:return _2(e,t,r);case 4:return cg(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=xl(t,null,n,r):vn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ni(n,i),Q1(e,t,n,i,r);case 7:return vn(e,t,t.pendingProps,r),t.child;case 8:return vn(e,t,t.pendingProps.children,r),t.child;case 12:return vn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,jt(Nh,n._currentValue),n._currentValue=o,s!==null)if(Vi(s.value,o)){if(s.children===i.children&&!Fn.current){t=Rs(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var u=l.firstContext;u!==null;){if(u.context===n){if(s.tag===1){u=Ts(-1,r&-r),u.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}s.lanes|=r,u=s.alternate,u!==null&&(u.lanes|=r),Dp(s.return,r,t),l.lanes|=r;break}u=u.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Se(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Dp(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}vn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,cl(t,r),i=xi(i),n=n(i),t.flags|=1,vn(e,t,n,r),t.child;case 14:return n=t.type,i=Ni(n,t.pendingProps),i=Ni(n.type,i),ev(e,t,n,i,r);case 15:return d2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ni(n,i),lh(e,t),t.tag=1,bn(n)?(e=!0,kh(t)):e=!1,cl(t,r),u2(t,n,i),bp(t,n,i,r),Up(null,t,n,!0,e,r);case 19:return v2(e,t,r);case 22:return p2(e,t,r)}throw Error(Se(156,t.tag))};function D2(e,t){return oE(e,t)}function yk(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gi(e,t,r,n){return new yk(e,t,r,n)}function wg(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ek(e){if(typeof e=="function")return wg(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Hm)return 11;if(e===Wm)return 14}return 2}function ha(e,t){var r=e.alternate;return r===null?(r=gi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function fh(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")wg(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case $o:return Ha(r.children,i,s,t);case jm:o=8,i|=8;break;case ap:return e=gi(12,r,t,i|2),e.elementType=ap,e.lanes=s,e;case op:return e=gi(13,r,t,i),e.elementType=op,e.lanes=s,e;case lp:return e=gi(19,r,t,i),e.elementType=lp,e.lanes=s,e;case Wy:return A0(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case jy:o=10;break e;case Hy:o=9;break e;case Hm:o=11;break e;case Wm:o=14;break e;case Zs:o=16,n=null;break e}throw Error(Se(130,e==null?e:typeof e,""))}return t=gi(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Ha(e,t,r,n){return e=gi(7,e,n,t),e.lanes=r,e}function A0(e,t,r,n){return e=gi(22,e,n,t),e.elementType=Wy,e.lanes=r,e.stateNode={isHidden:!1},e}function Od(e,t,r){return e=gi(6,e,null,t),e.lanes=r,e}function Ld(e,t,r){return t=gi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Tk(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dd(0),this.expirationTimes=dd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dd(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Sg(e,t,r,n,i,s,o,l,u){return e=new Tk(e,t,r,l,u),t===1?(t=1,s===!0&&(t|=8)):t=0,s=gi(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},lg(s),e}function Ak(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Go,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function F2(e){if(!e)return va;e=e._reactInternals;e:{if(oo(e)!==e||e.tag!==1)throw Error(Se(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(bn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Se(171))}if(e.tag===1){var r=e.type;if(bn(r))return FE(e,r,t)}return t}function b2(e,t,r,n,i,s,o,l,u){return e=Sg(r,n,!0,e,i,s,o,l,u),e.context=F2(null),r=e.current,n=Tn(),i=fa(r),s=Ts(n,i),s.callback=t??null,ca(r,s,i),e.current.lanes=i,Bu(e,i,n),Mn(e,n),e}function w0(e,t,r,n){var i=t.current,s=Tn(),o=fa(i);return r=F2(r),t.context===null?t.context=r:t.pendingContext=r,t=Ts(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ca(i,t,o),e!==null&&(Bi(e,i,o,s),sh(e,i,o)),o}function zh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hv(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ig(e,t){hv(e,t),(e=e.alternate)&&hv(e,t)}function wk(){return null}var M2=typeof reportError=="function"?reportError:function(e){console.error(e)};function Cg(e){this._internalRoot=e}S0.prototype.render=Cg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Se(409));w0(e,t,null,null)};S0.prototype.unmount=Cg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Qa(function(){w0(null,e,null,null)}),t[Cs]=null}};function S0(e){this._internalRoot=e}S0.prototype.unstable_scheduleHydration=function(e){if(e){var t=pE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<qs.length&&t!==0&&t<qs[r].priority;r++);qs.splice(r,0,e),r===0&&gE(e)}};function kg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function I0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function dv(){}function Sk(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var h=zh(o);s.call(h)}}var o=b2(t,n,e,0,null,!1,!1,"",dv);return e._reactRootContainer=o,e[Cs]=o.current,cu(e.nodeType===8?e.parentNode:e),Qa(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var h=zh(u);l.call(h)}}var u=Sg(e,0,!1,null,null,!1,!1,"",dv);return e._reactRootContainer=u,e[Cs]=u.current,cu(e.nodeType===8?e.parentNode:e),Qa(function(){w0(t,u,r,n)}),u}function C0(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var u=zh(o);l.call(u)}}w0(t,o,e,i)}else o=Sk(r,t,e,i,n);return zh(o)}hE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Tc(t.pendingLanes);r!==0&&(Zm(t,r|1),Mn(t,hr()),!(At&6)&&(Tl=hr()+500,Ca()))}break;case 13:Qa(function(){var n=ks(e,1);if(n!==null){var i=Tn();Bi(n,e,1,i)}}),Ig(e,1)}};Km=function(e){if(e.tag===13){var t=ks(e,134217728);if(t!==null){var r=Tn();Bi(t,e,134217728,r)}Ig(e,134217728)}};dE=function(e){if(e.tag===13){var t=fa(e),r=ks(e,t);if(r!==null){var n=Tn();Bi(r,e,t,n)}Ig(e,t)}};pE=function(){return Ot};mE=function(e,t){var r=Ot;try{return Ot=e,t()}finally{Ot=r}};vp=function(e,t,r){switch(t){case"input":if(fp(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=_0(n);if(!i)throw Error(Se(90));$y(n),fp(n,i)}}}break;case"textarea":Ky(e,r);break;case"select":t=r.value,t!=null&&sl(e,!!r.multiple,t,!1)}};tE=Eg;rE=Qa;var Ik={usingClientEntryPoint:!1,Events:[Vu,qo,_0,Qy,eE,Eg]},_c={findFiberByHostInstance:Ma,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ck={bundleType:_c.bundleType,version:_c.version,rendererPackageName:_c.rendererPackageName,rendererConfig:_c.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=sE(e),e===null?null:e.stateNode},findFiberByHostInstance:_c.findFiberByHostInstance||wk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Uf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Uf.isDisabled&&Uf.supportsFiber)try{d0=Uf.inject(Ck),Yi=Uf}catch{}}Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ik;Qn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kg(t))throw Error(Se(200));return Ak(e,t,null,r)};Qn.createRoot=function(e,t){if(!kg(e))throw Error(Se(299));var r=!1,n="",i=M2;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Sg(e,1,!1,null,null,r,!1,n,i),e[Cs]=t.current,cu(e.nodeType===8?e.parentNode:e),new Cg(t)};Qn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Se(188)):(e=Object.keys(e).join(","),Error(Se(268,e)));return e=sE(t),e=e===null?null:e.stateNode,e};Qn.flushSync=function(e){return Qa(e)};Qn.hydrate=function(e,t,r){if(!I0(t))throw Error(Se(200));return C0(null,e,t,!0,r)};Qn.hydrateRoot=function(e,t,r){if(!kg(e))throw Error(Se(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=M2;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=b2(t,null,e,1,r??null,i,!1,s,o),e[Cs]=t.current,cu(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new S0(t)};Qn.render=function(e,t,r){if(!I0(t))throw Error(Se(200));return C0(null,e,t,!1,r)};Qn.unmountComponentAtNode=function(e){if(!I0(e))throw Error(Se(40));return e._reactRootContainer?(Qa(function(){C0(null,null,e,!1,function(){e._reactRootContainer=null,e[Cs]=null})}),!0):!1};Qn.unstable_batchedUpdates=Eg;Qn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!I0(r))throw Error(Se(200));if(e==null||e._reactInternals===void 0)throw Error(Se(38));return C0(e,t,r,!1,n)};Qn.version="18.3.1-next-f1338f8080-20240426";function B2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(B2)}catch(e){console.error(e)}}B2(),By.exports=Qn;var U2=By.exports,pv=U2;ip.createRoot=pv.createRoot,ip.hydrateRoot=pv.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vu(){return vu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vu.apply(this,arguments)}var ta;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ta||(ta={}));const mv="popstate";function kk(e){e===void 0&&(e={});function t(i,s){let{pathname:o="/",search:l="",hash:u=""}=lo(i.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Yp("",{pathname:o,search:l,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(i,s){let o=i.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let u=i.location.href,h=u.indexOf("#");l=h===-1?u:u.slice(0,h)}return l+"#"+(typeof s=="string"?s:V2(s))}function n(i,s){k0(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return Pk(t,r,n,e)}function kr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function k0(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Rk(){return Math.random().toString(36).substr(2,8)}function gv(e,t){return{usr:e.state,key:e.key,idx:t}}function Yp(e,t,r,n){return r===void 0&&(r=null),vu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?lo(t):t,{state:r,key:t&&t.key||n||Rk()})}function V2(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function lo(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Pk(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,l=ta.Pop,u=null,h=p();h==null&&(h=0,o.replaceState(vu({},o.state,{idx:h}),""));function p(){return(o.state||{idx:null}).idx}function m(){l=ta.Pop;let w=p(),k=w==null?null:w-h;h=w,u&&u({action:l,location:y.location,delta:k})}function _(w,k){l=ta.Push;let C=Yp(y.location,w,k);r&&r(C,w),h=p()+1;let A=gv(C,h),U=y.createHref(C);try{o.pushState(A,"",U)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;i.location.assign(U)}s&&u&&u({action:l,location:y.location,delta:1})}function v(w,k){l=ta.Replace;let C=Yp(y.location,w,k);r&&r(C,w),h=p();let A=gv(C,h),U=y.createHref(C);o.replaceState(A,"",U),s&&u&&u({action:l,location:y.location,delta:0})}function E(w){let k=i.location.origin!=="null"?i.location.origin:i.location.href,C=typeof w=="string"?w:V2(w);return C=C.replace(/ $/,"%20"),kr(k,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,k)}let y={get action(){return l},get location(){return e(i,o)},listen(w){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(mv,m),u=w,()=>{i.removeEventListener(mv,m),u=null}},createHref(w){return t(i,w)},createURL:E,encodeLocation(w){let k=E(w);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:_,replace:v,go(w){return o.go(w)}};return y}var _v;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(_v||(_v={}));function Nk(e,t,r){return r===void 0&&(r="/"),Ok(e,t,r)}function Ok(e,t,r,n){let i=typeof t=="string"?lo(t):t,s=H2(i.pathname||"/",r);if(s==null)return null;let o=z2(e);Lk(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let h=Gk(s);l=jk(o[u],h)}return l}function z2(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,l)=>{let u={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};u.relativePath.startsWith("/")&&(kr(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let h=Wa([n,u.relativePath]),p=r.concat(u);s.children&&s.children.length>0&&(kr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),z2(s.children,t,p,h)),!(s.path==null&&!s.index)&&t.push({path:h,score:Vk(h,s.index),routesMeta:p})};return e.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let u of j2(s.path))i(s,o,u)}),t}function j2(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=j2(n.join("/")),l=[];return l.push(...o.map(u=>u===""?s:[s,u].join("/"))),i&&l.push(...o),l.map(u=>e.startsWith("/")&&u===""?"/":u)}function Lk(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:zk(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Dk=/^:[\w-]+$/,Fk=3,bk=2,Mk=1,Bk=10,Uk=-2,vv=e=>e==="*";function Vk(e,t){let r=e.split("/"),n=r.length;return r.some(vv)&&(n+=Uk),t&&(n+=bk),r.filter(i=>!vv(i)).reduce((i,s)=>i+(Dk.test(s)?Fk:s===""?Mk:Bk),n)}function zk(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function jk(e,t,r){let{routesMeta:n}=e,i={},s="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],h=l===n.length-1,p=s==="/"?t:t.slice(s.length)||"/",m=Hk({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},p),_=u.route;if(!m)return null;Object.assign(i,m.params),o.push({params:i,pathname:Wa([s,m.pathname]),pathnameBase:Jk(Wa([s,m.pathnameBase])),route:_}),m.pathnameBase!=="/"&&(s=Wa([s,m.pathnameBase]))}return o}function Hk(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Wk(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((h,p,m)=>{let{paramName:_,isOptional:v}=p;if(_==="*"){let y=l[m]||"";o=s.slice(0,s.length-y.length).replace(/(.)\/+$/,"$1")}const E=l[m];return v&&!E?h[_]=void 0:h[_]=(E||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:o,pattern:e}}function Wk(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),k0(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function Gk(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return k0(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function H2(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const $k=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zk=e=>$k.test(e);function Kk(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?lo(e):e,s;if(r)if(Zk(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),k0(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=xv(r.substring(1),"/"):s=xv(r,t)}else s=t;return{pathname:s,search:Qk(n),hash:eR(i)}}function xv(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Dd(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Xk(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function qk(e,t){let r=Xk(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Yk(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=lo(e):(i=vu({},e),kr(!i.pathname||!i.pathname.includes("?"),Dd("?","pathname","search",i)),kr(!i.pathname||!i.pathname.includes("#"),Dd("#","pathname","hash",i)),kr(!i.search||!i.search.includes("#"),Dd("#","search","hash",i)));let s=e===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=r;else{let m=t.length-1;if(!n&&o.startsWith("..")){let _=o.split("/");for(;_[0]==="..";)_.shift(),m-=1;i.pathname=_.join("/")}l=m>=0?t[m]:"/"}let u=Kk(i,l),h=o&&o!=="/"&&o.endsWith("/"),p=(s||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(h||p)&&(u.pathname+="/"),u}const Wa=e=>e.join("/").replace(/\/\/+/g,"/"),Jk=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Qk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,eR=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function tR(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const W2=["post","put","patch","delete"];new Set(W2);const rR=["get",...W2];new Set(rR);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xu(){return xu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xu.apply(this,arguments)}const Rg=_e.createContext(null),nR=_e.createContext(null),R0=_e.createContext(null),P0=_e.createContext(null),Fl=_e.createContext({outlet:null,matches:[],isDataRoute:!1}),G2=_e.createContext(null);function N0(){return _e.useContext(P0)!=null}function $2(){return N0()||kr(!1),_e.useContext(P0).location}function Z2(e){_e.useContext(R0).static||_e.useLayoutEffect(e)}function K2(){let{isDataRoute:e}=_e.useContext(Fl);return e?gR():iR()}function iR(){N0()||kr(!1);let e=_e.useContext(Rg),{basename:t,future:r,navigator:n}=_e.useContext(R0),{matches:i}=_e.useContext(Fl),{pathname:s}=$2(),o=JSON.stringify(qk(i,r.v7_relativeSplatPath)),l=_e.useRef(!1);return Z2(()=>{l.current=!0}),_e.useCallback(function(h,p){if(p===void 0&&(p={}),!l.current)return;if(typeof h=="number"){n.go(h);return}let m=Yk(h,JSON.parse(o),s,p.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Wa([t,m.pathname])),(p.replace?n.replace:n.push)(m,p.state,p)},[t,n,o,s,e])}function sR(e,t){return aR(e,t)}function aR(e,t,r,n){N0()||kr(!1);let{navigator:i}=_e.useContext(R0),{matches:s}=_e.useContext(Fl),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let h=$2(),p;if(t){var m;let w=typeof t=="string"?lo(t):t;u==="/"||(m=w.pathname)!=null&&m.startsWith(u)||kr(!1),p=w}else p=h;let _=p.pathname||"/",v=_;if(u!=="/"){let w=u.replace(/^\//,"").split("/");v="/"+_.replace(/^\//,"").split("/").slice(w.length).join("/")}let E=Nk(e,{pathname:v}),y=fR(E&&E.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:Wa([u,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?u:Wa([u,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,r,n);return t&&y?_e.createElement(P0.Provider,{value:{location:xu({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:ta.Pop}},y):y}function oR(){let e=mR(),t=tR(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _e.createElement(_e.Fragment,null,_e.createElement("h2",null,"Unexpected Application Error!"),_e.createElement("h3",{style:{fontStyle:"italic"}},t),r?_e.createElement("pre",{style:i},r):null,null)}const lR=_e.createElement(oR,null);class cR extends _e.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?_e.createElement(Fl.Provider,{value:this.props.routeContext},_e.createElement(G2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uR(e){let{routeContext:t,match:r,children:n}=e,i=_e.useContext(Rg);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),_e.createElement(Fl.Provider,{value:t},n)}function fR(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(i=r)==null?void 0:i.errors;if(l!=null){let p=o.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);p>=0||kr(!1),o=o.slice(0,Math.min(o.length,p+1))}let u=!1,h=-1;if(r&&n&&n.v7_partialHydration)for(let p=0;p<o.length;p++){let m=o[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=p),m.route.id){let{loaderData:_,errors:v}=r,E=m.route.loader&&_[m.route.id]===void 0&&(!v||v[m.route.id]===void 0);if(m.route.lazy||E){u=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}return o.reduceRight((p,m,_)=>{let v,E=!1,y=null,w=null;r&&(v=l&&m.route.id?l[m.route.id]:void 0,y=m.route.errorElement||lR,u&&(h<0&&_===0?(_R("route-fallback"),E=!0,w=null):h===_&&(E=!0,w=m.route.hydrateFallbackElement||null)));let k=t.concat(o.slice(0,_+1)),C=()=>{let A;return v?A=y:E?A=w:m.route.Component?A=_e.createElement(m.route.Component,null):m.route.element?A=m.route.element:A=p,_e.createElement(uR,{match:m,routeContext:{outlet:p,matches:k,isDataRoute:r!=null},children:A})};return r&&(m.route.ErrorBoundary||m.route.errorElement||_===0)?_e.createElement(cR,{location:r.location,revalidation:r.revalidation,component:y,error:v,children:C(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):C()},null)}var X2=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(X2||{}),q2=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(q2||{});function hR(e){let t=_e.useContext(Rg);return t||kr(!1),t}function dR(e){let t=_e.useContext(nR);return t||kr(!1),t}function pR(e){let t=_e.useContext(Fl);return t||kr(!1),t}function Y2(e){let t=pR(),r=t.matches[t.matches.length-1];return r.route.id||kr(!1),r.route.id}function mR(){var e;let t=_e.useContext(G2),r=dR(),n=Y2();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function gR(){let{router:e}=hR(X2.UseNavigateStable),t=Y2(q2.UseNavigateStable),r=_e.useRef(!1);return Z2(()=>{r.current=!0}),_e.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,xu({fromRouteId:t},s)))},[e,t])}const yv={};function _R(e,t,r){yv[e]||(yv[e]=!0)}function vR(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Jp(e){kr(!1)}function xR(e){let{basename:t="/",children:r=null,location:n,navigationType:i=ta.Pop,navigator:s,static:o=!1,future:l}=e;N0()&&kr(!1);let u=t.replace(/^\/*/,"/"),h=_e.useMemo(()=>({basename:u,navigator:s,static:o,future:xu({v7_relativeSplatPath:!1},l)}),[u,l,s,o]);typeof n=="string"&&(n=lo(n));let{pathname:p="/",search:m="",hash:_="",state:v=null,key:E="default"}=n,y=_e.useMemo(()=>{let w=H2(p,u);return w==null?null:{location:{pathname:w,search:m,hash:_,state:v,key:E},navigationType:i}},[u,p,m,_,v,E,i]);return y==null?null:_e.createElement(R0.Provider,{value:h},_e.createElement(P0.Provider,{children:r,value:y}))}function yR(e){let{children:t,location:r}=e;return sR(Qp(t),r)}new Promise(()=>{});function Qp(e,t){t===void 0&&(t=[]);let r=[];return _e.Children.forEach(e,(n,i)=>{if(!_e.isValidElement(n))return;let s=[...t,i];if(n.type===_e.Fragment){r.push.apply(r,Qp(n.props.children,s));return}n.type!==Jp&&kr(!1),!n.props.index||!n.props.children||kr(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Qp(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const ER="6";try{window.__reactRouterVersion=ER}catch{}const TR="startTransition",Ev=_I[TR];function AR(e){let{basename:t,children:r,future:n,window:i}=e,s=_e.useRef();s.current==null&&(s.current=kk({window:i,v5Compat:!0}));let o=s.current,[l,u]=_e.useState({action:o.action,location:o.location}),{v7_startTransition:h}=n||{},p=_e.useCallback(m=>{h&&Ev?Ev(()=>u(m)):u(m)},[u,h]);return _e.useLayoutEffect(()=>o.listen(p),[o,p]),_e.useEffect(()=>vR(n),[n]),_e.createElement(xR,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}var Tv;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Tv||(Tv={}));var Av;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Av||(Av={}));function J2(e,t){const r=_e.useRef(t);_e.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}function wR(e,t,r){t.center!==r.center&&e.setLatLng(t.center),t.radius!=null&&t.radius!==r.radius&&e.setRadius(t.radius)}const SR=1;function IR(e){return Object.freeze({__version:SR,map:e})}function Q2(e,t){return Object.freeze({...e,...t})}const eT=_e.createContext(null),tT=eT.Provider;function O0(){const e=_e.useContext(eT);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function CR(e){function t(r,n){const{instance:i,context:s}=e(r).current;return _e.useImperativeHandle(n,()=>i),r.children==null?null:Ka.createElement(tT,{value:s},r.children)}return _e.forwardRef(t)}function kR(e){function t(r,n){const[i,s]=_e.useState(!1),{instance:o}=e(r,s).current;_e.useImperativeHandle(n,()=>o),_e.useEffect(function(){i&&o.update()},[o,i,r.children]);const l=o._contentNode;return l?U2.createPortal(r.children,l):null}return _e.forwardRef(t)}function RR(e){function t(r,n){const{instance:i}=e(r).current;return _e.useImperativeHandle(n,()=>i),null}return _e.forwardRef(t)}function Pg(e,t){const r=_e.useRef();_e.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function L0(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}function PR(e,t){return function(n,i){const s=O0(),o=e(L0(n,s),s);return J2(s.map,n.attribution),Pg(o.current,n.eventHandlers),t(o.current,s,n,i),o}}var em={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,t){(function(r,n){n(t)})(eI,function(r){var n="1.9.4";function i(a){var c,d,g,T;for(d=1,g=arguments.length;d<g;d++){T=arguments[d];for(c in T)a[c]=T[c]}return a}var s=Object.create||function(){function a(){}return function(c){return a.prototype=c,new a}}();function o(a,c){var d=Array.prototype.slice;if(a.bind)return a.bind.apply(a,d.call(arguments,1));var g=d.call(arguments,2);return function(){return a.apply(c,g.length?g.concat(d.call(arguments)):arguments)}}var l=0;function u(a){return"_leaflet_id"in a||(a._leaflet_id=++l),a._leaflet_id}function h(a,c,d){var g,T,O,J;return J=function(){g=!1,T&&(O.apply(d,T),T=!1)},O=function(){g?T=arguments:(a.apply(d,arguments),setTimeout(J,c),g=!0)},O}function p(a,c,d){var g=c[1],T=c[0],O=g-T;return a===g&&d?a:((a-T)%O+O)%O+T}function m(){return!1}function _(a,c){if(c===!1)return a;var d=Math.pow(10,c===void 0?6:c);return Math.round(a*d)/d}function v(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function E(a){return v(a).split(/\s+/)}function y(a,c){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?s(a.options):{});for(var d in c)a.options[d]=c[d];return a.options}function w(a,c,d){var g=[];for(var T in a)g.push(encodeURIComponent(d?T.toUpperCase():T)+"="+encodeURIComponent(a[T]));return(!c||c.indexOf("?")===-1?"?":"&")+g.join("&")}var k=/\{ *([\w_ -]+) *\}/g;function C(a,c){return a.replace(k,function(d,g){var T=c[g];if(T===void 0)throw new Error("No value provided for variable "+d);return typeof T=="function"&&(T=T(c)),T})}var A=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function U(a,c){for(var d=0;d<a.length;d++)if(a[d]===c)return d;return-1}var q="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function K(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var S=0;function R(a){var c=+new Date,d=Math.max(0,16-(c-S));return S=c+d,window.setTimeout(a,d)}var P=window.requestAnimationFrame||K("RequestAnimationFrame")||R,D=window.cancelAnimationFrame||K("CancelAnimationFrame")||K("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function F(a,c,d){if(d&&P===R)a.call(c);else return P.call(window,o(a,c))}function b(a){a&&D.call(window,a)}var M={__proto__:null,extend:i,create:s,bind:o,get lastId(){return l},stamp:u,throttle:h,wrapNum:p,falseFn:m,formatNum:_,trim:v,splitWords:E,setOptions:y,getParamString:w,template:C,isArray:A,indexOf:U,emptyImageUrl:q,requestFn:P,cancelFn:D,requestAnimFrame:F,cancelAnimFrame:b};function Ce(){}Ce.extend=function(a){var c=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=c.__super__=this.prototype,g=s(d);g.constructor=c,c.prototype=g;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(c[T]=this[T]);return a.statics&&i(c,a.statics),a.includes&&(Ie(a.includes),i.apply(null,[g].concat(a.includes))),i(g,a),delete g.statics,delete g.includes,g.options&&(g.options=d.options?s(d.options):{},i(g.options,a.options)),g._initHooks=[],g.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var O=0,J=g._initHooks.length;O<J;O++)g._initHooks[O].call(this)}},c},Ce.include=function(a){var c=this.prototype.options;return i(this.prototype,a),a.options&&(this.prototype.options=c,this.mergeOptions(a.options)),this},Ce.mergeOptions=function(a){return i(this.prototype.options,a),this},Ce.addInitHook=function(a){var c=Array.prototype.slice.call(arguments,1),d=typeof a=="function"?a:function(){this[a].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function Ie(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=A(a)?a:[a];for(var c=0;c<a.length;c++)a[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Re={on:function(a,c,d){if(typeof a=="object")for(var g in a)this._on(g,a[g],c);else{a=E(a);for(var T=0,O=a.length;T<O;T++)this._on(a[T],c,d)}return this},off:function(a,c,d){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var g in a)this._off(g,a[g],c);else{a=E(a);for(var T=arguments.length===1,O=0,J=a.length;O<J;O++)T?this._off(a[O]):this._off(a[O],c,d)}return this},_on:function(a,c,d,g){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(a,c,d)===!1){d===this&&(d=void 0);var T={fn:c,ctx:d};g&&(T.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(T)}},_off:function(a,c,d){var g,T,O;if(this._events&&(g=this._events[a],!!g)){if(arguments.length===1){if(this._firingCount)for(T=0,O=g.length;T<O;T++)g[T].fn=m;delete this._events[a];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var J=this._listens(a,c,d);if(J!==!1){var ae=g[J];this._firingCount&&(ae.fn=m,this._events[a]=g=g.slice()),g.splice(J,1)}}},fire:function(a,c,d){if(!this.listens(a,d))return this;var g=i({},c,{type:a,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var T=this._events[a];if(T){this._firingCount=this._firingCount+1||1;for(var O=0,J=T.length;O<J;O++){var ae=T[O],he=ae.fn;ae.once&&this.off(a,he,ae.ctx),he.call(ae.ctx||this,g)}this._firingCount--}}return d&&this._propagateEvent(g),this},listens:function(a,c,d,g){typeof a!="string"&&console.warn('"string" type argument expected');var T=c;typeof c!="function"&&(g=!!c,T=void 0,d=void 0);var O=this._events&&this._events[a];if(O&&O.length&&this._listens(a,T,d)!==!1)return!0;if(g){for(var J in this._eventParents)if(this._eventParents[J].listens(a,c,d,g))return!0}return!1},_listens:function(a,c,d){if(!this._events)return!1;var g=this._events[a]||[];if(!c)return!!g.length;d===this&&(d=void 0);for(var T=0,O=g.length;T<O;T++)if(g[T].fn===c&&g[T].ctx===d)return T;return!1},once:function(a,c,d){if(typeof a=="object")for(var g in a)this._on(g,a[g],c,!0);else{a=E(a);for(var T=0,O=a.length;T<O;T++)this._on(a[T],c,d,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[u(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[u(a)],this},_propagateEvent:function(a){for(var c in this._eventParents)this._eventParents[c].fire(a.type,i({layer:a.target,propagatedFrom:a.target},a),!0)}};Re.addEventListener=Re.on,Re.removeEventListener=Re.clearAllEventListeners=Re.off,Re.addOneTimeEventListener=Re.once,Re.fireEvent=Re.fire,Re.hasEventListeners=Re.listens;var ke=Ce.extend(Re);function fe(a,c,d){this.x=d?Math.round(a):a,this.y=d?Math.round(c):c}var te=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(a){return this.clone()._add(de(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(de(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new fe(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new fe(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=te(this.x),this.y=te(this.y),this},distanceTo:function(a){a=de(a);var c=a.x-this.x,d=a.y-this.y;return Math.sqrt(c*c+d*d)},equals:function(a){return a=de(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=de(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+_(this.x)+", "+_(this.y)+")"}};function de(a,c,d){return a instanceof fe?a:A(a)?new fe(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new fe(a.x,a.y):new fe(a,c,d)}function Ee(a,c){if(a)for(var d=c?[a,c]:a,g=0,T=d.length;g<T;g++)this.extend(d[g])}Ee.prototype={extend:function(a){var c,d;if(!a)return this;if(a instanceof fe||typeof a[0]=="number"||"x"in a)c=d=de(a);else if(a=j(a),c=a.min,d=a.max,!c||!d)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=d.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(a){return de((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return de(this.min.x,this.max.y)},getTopRight:function(){return de(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var c,d;return typeof a[0]=="number"||a instanceof fe?a=de(a):a=j(a),a instanceof Ee?(c=a.min,d=a.max):c=d=a,c.x>=this.min.x&&d.x<=this.max.x&&c.y>=this.min.y&&d.y<=this.max.y},intersects:function(a){a=j(a);var c=this.min,d=this.max,g=a.min,T=a.max,O=T.x>=c.x&&g.x<=d.x,J=T.y>=c.y&&g.y<=d.y;return O&&J},overlaps:function(a){a=j(a);var c=this.min,d=this.max,g=a.min,T=a.max,O=T.x>c.x&&g.x<d.x,J=T.y>c.y&&g.y<d.y;return O&&J},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var c=this.min,d=this.max,g=Math.abs(c.x-d.x)*a,T=Math.abs(c.y-d.y)*a;return j(de(c.x-g,c.y-T),de(d.x+g,d.y+T))},equals:function(a){return a?(a=j(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function j(a,c){return!a||a instanceof Ee?a:new Ee(a,c)}function re(a,c){if(a)for(var d=c?[a,c]:a,g=0,T=d.length;g<T;g++)this.extend(d[g])}re.prototype={extend:function(a){var c=this._southWest,d=this._northEast,g,T;if(a instanceof Y)g=a,T=a;else if(a instanceof re){if(g=a._southWest,T=a._northEast,!g||!T)return this}else return a?this.extend(le(a)||Q(a)):this;return!c&&!d?(this._southWest=new Y(g.lat,g.lng),this._northEast=new Y(T.lat,T.lng)):(c.lat=Math.min(g.lat,c.lat),c.lng=Math.min(g.lng,c.lng),d.lat=Math.max(T.lat,d.lat),d.lng=Math.max(T.lng,d.lng)),this},pad:function(a){var c=this._southWest,d=this._northEast,g=Math.abs(c.lat-d.lat)*a,T=Math.abs(c.lng-d.lng)*a;return new re(new Y(c.lat-g,c.lng-T),new Y(d.lat+g,d.lng+T))},getCenter:function(){return new Y((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Y(this.getNorth(),this.getWest())},getSouthEast:function(){return new Y(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof Y||"lat"in a?a=le(a):a=Q(a);var c=this._southWest,d=this._northEast,g,T;return a instanceof re?(g=a.getSouthWest(),T=a.getNorthEast()):g=T=a,g.lat>=c.lat&&T.lat<=d.lat&&g.lng>=c.lng&&T.lng<=d.lng},intersects:function(a){a=Q(a);var c=this._southWest,d=this._northEast,g=a.getSouthWest(),T=a.getNorthEast(),O=T.lat>=c.lat&&g.lat<=d.lat,J=T.lng>=c.lng&&g.lng<=d.lng;return O&&J},overlaps:function(a){a=Q(a);var c=this._southWest,d=this._northEast,g=a.getSouthWest(),T=a.getNorthEast(),O=T.lat>c.lat&&g.lat<d.lat,J=T.lng>c.lng&&g.lng<d.lng;return O&&J},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,c){return a?(a=Q(a),this._southWest.equals(a.getSouthWest(),c)&&this._northEast.equals(a.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Q(a,c){return a instanceof re?a:new re(a,c)}function Y(a,c,d){if(isNaN(a)||isNaN(c))throw new Error("Invalid LatLng object: ("+a+", "+c+")");this.lat=+a,this.lng=+c,d!==void 0&&(this.alt=+d)}Y.prototype={equals:function(a,c){if(!a)return!1;a=le(a);var d=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return d<=(c===void 0?1e-9:c)},toString:function(a){return"LatLng("+_(this.lat,a)+", "+_(this.lng,a)+")"},distanceTo:function(a){return Ne.distance(this,le(a))},wrap:function(){return Ne.wrapLatLng(this)},toBounds:function(a){var c=180*a/40075017,d=c/Math.cos(Math.PI/180*this.lat);return Q([this.lat-c,this.lng-d],[this.lat+c,this.lng+d])},clone:function(){return new Y(this.lat,this.lng,this.alt)}};function le(a,c,d){return a instanceof Y?a:A(a)&&typeof a[0]!="object"?a.length===3?new Y(a[0],a[1],a[2]):a.length===2?new Y(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new Y(a.lat,"lng"in a?a.lng:a.lon,a.alt):c===void 0?null:new Y(a,c,d)}var ye={latLngToPoint:function(a,c){var d=this.projection.project(a),g=this.scale(c);return this.transformation._transform(d,g)},pointToLatLng:function(a,c){var d=this.scale(c),g=this.transformation.untransform(a,d);return this.projection.unproject(g)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var c=this.projection.bounds,d=this.scale(a),g=this.transformation.transform(c.min,d),T=this.transformation.transform(c.max,d);return new Ee(g,T)},infinite:!1,wrapLatLng:function(a){var c=this.wrapLng?p(a.lng,this.wrapLng,!0):a.lng,d=this.wrapLat?p(a.lat,this.wrapLat,!0):a.lat,g=a.alt;return new Y(d,c,g)},wrapLatLngBounds:function(a){var c=a.getCenter(),d=this.wrapLatLng(c),g=c.lat-d.lat,T=c.lng-d.lng;if(g===0&&T===0)return a;var O=a.getSouthWest(),J=a.getNorthEast(),ae=new Y(O.lat-g,O.lng-T),he=new Y(J.lat-g,J.lng-T);return new re(ae,he)}},Ne=i({},ye,{wrapLng:[-180,180],R:6371e3,distance:function(a,c){var d=Math.PI/180,g=a.lat*d,T=c.lat*d,O=Math.sin((c.lat-a.lat)*d/2),J=Math.sin((c.lng-a.lng)*d/2),ae=O*O+Math.cos(g)*Math.cos(T)*J*J,he=2*Math.atan2(Math.sqrt(ae),Math.sqrt(1-ae));return this.R*he}}),ee=6378137,me={R:ee,MAX_LATITUDE:85.0511287798,project:function(a){var c=Math.PI/180,d=this.MAX_LATITUDE,g=Math.max(Math.min(d,a.lat),-d),T=Math.sin(g*c);return new fe(this.R*a.lng*c,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(a){var c=180/Math.PI;return new Y((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*c,a.x*c/this.R)},bounds:function(){var a=ee*Math.PI;return new Ee([-a,-a],[a,a])}()};function Fe(a,c,d,g){if(A(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=c,this._c=d,this._d=g}Fe.prototype={transform:function(a,c){return this._transform(a.clone(),c)},_transform:function(a,c){return c=c||1,a.x=c*(this._a*a.x+this._b),a.y=c*(this._c*a.y+this._d),a},untransform:function(a,c){return c=c||1,new fe((a.x/c-this._b)/this._a,(a.y/c-this._d)/this._c)}};function H(a,c,d,g){return new Fe(a,c,d,g)}var Ve=i({},Ne,{code:"EPSG:3857",projection:me,transformation:function(){var a=.5/(Math.PI*me.R);return H(a,.5,-a,.5)}()}),je=i({},Ve,{code:"EPSG:900913"});function tt(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function Ze(a,c){var d="",g,T,O,J,ae,he;for(g=0,O=a.length;g<O;g++){for(ae=a[g],T=0,J=ae.length;T<J;T++)he=ae[T],d+=(T?"L":"M")+he.x+" "+he.y;d+=c?We.svg?"z":"x":""}return d||"M0 0"}var Pe=document.documentElement.style,ne="ActiveXObject"in window,De=ne&&!document.addEventListener,Me="msLaunchUri"in navigator&&!("documentMode"in document),Qe=kn("webkit"),st=kn("android"),pt=kn("android 2")||kn("android 3"),mt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),dr=st&&kn("Google")&&mt<537&&!("AudioNode"in window),St=!!window.opera,Mt=!Me&&kn("chrome"),Ut=kn("gecko")&&!Qe&&!St&&!ne,Nr=!Mt&&kn("safari"),et=kn("phantom"),kt="OTransition"in Pe,Rt=navigator.platform.indexOf("Win")===0,Dt=ne&&"transition"in Pe,zr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!pt,ti="MozPerspective"in Pe,Ke=!window.L_DISABLE_3D&&(Dt||zr||ti)&&!kt&&!et,Vt=typeof orientation<"u"||kn("mobile"),pr=Vt&&Qe,lr=Vt&&zr,Cn=!window.PointerEvent&&window.MSPointerEvent,mn=!!(window.PointerEvent||Cn),Or="ontouchstart"in window||!!window.TouchEvent,Jr=!window.L_NO_TOUCH&&(Or||mn),Qr=Vt&&St,ri=Vt&&Ut,zi=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,vo=function(){var a=!1;try{var c=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",m,c),window.removeEventListener("testPassiveEventSupport",m,c)}catch{}return a}(),as=function(){return!!document.createElement("canvas").getContext}(),Ms=!!(document.createElementNS&&tt("svg").createSVGRect),Tr=!!Ms&&function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),xo=!Ms&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var c=a.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),Ai=navigator.platform.indexOf("Mac")===0,os=navigator.platform.indexOf("Linux")===0;function kn(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var We={ie:ne,ielt9:De,edge:Me,webkit:Qe,android:st,android23:pt,androidStock:dr,opera:St,chrome:Mt,gecko:Ut,safari:Nr,phantom:et,opera12:kt,win:Rt,ie3d:Dt,webkit3d:zr,gecko3d:ti,any3d:Ke,mobile:Vt,mobileWebkit:pr,mobileWebkit3d:lr,msPointer:Cn,pointer:mn,touch:Jr,touchNative:Or,mobileOpera:Qr,mobileGecko:ri,retina:zi,passiveEvents:vo,canvas:as,svg:Ms,vml:xo,inlineSvg:Tr,mac:Ai,linux:os},N=We.msPointer?"MSPointerDown":"pointerdown",G=We.msPointer?"MSPointerMove":"pointermove",V=We.msPointer?"MSPointerUp":"pointerup",z=We.msPointer?"MSPointerCancel":"pointercancel",Z={touchstart:N,touchmove:G,touchend:V,touchcancel:z},X={touchstart:be,touchmove:we,touchend:we,touchcancel:we},se={},ge=!1;function oe(a,c,d){return c==="touchstart"&&Be(),X[c]?(d=X[c].bind(this,d),a.addEventListener(Z[c],d,!1),d):(console.warn("wrong event specified:",c),m)}function ce(a,c,d){if(!Z[c]){console.warn("wrong event specified:",c);return}a.removeEventListener(Z[c],d,!1)}function ue(a){se[a.pointerId]=a}function Te(a){se[a.pointerId]&&(se[a.pointerId]=a)}function Oe(a){delete se[a.pointerId]}function Be(){ge||(document.addEventListener(N,ue,!0),document.addEventListener(G,Te,!0),document.addEventListener(V,Oe,!0),document.addEventListener(z,Oe,!0),ge=!0)}function we(a,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var d in se)c.touches.push(se[d]);c.changedTouches=[c],a(c)}}function be(a,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Jt(c),we(a,c)}function Ye(a){var c={},d,g;for(g in a)d=a[g],c[g]=d&&d.bind?d.bind(a):d;return a=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var Pt=200;function Ct(a,c){a.addEventListener("dblclick",c);var d=0,g;function T(O){if(O.detail!==1){g=O.detail;return}if(!(O.pointerType==="mouse"||O.sourceCapabilities&&!O.sourceCapabilities.firesTouchEvents)){var J=Jl(O);if(!(J.some(function(he){return he instanceof HTMLLabelElement&&he.attributes.for})&&!J.some(function(he){return he instanceof HTMLInputElement||he instanceof HTMLSelectElement}))){var ae=Date.now();ae-d<=Pt?(g++,g===2&&c(Ye(O))):g=1,d=ae}}}return a.addEventListener("click",T),{dblclick:c,simDblclick:T}}function zt(a,c){a.removeEventListener("dblclick",c.dblclick),a.removeEventListener("click",c.simDblclick)}var Bn=cs(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Un=cs(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),wi=Un==="webkitTransition"||Un==="OTransition"?Un+"End":"transitionend";function Vn(a){return typeof a=="string"?document.getElementById(a):a}function ni(a,c){var d=a.style[c]||a.currentStyle&&a.currentStyle[c];if((!d||d==="auto")&&document.defaultView){var g=document.defaultView.getComputedStyle(a,null);d=g?g[c]:null}return d==="auto"?null:d}function rt(a,c,d){var g=document.createElement(a);return g.className=c||"",d&&d.appendChild(g),g}function Bt(a){var c=a.parentNode;c&&c.removeChild(a)}function Pa(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function ls(a){var c=a.parentNode;c&&c.lastChild!==a&&c.appendChild(a)}function Bs(a){var c=a.parentNode;c&&c.firstChild!==a&&c.insertBefore(a,c.firstChild)}function Hl(a,c){if(a.classList!==void 0)return a.classList.contains(c);var d=ii(a);return d.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(d)}function ct(a,c){if(a.classList!==void 0)for(var d=E(c),g=0,T=d.length;g<T;g++)a.classList.add(d[g]);else if(!Hl(a,c)){var O=ii(a);Wl(a,(O?O+" ":"")+c)}}function $t(a,c){a.classList!==void 0?a.classList.remove(c):Wl(a,v((" "+ii(a)+" ").replace(" "+c+" "," ")))}function Wl(a,c){a.className.baseVal===void 0?a.className=c:a.className.baseVal=c}function ii(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function ir(a,c){"opacity"in a.style?a.style.opacity=c:"filter"in a.style&&yo(a,c)}function yo(a,c){var d=!1,g="DXImageTransform.Microsoft.Alpha";try{d=a.filters.item(g)}catch{if(c===1)return}c=Math.round(c*100),d?(d.Enabled=c!==100,d.Opacity=c):a.style.filter+=" progid:"+g+"(opacity="+c+")"}function cs(a){for(var c=document.documentElement.style,d=0;d<a.length;d++)if(a[d]in c)return a[d];return!1}function ji(a,c,d){var g=c||new fe(0,0);a.style[Bn]=(We.ie3d?"translate("+g.x+"px,"+g.y+"px)":"translate3d("+g.x+"px,"+g.y+"px,0)")+(d?" scale("+d+")":"")}function nt(a,c){a._leaflet_pos=c,We.any3d?ji(a,c):(a.style.left=c.x+"px",a.style.top=c.y+"px")}function si(a){return a._leaflet_pos||new fe(0,0)}var Si,Ii,Gl;if("onselectstart"in document)Si=function(){Xe(window,"selectstart",Jt)},Ii=function(){Ft(window,"selectstart",Jt)};else{var Us=cs(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Si=function(){if(Us){var a=document.documentElement.style;Gl=a[Us],a[Us]="none"}},Ii=function(){Us&&(document.documentElement.style[Us]=Gl,Gl=void 0)}}function $l(){Xe(window,"dragstart",Jt)}function Zl(){Ft(window,"dragstart",Jt)}var Eo,Kl;function us(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(zn(),Eo=a,Kl=a.style.outlineStyle,a.style.outlineStyle="none",Xe(window,"keydown",zn))}function zn(){Eo&&(Eo.style.outlineStyle=Kl,Eo=void 0,Kl=void 0,Ft(window,"keydown",zn))}function Xl(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function To(a){var c=a.getBoundingClientRect();return{x:c.width/a.offsetWidth||1,y:c.height/a.offsetHeight||1,boundingClientRect:c}}var rf={__proto__:null,TRANSFORM:Bn,TRANSITION:Un,TRANSITION_END:wi,get:Vn,getStyle:ni,create:rt,remove:Bt,empty:Pa,toFront:ls,toBack:Bs,hasClass:Hl,addClass:ct,removeClass:$t,setClass:Wl,getClass:ii,setOpacity:ir,testProp:cs,setTransform:ji,setPosition:nt,getPosition:si,get disableTextSelection(){return Si},get enableTextSelection(){return Ii},disableImageDrag:$l,enableImageDrag:Zl,preventOutline:us,restoreOutline:zn,getSizedParentNode:Xl,getScale:To};function Xe(a,c,d,g){if(c&&typeof c=="object")for(var T in c)ql(a,T,c[T],d);else{c=E(c);for(var O=0,J=c.length;O<J;O++)ql(a,c[O],d,g)}return this}var ai="_leaflet_events";function Ft(a,c,d,g){if(arguments.length===1)nf(a),delete a[ai];else if(c&&typeof c=="object")for(var T in c)Yl(a,T,c[T],d);else if(c=E(c),arguments.length===2)nf(a,function(ae){return U(c,ae)!==-1});else for(var O=0,J=c.length;O<J;O++)Yl(a,c[O],d,g);return this}function nf(a,c){for(var d in a[ai]){var g=d.split(/\d/)[0];(!c||c(g))&&Yl(a,g,null,null,d)}}var oi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ql(a,c,d,g){var T=c+u(d)+(g?"_"+u(g):"");if(a[ai]&&a[ai][T])return this;var O=function(ae){return d.call(g||a,ae||window.event)},J=O;!We.touchNative&&We.pointer&&c.indexOf("touch")===0?O=oe(a,c,O):We.touch&&c==="dblclick"?O=Ct(a,O):"addEventListener"in a?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?a.addEventListener(oi[c]||c,O,We.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(O=function(ae){ae=ae||window.event,Ql(a,ae)&&J(ae)},a.addEventListener(oi[c],O,!1)):a.addEventListener(c,J,!1):a.attachEvent("on"+c,O),a[ai]=a[ai]||{},a[ai][T]=O}function Yl(a,c,d,g,T){T=T||c+u(d)+(g?"_"+u(g):"");var O=a[ai]&&a[ai][T];if(!O)return this;!We.touchNative&&We.pointer&&c.indexOf("touch")===0?ce(a,c,O):We.touch&&c==="dblclick"?zt(a,O):"removeEventListener"in a?a.removeEventListener(oi[c]||c,O,!1):a.detachEvent("on"+c,O),a[ai][T]=null}function li(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function Vs(a){return ql(a,"wheel",li),this}function zs(a){return Xe(a,"mousedown touchstart dblclick contextmenu",li),a._leaflet_disable_click=!0,this}function Jt(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function jn(a){return Jt(a),li(a),this}function Jl(a){if(a.composedPath)return a.composedPath();for(var c=[],d=a.target;d;)c.push(d),d=d.parentNode;return c}function Ao(a,c){if(!c)return new fe(a.clientX,a.clientY);var d=To(c),g=d.boundingClientRect;return new fe((a.clientX-g.left)/d.x-c.clientLeft,(a.clientY-g.top)/d.y-c.clientTop)}var Zt=We.linux&&We.chrome?window.devicePixelRatio:We.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function sf(a){return We.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/Zt:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function Ql(a,c){var d=c.relatedTarget;if(!d)return!0;try{for(;d&&d!==a;)d=d.parentNode}catch{return!1}return d!==a}var af={__proto__:null,on:Xe,off:Ft,stopPropagation:li,disableScrollPropagation:Vs,disableClickPropagation:zs,preventDefault:Jt,stop:jn,getPropagationPath:Jl,getMousePosition:Ao,getWheelDelta:sf,isExternalTarget:Ql,addListener:Xe,removeListener:Ft},ec=ke.extend({run:function(a,c,d,g){this.stop(),this._el=a,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(g||.5,.2),this._startPos=si(a),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(a){var c=+new Date-this._startTime,d=this._duration*1e3;c<d?this._runFrame(this._easeOut(c/d),a):(this._runFrame(1),this._complete())},_runFrame:function(a,c){var d=this._startPos.add(this._offset.multiplyBy(a));c&&d._round(),nt(this._el,d),this.fire("step")},_complete:function(){b(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),ht=ke.extend({options:{crs:Ve,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,c){c=y(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(le(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Un&&We.any3d&&!We.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Xe(this._proxy,wi,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,c,d){if(c=c===void 0?this._zoom:this._limitZoom(c),a=this._limitCenter(le(a),c,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=i({animate:d.animate},d.zoom),d.pan=i({animate:d.animate,duration:d.duration},d.pan));var g=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,c,d.zoom):this._tryAnimatedPan(a,d.pan);if(g)return clearTimeout(this._sizeTimer),this}return this._resetView(a,c,d.pan&&d.pan.noMoveStart),this},setZoom:function(a,c){return this._loaded?this.setView(this.getCenter(),a,{zoom:c}):(this._zoom=a,this)},zoomIn:function(a,c){return a=a||(We.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,c)},zoomOut:function(a,c){return a=a||(We.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,c)},setZoomAround:function(a,c,d){var g=this.getZoomScale(c),T=this.getSize().divideBy(2),O=a instanceof fe?a:this.latLngToContainerPoint(a),J=O.subtract(T).multiplyBy(1-1/g),ae=this.containerPointToLatLng(T.add(J));return this.setView(ae,c,{zoom:d})},_getBoundsCenterZoom:function(a,c){c=c||{},a=a.getBounds?a.getBounds():Q(a);var d=de(c.paddingTopLeft||c.padding||[0,0]),g=de(c.paddingBottomRight||c.padding||[0,0]),T=this.getBoundsZoom(a,!1,d.add(g));if(T=typeof c.maxZoom=="number"?Math.min(c.maxZoom,T):T,T===1/0)return{center:a.getCenter(),zoom:T};var O=g.subtract(d).divideBy(2),J=this.project(a.getSouthWest(),T),ae=this.project(a.getNorthEast(),T),he=this.unproject(J.add(ae).divideBy(2).add(O),T);return{center:he,zoom:T}},fitBounds:function(a,c){if(a=Q(a),!a.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(a,c);return this.setView(d.center,d.zoom,c)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,c){return this.setView(a,this._zoom,{pan:c})},panBy:function(a,c){if(a=de(a).round(),c=c||{},!a.x&&!a.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ec,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){ct(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,d,c.duration||.25,c.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,c,d){if(d=d||{},d.animate===!1||!We.any3d)return this.setView(a,c,d);this._stop();var g=this.project(this.getCenter()),T=this.project(a),O=this.getSize(),J=this._zoom;a=le(a),c=c===void 0?J:c;var ae=Math.max(O.x,O.y),he=ae*this.getZoomScale(J,c),ve=T.distanceTo(g)||1,Ue=1.42,qe=Ue*Ue;function ft(gr){var Tf=gr?-1:1,XS=gr?he:ae,qS=he*he-ae*ae+Tf*qe*qe*ve*ve,YS=2*XS*qe*ve,od=qS/YS,s1=Math.sqrt(od*od+1)-od,JS=s1<1e-9?-18:Math.log(s1);return JS}function _n(gr){return(Math.exp(gr)-Math.exp(-gr))/2}function Dr(gr){return(Math.exp(gr)+Math.exp(-gr))/2}function ui(gr){return _n(gr)/Dr(gr)}var Pn=ft(0);function bo(gr){return ae*(Dr(Pn)/Dr(Pn+Ue*gr))}function GS(gr){return ae*(Dr(Pn)*ui(Pn+Ue*gr)-_n(Pn))/qe}function $S(gr){return 1-Math.pow(1-gr,1.5)}var ZS=Date.now(),n1=(ft(1)-Pn)/Ue,KS=d.duration?1e3*d.duration:1e3*n1*.8;function i1(){var gr=(Date.now()-ZS)/KS,Tf=$S(gr)*n1;gr<=1?(this._flyToFrame=F(i1,this),this._move(this.unproject(g.add(T.subtract(g).multiplyBy(GS(Tf)/ve)),J),this.getScaleZoom(ae/bo(Tf),J),{flyTo:!0})):this._move(a,c)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),i1.call(this),this},flyToBounds:function(a,c){var d=this._getBoundsCenterZoom(a,c);return this.flyTo(d.center,d.zoom,c)},setMaxBounds:function(a){return a=Q(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var c=this.options.minZoom;return this.options.minZoom=a,this._loaded&&c!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var c=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&c!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,c){this._enforcingBounds=!0;var d=this.getCenter(),g=this._limitCenter(d,this._zoom,Q(a));return d.equals(g)||this.panTo(g,c),this._enforcingBounds=!1,this},panInside:function(a,c){c=c||{};var d=de(c.paddingTopLeft||c.padding||[0,0]),g=de(c.paddingBottomRight||c.padding||[0,0]),T=this.project(this.getCenter()),O=this.project(a),J=this.getPixelBounds(),ae=j([J.min.add(d),J.max.subtract(g)]),he=ae.getSize();if(!ae.contains(O)){this._enforcingBounds=!0;var ve=O.subtract(ae.getCenter()),Ue=ae.extend(O).getSize().subtract(he);T.x+=ve.x<0?-Ue.x:Ue.x,T.y+=ve.y<0?-Ue.y:Ue.y,this.panTo(this.unproject(T),c),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=i({animate:!1,pan:!0},a===!0?{animate:!0}:a);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),g=c.divideBy(2).round(),T=d.divideBy(2).round(),O=g.subtract(T);return!O.x&&!O.y?this:(a.animate&&a.pan?this.panBy(O):(a.pan&&this._rawPanBy(O),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=i({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=o(this._handleGeolocationResponse,this),d=o(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,d,a):navigator.geolocation.getCurrentPosition(c,d,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var c=a.code,d=a.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var c=a.coords.latitude,d=a.coords.longitude,g=new Y(c,d),T=g.toBounds(a.coords.accuracy*2),O=this._locateOptions;if(O.setView){var J=this.getBoundsZoom(T);this.setView(g,O.maxZoom?Math.min(J,O.maxZoom):J)}var ae={latlng:g,bounds:T,timestamp:a.timestamp};for(var he in a.coords)typeof a.coords[he]=="number"&&(ae[he]=a.coords[he]);this.fire("locationfound",ae)}},addHandler:function(a,c){if(!c)return this;var d=this[a]=new c(this);return this._handlers.push(d),this.options[a]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Bt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(b(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)Bt(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,c){var d="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),g=rt("div",d,c||this._mapPane);return a&&(this._panes[a]=g),g},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),c=this.unproject(a.getBottomLeft()),d=this.unproject(a.getTopRight());return new re(c,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,c,d){a=Q(a),d=de(d||[0,0]);var g=this.getZoom()||0,T=this.getMinZoom(),O=this.getMaxZoom(),J=a.getNorthWest(),ae=a.getSouthEast(),he=this.getSize().subtract(d),ve=j(this.project(ae,g),this.project(J,g)).getSize(),Ue=We.any3d?this.options.zoomSnap:1,qe=he.x/ve.x,ft=he.y/ve.y,_n=c?Math.max(qe,ft):Math.min(qe,ft);return g=this.getScaleZoom(_n,g),Ue&&(g=Math.round(g/(Ue/100))*(Ue/100),g=c?Math.ceil(g/Ue)*Ue:Math.floor(g/Ue)*Ue),Math.max(T,Math.min(O,g))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new fe(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,c){var d=this._getTopLeftPoint(a,c);return new Ee(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,c){var d=this.options.crs;return c=c===void 0?this._zoom:c,d.scale(a)/d.scale(c)},getScaleZoom:function(a,c){var d=this.options.crs;c=c===void 0?this._zoom:c;var g=d.zoom(a*d.scale(c));return isNaN(g)?1/0:g},project:function(a,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(le(a),c)},unproject:function(a,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(de(a),c)},layerPointToLatLng:function(a){var c=de(a).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(a){var c=this.project(le(a))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(le(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(Q(a))},distance:function(a,c){return this.options.crs.distance(le(a),le(c))},containerPointToLayerPoint:function(a){return de(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return de(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var c=this.containerPointToLayerPoint(de(a));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(le(a)))},mouseEventToContainerPoint:function(a){return Ao(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var c=this._container=Vn(a);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Xe(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&We.any3d,ct(a,"leaflet-container"+(We.touch?" leaflet-touch":"")+(We.retina?" leaflet-retina":"")+(We.ielt9?" leaflet-oldie":"")+(We.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=ni(a,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),nt(this._mapPane,new fe(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ct(a.markerPane,"leaflet-zoom-hide"),ct(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,c,d){nt(this._mapPane,new fe(0,0));var g=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var T=this._zoom!==c;this._moveStart(T,d)._move(a,c)._moveEnd(T),this.fire("viewreset"),g&&this.fire("load")},_moveStart:function(a,c){return a&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(a,c,d,g){c===void 0&&(c=this._zoom);var T=this._zoom!==c;return this._zoom=c,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),g?d&&d.pinch&&this.fire("zoom",d):((T||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return b(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){nt(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[u(this._container)]=this;var c=a?Ft:Xe;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),We.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){b(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,c){for(var d=[],g,T=c==="mouseout"||c==="mouseover",O=a.target||a.srcElement,J=!1;O;){if(g=this._targets[u(O)],g&&(c==="click"||c==="preclick")&&this._draggableMoved(g)){J=!0;break}if(g&&g.listens(c,!0)&&(T&&!Ql(O,a)||(d.push(g),T))||O===this._container)break;O=O.parentNode}return!d.length&&!J&&!T&&this.listens(c,!0)&&(d=[this]),d},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var c=a.target||a.srcElement;if(!(!this._loaded||c._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(c))){var d=a.type;d==="mousedown"&&us(c),this._fireDOMEvent(a,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,c,d){if(a.type==="click"){var g=i({},a);g.type="preclick",this._fireDOMEvent(g,g.type,d)}var T=this._findEventTargets(a,c);if(d){for(var O=[],J=0;J<d.length;J++)d[J].listens(c,!0)&&O.push(d[J]);T=O.concat(T)}if(T.length){c==="contextmenu"&&Jt(a);var ae=T[0],he={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var ve=ae.getLatLng&&(!ae._radius||ae._radius<=10);he.containerPoint=ve?this.latLngToContainerPoint(ae.getLatLng()):this.mouseEventToContainerPoint(a),he.layerPoint=this.containerPointToLayerPoint(he.containerPoint),he.latlng=ve?ae.getLatLng():this.layerPointToLatLng(he.layerPoint)}for(J=0;J<T.length;J++)if(T[J].fire(c,he,!0),he.originalEvent._stopped||T[J].options.bubblingMouseEvents===!1&&U(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,c=this._handlers.length;a<c;a++)this._handlers[a].disable()},whenReady:function(a,c){return this._loaded?a.call(c||this,{target:this}):this.on("load",a,c),this},_getMapPanePos:function(){return si(this._mapPane)||new fe(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,c){var d=a&&c!==void 0?this._getNewPixelOrigin(a,c):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,c){var d=this.getSize()._divideBy(2);return this.project(a,c)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,c,d){var g=this._getNewPixelOrigin(d,c);return this.project(a,c)._subtract(g)},_latLngBoundsToNewLayerBounds:function(a,c,d){var g=this._getNewPixelOrigin(d,c);return j([this.project(a.getSouthWest(),c)._subtract(g),this.project(a.getNorthWest(),c)._subtract(g),this.project(a.getSouthEast(),c)._subtract(g),this.project(a.getNorthEast(),c)._subtract(g)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,c,d){if(!d)return a;var g=this.project(a,c),T=this.getSize().divideBy(2),O=new Ee(g.subtract(T),g.add(T)),J=this._getBoundsOffset(O,d,c);return Math.abs(J.x)<=1&&Math.abs(J.y)<=1?a:this.unproject(g.add(J),c)},_limitOffset:function(a,c){if(!c)return a;var d=this.getPixelBounds(),g=new Ee(d.min.add(a),d.max.add(a));return a.add(this._getBoundsOffset(g,c))},_getBoundsOffset:function(a,c,d){var g=j(this.project(c.getNorthEast(),d),this.project(c.getSouthWest(),d)),T=g.min.subtract(a.min),O=g.max.subtract(a.max),J=this._rebound(T.x,-O.x),ae=this._rebound(T.y,-O.y);return new fe(J,ae)},_rebound:function(a,c){return a+c>0?Math.round(a-c)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(c))},_limitZoom:function(a){var c=this.getMinZoom(),d=this.getMaxZoom(),g=We.any3d?this.options.zoomSnap:1;return g&&(a=Math.round(a/g)*g),Math.max(c,Math.min(d,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){$t(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,c){var d=this._getCenterOffset(a)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,c),!0)},_createAnimProxy:function(){var a=this._proxy=rt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(c){var d=Bn,g=this._proxy.style[d];ji(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),g===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Bt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),c=this.getZoom();ji(this._proxy,this.project(a,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,c,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var g=this.getZoomScale(c),T=this._getCenterOffset(a)._divideBy(1-1/g);return d.animate!==!0&&!this.getSize().contains(T)?!1:(F(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(a,c,!0)},this),!0)},_animateZoom:function(a,c,d,g){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=c,ct(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:c,noUpdate:g}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&$t(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function wo(a,c){return new ht(a,c)}var Rn=Ce.extend({options:{position:"topright"},initialize:function(a){y(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var c=this._map;return c&&c.removeControl(this),this.options.position=a,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var c=this._container=this.onAdd(a),d=this.getPosition(),g=a._controlCorners[d];return ct(c,"leaflet-control"),d.indexOf("bottom")!==-1?g.insertBefore(c,g.firstChild):g.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Bt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),gn=function(a){return new Rn(a)};ht.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},c="leaflet-",d=this._controlContainer=rt("div",c+"control-container",this._container);function g(T,O){var J=c+T+" "+c+O;a[T+O]=rt("div",J,d)}g("top","left"),g("top","right"),g("bottom","left"),g("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)Bt(this._controlCorners[a]);Bt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var tc=Rn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,c,d,g){return d<g?-1:g<d?1:0}},initialize:function(a,c,d){y(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var g in a)this._addLayer(a[g],g);for(g in c)this._addLayer(c[g],g,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return Rn.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,c){return this._addLayer(a,c),this._map?this._update():this},addOverlay:function(a,c){return this._addLayer(a,c,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(a));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){ct(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(ct(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):$t(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return $t(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",c=this._container=rt("div",a),d=this.options.collapsed;c.setAttribute("aria-haspopup",!0),zs(c),Vs(c);var g=this._section=rt("section",a+"-list");d&&(this._map.on("click",this.collapse,this),Xe(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=rt("a",a+"-toggle",c);T.href="#",T.title="Layers",T.setAttribute("role","button"),Xe(T,{keydown:function(O){O.keyCode===13&&this._expandSafely()},click:function(O){Jt(O),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=rt("div",a+"-base",g),this._separator=rt("div",a+"-separator",g),this._overlaysList=rt("div",a+"-overlays",g),c.appendChild(g)},_getLayer:function(a){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===a)return this._layers[c]},_addLayer:function(a,c,d){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:c,overlay:d}),this.options.sortLayers&&this._layers.sort(o(function(g,T){return this.options.sortFunction(g.layer,T.layer,g.name,T.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Pa(this._baseLayersList),Pa(this._overlaysList),this._layerControlInputs=[];var a,c,d,g,T=0;for(d=0;d<this._layers.length;d++)g=this._layers[d],this._addItem(g),c=c||g.overlay,a=a||!g.overlay,T+=g.overlay?0:1;return this.options.hideSingleBase&&(a=a&&T>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=c&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var c=this._getLayer(u(a.target)),d=c.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;d&&this._map.fire(d,c)},_createRadioElement:function(a,c){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(c?' checked="checked"':"")+"/>",g=document.createElement("div");return g.innerHTML=d,g.firstChild},_addItem:function(a){var c=document.createElement("label"),d=this._map.hasLayer(a.layer),g;a.overlay?(g=document.createElement("input"),g.type="checkbox",g.className="leaflet-control-layers-selector",g.defaultChecked=d):g=this._createRadioElement("leaflet-base-layers_"+u(this),d),this._layerControlInputs.push(g),g.layerId=u(a.layer),Xe(g,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+a.name;var O=document.createElement("span");c.appendChild(O),O.appendChild(g),O.appendChild(T);var J=a.overlay?this._overlaysList:this._baseLayersList;return J.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,c,d,g=[],T=[];this._handlingClick=!0;for(var O=a.length-1;O>=0;O--)c=a[O],d=this._getLayer(c.layerId).layer,c.checked?g.push(d):c.checked||T.push(d);for(O=0;O<T.length;O++)this._map.hasLayer(T[O])&&this._map.removeLayer(T[O]);for(O=0;O<g.length;O++)this._map.hasLayer(g[O])||this._map.addLayer(g[O]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,c,d,g=this._map.getZoom(),T=a.length-1;T>=0;T--)c=a[T],d=this._getLayer(c.layerId).layer,c.disabled=d.options.minZoom!==void 0&&g<d.options.minZoom||d.options.maxZoom!==void 0&&g>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,Xe(a,"click",Jt),this.expand();var c=this;setTimeout(function(){Ft(a,"click",Jt),c._preventClick=!1})}}),td=function(a,c,d){return new tc(a,c,d)},fs=Rn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var c="leaflet-control-zoom",d=rt("div",c+" leaflet-bar"),g=this.options;return this._zoomInButton=this._createButton(g.zoomInText,g.zoomInTitle,c+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(g.zoomOutText,g.zoomOutTitle,c+"-out",d,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,c,d,g,T){var O=rt("a",d,g);return O.innerHTML=a,O.href="#",O.title=c,O.setAttribute("role","button"),O.setAttribute("aria-label",c),zs(O),Xe(O,"click",jn),Xe(O,"click",T,this),Xe(O,"click",this._refocusOnMap,this),O},_updateDisabled:function(){var a=this._map,c="leaflet-disabled";$t(this._zoomInButton,c),$t(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(ct(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(ct(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});ht.mergeOptions({zoomControl:!0}),ht.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new fs,this.addControl(this.zoomControl))});var of=function(a){return new fs(a)},So=Rn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var c="leaflet-control-scale",d=rt("div",c),g=this.options;return this._addScales(g,c+"-line",d),a.on(g.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),d},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,c,d){a.metric&&(this._mScale=rt("div",c,d)),a.imperial&&(this._iScale=rt("div",c,d))},_update:function(){var a=this._map,c=a.getSize().y/2,d=a.distance(a.containerPointToLatLng([0,c]),a.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(d)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var c=this._getRoundNum(a),d=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,d,c/a)},_updateImperial:function(a){var c=a*3.2808399,d,g,T;c>5280?(d=c/5280,g=this._getRoundNum(d),this._updateScale(this._iScale,g+" mi",g/d)):(T=this._getRoundNum(c),this._updateScale(this._iScale,T+" ft",T/c))},_updateScale:function(a,c,d){a.style.width=Math.round(this.options.maxWidth*d)+"px",a.innerHTML=c},_getRoundNum:function(a){var c=Math.pow(10,(Math.floor(a)+"").length-1),d=a/c;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,c*d}}),Io=function(a){return new So(a)},lf='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',js=Rn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(We.inlineSvg?lf+" ":"")+"Leaflet</a>"},initialize:function(a){y(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=rt("div","leaflet-control-attribution"),zs(this._container);for(var c in a._layers)a._layers[c].getAttribution&&this.addAttribution(a._layers[c].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var c in this._attributions)this._attributions[c]&&a.push(c);var d=[];this.options.prefix&&d.push(this.options.prefix),a.length&&d.push(a.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});ht.mergeOptions({attributionControl:!0}),ht.addInitHook(function(){this.options.attributionControl&&new js().addTo(this)});var rd=function(a){return new js(a)};Rn.Layers=tc,Rn.Zoom=fs,Rn.Scale=So,Rn.Attribution=js,gn.layers=td,gn.zoom=of,gn.scale=Io,gn.attribution=rd;var Hn=Ce.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Hn.addTo=function(a,c){return a.addHandler(c,this),this};var Na={Events:Re},rc=We.touch?"touchstart mousedown":"mousedown",Ci=ke.extend({options:{clickTolerance:3},initialize:function(a,c,d,g){y(this,g),this._element=a,this._dragStartTarget=c||a,this._preventOutline=d},enable:function(){this._enabled||(Xe(this._dragStartTarget,rc,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ci._dragging===this&&this.finishDrag(!0),Ft(this._dragStartTarget,rc,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!Hl(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){Ci._dragging===this&&this.finishDrag();return}if(!(Ci._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(Ci._dragging=this,this._preventOutline&&us(this._element),$l(),Si(),!this._moving)){this.fire("down");var c=a.touches?a.touches[0]:a,d=Xl(this._element);this._startPoint=new fe(c.clientX,c.clientY),this._startPos=si(this._element),this._parentScale=To(d);var g=a.type==="mousedown";Xe(document,g?"mousemove":"touchmove",this._onMove,this),Xe(document,g?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var c=a.touches&&a.touches.length===1?a.touches[0]:a,d=new fe(c.clientX,c.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,Jt(a),this._moved||(this.fire("dragstart"),this._moved=!0,ct(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ct(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),nt(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){$t(document.body,"leaflet-dragging"),this._lastTarget&&($t(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ft(document,"mousemove touchmove",this._onMove,this),Ft(document,"mouseup touchend touchcancel",this._onUp,this),Zl(),Ii();var c=this._moved&&this._moving;this._moving=!1,Ci._dragging=!1,c&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function Co(a,c,d){var g,T=[1,4,2,8],O,J,ae,he,ve,Ue,qe,ft;for(O=0,Ue=a.length;O<Ue;O++)a[O]._code=Hi(a[O],c);for(ae=0;ae<4;ae++){for(qe=T[ae],g=[],O=0,Ue=a.length,J=Ue-1;O<Ue;J=O++)he=a[O],ve=a[J],he._code&qe?ve._code&qe||(ft=Lr(ve,he,qe,c,d),ft._code=Hi(ft,c),g.push(ft)):(ve._code&qe&&(ft=Lr(ve,he,qe,c,d),ft._code=Hi(ft,c),g.push(ft)),g.push(he));a=g}return a}function ko(a,c){var d,g,T,O,J,ae,he,ve,Ue;if(!a||a.length===0)throw new Error("latlngs not passed");f(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var qe=le([0,0]),ft=Q(a),_n=ft.getNorthWest().distanceTo(ft.getSouthWest())*ft.getNorthEast().distanceTo(ft.getNorthWest());_n<1700&&(qe=Ro(a));var Dr=a.length,ui=[];for(d=0;d<Dr;d++){var Pn=le(a[d]);ui.push(c.project(le([Pn.lat-qe.lat,Pn.lng-qe.lng])))}for(ae=he=ve=0,d=0,g=Dr-1;d<Dr;g=d++)T=ui[d],O=ui[g],J=T.y*O.x-O.y*T.x,he+=(T.x+O.x)*J,ve+=(T.y+O.y)*J,ae+=J*3;ae===0?Ue=ui[0]:Ue=[he/ae,ve/ae];var bo=c.unproject(de(Ue));return le([bo.lat+qe.lat,bo.lng+qe.lng])}function Ro(a){for(var c=0,d=0,g=0,T=0;T<a.length;T++){var O=le(a[T]);c+=O.lat,d+=O.lng,g++}return le([c/g,d/g])}var Po={__proto__:null,clipPolygon:Co,polygonCenter:ko,centroid:Ro};function nc(a,c){if(!c||!a.length)return a.slice();var d=c*c;return a=uf(a,d),a=cf(a,d),a}function ic(a,c,d){return Math.sqrt(ci(a,c,d,!0))}function hs(a,c,d){return ci(a,c,d)}function cf(a,c){var d=a.length,g=typeof Uint8Array<"u"?Uint8Array:Array,T=new g(d);T[0]=T[d-1]=1,No(a,T,c,0,d-1);var O,J=[];for(O=0;O<d;O++)T[O]&&J.push(a[O]);return J}function No(a,c,d,g,T){var O=0,J,ae,he;for(ae=g+1;ae<=T-1;ae++)he=ci(a[ae],a[g],a[T],!0),he>O&&(J=ae,O=he);O>d&&(c[J]=1,No(a,c,d,g,J),No(a,c,d,J,T))}function uf(a,c){for(var d=[a[0]],g=1,T=0,O=a.length;g<O;g++)ff(a[g],a[T])>c&&(d.push(a[g]),T=g);return T<O-1&&d.push(a[O-1]),d}var sc;function Oa(a,c,d,g,T){var O=g?sc:Hi(a,d),J=Hi(c,d),ae,he,ve;for(sc=J;;){if(!(O|J))return[a,c];if(O&J)return!1;ae=O||J,he=Lr(a,c,ae,d,T),ve=Hi(he,d),ae===O?(a=he,O=ve):(c=he,J=ve)}}function Lr(a,c,d,g,T){var O=c.x-a.x,J=c.y-a.y,ae=g.min,he=g.max,ve,Ue;return d&8?(ve=a.x+O*(he.y-a.y)/J,Ue=he.y):d&4?(ve=a.x+O*(ae.y-a.y)/J,Ue=ae.y):d&2?(ve=he.x,Ue=a.y+J*(he.x-a.x)/O):d&1&&(ve=ae.x,Ue=a.y+J*(ae.x-a.x)/O),new fe(ve,Ue,T)}function Hi(a,c){var d=0;return a.x<c.min.x?d|=1:a.x>c.max.x&&(d|=2),a.y<c.min.y?d|=4:a.y>c.max.y&&(d|=8),d}function ff(a,c){var d=c.x-a.x,g=c.y-a.y;return d*d+g*g}function ci(a,c,d,g){var T=c.x,O=c.y,J=d.x-T,ae=d.y-O,he=J*J+ae*ae,ve;return he>0&&(ve=((a.x-T)*J+(a.y-O)*ae)/he,ve>1?(T=d.x,O=d.y):ve>0&&(T+=J*ve,O+=ae*ve)),J=a.x-T,ae=a.y-O,g?J*J+ae*ae:new fe(T,O)}function f(a){return!A(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function x(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),f(a)}function I(a,c){var d,g,T,O,J,ae,he,ve;if(!a||a.length===0)throw new Error("latlngs not passed");f(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var Ue=le([0,0]),qe=Q(a),ft=qe.getNorthWest().distanceTo(qe.getSouthWest())*qe.getNorthEast().distanceTo(qe.getNorthWest());ft<1700&&(Ue=Ro(a));var _n=a.length,Dr=[];for(d=0;d<_n;d++){var ui=le(a[d]);Dr.push(c.project(le([ui.lat-Ue.lat,ui.lng-Ue.lng])))}for(d=0,g=0;d<_n-1;d++)g+=Dr[d].distanceTo(Dr[d+1])/2;if(g===0)ve=Dr[0];else for(d=0,O=0;d<_n-1;d++)if(J=Dr[d],ae=Dr[d+1],T=J.distanceTo(ae),O+=T,O>g){he=(O-g)/T,ve=[ae.x-he*(ae.x-J.x),ae.y-he*(ae.y-J.y)];break}var Pn=c.unproject(de(ve));return le([Pn.lat+Ue.lat,Pn.lng+Ue.lng])}var B={__proto__:null,simplify:nc,pointToSegmentDistance:ic,closestPointOnSegment:hs,clipSegment:Oa,_getEdgeIntersection:Lr,_getBitCode:Hi,_sqClosestPointOnSegment:ci,isFlat:f,_flat:x,polylineCenter:I},ie={project:function(a){return new fe(a.lng,a.lat)},unproject:function(a){return new Y(a.y,a.x)},bounds:new Ee([-180,-90],[180,90])},pe={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Ee([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var c=Math.PI/180,d=this.R,g=a.lat*c,T=this.R_MINOR/d,O=Math.sqrt(1-T*T),J=O*Math.sin(g),ae=Math.tan(Math.PI/4-g/2)/Math.pow((1-J)/(1+J),O/2);return g=-d*Math.log(Math.max(ae,1e-10)),new fe(a.lng*c*d,g)},unproject:function(a){for(var c=180/Math.PI,d=this.R,g=this.R_MINOR/d,T=Math.sqrt(1-g*g),O=Math.exp(-a.y/d),J=Math.PI/2-2*Math.atan(O),ae=0,he=.1,ve;ae<15&&Math.abs(he)>1e-7;ae++)ve=T*Math.sin(J),ve=Math.pow((1-ve)/(1+ve),T/2),he=Math.PI/2-2*Math.atan(O*ve)-J,J+=he;return new Y(J*c,a.x*c/d)}},Le={__proto__:null,LonLat:ie,Mercator:pe,SphericalMercator:me},Nt=i({},Ne,{code:"EPSG:3395",projection:pe,transformation:function(){var a=.5/(Math.PI*pe.R);return H(a,.5,-a,.5)}()}),mr=i({},Ne,{code:"EPSG:4326",projection:ie,transformation:H(1/180,1,-1/180,.5)}),vt=i({},ye,{projection:ie,transformation:H(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,c){var d=c.lng-a.lng,g=c.lat-a.lat;return Math.sqrt(d*d+g*g)},infinite:!0});ye.Earth=Ne,ye.EPSG3395=Nt,ye.EPSG3857=Ve,ye.EPSG900913=je,ye.EPSG4326=mr,ye.Simple=vt;var bt=ke.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[u(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[u(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var c=a.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var d=this.getEvents();c.on(d,this),this.once("remove",function(){c.off(d,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});ht.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(a);return this._layers[c]?this:(this._layers[c]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var c=u(a);return this._layers[c]?(this._loaded&&a.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return u(a)in this._layers},eachLayer:function(a,c){for(var d in this._layers)a.call(c,this._layers[d]);return this},_addLayers:function(a){a=a?A(a)?a:[a]:[];for(var c=0,d=a.length;c<d;c++)this.addLayer(a[c])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[u(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var c=u(a);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,c=-1/0,d=this._getZoomSpan();for(var g in this._zoomBoundLayers){var T=this._zoomBoundLayers[g].options;a=T.minZoom===void 0?a:Math.min(a,T.minZoom),c=T.maxZoom===void 0?c:Math.max(c,T.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=a===1/0?void 0:a,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Qt=bt.extend({initialize:function(a,c){y(this,c),this._layers={};var d,g;if(a)for(d=0,g=a.length;d<g;d++)this.addLayer(a[d])},addLayer:function(a){var c=this.getLayerId(a);return this._layers[c]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var c=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(a){var c=typeof a=="number"?a:this.getLayerId(a);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var c=Array.prototype.slice.call(arguments,1),d,g;for(d in this._layers)g=this._layers[d],g[a]&&g[a].apply(g,c);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,c){for(var d in this._layers)a.call(c,this._layers[d]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return u(a)}}),Hs=function(a,c){return new Qt(a,c)},cr=Qt.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),Qt.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),Qt.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new re;for(var c in this._layers){var d=this._layers[c];a.extend(d.getBounds?d.getBounds():d.getLatLng())}return a}}),Oo=function(a,c){return new cr(a,c)},Wi=Ce.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){y(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,c){var d=this._getIconUrl(a);if(!d){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var g=this._createImg(d,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(g,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),g},_setIconStyles:function(a,c){var d=this.options,g=d[c+"Size"];typeof g=="number"&&(g=[g,g]);var T=de(g),O=de(c==="shadow"&&d.shadowAnchor||d.iconAnchor||T&&T.divideBy(2,!0));a.className="leaflet-marker-"+c+" "+(d.className||""),O&&(a.style.marginLeft=-O.x+"px",a.style.marginTop=-O.y+"px"),T&&(a.style.width=T.x+"px",a.style.height=T.y+"px")},_createImg:function(a,c){return c=c||document.createElement("img"),c.src=a,c},_getIconUrl:function(a){return We.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function IS(a){return new Wi(a)}var ac=Wi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof ac.imagePath!="string"&&(ac.imagePath=this._detectIconPath()),(this.options.imagePath||ac.imagePath)+Wi.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var c=function(d,g,T){var O=g.exec(d);return O&&O[T]};return a=c(a,/^url\((['"])?(.+)\1\)$/,2),a&&c(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=rt("div","leaflet-default-icon-path",document.body),c=ni(a,"background-image")||ni(a,"backgroundImage");if(document.body.removeChild(a),c=this._stripUrl(c),c)return c;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),B_=Hn.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Ci(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ct(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&$t(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var c=this._marker,d=c._map,g=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,O=si(c._icon),J=d.getPixelBounds(),ae=d.getPixelOrigin(),he=j(J.min._subtract(ae).add(T),J.max._subtract(ae).subtract(T));if(!he.contains(O)){var ve=de((Math.max(he.max.x,O.x)-he.max.x)/(J.max.x-he.max.x)-(Math.min(he.min.x,O.x)-he.min.x)/(J.min.x-he.min.x),(Math.max(he.max.y,O.y)-he.max.y)/(J.max.y-he.max.y)-(Math.min(he.min.y,O.y)-he.min.y)/(J.min.y-he.min.y)).multiplyBy(g);d.panBy(ve,{animate:!1}),this._draggable._newPos._add(ve),this._draggable._startPos._add(ve),nt(c._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=F(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(b(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,a)))},_onDrag:function(a){var c=this._marker,d=c._shadow,g=si(c._icon),T=c._map.layerPointToLatLng(g);d&&nt(d,g),c._latlng=T,a.latlng=T,a.oldLatLng=this._oldLatLng,c.fire("move",a).fire("drag",a)},_onDragEnd:function(a){b(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),hf=bt.extend({options:{icon:new ac,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,c){y(this,c),this._latlng=le(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var c=this._latlng;return this._latlng=le(a),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=a.icon.createIcon(this._icon),g=!1;d!==this._icon&&(this._icon&&this._removeIcon(),g=!0,a.title&&(d.title=a.title),d.tagName==="IMG"&&(d.alt=a.alt||"")),ct(d,c),a.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Xe(d,"focus",this._panOnFocus,this);var T=a.icon.createShadow(this._shadow),O=!1;T!==this._shadow&&(this._removeShadow(),O=!0),T&&(ct(T,c),T.alt=""),this._shadow=T,a.opacity<1&&this._updateOpacity(),g&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&O&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ft(this._icon,"focus",this._panOnFocus,this),Bt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Bt(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&nt(this._icon,a),this._shadow&&nt(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var c=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(ct(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),B_)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new B_(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&ir(this._icon,a),this._shadow&&ir(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var c=this.options.icon.options,d=c.iconSize?de(c.iconSize):de(0,0),g=c.iconAnchor?de(c.iconAnchor):de(0,0);a.panInside(this._latlng,{paddingTopLeft:g,paddingBottomRight:d.subtract(g)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function CS(a,c){return new hf(a,c)}var Ws=bt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return y(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),df=Ws.extend({options:{fill:!0,radius:10},initialize:function(a,c){y(this,c),this._latlng=le(a),this._radius=this.options.radius},setLatLng:function(a){var c=this._latlng;return this._latlng=le(a),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var c=a&&a.radius||this._radius;return Ws.prototype.setStyle.call(this,a),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,c=this._radiusY||a,d=this._clickTolerance(),g=[a+d,c+d];this._pxBounds=new Ee(this._point.subtract(g),this._point.add(g))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function kS(a,c){return new df(a,c)}var nd=df.extend({initialize:function(a,c,d){if(typeof c=="number"&&(c=i({},d,{radius:c})),y(this,c),this._latlng=le(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new re(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:Ws.prototype.setStyle,_project:function(){var a=this._latlng.lng,c=this._latlng.lat,d=this._map,g=d.options.crs;if(g.distance===Ne.distance){var T=Math.PI/180,O=this._mRadius/Ne.R/T,J=d.project([c+O,a]),ae=d.project([c-O,a]),he=J.add(ae).divideBy(2),ve=d.unproject(he).lat,Ue=Math.acos((Math.cos(O*T)-Math.sin(c*T)*Math.sin(ve*T))/(Math.cos(c*T)*Math.cos(ve*T)))/T;(isNaN(Ue)||Ue===0)&&(Ue=O/Math.cos(Math.PI/180*c)),this._point=he.subtract(d.getPixelOrigin()),this._radius=isNaN(Ue)?0:he.x-d.project([ve,a-Ue]).x,this._radiusY=he.y-J.y}else{var qe=g.unproject(g.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint(qe).x}this._updateBounds()}});function RS(a,c,d){return new nd(a,c,d)}var ds=Ws.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,c){y(this,c),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var c=1/0,d=null,g=ci,T,O,J=0,ae=this._parts.length;J<ae;J++)for(var he=this._parts[J],ve=1,Ue=he.length;ve<Ue;ve++){T=he[ve-1],O=he[ve];var qe=g(a,T,O,!0);qe<c&&(c=qe,d=g(a,T,O))}return d&&(d.distance=Math.sqrt(c)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return I(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,c){return c=c||this._defaultShape(),a=le(a),c.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new re,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return f(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var c=[],d=f(a),g=0,T=a.length;g<T;g++)d?(c[g]=le(a[g]),this._bounds.extend(c[g])):c[g]=this._convertLatLngs(a[g]);return c},_project:function(){var a=new Ee;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),c=new fe(a,a);this._rawPxBounds&&(this._pxBounds=new Ee([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(a,c,d){var g=a[0]instanceof Y,T=a.length,O,J;if(g){for(J=[],O=0;O<T;O++)J[O]=this._map.latLngToLayerPoint(a[O]),d.extend(J[O]);c.push(J)}else for(O=0;O<T;O++)this._projectLatlngs(a[O],c,d)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,d,g,T,O,J,ae,he;for(d=0,T=0,O=this._rings.length;d<O;d++)for(he=this._rings[d],g=0,J=he.length;g<J-1;g++)ae=Oa(he[g],he[g+1],a,g,!0),ae&&(c[T]=c[T]||[],c[T].push(ae[0]),(ae[1]!==he[g+1]||g===J-2)&&(c[T].push(ae[1]),T++))}},_simplifyPoints:function(){for(var a=this._parts,c=this.options.smoothFactor,d=0,g=a.length;d<g;d++)a[d]=nc(a[d],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,c){var d,g,T,O,J,ae,he=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(d=0,O=this._parts.length;d<O;d++)for(ae=this._parts[d],g=0,J=ae.length,T=J-1;g<J;T=g++)if(!(!c&&g===0)&&ic(a,ae[T],ae[g])<=he)return!0;return!1}});function PS(a,c){return new ds(a,c)}ds._flat=x;var Lo=ds.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ko(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var c=ds.prototype._convertLatLngs.call(this,a),d=c.length;return d>=2&&c[0]instanceof Y&&c[0].equals(c[d-1])&&c.pop(),c},_setLatLngs:function(a){ds.prototype._setLatLngs.call(this,a),f(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return f(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,c=this.options.weight,d=new fe(c,c);if(a=new Ee(a.min.subtract(d),a.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var g=0,T=this._rings.length,O;g<T;g++)O=Co(this._rings[g],a,!0),O.length&&this._parts.push(O)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var c=!1,d,g,T,O,J,ae,he,ve;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(O=0,he=this._parts.length;O<he;O++)for(d=this._parts[O],J=0,ve=d.length,ae=ve-1;J<ve;ae=J++)g=d[J],T=d[ae],g.y>a.y!=T.y>a.y&&a.x<(T.x-g.x)*(a.y-g.y)/(T.y-g.y)+g.x&&(c=!c);return c||ds.prototype._containsPoint.call(this,a,!0)}});function NS(a,c){return new Lo(a,c)}var ps=cr.extend({initialize:function(a,c){y(this,c),this._layers={},a&&this.addData(a)},addData:function(a){var c=A(a)?a:a.features,d,g,T;if(c){for(d=0,g=c.length;d<g;d++)T=c[d],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var O=this.options;if(O.filter&&!O.filter(a))return this;var J=pf(a,O);return J?(J.feature=_f(a),J.defaultOptions=J.options,this.resetStyle(J),O.onEachFeature&&O.onEachFeature(a,J),this.addLayer(J)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=i({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(c){this._setLayerStyle(c,a)},this)},_setLayerStyle:function(a,c){a.setStyle&&(typeof c=="function"&&(c=c(a.feature)),a.setStyle(c))}});function pf(a,c){var d=a.type==="Feature"?a.geometry:a,g=d?d.coordinates:null,T=[],O=c&&c.pointToLayer,J=c&&c.coordsToLatLng||id,ae,he,ve,Ue;if(!g&&!d)return null;switch(d.type){case"Point":return ae=J(g),U_(O,a,ae,c);case"MultiPoint":for(ve=0,Ue=g.length;ve<Ue;ve++)ae=J(g[ve]),T.push(U_(O,a,ae,c));return new cr(T);case"LineString":case"MultiLineString":return he=mf(g,d.type==="LineString"?0:1,J),new ds(he,c);case"Polygon":case"MultiPolygon":return he=mf(g,d.type==="Polygon"?1:2,J),new Lo(he,c);case"GeometryCollection":for(ve=0,Ue=d.geometries.length;ve<Ue;ve++){var qe=pf({geometry:d.geometries[ve],type:"Feature",properties:a.properties},c);qe&&T.push(qe)}return new cr(T);case"FeatureCollection":for(ve=0,Ue=d.features.length;ve<Ue;ve++){var ft=pf(d.features[ve],c);ft&&T.push(ft)}return new cr(T);default:throw new Error("Invalid GeoJSON object.")}}function U_(a,c,d,g){return a?a(c,d):new hf(d,g&&g.markersInheritOptions&&g)}function id(a){return new Y(a[1],a[0],a[2])}function mf(a,c,d){for(var g=[],T=0,O=a.length,J;T<O;T++)J=c?mf(a[T],c-1,d):(d||id)(a[T]),g.push(J);return g}function sd(a,c){return a=le(a),a.alt!==void 0?[_(a.lng,c),_(a.lat,c),_(a.alt,c)]:[_(a.lng,c),_(a.lat,c)]}function gf(a,c,d,g){for(var T=[],O=0,J=a.length;O<J;O++)T.push(c?gf(a[O],f(a[O])?0:c-1,d,g):sd(a[O],g));return!c&&d&&T.length>0&&T.push(T[0].slice()),T}function Do(a,c){return a.feature?i({},a.feature,{geometry:c}):_f(c)}function _f(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var ad={toGeoJSON:function(a){return Do(this,{type:"Point",coordinates:sd(this.getLatLng(),a)})}};hf.include(ad),nd.include(ad),df.include(ad),ds.include({toGeoJSON:function(a){var c=!f(this._latlngs),d=gf(this._latlngs,c?1:0,!1,a);return Do(this,{type:(c?"Multi":"")+"LineString",coordinates:d})}}),Lo.include({toGeoJSON:function(a){var c=!f(this._latlngs),d=c&&!f(this._latlngs[0]),g=gf(this._latlngs,d?2:c?1:0,!0,a);return c||(g=[g]),Do(this,{type:(d?"Multi":"")+"Polygon",coordinates:g})}}),Qt.include({toMultiPoint:function(a){var c=[];return this.eachLayer(function(d){c.push(d.toGeoJSON(a).geometry.coordinates)}),Do(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(a){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(a);var d=c==="GeometryCollection",g=[];return this.eachLayer(function(T){if(T.toGeoJSON){var O=T.toGeoJSON(a);if(d)g.push(O.geometry);else{var J=_f(O);J.type==="FeatureCollection"?g.push.apply(g,J.features):g.push(J)}}}),d?Do(this,{geometries:g,type:"GeometryCollection"}):{type:"FeatureCollection",features:g}}});function V_(a,c){return new ps(a,c)}var OS=V_,vf=bt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,c,d){this._url=a,this._bounds=Q(c),y(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ct(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Bt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&ls(this._image),this},bringToBack:function(){return this._map&&Bs(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=Q(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",c=this._image=a?this._url:rt("img");if(ct(c,"leaflet-image-layer"),this._zoomAnimated&&ct(c,"leaflet-zoom-animated"),this.options.className&&ct(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onload=o(this.fire,this,"load"),c.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(a){var c=this._map.getZoomScale(a.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;ji(this._image,d,c)},_reset:function(){var a=this._image,c=new Ee(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=c.getSize();nt(a,c.min),a.style.width=d.x+"px",a.style.height=d.y+"px"},_updateOpacity:function(){ir(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),LS=function(a,c,d){return new vf(a,c,d)},z_=vf.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",c=this._image=a?this._url:rt("video");if(ct(c,"leaflet-image-layer"),this._zoomAnimated&&ct(c,"leaflet-zoom-animated"),this.options.className&&ct(c,this.options.className),c.onselectstart=m,c.onmousemove=m,c.onloadeddata=o(this.fire,this,"load"),a){for(var d=c.getElementsByTagName("source"),g=[],T=0;T<d.length;T++)g.push(d[T].src);this._url=d.length>0?g:[c.src];return}A(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var O=0;O<this._url.length;O++){var J=rt("source");J.src=this._url[O],c.appendChild(J)}}});function DS(a,c,d){return new z_(a,c,d)}var j_=vf.extend({_initImage:function(){var a=this._image=this._url;ct(a,"leaflet-image-layer"),this._zoomAnimated&&ct(a,"leaflet-zoom-animated"),this.options.className&&ct(a,this.options.className),a.onselectstart=m,a.onmousemove=m}});function FS(a,c,d){return new j_(a,c,d)}var Gi=bt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,c){a&&(a instanceof Y||A(a))?(this._latlng=le(a),y(this,c)):(y(this,a),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&ir(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&ir(this._container,1),this.bringToFront(),this.options.interactive&&(ct(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(ir(this._container,0),this._removeTimeout=setTimeout(o(Bt,void 0,this._container),200)):Bt(this._container),this.options.interactive&&($t(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=le(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ls(this._container),this},bringToBack:function(){return this._map&&Bs(this._container),this},_prepareOpen:function(a){var c=this._source;if(!c._map)return!1;if(c instanceof cr){c=null;var d=this._source._layers;for(var g in d)if(d[g]._map){c=d[g];break}if(!c)return!1;this._source=c}if(!a)if(c.getCenter)a=c.getCenter();else if(c.getLatLng)a=c.getLatLng();else if(c.getBounds)a=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")a.innerHTML=c;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),c=de(this.options.offset),d=this._getAnchor();this._zoomAnimated?nt(this._container,a.add(d)):c=c.add(a).add(d);var g=this._containerBottom=-c.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=g+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});ht.include({_initOverlay:function(a,c,d,g){var T=c;return T instanceof a||(T=new a(g).setContent(c)),d&&T.setLatLng(d),T}}),bt.include({_initOverlay:function(a,c,d,g){var T=d;return T instanceof a?(y(T,g),T._source=this):(T=c&&!g?c:new a(g,this),T.setContent(d)),T}});var xf=Gi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,Gi.prototype.openOn.call(this,a)},onAdd:function(a){Gi.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ws||this._source.on("preclick",li))},onRemove:function(a){Gi.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ws||this._source.off("preclick",li))},getEvents:function(){var a=Gi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",c=this._container=rt("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=rt("div",a+"-content-wrapper",c);if(this._contentNode=rt("div",a+"-content",d),zs(c),Vs(this._contentNode),Xe(c,"contextmenu",li),this._tipContainer=rt("div",a+"-tip-container",c),this._tip=rt("div",a+"-tip",this._tipContainer),this.options.closeButton){var g=this._closeButton=rt("a",a+"-close-button",c);g.setAttribute("role","button"),g.setAttribute("aria-label","Close popup"),g.href="#close",g.innerHTML='<span aria-hidden="true">&#215;</span>',Xe(g,"click",function(T){Jt(T),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,c=a.style;c.width="",c.whiteSpace="nowrap";var d=a.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),c.width=d+1+"px",c.whiteSpace="",c.height="";var g=a.offsetHeight,T=this.options.maxHeight,O="leaflet-popup-scrolled";T&&g>T?(c.height=T+"px",ct(a,O)):$t(a,O),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var c=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),d=this._getAnchor();nt(this._container,c.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,c=parseInt(ni(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+c,g=this._containerWidth,T=new fe(this._containerLeft,-d-this._containerBottom);T._add(si(this._container));var O=a.layerPointToContainerPoint(T),J=de(this.options.autoPanPadding),ae=de(this.options.autoPanPaddingTopLeft||J),he=de(this.options.autoPanPaddingBottomRight||J),ve=a.getSize(),Ue=0,qe=0;O.x+g+he.x>ve.x&&(Ue=O.x+g-ve.x+he.x),O.x-Ue-ae.x<0&&(Ue=O.x-ae.x),O.y+d+he.y>ve.y&&(qe=O.y+d-ve.y+he.y),O.y-qe-ae.y<0&&(qe=O.y-ae.y),(Ue||qe)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([Ue,qe]))}},_getAnchor:function(){return de(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),bS=function(a,c){return new xf(a,c)};ht.mergeOptions({closePopupOnClick:!0}),ht.include({openPopup:function(a,c,d){return this._initOverlay(xf,a,c,d).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),bt.include({bindPopup:function(a,c){return this._popup=this._initOverlay(xf,this._popup,a,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof cr||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){jn(a);var c=a.layer||a.target;if(this._popup._source===c&&!(c instanceof Ws)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=c,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var yf=Gi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){Gi.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){Gi.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=Gi.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",c=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=rt("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var c,d,g=this._map,T=this._container,O=g.latLngToContainerPoint(g.getCenter()),J=g.layerPointToContainerPoint(a),ae=this.options.direction,he=T.offsetWidth,ve=T.offsetHeight,Ue=de(this.options.offset),qe=this._getAnchor();ae==="top"?(c=he/2,d=ve):ae==="bottom"?(c=he/2,d=0):ae==="center"?(c=he/2,d=ve/2):ae==="right"?(c=0,d=ve/2):ae==="left"?(c=he,d=ve/2):J.x<O.x?(ae="right",c=0,d=ve/2):(ae="left",c=he+(Ue.x+qe.x)*2,d=ve/2),a=a.subtract(de(c,d,!0)).add(Ue).add(qe),$t(T,"leaflet-tooltip-right"),$t(T,"leaflet-tooltip-left"),$t(T,"leaflet-tooltip-top"),$t(T,"leaflet-tooltip-bottom"),ct(T,"leaflet-tooltip-"+ae),nt(T,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&ir(this._container,a)},_animateZoom:function(a){var c=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(c)},_getAnchor:function(){return de(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),MS=function(a,c){return new yf(a,c)};ht.include({openTooltip:function(a,c,d){return this._initOverlay(yf,a,c,d).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),bt.include({bindTooltip:function(a,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(yf,this._tooltip,a,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var c=a?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[c](d),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof cr||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var c=typeof a.getElement=="function"&&a.getElement();c&&(Xe(c,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),Xe(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var c=typeof a.getElement=="function"&&a.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var c=a.latlng,d,g;this._tooltip.options.sticky&&a.originalEvent&&(d=this._map.mouseEventToContainerPoint(a.originalEvent),g=this._map.containerPointToLayerPoint(d),c=this._map.layerPointToLatLng(g)),this._tooltip.setLatLng(c)}});var H_=Wi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var c=a&&a.tagName==="DIV"?a:document.createElement("div"),d=this.options;if(d.html instanceof Element?(Pa(c),c.appendChild(d.html)):c.innerHTML=d.html!==!1?d.html:"",d.bgPos){var g=de(d.bgPos);c.style.backgroundPosition=-g.x+"px "+-g.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function BS(a){return new H_(a)}Wi.Default=ac;var oc=bt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:We.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){y(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),Bt(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ls(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Bs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof fe?a:new fe(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var c=this.getPane().children,d=-a(-1/0,1/0),g=0,T=c.length,O;g<T;g++)O=c[g].style.zIndex,c[g]!==this._container&&O&&(d=a(d,+O));isFinite(d)&&(this.options.zIndex=d+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!We.ielt9){ir(this._container,this.options.opacity);var a=+new Date,c=!1,d=!1;for(var g in this._tiles){var T=this._tiles[g];if(!(!T.current||!T.loaded)){var O=Math.min(1,(a-T.loaded)/200);ir(T.el,O),O<1?c=!0:(T.active?d=!0:this._onOpaqueTile(T),T.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),c&&(b(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=rt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,c=this.options.maxZoom;if(a!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===a?(this._levels[d].el.style.zIndex=c-Math.abs(a-d),this._onUpdateLevel(d)):(Bt(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var g=this._levels[a],T=this._map;return g||(g=this._levels[a]={},g.el=rt("div","leaflet-tile-container leaflet-zoom-animated",this._container),g.el.style.zIndex=c,g.origin=T.project(T.unproject(T.getPixelOrigin()),a).round(),g.zoom=a,this._setZoomTransform(g,T.getCenter(),T.getZoom()),m(g.el.offsetWidth),this._onCreateLevel(g)),this._level=g,g}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var a,c,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)c=this._tiles[a],c.retain=c.current;for(a in this._tiles)if(c=this._tiles[a],c.current&&!c.active){var g=c.coords;this._retainParent(g.x,g.y,g.z,g.z-5)||this._retainChildren(g.x,g.y,g.z,g.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var c in this._tiles)this._tiles[c].coords.z===a&&this._removeTile(c)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)Bt(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,c,d,g){var T=Math.floor(a/2),O=Math.floor(c/2),J=d-1,ae=new fe(+T,+O);ae.z=+J;var he=this._tileCoordsToKey(ae),ve=this._tiles[he];return ve&&ve.active?(ve.retain=!0,!0):(ve&&ve.loaded&&(ve.retain=!0),J>g?this._retainParent(T,O,J,g):!1)},_retainChildren:function(a,c,d,g){for(var T=2*a;T<2*a+2;T++)for(var O=2*c;O<2*c+2;O++){var J=new fe(T,O);J.z=d+1;var ae=this._tileCoordsToKey(J),he=this._tiles[ae];if(he&&he.active){he.retain=!0;continue}else he&&he.loaded&&(he.retain=!0);d+1<g&&this._retainChildren(T,O,d+1,g)}},_resetView:function(a){var c=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var c=this.options;return c.minNativeZoom!==void 0&&a<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<a?c.maxNativeZoom:a},_setView:function(a,c,d,g){var T=Math.round(c);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var O=this.options.updateWhenZooming&&T!==this._tileZoom;(!g||O)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(a),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(a,c)},_setZoomTransforms:function(a,c){for(var d in this._levels)this._setZoomTransform(this._levels[d],a,c)},_setZoomTransform:function(a,c,d){var g=this._map.getZoomScale(d,a.zoom),T=a.origin.multiplyBy(g).subtract(this._map._getNewPixelOrigin(c,d)).round();We.any3d?ji(a.el,T,g):nt(a.el,T)},_resetGrid:function(){var a=this._map,c=a.options.crs,d=this._tileSize=this.getTileSize(),g=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,c.wrapLng[0]],g).x/d.x),Math.ceil(a.project([0,c.wrapLng[1]],g).x/d.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([c.wrapLat[0],0],g).y/d.x),Math.ceil(a.project([c.wrapLat[1],0],g).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var c=this._map,d=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),g=c.getZoomScale(d,this._tileZoom),T=c.project(a,this._tileZoom).floor(),O=c.getSize().divideBy(g*2);return new Ee(T.subtract(O),T.add(O))},_update:function(a){var c=this._map;if(c){var d=this._clampZoom(c.getZoom());if(a===void 0&&(a=c.getCenter()),this._tileZoom!==void 0){var g=this._getTiledPixelBounds(a),T=this._pxBoundsToTileRange(g),O=T.getCenter(),J=[],ae=this.options.keepBuffer,he=new Ee(T.getBottomLeft().subtract([ae,-ae]),T.getTopRight().add([ae,-ae]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ve in this._tiles){var Ue=this._tiles[ve].coords;(Ue.z!==this._tileZoom||!he.contains(new fe(Ue.x,Ue.y)))&&(this._tiles[ve].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(a,d);return}for(var qe=T.min.y;qe<=T.max.y;qe++)for(var ft=T.min.x;ft<=T.max.x;ft++){var _n=new fe(ft,qe);if(_n.z=this._tileZoom,!!this._isValidTile(_n)){var Dr=this._tiles[this._tileCoordsToKey(_n)];Dr?Dr.current=!0:J.push(_n)}}if(J.sort(function(Pn,bo){return Pn.distanceTo(O)-bo.distanceTo(O)}),J.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ui=document.createDocumentFragment();for(ft=0;ft<J.length;ft++)this._addTile(J[ft],ui);this._level.el.appendChild(ui)}}}},_isValidTile:function(a){var c=this._map.options.crs;if(!c.infinite){var d=this._globalTileRange;if(!c.wrapLng&&(a.x<d.min.x||a.x>d.max.x)||!c.wrapLat&&(a.y<d.min.y||a.y>d.max.y))return!1}if(!this.options.bounds)return!0;var g=this._tileCoordsToBounds(a);return Q(this.options.bounds).overlaps(g)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var c=this._map,d=this.getTileSize(),g=a.scaleBy(d),T=g.add(d),O=c.unproject(g,a.z),J=c.unproject(T,a.z);return[O,J]},_tileCoordsToBounds:function(a){var c=this._tileCoordsToNwSe(a),d=new re(c[0],c[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var c=a.split(":"),d=new fe(+c[0],+c[1]);return d.z=+c[2],d},_removeTile:function(a){var c=this._tiles[a];c&&(Bt(c.el),delete this._tiles[a],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){ct(a,"leaflet-tile");var c=this.getTileSize();a.style.width=c.x+"px",a.style.height=c.y+"px",a.onselectstart=m,a.onmousemove=m,We.ielt9&&this.options.opacity<1&&ir(a,this.options.opacity)},_addTile:function(a,c){var d=this._getTilePos(a),g=this._tileCoordsToKey(a),T=this.createTile(this._wrapCoords(a),o(this._tileReady,this,a));this._initTile(T),this.createTile.length<2&&F(o(this._tileReady,this,a,null,T)),nt(T,d),this._tiles[g]={el:T,coords:a,current:!0},c.appendChild(T),this.fire("tileloadstart",{tile:T,coords:a})},_tileReady:function(a,c,d){c&&this.fire("tileerror",{error:c,tile:d,coords:a});var g=this._tileCoordsToKey(a);d=this._tiles[g],d&&(d.loaded=+new Date,this._map._fadeAnimated?(ir(d.el,0),b(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),c||(ct(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),We.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var c=new fe(this._wrapX?p(a.x,this._wrapX):a.x,this._wrapY?p(a.y,this._wrapY):a.y);return c.z=a.z,c},_pxBoundsToTileRange:function(a){var c=this.getTileSize();return new Ee(a.min.unscaleBy(c).floor(),a.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function US(a){return new oc(a)}var Fo=oc.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,c){this._url=a,c=y(this,c),c.detectRetina&&We.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,c){return this._url===a&&c===void 0&&(c=!0),this._url=a,c||this.redraw(),this},createTile:function(a,c){var d=document.createElement("img");return Xe(d,"load",o(this._tileOnLoad,this,c,d)),Xe(d,"error",o(this._tileOnError,this,c,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(a),d},getTileUrl:function(a){var c={r:We.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-a.y;this.options.tms&&(c.y=d),c["-y"]=d}return C(this._url,i(c,this.options))},_tileOnLoad:function(a,c){We.ielt9?setTimeout(o(a,this,null,c),0):a(null,c)},_tileOnError:function(a,c,d){var g=this.options.errorTileUrl;g&&c.getAttribute("src")!==g&&(c.src=g),a(d,c)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,c=this.options.maxZoom,d=this.options.zoomReverse,g=this.options.zoomOffset;return d&&(a=c-a),a+g},_getSubdomain:function(a){var c=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var a,c;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(c=this._tiles[a].el,c.onload=m,c.onerror=m,!c.complete)){c.src=q;var d=this._tiles[a].coords;Bt(c),delete this._tiles[a],this.fire("tileabort",{tile:c,coords:d})}},_removeTile:function(a){var c=this._tiles[a];if(c)return c.el.setAttribute("src",q),oc.prototype._removeTile.call(this,a)},_tileReady:function(a,c,d){if(!(!this._map||d&&d.getAttribute("src")===q))return oc.prototype._tileReady.call(this,a,c,d)}});function W_(a,c){return new Fo(a,c)}var G_=Fo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,c){this._url=a;var d=i({},this.defaultWmsParams);for(var g in c)g in this.options||(d[g]=c[g]);c=y(this,c);var T=c.detectRetina&&We.retina?2:1,O=this.getTileSize();d.width=O.x*T,d.height=O.y*T,this.wmsParams=d},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,Fo.prototype.onAdd.call(this,a)},getTileUrl:function(a){var c=this._tileCoordsToNwSe(a),d=this._crs,g=j(d.project(c[0]),d.project(c[1])),T=g.min,O=g.max,J=(this._wmsVersion>=1.3&&this._crs===mr?[T.y,T.x,O.y,O.x]:[T.x,T.y,O.x,O.y]).join(","),ae=Fo.prototype.getTileUrl.call(this,a);return ae+w(this.wmsParams,ae,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+J},setParams:function(a,c){return i(this.wmsParams,a),c||this.redraw(),this}});function VS(a,c){return new G_(a,c)}Fo.WMS=G_,W_.wms=VS;var ms=bt.extend({options:{padding:.1},initialize:function(a){y(this,a),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ct(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,c){var d=this._map.getZoomScale(c,this._zoom),g=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,c),O=g.multiplyBy(-d).add(T).subtract(this._map._getNewPixelOrigin(a,c));We.any3d?ji(this._container,O,d):nt(this._container,O)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,c=this._map.getSize(),d=this._map.containerPointToLayerPoint(c.multiplyBy(-a)).round();this._bounds=new Ee(d,d.add(c.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),$_=ms.extend({options:{tolerance:0},getEvents:function(){var a=ms.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ms.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");Xe(a,"mousemove",this._onMouseMove,this),Xe(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Xe(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){b(this._redrawRequest),delete this._ctx,Bt(this._container),Ft(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var c in this._layers)a=this._layers[c],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ms.prototype._update.call(this);var a=this._bounds,c=this._container,d=a.getSize(),g=We.retina?2:1;nt(c,a.min),c.width=g*d.x,c.height=g*d.y,c.style.width=d.x+"px",c.style.height=d.y+"px",We.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){ms.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[u(a)]=a;var c=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var c=a._order,d=c.next,g=c.prev;d?d.prev=g:this._drawLast=g,g?g.next=d:this._drawFirst=d,delete a._order,delete this._layers[u(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var c=a.options.dashArray.split(/[, ]+/),d=[],g,T;for(T=0;T<c.length;T++){if(g=Number(c[T]),isNaN(g))return;d.push(g)}a.options._dashArray=d}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var c=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Ee,this._redrawBounds.extend(a._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(a._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var c=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,c=this._redrawBounds;if(this._ctx.save(),c){var d=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var g=this._drawFirst;g;g=g.next)a=g.layer,(!c||a._pxBounds&&a._pxBounds.intersects(c))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,c){if(this._drawing){var d,g,T,O,J=a._parts,ae=J.length,he=this._ctx;if(ae){for(he.beginPath(),d=0;d<ae;d++){for(g=0,T=J[d].length;g<T;g++)O=J[d][g],he[g?"lineTo":"moveTo"](O.x,O.y);c&&he.closePath()}this._fillStroke(he,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var c=a._point,d=this._ctx,g=Math.max(Math.round(a._radius),1),T=(Math.max(Math.round(a._radiusY),1)||g)/g;T!==1&&(d.save(),d.scale(1,T)),d.beginPath(),d.arc(c.x,c.y/T,g,0,Math.PI*2,!1),T!==1&&d.restore(),this._fillStroke(d,a)}},_fillStroke:function(a,c){var d=c.options;d.fill&&(a.globalAlpha=d.fillOpacity,a.fillStyle=d.fillColor||d.color,a.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(a.setLineDash&&a.setLineDash(c.options&&c.options._dashArray||[]),a.globalAlpha=d.opacity,a.lineWidth=d.weight,a.strokeStyle=d.color,a.lineCap=d.lineCap,a.lineJoin=d.lineJoin,a.stroke())},_onClick:function(a){for(var c=this._map.mouseEventToLayerPoint(a),d,g,T=this._drawFirst;T;T=T.next)d=T.layer,d.options.interactive&&d._containsPoint(c)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(d))&&(g=d);this._fireEvent(g?[g]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,c)}},_handleMouseOut:function(a){var c=this._hoveredLayer;c&&($t(this._container,"leaflet-interactive"),this._fireEvent([c],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,c){if(!this._mouseHoverThrottled){for(var d,g,T=this._drawFirst;T;T=T.next)d=T.layer,d.options.interactive&&d._containsPoint(c)&&(g=d);g!==this._hoveredLayer&&(this._handleMouseOut(a),g&&(ct(this._container,"leaflet-interactive"),this._fireEvent([g],a,"mouseover"),this._hoveredLayer=g)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,c,d){this._map._fireDOMEvent(c,d||c.type,a)},_bringToFront:function(a){var c=a._order;if(c){var d=c.next,g=c.prev;if(d)d.prev=g;else return;g?g.next=d:d&&(this._drawFirst=d),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(a)}},_bringToBack:function(a){var c=a._order;if(c){var d=c.next,g=c.prev;if(g)g.next=d;else return;d?d.prev=g:g&&(this._drawLast=g),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(a)}}});function Z_(a){return We.canvas?new $_(a):null}var lc=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),zS={_initContainer:function(){this._container=rt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ms.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var c=a._container=lc("shape");ct(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",a._path=lc("path"),c.appendChild(a._path),this._updateStyle(a),this._layers[u(a)]=a},_addPath:function(a){var c=a._container;this._container.appendChild(c),a.options.interactive&&a.addInteractiveTarget(c)},_removePath:function(a){var c=a._container;Bt(c),a.removeInteractiveTarget(c),delete this._layers[u(a)]},_updateStyle:function(a){var c=a._stroke,d=a._fill,g=a.options,T=a._container;T.stroked=!!g.stroke,T.filled=!!g.fill,g.stroke?(c||(c=a._stroke=lc("stroke")),T.appendChild(c),c.weight=g.weight+"px",c.color=g.color,c.opacity=g.opacity,g.dashArray?c.dashStyle=A(g.dashArray)?g.dashArray.join(" "):g.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=g.lineCap.replace("butt","flat"),c.joinstyle=g.lineJoin):c&&(T.removeChild(c),a._stroke=null),g.fill?(d||(d=a._fill=lc("fill")),T.appendChild(d),d.color=g.fillColor||g.color,d.opacity=g.fillOpacity):d&&(T.removeChild(d),a._fill=null)},_updateCircle:function(a){var c=a._point.round(),d=Math.round(a._radius),g=Math.round(a._radiusY||d);this._setPath(a,a._empty()?"M0 0":"AL "+c.x+","+c.y+" "+d+","+g+" 0,"+65535*360)},_setPath:function(a,c){a._path.v=c},_bringToFront:function(a){ls(a._container)},_bringToBack:function(a){Bs(a._container)}},Ef=We.vml?lc:tt,cc=ms.extend({_initContainer:function(){this._container=Ef("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ef("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Bt(this._container),Ft(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ms.prototype._update.call(this);var a=this._bounds,c=a.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,d.setAttribute("width",c.x),d.setAttribute("height",c.y)),nt(d,a.min),d.setAttribute("viewBox",[a.min.x,a.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(a){var c=a._path=Ef("path");a.options.className&&ct(c,a.options.className),a.options.interactive&&ct(c,"leaflet-interactive"),this._updateStyle(a),this._layers[u(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){Bt(a._path),a.removeInteractiveTarget(a._path),delete this._layers[u(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var c=a._path,d=a.options;c&&(d.stroke?(c.setAttribute("stroke",d.color),c.setAttribute("stroke-opacity",d.opacity),c.setAttribute("stroke-width",d.weight),c.setAttribute("stroke-linecap",d.lineCap),c.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?c.setAttribute("stroke-dasharray",d.dashArray):c.removeAttribute("stroke-dasharray"),d.dashOffset?c.setAttribute("stroke-dashoffset",d.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),d.fill?(c.setAttribute("fill",d.fillColor||d.color),c.setAttribute("fill-opacity",d.fillOpacity),c.setAttribute("fill-rule",d.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(a,c){this._setPath(a,Ze(a._parts,c))},_updateCircle:function(a){var c=a._point,d=Math.max(Math.round(a._radius),1),g=Math.max(Math.round(a._radiusY),1)||d,T="a"+d+","+g+" 0 1,0 ",O=a._empty()?"M0 0":"M"+(c.x-d)+","+c.y+T+d*2+",0 "+T+-d*2+",0 ";this._setPath(a,O)},_setPath:function(a,c){a._path.setAttribute("d",c)},_bringToFront:function(a){ls(a._path)},_bringToBack:function(a){Bs(a._path)}});We.vml&&cc.include(zS);function K_(a){return We.svg||We.vml?new cc(a):null}ht.include({getRenderer:function(a){var c=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var c=this._paneRenderers[a];return c===void 0&&(c=this._createRenderer({pane:a}),this._paneRenderers[a]=c),c},_createRenderer:function(a){return this.options.preferCanvas&&Z_(a)||K_(a)}});var X_=Lo.extend({initialize:function(a,c){Lo.prototype.initialize.call(this,this._boundsToLatLngs(a),c)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=Q(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function jS(a,c){return new X_(a,c)}cc.create=Ef,cc.pointsToPath=Ze,ps.geometryToLayer=pf,ps.coordsToLatLng=id,ps.coordsToLatLngs=mf,ps.latLngToCoords=sd,ps.latLngsToCoords=gf,ps.getFeature=Do,ps.asFeature=_f,ht.mergeOptions({boxZoom:!0});var q_=Hn.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){Xe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ft(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Bt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Si(),$l(),this._startPoint=this._map.mouseEventToContainerPoint(a),Xe(document,{contextmenu:jn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=rt("div","leaflet-zoom-box",this._container),ct(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var c=new Ee(this._point,this._startPoint),d=c.getSize();nt(this._box,c.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(Bt(this._box),$t(this._container,"leaflet-crosshair")),Ii(),Zl(),Ft(document,{contextmenu:jn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var c=new re(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ht.addInitHook("addHandler","boxZoom",q_),ht.mergeOptions({doubleClickZoom:!0});var Y_=Hn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var c=this._map,d=c.getZoom(),g=c.options.zoomDelta,T=a.originalEvent.shiftKey?d-g:d+g;c.options.doubleClickZoom==="center"?c.setZoom(T):c.setZoomAround(a.containerPoint,T)}});ht.addInitHook("addHandler","doubleClickZoom",Y_),ht.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var J_=Hn.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Ci(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}ct(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){$t(this._map._container,"leaflet-grab"),$t(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=Q(this._map.options.maxBounds);this._offsetLimit=j(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var c=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(c),this._prunePositions(c)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,c){return a-(a-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;a.x<c.min.x&&(a.x=this._viscousLimit(a.x,c.min.x)),a.y<c.min.y&&(a.y=this._viscousLimit(a.y,c.min.y)),a.x>c.max.x&&(a.x=this._viscousLimit(a.x,c.max.x)),a.y>c.max.y&&(a.y=this._viscousLimit(a.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,c=Math.round(a/2),d=this._initialWorldOffset,g=this._draggable._newPos.x,T=(g-c+d)%a+c-d,O=(g+c+d)%a-c-d,J=Math.abs(T+d)<Math.abs(O+d)?T:O;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=J},_onDragEnd:function(a){var c=this._map,d=c.options,g=!d.inertia||a.noInertia||this._times.length<2;if(c.fire("dragend",a),g)c.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),O=(this._lastTime-this._times[0])/1e3,J=d.easeLinearity,ae=T.multiplyBy(J/O),he=ae.distanceTo([0,0]),ve=Math.min(d.inertiaMaxSpeed,he),Ue=ae.multiplyBy(ve/he),qe=ve/(d.inertiaDeceleration*J),ft=Ue.multiplyBy(-qe/2).round();!ft.x&&!ft.y?c.fire("moveend"):(ft=c._limitOffset(ft,c.options.maxBounds),F(function(){c.panBy(ft,{duration:qe,easeLinearity:J,noMoveStart:!0,animate:!0})}))}}});ht.addInitHook("addHandler","dragging",J_),ht.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Q_=Hn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),Xe(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ft(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,c=document.documentElement,d=a.scrollTop||c.scrollTop,g=a.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(g,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var c=this._panKeys={},d=this.keyCodes,g,T;for(g=0,T=d.left.length;g<T;g++)c[d.left[g]]=[-1*a,0];for(g=0,T=d.right.length;g<T;g++)c[d.right[g]]=[a,0];for(g=0,T=d.down.length;g<T;g++)c[d.down[g]]=[0,a];for(g=0,T=d.up.length;g<T;g++)c[d.up[g]]=[0,-1*a]},_setZoomDelta:function(a){var c=this._zoomKeys={},d=this.keyCodes,g,T;for(g=0,T=d.zoomIn.length;g<T;g++)c[d.zoomIn[g]]=a;for(g=0,T=d.zoomOut.length;g<T;g++)c[d.zoomOut[g]]=-a},_addHooks:function(){Xe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ft(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var c=a.keyCode,d=this._map,g;if(c in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(g=this._panKeys[c],a.shiftKey&&(g=de(g).multiplyBy(3)),d.options.maxBounds&&(g=d._limitOffset(de(g),d.options.maxBounds)),d.options.worldCopyJump){var T=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(g)));d.panTo(T)}else d.panBy(g)}else if(c in this._zoomKeys)d.setZoom(d.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;jn(a)}}});ht.addInitHook("addHandler","keyboard",Q_),ht.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var e1=Hn.extend({addHooks:function(){Xe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ft(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var c=sf(a),d=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var g=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),g),jn(a)},_performZoom:function(){var a=this._map,c=a.getZoom(),d=this._map.options.zoomSnap||0;a._stop();var g=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(g))))/Math.LN2,O=d?Math.ceil(T/d)*d:T,J=a._limitZoom(c+(this._delta>0?O:-O))-c;this._delta=0,this._startTime=null,J&&(a.options.scrollWheelZoom==="center"?a.setZoom(c+J):a.setZoomAround(this._lastMousePos,c+J))}});ht.addInitHook("addHandler","scrollWheelZoom",e1);var HS=600;ht.mergeOptions({tapHold:We.touchNative&&We.safari&&We.mobile,tapTolerance:15});var t1=Hn.extend({addHooks:function(){Xe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ft(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var c=a.touches[0];this._startPos=this._newPos=new fe(c.clientX,c.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Xe(document,"touchend",Jt),Xe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),HS),Xe(document,"touchend touchcancel contextmenu",this._cancel,this),Xe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){Ft(document,"touchend",Jt),Ft(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),Ft(document,"touchend touchcancel contextmenu",this._cancel,this),Ft(document,"touchmove",this._onMove,this)},_onMove:function(a){var c=a.touches[0];this._newPos=new fe(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,c){var d=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});d._simulated=!0,c.target.dispatchEvent(d)}});ht.addInitHook("addHandler","tapHold",t1),ht.mergeOptions({touchZoom:We.touch,bounceAtZoomLimits:!0});var r1=Hn.extend({addHooks:function(){ct(this._map._container,"leaflet-touch-zoom"),Xe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){$t(this._map._container,"leaflet-touch-zoom"),Ft(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(!(!a.touches||a.touches.length!==2||c._animatingZoom||this._zooming)){var d=c.mouseEventToContainerPoint(a.touches[0]),g=c.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(d.add(g)._divideBy(2))),this._startDist=d.distanceTo(g),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),Xe(document,"touchmove",this._onTouchMove,this),Xe(document,"touchend touchcancel",this._onTouchEnd,this),Jt(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var c=this._map,d=c.mouseEventToContainerPoint(a.touches[0]),g=c.mouseEventToContainerPoint(a.touches[1]),T=d.distanceTo(g)/this._startDist;if(this._zoom=c.getScaleZoom(T,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&T<1||this._zoom>c.getMaxZoom()&&T>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var O=d._add(g)._divideBy(2)._subtract(this._centerPoint);if(T===1&&O.x===0&&O.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(O),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),b(this._animRequest);var J=o(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(J,this,!0),Jt(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,b(this._animRequest),Ft(document,"touchmove",this._onTouchMove,this),Ft(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ht.addInitHook("addHandler","touchZoom",r1),ht.BoxZoom=q_,ht.DoubleClickZoom=Y_,ht.Drag=J_,ht.Keyboard=Q_,ht.ScrollWheelZoom=e1,ht.TapHold=t1,ht.TouchZoom=r1,r.Bounds=Ee,r.Browser=We,r.CRS=ye,r.Canvas=$_,r.Circle=nd,r.CircleMarker=df,r.Class=Ce,r.Control=Rn,r.DivIcon=H_,r.DivOverlay=Gi,r.DomEvent=af,r.DomUtil=rf,r.Draggable=Ci,r.Evented=ke,r.FeatureGroup=cr,r.GeoJSON=ps,r.GridLayer=oc,r.Handler=Hn,r.Icon=Wi,r.ImageOverlay=vf,r.LatLng=Y,r.LatLngBounds=re,r.Layer=bt,r.LayerGroup=Qt,r.LineUtil=B,r.Map=ht,r.Marker=hf,r.Mixin=Na,r.Path=Ws,r.Point=fe,r.PolyUtil=Po,r.Polygon=Lo,r.Polyline=ds,r.Popup=xf,r.PosAnimation=ec,r.Projection=Le,r.Rectangle=X_,r.Renderer=ms,r.SVG=cc,r.SVGOverlay=j_,r.TileLayer=Fo,r.Tooltip=yf,r.Transformation=Fe,r.Util=M,r.VideoOverlay=z_,r.bind=o,r.bounds=j,r.canvas=Z_,r.circle=RS,r.circleMarker=kS,r.control=gn,r.divIcon=BS,r.extend=i,r.featureGroup=Oo,r.geoJSON=V_,r.geoJson=OS,r.gridLayer=US,r.icon=IS,r.imageOverlay=LS,r.latLng=le,r.latLngBounds=Q,r.layerGroup=Hs,r.map=wo,r.marker=CS,r.point=de,r.polygon=NS,r.polyline=PS,r.popup=bS,r.rectangle=jS,r.setOptions=y,r.stamp=u,r.svg=K_,r.svgOverlay=FS,r.tileLayer=W_,r.tooltip=MS,r.transformation=H,r.version=n,r.videoOverlay=DS;var WS=window.L;r.noConflict=function(){return window.L=WS,this},window.L=r})})(em,em.exports);var ju=em.exports;function D0(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function Ng(e,t){return t==null?function(n,i){const s=_e.useRef();return s.current||(s.current=e(n,i)),s}:function(n,i){const s=_e.useRef();s.current||(s.current=e(n,i));const o=_e.useRef(n),{instance:l}=s.current;return _e.useEffect(function(){o.current!==n&&(t(l,n,o.current),o.current=n)},[l,n,i]),s}}function rT(e,t){_e.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){var s;(s=t.layerContainer)==null||s.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function NR(e){return function(r){const n=O0(),i=e(L0(r,n),n);return J2(n.map,r.attribution),Pg(i.current,r.eventHandlers),rT(i.current,n),i}}function OR(e,t){const r=_e.useRef();_e.useEffect(function(){if(t.pathOptions!==r.current){const i=t.pathOptions??{};e.instance.setStyle(i),r.current=i}},[e,t])}function LR(e){return function(r){const n=O0(),i=e(L0(r,n),n);return Pg(i.current,r.eventHandlers),rT(i.current,n),OR(i.current,r),i}}function DR(e,t){const r=Ng(e),n=PR(r,t);return kR(n)}function nT(e,t){const r=Ng(e,t),n=LR(r);return CR(n)}function FR(e,t){const r=Ng(e,t),n=NR(r);return RR(n)}function bR(e,t,r){const{opacity:n,zIndex:i}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),i!=null&&i!==r.zIndex&&e.setZIndex(i)}function iT(){return O0().map}const sT=nT(function({center:t,children:r,...n},i){const s=new ju.CircleMarker(t,n);return D0(s,Q2(i,{overlayContainer:s}))},wR),aT=nT(function({data:t,...r},n){const i=new ju.GeoJSON(t,r);return D0(i,Q2(n,{overlayContainer:i}))},function(t,r,n){r.style!==n.style&&(r.style==null?t.resetStyle():t.setStyle(r.style))});function tm(){return tm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tm.apply(this,arguments)}function MR({bounds:e,boundsOptions:t,center:r,children:n,className:i,id:s,placeholder:o,style:l,whenReady:u,zoom:h,...p},m){const[_]=_e.useState({className:i,id:s,style:l}),[v,E]=_e.useState(null);_e.useImperativeHandle(m,()=>(v==null?void 0:v.map)??null,[v]);const y=_e.useCallback(k=>{if(k!==null&&v===null){const C=new ju.Map(k,p);r!=null&&h!=null?C.setView(r,h):e!=null&&C.fitBounds(e,t),u!=null&&C.whenReady(u),E(IR(C))}},[]);_e.useEffect(()=>()=>{v==null||v.map.remove()},[v]);const w=v?Ka.createElement(tT,{value:v},n):o??null;return Ka.createElement("div",tm({},_,{ref:y}),w)}const oT=_e.forwardRef(MR),lT=FR(function({url:t,...r},n){const i=new ju.TileLayer(t,L0(r,n));return D0(i,n)},function(t,r,n){bR(t,r,n);const{url:i}=r;i!=null&&i!==n.url&&t.setUrl(i)}),jh=DR(function(t,r){const n=new ju.Tooltip(t,r.overlayContainer);return D0(n,r)},function(t,r,{position:n},i){_e.useEffect(function(){const o=r.overlayContainer;if(o==null)return;const{instance:l}=t,u=p=>{p.tooltip===l&&(n!=null&&l.setLatLng(n),l.update(),i(!0))},h=p=>{p.tooltip===l&&i(!1)};return o.on({tooltipopen:u,tooltipclose:h}),o.bindTooltip(l),function(){o.off({tooltipopen:u,tooltipclose:h}),o._map!=null&&o.unbindTooltip()}},[t,r,i,n])});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var cT=1252,BR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Og={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Lg=function(e){BR.indexOf(e)!=-1&&(cT=Og[0]=e)};function UR(){Lg(1252)}var Fi=function(e){Lg(e)};function uT(){Fi(1200),UR()}function wv(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function VR(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function fT(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var wc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?VR(e.slice(2)):t==254&&r==255?fT(e.slice(2)):t==65279?e.slice(1):e},Vf=function(t){return String.fromCharCode(t)},Sv=function(t){return String.fromCharCode(t)},yu,ra="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Iv(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0,u=0,h=0;h<e.length;)r=e.charCodeAt(h++),s=r>>2,n=e.charCodeAt(h++),o=(r&3)<<4|n>>4,i=e.charCodeAt(h++),l=(n&15)<<2|i>>6,u=i&63,isNaN(n)?l=u=64:isNaN(i)&&(u=64),t+=ra.charAt(s)+ra.charAt(o)+ra.charAt(l)+ra.charAt(u);return t}function Jn(e){var t="",r=0,n=0,i=0,s=0,o=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)s=ra.indexOf(e.charAt(h++)),o=ra.indexOf(e.charAt(h++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=ra.indexOf(e.charAt(h++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),u=ra.indexOf(e.charAt(h++)),i=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var _t=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),co=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function xa(e){return _t?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Cv(e){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Di=function(t){return _t?co(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function uo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Dg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Dg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Js=_t?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:co(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function zR(e){for(var t=[],r=0,n=e.length+250,i=xa(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=xa(65535),n=65530)}return t.push(i.slice(0,r)),Js(t)}var An=/\u0000/g,Sc=/[\u0001-\u0006]/g;function fl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function bi(e,t){var r=""+e;return r.length>=t?r:ar("0",t-r.length)+r}function Fg(e,t){var r=""+e;return r.length>=t?r:ar(" ",t-r.length)+r}function Hh(e,t){var r=""+e;return r.length>=t?r:r+ar(" ",t-r.length)}function jR(e,t){var r=""+Math.round(e);return r.length>=t?r:ar("0",t-r.length)+r}function HR(e,t){var r=""+e;return r.length>=t?r:ar("0",t-r.length)+r}var kv=Math.pow(2,32);function Bo(e,t){if(e>kv||e<-kv)return jR(e,t);var r=Math.round(e);return HR(r,t)}function Wh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Rv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Fd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function WR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Pv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},GR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gh(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,l=0,u=1,h=0,p=0,m=Math.floor(i);h<t&&(m=Math.floor(i),l=m*o+s,p=m*h+u,!(i-m<5e-8));)i=1/(i-m),s=o,o=l,u=h,h=p;if(p>t&&(h>t?(p=u,l=s):(p=h,l=o)),!r)return[0,n*l,p];var _=Math.floor(n*l/p);return[_,n*l-_*p,p]}function Va(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),n<60&&(s=(s+6)%7),r&&(s=YR(u,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}var hT=new Date(1899,11,31,0,0,0),$R=hT.getTime(),ZR=new Date(1900,2,1,0,0,0);function dT(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=ZR&&(r+=24*60*60*1e3),(r-($R+(e.getTimezoneOffset()-hT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function bg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function KR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function XR(e){var t=e<0?12:11,r=bg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function qR(e){var t=bg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Eu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=XR(e):t===10?r=e.toFixed(10).substr(0,12):r=qR(e),bg(KR(r.toUpperCase()))}function eo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Eu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ei(14,dT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function YR(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function JR(e,t,r,n){var i="",s=0,o=0,l=r.y,u,h=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,h=2;break;default:u=l%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,h=t.length;break;case 3:return Fd[r.m-1][1];case 5:return Fd[r.m-1][0];default:return Fd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,h=t.length;break;case 3:return Rv[r.q][0];default:return Rv[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?bi(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=bi(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:u=l,h=1;break}var p=h>0?bi(u,h):"";return p}function na(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var pT=/%/g;function QR(e,t,r){var n=t.replace(pT,""),i=t.length-n.length;return As(e,n,r*Math.pow(10,2*i))+ar("%",i)}function e4(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return As(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function mT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+mT(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,h,p){return u+h+p.substr(0,(i+s)%i)+"."+p.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var gT=/# (\?+)( ?)\/( ?)(\d+)/;function t4(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?ar(" ",e[1].length+1+e[4].length):Fg(o,e[1].length)+e[2]+"/"+e[3]+bi(l,e[4].length))}function r4(e,t,r){return r+(t===0?"":""+t)+ar(" ",e[1].length+2+e[4].length)}var _T=/^#*0*\.([0#]+)/,vT=/\).*[0#]/,xT=/\(###\) ###\\?-####/;function xn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Nv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ov(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function n4(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function i4(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function hi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(vT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hi("n",n,r):"("+hi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return e4(e,t,r);if(t.indexOf("%")!==-1)return QR(e,t,r);if(t.indexOf("E")!==-1)return mT(t,r);if(t.charCodeAt(0)===36)return"$"+hi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,u=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+Bo(u,t.length);if(t.match(/^[#?]+$/))return i=Bo(r,0),i==="0"&&(i=""),i.length>t.length?i:xn(t.substr(0,t.length-i.length))+i;if(s=t.match(gT))return t4(s,u,h);if(t.match(/^#+0+$/))return h+Bo(u,t.length-t.indexOf("0"));if(s=t.match(_T))return i=Nv(r,s[1].length).replace(/^([^\.]+)$/,"$1."+xn(s[1])).replace(/\.$/,"."+xn(s[1])).replace(/\.(\d*)$/,function(E,y){return"."+y+ar("0",xn(s[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+Nv(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+na(Bo(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hi(e,t,-r):na(""+(Math.floor(r)+n4(r,s[1].length)))+"."+bi(Ov(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return hi(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=fl(hi(e,t.replace(/[\\-]/g,""),r)),o=0,fl(fl(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(t.match(xT))return i=hi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=Gh(u,Math.pow(10,o)-1,!1),i=""+h,p=As("n",s[1],l[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+s[2]+"/"+s[3],p=Hh(l[2],o),p.length<s[4].length&&(p=xn(s[4].substr(s[4].length-p.length))+p),i+=p,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=Gh(u,Math.pow(10,o)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Fg(l[1],o)+s[2]+"/"+s[3]+Hh(l[2],o):ar(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Bo(r,0),t.length<=i.length?i:xn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,_=t.length-i.length-m;return xn(t.substr(0,m)+i+t.substr(t.length-_))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=Ov(r,s[1].length),r<0?"-"+hi(e,t,-r):na(i4(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?bi(0,3-E.length):"")+E})+"."+bi(o,s[1].length);switch(t){case"###,##0.00":return hi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=na(Bo(u,0));return v!=="0"?h+v:"";case"###,###.00":return hi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return hi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function s4(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return As(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function a4(e,t,r){var n=t.replace(pT,""),i=t.length-n.length;return As(e,n,r*Math.pow(10,2*i))+ar("%",i)}function yT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+yT(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,h,p){return u+h+p.substr(0,(i+s)%i)+"."+p.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ki(e,t,r){if(e.charCodeAt(0)===40&&!t.match(vT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ki("n",n,r):"("+Ki("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return s4(e,t,r);if(t.indexOf("%")!==-1)return a4(e,t,r);if(t.indexOf("E")!==-1)return yT(t,r);if(t.charCodeAt(0)===36)return"$"+Ki(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,u=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+bi(u,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:xn(t.substr(0,t.length-i.length))+i;if(s=t.match(gT))return r4(s,u,h);if(t.match(/^#+0+$/))return h+bi(u,t.length-t.indexOf("0"));if(s=t.match(_T))return i=(""+r).replace(/^([^\.]+)$/,"$1."+xn(s[1])).replace(/\.$/,"."+xn(s[1])),i=i.replace(/\.(\d*)$/,function(E,y){return"."+y+ar("0",xn(s[1]).length-y.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+na(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ki(e,t,-r):na(""+r)+"."+ar("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ki(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=fl(Ki(e,t.replace(/[\\-]/g,""),r)),o=0,fl(fl(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(t.match(xT))return i=Ki(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=Gh(u,Math.pow(10,o)-1,!1),i=""+h,p=As("n",s[1],l[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+s[2]+"/"+s[3],p=Hh(l[2],o),p.length<s[4].length&&(p=xn(s[4].substr(s[4].length-p.length))+p),i+=p,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=Gh(u,Math.pow(10,o)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Fg(l[1],o)+s[2]+"/"+s[3]+Hh(l[2],o):ar(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:xn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,_=t.length-i.length-m;return xn(t.substr(0,m)+i+t.substr(t.length-_))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ki(e,t,-r):na(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?bi(0,3-E.length):"")+E})+"."+bi(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=na(""+u);return v!=="0"?h+v:"";default:if(t.match(/\.[0#?]*$/))return Ki(e,t.slice(0,t.lastIndexOf(".")),r)+xn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function As(e,t,r){return(r|0)===r?Ki(e,t,r):hi(e,t,r)}function o4(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ET=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function bl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Wh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ET))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function l4(e,t,r,n){for(var i=[],s="",o=0,l="",u="t",h,p,m,_="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Wh(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(m=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(m);i[i.length]={t:"t",v:s},++o;break;case"\\":var v=e.charAt(++o),E=v==="("||v===")"?v:"t";i[i.length]={t:E,v},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(h==null&&(h=Va(t,r,e.charAt(o+1)==="2"),h==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},u=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=Va(t,r),h==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=_),i[i.length]={t:l,v:s},u=l;break;case"A":case"a":case"":var y={t:l,v:l};if(h==null&&(h=Va(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(y.v=h.H>=12?"P":"A"),y.t="T",_="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(y.v=h.H>=12?"PM":"AM"),y.t="T",o+=5,_="h"):e.substr(o,5).toUpperCase()==="/"?(h!=null&&(y.v=h.H>=12?"":""),y.t="T",o+=5,_="h"):(y.t="t",++o),h==null&&y.t==="T")return"";i[i.length]=y,u=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ET)){if(h==null&&(h=Va(t,r),h==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",bl(e)||(i[i.length]={t:"t",v:s}));break;case".":if(h!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;i[i.length]={t:l,v:s},u=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var w=0,k=0,C;for(o=i.length-1,u="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=_,u="h",w<1&&(w=1);break;case"s":(C=i[o].v.match(/\.0+$/))&&(k=Math.max(k,C[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":u=i[o].t;break;case"m":u==="s"&&(i[o].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[o].v.match(/[Hh]/)&&(w=1),w<2&&i[o].v.match(/[Mm]/)&&(w=2),w<3&&i[o].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var A="",U;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=JR(i[o].t.charCodeAt(0),i[o].v,h,k),i[o].t="t";break;case"n":case"?":for(U=o+1;i[U]!=null&&((l=i[U].t)==="?"||l==="D"||(l===" "||l==="t")&&i[U+1]!=null&&(i[U+1].t==="?"||i[U+1].t==="t"&&i[U+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[U].v==="/"||i[U].v===" "&&i[U+1]!=null&&i[U+1].t=="?"));)i[o].v+=i[U].v,i[U]={v:"",t:";"},++U;A+=i[o].v,o=U-1;break;case"G":i[o].t="t",i[o].v=eo(t,r);break}var q="",K,S;if(A.length>0){A.charCodeAt(0)==40?(K=t<0&&A.charCodeAt(0)===45?-t:t,S=As("n",A,K)):(K=t<0&&n>1?-t:t,S=As("n",A,K),K<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),U=S.length-1;var R=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){R=o;break}var P=i.length;if(R===i.length&&S.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(U>=i[o].v.length-1?(U-=i[o].v.length,i[o].v=S.substr(U+1,i[o].v.length)):U<0?i[o].v="":(i[o].v=S.substr(0,U+1),U=-1),i[o].t="t",P=o);U>=0&&P<i.length&&(i[P].v=S.substr(0,U+1)+i[P].v)}else if(R!==i.length&&S.indexOf("E")===-1){for(U=S.indexOf(".")-1,o=R;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(p=i[o].v.indexOf(".")>-1&&o===R?i[o].v.indexOf(".")-1:i[o].v.length-1,q=i[o].v.substr(p+1);p>=0;--p)U>=0&&(i[o].v.charAt(p)==="0"||i[o].v.charAt(p)==="#")&&(q=S.charAt(U--)+q);i[o].v=q,i[o].t="t",P=o}for(U>=0&&P<i.length&&(i[P].v=S.substr(0,U+1)+i[P].v),U=S.indexOf(".")+1,o=R;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==R)){for(p=i[o].v.indexOf(".")>-1&&o===R?i[o].v.indexOf(".")+1:0,q=i[o].v.substr(0,p);p<i[o].v.length;++p)U<S.length&&(q+=S.charAt(U++));i[o].v=q,i[o].t="t",P=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(K=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=As(i[o].t,i[o].v,K),i[o].t="t");var D="";for(o=0;o!==i.length;++o)i[o]!=null&&(D+=i[o].v);return D}var Lv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Dv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function c4(e,t){var r=o4(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Lv),l=r[1].match(Lv);return Dv(t,o)?[n,r[0]]:Dv(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Ei(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ut)[e],n==null&&(n=r.table&&r.table[Pv[e]]||ut[Pv[e]]),n==null&&(n=GR[e]||"General");break}if(Wh(n,0))return eo(t,r);t instanceof Date&&(t=dT(t,r.date1904));var i=c4(n,t);if(Wh(i[1]))return eo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return l4(i[1],t,r,i[0])}function Ga(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ut[r]==null){t<0&&(t=r);continue}if(ut[r]==e){t=r;break}}t<0&&(t=391)}return ut[t]=e,t}function TT(){ut=WR()}var u4={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},AT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function f4(e){var t=typeof e=="number"?ut[e]:e;return t=t.replace(AT,"(\\d+)"),new RegExp("^"+t+"$")}function h4(e,t,r){var n=-1,i=-1,s=-1,o=-1,l=-1,u=-1;(t.match(AT)||[]).forEach(function(m,_){var v=parseInt(r[_+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=v;break;case"d":s=v;break;case"h":o=v;break;case"s":u=v;break;case"m":o>=0?l=v:i=v;break}}),u>=0&&l==-1&&i>=0&&(l=i,i=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&l==-1&&u==-1?h:n==-1&&i==-1&&s==-1?p:h+"T"+p}var d4=function(){var e={};e.version="1.2.0";function t(){for(var S=0,R=new Array(256),P=0;P!=256;++P)S=P,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,R[P]=S;return typeof Int32Array<"u"?new Int32Array(R):R}var r=t();function n(S){var R=0,P=0,D=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)F[D]=S[D];for(D=0;D!=256;++D)for(P=S[D],R=256+D;R<4096;R+=256)P=F[R]=P>>>8^S[P&255];var b=[];for(D=1;D!=16;++D)b[D-1]=typeof Int32Array<"u"?F.subarray(D*256,D*256+256):F.slice(D*256,D*256+256);return b}var i=n(r),s=i[0],o=i[1],l=i[2],u=i[3],h=i[4],p=i[5],m=i[6],_=i[7],v=i[8],E=i[9],y=i[10],w=i[11],k=i[12],C=i[13],A=i[14];function U(S,R){for(var P=R^-1,D=0,F=S.length;D<F;)P=P>>>8^r[(P^S.charCodeAt(D++))&255];return~P}function q(S,R){for(var P=R^-1,D=S.length-15,F=0;F<D;)P=A[S[F++]^P&255]^C[S[F++]^P>>8&255]^k[S[F++]^P>>16&255]^w[S[F++]^P>>>24]^y[S[F++]]^E[S[F++]]^v[S[F++]]^_[S[F++]]^m[S[F++]]^p[S[F++]]^h[S[F++]]^u[S[F++]]^l[S[F++]]^o[S[F++]]^s[S[F++]]^r[S[F++]];for(D+=15;F<D;)P=P>>>8^r[(P^S[F++])&255];return~P}function K(S,R){for(var P=R^-1,D=0,F=S.length,b=0,M=0;D<F;)b=S.charCodeAt(D++),b<128?P=P>>>8^r[(P^b)&255]:b<2048?(P=P>>>8^r[(P^(192|b>>6&31))&255],P=P>>>8^r[(P^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,M=S.charCodeAt(D++)&1023,P=P>>>8^r[(P^(240|b>>8&7))&255],P=P>>>8^r[(P^(128|b>>2&63))&255],P=P>>>8^r[(P^(128|M>>6&15|(b&3)<<4))&255],P=P>>>8^r[(P^(128|M&63))&255]):(P=P>>>8^r[(P^(224|b>>12&15))&255],P=P>>>8^r[(P^(128|b>>6&63))&255],P=P>>>8^r[(P^(128|b&63))&255]);return~P}return e.table=r,e.bstr=U,e.buf=q,e.str=K,e}(),yt=function(){var t={};t.version="1.2.1";function r(N,G){for(var V=N.split("/"),z=G.split("/"),Z=0,X=0,se=Math.min(V.length,z.length);Z<se;++Z){if(X=V[Z].length-z[Z].length)return X;if(V[Z]!=z[Z])return V[Z]<z[Z]?-1:1}return V.length-z.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var G=N.lastIndexOf("/");return G===-1?N:N.slice(0,G+1)}function i(N){if(N.charAt(N.length-1)=="/")return i(N.slice(0,-1));var G=N.lastIndexOf("/");return G===-1?N:N.slice(G+1)}function s(N,G){typeof G=="string"&&(G=new Date(G));var V=G.getHours();V=V<<6|G.getMinutes(),V=V<<5|G.getSeconds()>>>1,N.write_shift(2,V);var z=G.getFullYear()-1980;z=z<<4|G.getMonth()+1,z=z<<5|G.getDate(),N.write_shift(2,z)}function o(N){var G=N.read_shift(2)&65535,V=N.read_shift(2)&65535,z=new Date,Z=V&31;V>>>=5;var X=V&15;V>>>=4,z.setMilliseconds(0),z.setFullYear(V+1980),z.setMonth(X-1),z.setDate(Z);var se=G&31;G>>>=5;var ge=G&63;return G>>>=6,z.setHours(G),z.setMinutes(ge),z.setSeconds(se<<1),z}function l(N){Wr(N,0);for(var G={},V=0;N.l<=N.length-4;){var z=N.read_shift(2),Z=N.read_shift(2),X=N.l+Z,se={};switch(z){case 21589:V=N.read_shift(1),V&1&&(se.mtime=N.read_shift(4)),Z>5&&(V&2&&(se.atime=N.read_shift(4)),V&4&&(se.ctime=N.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}N.l=X,G[z]=se}return G}var u;function h(){return u||(u={})}function p(N,G){if(N[0]==80&&N[1]==75)return Cn(N,G);if((N[0]|32)==109&&(N[1]|32)==105)return Ms(N,G);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var V=3,z=512,Z=0,X=0,se=0,ge=0,oe=0,ce=[],ue=N.slice(0,512);Wr(ue,0);var Te=m(ue);switch(V=Te[0],V){case 3:z=512;break;case 4:z=4096;break;case 0:if(Te[1]==0)return Cn(N,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+V)}z!==512&&(ue=N.slice(0,z),Wr(ue,28));var Oe=N.slice(0,z);_(ue,V);var Be=ue.read_shift(4,"i");if(V===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);ue.l+=4,se=ue.read_shift(4,"i"),ue.l+=4,ue.chk("00100000","Mini Stream Cutoff Size: "),ge=ue.read_shift(4,"i"),Z=ue.read_shift(4,"i"),oe=ue.read_shift(4,"i"),X=ue.read_shift(4,"i");for(var we=-1,be=0;be<109&&(we=ue.read_shift(4,"i"),!(we<0));++be)ce[be]=we;var Ye=v(N,z);w(oe,X,Ye,z,ce);var Pt=C(Ye,se,ce,z);Pt[se].name="!Directory",Z>0&&ge!==M&&(Pt[ge].name="!MiniFAT"),Pt[ce[0]].name="!FAT",Pt.fat_addrs=ce,Pt.ssz=z;var Ct={},zt=[],Bn=[],Un=[];A(se,Pt,Ye,zt,Z,Ct,Bn,ge),E(Bn,Un,zt),zt.shift();var wi={FileIndex:Bn,FullPaths:Un};return G&&G.raw&&(wi.raw={header:Oe,sectors:Ye}),wi}function m(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Ce,"Header Signature: "),N.l+=16;var G=N.read_shift(2,"u");return[N.read_shift(2,"u"),G]}function _(N,G){var V=9;switch(N.l+=2,V=N.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+V);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+V);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+V)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function v(N,G){for(var V=Math.ceil(N.length/G)-1,z=[],Z=1;Z<V;++Z)z[Z-1]=N.slice(Z*G,(Z+1)*G);return z[V-1]=N.slice(V*G),z}function E(N,G,V){for(var z=0,Z=0,X=0,se=0,ge=0,oe=V.length,ce=[],ue=[];z<oe;++z)ce[z]=ue[z]=z,G[z]=V[z];for(;ge<ue.length;++ge)z=ue[ge],Z=N[z].L,X=N[z].R,se=N[z].C,ce[z]===z&&(Z!==-1&&ce[Z]!==Z&&(ce[z]=ce[Z]),X!==-1&&ce[X]!==X&&(ce[z]=ce[X])),se!==-1&&(ce[se]=z),Z!==-1&&z!=ce[z]&&(ce[Z]=ce[z],ue.lastIndexOf(Z)<ge&&ue.push(Z)),X!==-1&&z!=ce[z]&&(ce[X]=ce[z],ue.lastIndexOf(X)<ge&&ue.push(X));for(z=1;z<oe;++z)ce[z]===z&&(X!==-1&&ce[X]!==X?ce[z]=ce[X]:Z!==-1&&ce[Z]!==Z&&(ce[z]=ce[Z]));for(z=1;z<oe;++z)if(N[z].type!==0){if(ge=z,ge!=ce[ge])do ge=ce[ge],G[z]=G[ge]+"/"+G[z];while(ge!==0&&ce[ge]!==-1&&ge!=ce[ge]);ce[z]=-1}for(G[0]+="/",z=1;z<oe;++z)N[z].type!==2&&(G[z]+="/")}function y(N,G,V){for(var z=N.start,Z=N.size,X=[],se=z;V&&Z>0&&se>=0;)X.push(G.slice(se*b,se*b+b)),Z-=b,se=ba(V,se*4);return X.length===0?Ar(0):Js(X).slice(0,N.size)}function w(N,G,V,z,Z){var X=M;if(N===M){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var se=V[N],ge=(z>>>2)-1;if(!se)return;for(var oe=0;oe<ge&&(X=ba(se,oe*4))!==M;++oe)Z.push(X);w(ba(se,z-4),G-1,V,z,Z)}}function k(N,G,V,z,Z){var X=[],se=[];Z||(Z=[]);var ge=z-1,oe=0,ce=0;for(oe=G;oe>=0;){Z[oe]=!0,X[X.length]=oe,se.push(N[oe]);var ue=V[Math.floor(oe*4/z)];if(ce=oe*4&ge,z<4+ce)throw new Error("FAT boundary crossed: "+oe+" 4 "+z);if(!N[ue])break;oe=ba(N[ue],ce)}return{nodes:X,data:Wv([se])}}function C(N,G,V,z){var Z=N.length,X=[],se=[],ge=[],oe=[],ce=z-1,ue=0,Te=0,Oe=0,Be=0;for(ue=0;ue<Z;++ue)if(ge=[],Oe=ue+G,Oe>=Z&&(Oe-=Z),!se[Oe]){oe=[];var we=[];for(Te=Oe;Te>=0;){we[Te]=!0,se[Te]=!0,ge[ge.length]=Te,oe.push(N[Te]);var be=V[Math.floor(Te*4/z)];if(Be=Te*4&ce,z<4+Be)throw new Error("FAT boundary crossed: "+Te+" 4 "+z);if(!N[be]||(Te=ba(N[be],Be),we[Te]))break}X[Oe]={nodes:ge,data:Wv([oe])}}return X}function A(N,G,V,z,Z,X,se,ge){for(var oe=0,ce=z.length?2:0,ue=G[N].data,Te=0,Oe=0,Be;Te<ue.length;Te+=128){var we=ue.slice(Te,Te+128);Wr(we,64),Oe=we.read_shift(2),Be=zg(we,0,Oe-ce),z.push(Be);var be={name:Be,type:we.read_shift(1),color:we.read_shift(1),L:we.read_shift(4,"i"),R:we.read_shift(4,"i"),C:we.read_shift(4,"i"),clsid:we.read_shift(16),state:we.read_shift(4,"i"),start:0,size:0},Ye=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);Ye!==0&&(be.ct=U(we,we.l-8));var Pt=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);Pt!==0&&(be.mt=U(we,we.l-8)),be.start=we.read_shift(4,"i"),be.size=we.read_shift(4,"i"),be.size<0&&be.start<0&&(be.size=be.type=0,be.start=M,be.name=""),be.type===5?(oe=be.start,Z>0&&oe!==M&&(G[oe].name="!StreamData")):be.size>=4096?(be.storage="fat",G[be.start]===void 0&&(G[be.start]=k(V,be.start,G.fat_addrs,G.ssz)),G[be.start].name=be.name,be.content=G[be.start].data.slice(0,be.size)):(be.storage="minifat",be.size<0?be.size=0:oe!==M&&be.start!==M&&G[oe]&&(be.content=y(be,G[oe].data,(G[ge]||{}).data))),be.content&&Wr(be.content,0),X[Be]=be,se.push(be)}}function U(N,G){return new Date((Gn(N,G+4)/1e7*Math.pow(2,32)+Gn(N,G)/1e7-11644473600)*1e3)}function q(N,G){return h(),p(u.readFileSync(N),G)}function K(N,G){var V=G&&G.type;switch(V||_t&&Buffer.isBuffer(N)&&(V="buffer"),V||"base64"){case"file":return q(N,G);case"base64":return p(Di(Jn(N)),G);case"binary":return p(Di(N),G)}return p(N,G)}function S(N,G){var V=G||{},z=V.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=z+"/",N.FileIndex[0]={name:z,type:5}),V.CLSID&&(N.FileIndex[0].clsid=V.CLSID),R(N)}function R(N){var G="Sh33tJ5";if(!yt.find(N,"/"+G)){var V=Ar(4);V[0]=55,V[1]=V[3]=50,V[2]=54,N.FileIndex.push({name:G,type:2,content:V,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+G),P(N)}}function P(N,G){S(N);for(var V=!1,z=!1,Z=N.FullPaths.length-1;Z>=0;--Z){var X=N.FileIndex[Z];switch(X.type){case 0:z?V=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(X.R*X.L*X.C)&&(V=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(V=!0);break;default:V=!0;break}}if(!(!V&&!G)){var se=new Date(1987,1,19),ge=0,oe=Object.create?Object.create(null):{},ce=[];for(Z=0;Z<N.FullPaths.length;++Z)oe[N.FullPaths[Z]]=!0,N.FileIndex[Z].type!==0&&ce.push([N.FullPaths[Z],N.FileIndex[Z]]);for(Z=0;Z<ce.length;++Z){var ue=n(ce[Z][0]);z=oe[ue],z||(ce.push([ue,{name:i(ue).replace("/",""),type:1,clsid:Re,ct:se,mt:se,content:null}]),oe[ue]=!0)}for(ce.sort(function(Be,we){return r(Be[0],we[0])}),N.FullPaths=[],N.FileIndex=[],Z=0;Z<ce.length;++Z)N.FullPaths[Z]=ce[Z][0],N.FileIndex[Z]=ce[Z][1];for(Z=0;Z<ce.length;++Z){var Te=N.FileIndex[Z],Oe=N.FullPaths[Z];if(Te.name=i(Oe).replace("/",""),Te.L=Te.R=Te.C=-(Te.color=1),Te.size=Te.content?Te.content.length:0,Te.start=0,Te.clsid=Te.clsid||Re,Z===0)Te.C=ce.length>1?1:-1,Te.size=0,Te.type=5;else if(Oe.slice(-1)=="/"){for(ge=Z+1;ge<ce.length&&n(N.FullPaths[ge])!=Oe;++ge);for(Te.C=ge>=ce.length?-1:ge,ge=Z+1;ge<ce.length&&n(N.FullPaths[ge])!=n(Oe);++ge);Te.R=ge>=ce.length?-1:ge,Te.type=1}else n(N.FullPaths[Z+1]||"")==n(Oe)&&(Te.R=Z+1),Te.type=2}}}function D(N,G){var V=G||{};if(V.fileType=="mad")return Tr(N,V);switch(P(N),V.fileType){case"zip":return Or(N,V)}var z=function(Be){for(var we=0,be=0,Ye=0;Ye<Be.FileIndex.length;++Ye){var Pt=Be.FileIndex[Ye];if(Pt.content){var Ct=Pt.content.length;Ct>0&&(Ct<4096?we+=Ct+63>>6:be+=Ct+511>>9)}}for(var zt=Be.FullPaths.length+3>>2,Bn=we+7>>3,Un=we+127>>7,wi=Bn+be+zt+Un,Vn=wi+127>>7,ni=Vn<=109?0:Math.ceil((Vn-109)/127);wi+Vn+ni+127>>7>Vn;)ni=++Vn<=109?0:Math.ceil((Vn-109)/127);var rt=[1,ni,Vn,Un,zt,be,we,0];return Be.FileIndex[0].size=we<<6,rt[7]=(Be.FileIndex[0].start=rt[0]+rt[1]+rt[2]+rt[3]+rt[4]+rt[5])+(rt[6]+7>>3),rt}(N),Z=Ar(z[7]<<9),X=0,se=0;{for(X=0;X<8;++X)Z.write_shift(1,Ie[X]);for(X=0;X<8;++X)Z.write_shift(2,0);for(Z.write_shift(2,62),Z.write_shift(2,3),Z.write_shift(2,65534),Z.write_shift(2,9),Z.write_shift(2,6),X=0;X<3;++X)Z.write_shift(2,0);for(Z.write_shift(4,0),Z.write_shift(4,z[2]),Z.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),Z.write_shift(4,0),Z.write_shift(4,4096),Z.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:M),Z.write_shift(4,z[3]),Z.write_shift(-4,z[1]?z[0]-1:M),Z.write_shift(4,z[1]),X=0;X<109;++X)Z.write_shift(-4,X<z[2]?z[1]+X:-1)}if(z[1])for(se=0;se<z[1];++se){for(;X<236+se*127;++X)Z.write_shift(-4,X<z[2]?z[1]+X:-1);Z.write_shift(-4,se===z[1]-1?M:se+1)}var ge=function(Be){for(se+=Be;X<se-1;++X)Z.write_shift(-4,X+1);Be&&(++X,Z.write_shift(-4,M))};for(se=X=0,se+=z[1];X<se;++X)Z.write_shift(-4,ke.DIFSECT);for(se+=z[2];X<se;++X)Z.write_shift(-4,ke.FATSECT);ge(z[3]),ge(z[4]);for(var oe=0,ce=0,ue=N.FileIndex[0];oe<N.FileIndex.length;++oe)ue=N.FileIndex[oe],ue.content&&(ce=ue.content.length,!(ce<4096)&&(ue.start=se,ge(ce+511>>9)));for(ge(z[6]+7>>3);Z.l&511;)Z.write_shift(-4,ke.ENDOFCHAIN);for(se=X=0,oe=0;oe<N.FileIndex.length;++oe)ue=N.FileIndex[oe],ue.content&&(ce=ue.content.length,!(!ce||ce>=4096)&&(ue.start=se,ge(ce+63>>6)));for(;Z.l&511;)Z.write_shift(-4,ke.ENDOFCHAIN);for(X=0;X<z[4]<<2;++X){var Te=N.FullPaths[X];if(!Te||Te.length===0){for(oe=0;oe<17;++oe)Z.write_shift(4,0);for(oe=0;oe<3;++oe)Z.write_shift(4,-1);for(oe=0;oe<12;++oe)Z.write_shift(4,0);continue}ue=N.FileIndex[X],X===0&&(ue.start=ue.size?ue.start-1:M);var Oe=X===0&&V.root||ue.name;if(ce=2*(Oe.length+1),Z.write_shift(64,Oe,"utf16le"),Z.write_shift(2,ce),Z.write_shift(1,ue.type),Z.write_shift(1,ue.color),Z.write_shift(-4,ue.L),Z.write_shift(-4,ue.R),Z.write_shift(-4,ue.C),ue.clsid)Z.write_shift(16,ue.clsid,"hex");else for(oe=0;oe<4;++oe)Z.write_shift(4,0);Z.write_shift(4,ue.state||0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,ue.start),Z.write_shift(4,ue.size),Z.write_shift(4,0)}for(X=1;X<N.FileIndex.length;++X)if(ue=N.FileIndex[X],ue.size>=4096)if(Z.l=ue.start+1<<9,_t&&Buffer.isBuffer(ue.content))ue.content.copy(Z,Z.l,0,ue.size),Z.l+=ue.size+511&-512;else{for(oe=0;oe<ue.size;++oe)Z.write_shift(1,ue.content[oe]);for(;oe&511;++oe)Z.write_shift(1,0)}for(X=1;X<N.FileIndex.length;++X)if(ue=N.FileIndex[X],ue.size>0&&ue.size<4096)if(_t&&Buffer.isBuffer(ue.content))ue.content.copy(Z,Z.l,0,ue.size),Z.l+=ue.size+63&-64;else{for(oe=0;oe<ue.size;++oe)Z.write_shift(1,ue.content[oe]);for(;oe&63;++oe)Z.write_shift(1,0)}if(_t)Z.l=Z.length;else for(;Z.l<Z.length;)Z.write_shift(1,0);return Z}function F(N,G){var V=N.FullPaths.map(function(oe){return oe.toUpperCase()}),z=V.map(function(oe){var ce=oe.split("/");return ce[ce.length-(oe.slice(-1)=="/"?2:1)]}),Z=!1;G.charCodeAt(0)===47?(Z=!0,G=V[0].slice(0,-1)+G):Z=G.indexOf("/")!==-1;var X=G.toUpperCase(),se=Z===!0?V.indexOf(X):z.indexOf(X);if(se!==-1)return N.FileIndex[se];var ge=!X.match(Sc);for(X=X.replace(An,""),ge&&(X=X.replace(Sc,"!")),se=0;se<V.length;++se)if((ge?V[se].replace(Sc,"!"):V[se]).replace(An,"")==X||(ge?z[se].replace(Sc,"!"):z[se]).replace(An,"")==X)return N.FileIndex[se];return null}var b=64,M=-2,Ce="d0cf11e0a1b11ae1",Ie=[208,207,17,224,161,177,26,225],Re="00000000000000000000000000000000",ke={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(N,G,V){h();var z=D(N,V);u.writeFileSync(G,z)}function te(N){for(var G=new Array(N.length),V=0;V<N.length;++V)G[V]=String.fromCharCode(N[V]);return G.join("")}function de(N,G){var V=D(N,G);switch(G&&G.type||"buffer"){case"file":return h(),u.writeFileSync(G.filename,V),V;case"binary":return typeof V=="string"?V:te(V);case"base64":return Iv(typeof V=="string"?V:te(V));case"buffer":if(_t)return Buffer.isBuffer(V)?V:co(V);case"array":return typeof V=="string"?Di(V):V}return V}var Ee;function j(N){try{var G=N.InflateRaw,V=new G;if(V._processChunk(new Uint8Array([3,0]),V._finishFlushFlag),V.bytesRead)Ee=N;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function re(N,G){if(!Ee)return pr(N,G);var V=Ee.InflateRaw,z=new V,Z=z._processChunk(N.slice(N.l),z._finishFlushFlag);return N.l+=z.bytesRead,Z}function Q(N){return Ee?Ee.deflateRawSync(N):et(N)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ne(N){var G=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(G>>16|G>>8|G)&255}for(var ee=typeof Uint8Array<"u",me=ee?new Uint8Array(256):[],Fe=0;Fe<256;++Fe)me[Fe]=Ne(Fe);function H(N,G){var V=me[N&255];return G<=8?V>>>8-G:(V=V<<8|me[N>>8&255],G<=16?V>>>16-G:(V=V<<8|me[N>>16&255],V>>>24-G))}function Ve(N,G){var V=G&7,z=G>>>3;return(N[z]|(V<=6?0:N[z+1]<<8))>>>V&3}function je(N,G){var V=G&7,z=G>>>3;return(N[z]|(V<=5?0:N[z+1]<<8))>>>V&7}function tt(N,G){var V=G&7,z=G>>>3;return(N[z]|(V<=4?0:N[z+1]<<8))>>>V&15}function Ze(N,G){var V=G&7,z=G>>>3;return(N[z]|(V<=3?0:N[z+1]<<8))>>>V&31}function Pe(N,G){var V=G&7,z=G>>>3;return(N[z]|(V<=1?0:N[z+1]<<8))>>>V&127}function ne(N,G,V){var z=G&7,Z=G>>>3,X=(1<<V)-1,se=N[Z]>>>z;return V<8-z||(se|=N[Z+1]<<8-z,V<16-z)||(se|=N[Z+2]<<16-z,V<24-z)||(se|=N[Z+3]<<24-z),se&X}function De(N,G,V){var z=G&7,Z=G>>>3;return z<=5?N[Z]|=(V&7)<<z:(N[Z]|=V<<z&255,N[Z+1]=(V&7)>>8-z),G+3}function Me(N,G,V){var z=G&7,Z=G>>>3;return V=(V&1)<<z,N[Z]|=V,G+1}function Qe(N,G,V){var z=G&7,Z=G>>>3;return V<<=z,N[Z]|=V&255,V>>>=8,N[Z+1]=V,G+8}function st(N,G,V){var z=G&7,Z=G>>>3;return V<<=z,N[Z]|=V&255,V>>>=8,N[Z+1]=V&255,N[Z+2]=V>>>8,G+16}function pt(N,G){var V=N.length,z=2*V>G?2*V:G+5,Z=0;if(V>=G)return N;if(_t){var X=Cv(z);if(N.copy)N.copy(X);else for(;Z<N.length;++Z)X[Z]=N[Z];return X}else if(ee){var se=new Uint8Array(z);if(se.set)se.set(N);else for(;Z<V;++Z)se[Z]=N[Z];return se}return N.length=z,N}function mt(N){for(var G=new Array(N),V=0;V<N;++V)G[V]=0;return G}function dr(N,G,V){var z=1,Z=0,X=0,se=0,ge=0,oe=N.length,ce=ee?new Uint16Array(32):mt(32);for(X=0;X<32;++X)ce[X]=0;for(X=oe;X<V;++X)N[X]=0;oe=N.length;var ue=ee?new Uint16Array(oe):mt(oe);for(X=0;X<oe;++X)ce[Z=N[X]]++,z<Z&&(z=Z),ue[X]=0;for(ce[0]=0,X=1;X<=z;++X)ce[X+16]=ge=ge+ce[X-1]<<1;for(X=0;X<oe;++X)ge=N[X],ge!=0&&(ue[X]=ce[ge+16]++);var Te=0;for(X=0;X<oe;++X)if(Te=N[X],Te!=0)for(ge=H(ue[X],z)>>z-Te,se=(1<<z+4-Te)-1;se>=0;--se)G[ge|se<<Te]=Te&15|X<<4;return z}var St=ee?new Uint16Array(512):mt(512),Mt=ee?new Uint16Array(32):mt(32);if(!ee){for(var Ut=0;Ut<512;++Ut)St[Ut]=0;for(Ut=0;Ut<32;++Ut)Mt[Ut]=0}(function(){for(var N=[],G=0;G<32;G++)N.push(5);dr(N,Mt,32);var V=[];for(G=0;G<=143;G++)V.push(8);for(;G<=255;G++)V.push(9);for(;G<=279;G++)V.push(7);for(;G<=287;G++)V.push(8);dr(V,St,288)})();var Nr=function(){for(var G=ee?new Uint8Array(32768):[],V=0,z=0;V<ye.length-1;++V)for(;z<ye[V+1];++z)G[z]=V;for(;z<32768;++z)G[z]=29;var Z=ee?new Uint8Array(259):[];for(V=0,z=0;V<le.length-1;++V)for(;z<le[V+1];++z)Z[z]=V;function X(ge,oe){for(var ce=0;ce<ge.length;){var ue=Math.min(65535,ge.length-ce),Te=ce+ue==ge.length;for(oe.write_shift(1,+Te),oe.write_shift(2,ue),oe.write_shift(2,~ue&65535);ue-- >0;)oe[oe.l++]=ge[ce++]}return oe.l}function se(ge,oe){for(var ce=0,ue=0,Te=ee?new Uint16Array(32768):[];ue<ge.length;){var Oe=Math.min(65535,ge.length-ue);if(Oe<10){for(ce=De(oe,ce,+(ue+Oe==ge.length)),ce&7&&(ce+=8-(ce&7)),oe.l=ce/8|0,oe.write_shift(2,Oe),oe.write_shift(2,~Oe&65535);Oe-- >0;)oe[oe.l++]=ge[ue++];ce=oe.l*8;continue}ce=De(oe,ce,+(ue+Oe==ge.length)+2);for(var Be=0;Oe-- >0;){var we=ge[ue];Be=(Be<<5^we)&32767;var be=-1,Ye=0;if((be=Te[Be])&&(be|=ue&-32768,be>ue&&(be-=32768),be<ue))for(;ge[be+Ye]==ge[ue+Ye]&&Ye<250;)++Ye;if(Ye>2){we=Z[Ye],we<=22?ce=Qe(oe,ce,me[we+1]>>1)-1:(Qe(oe,ce,3),ce+=5,Qe(oe,ce,me[we-23]>>5),ce+=3);var Pt=we<8?0:we-4>>2;Pt>0&&(st(oe,ce,Ye-le[we]),ce+=Pt),we=G[ue-be],ce=Qe(oe,ce,me[we]>>3),ce-=3;var Ct=we<4?0:we-2>>1;Ct>0&&(st(oe,ce,ue-be-ye[we]),ce+=Ct);for(var zt=0;zt<Ye;++zt)Te[Be]=ue&32767,Be=(Be<<5^ge[ue])&32767,++ue;Oe-=Ye-1}else we<=143?we=we+48:ce=Me(oe,ce,1),ce=Qe(oe,ce,me[we]),Te[Be]=ue&32767,++ue}ce=Qe(oe,ce,0)-1}return oe.l=(ce+7)/8|0,oe.l}return function(oe,ce){return oe.length<8?X(oe,ce):se(oe,ce)}}();function et(N){var G=Ar(50+Math.floor(N.length*1.1)),V=Nr(N,G);return G.slice(0,V)}var kt=ee?new Uint16Array(32768):mt(32768),Rt=ee?new Uint16Array(32768):mt(32768),Dt=ee?new Uint16Array(128):mt(128),zr=1,ti=1;function Ke(N,G){var V=Ze(N,G)+257;G+=5;var z=Ze(N,G)+1;G+=5;var Z=tt(N,G)+4;G+=4;for(var X=0,se=ee?new Uint8Array(19):mt(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,ce=ee?new Uint8Array(8):mt(8),ue=ee?new Uint8Array(8):mt(8),Te=se.length,Oe=0;Oe<Z;++Oe)se[Y[Oe]]=X=je(N,G),oe<X&&(oe=X),ce[X]++,G+=3;var Be=0;for(ce[0]=0,Oe=1;Oe<=oe;++Oe)ue[Oe]=Be=Be+ce[Oe-1]<<1;for(Oe=0;Oe<Te;++Oe)(Be=se[Oe])!=0&&(ge[Oe]=ue[Be]++);var we=0;for(Oe=0;Oe<Te;++Oe)if(we=se[Oe],we!=0){Be=me[ge[Oe]]>>8-we;for(var be=(1<<7-we)-1;be>=0;--be)Dt[Be|be<<we]=we&7|Oe<<3}var Ye=[];for(oe=1;Ye.length<V+z;)switch(Be=Dt[Pe(N,G)],G+=Be&7,Be>>>=3){case 16:for(X=3+Ve(N,G),G+=2,Be=Ye[Ye.length-1];X-- >0;)Ye.push(Be);break;case 17:for(X=3+je(N,G),G+=3;X-- >0;)Ye.push(0);break;case 18:for(X=11+Pe(N,G),G+=7;X-- >0;)Ye.push(0);break;default:Ye.push(Be),oe<Be&&(oe=Be);break}var Pt=Ye.slice(0,V),Ct=Ye.slice(V);for(Oe=V;Oe<286;++Oe)Pt[Oe]=0;for(Oe=z;Oe<30;++Oe)Ct[Oe]=0;return zr=dr(Pt,kt,286),ti=dr(Ct,Rt,30),G}function Vt(N,G){if(N[0]==3&&!(N[1]&3))return[xa(G),2];for(var V=0,z=0,Z=Cv(G||1<<18),X=0,se=Z.length>>>0,ge=0,oe=0;!(z&1);){if(z=je(N,V),V+=3,z>>>1)z>>1==1?(ge=9,oe=5):(V=Ke(N,V),ge=zr,oe=ti);else{V&7&&(V+=8-(V&7));var ce=N[V>>>3]|N[(V>>>3)+1]<<8;if(V+=32,ce>0)for(!G&&se<X+ce&&(Z=pt(Z,X+ce),se=Z.length);ce-- >0;)Z[X++]=N[V>>>3],V+=8;continue}for(;;){!G&&se<X+32767&&(Z=pt(Z,X+32767),se=Z.length);var ue=ne(N,V,ge),Te=z>>>1==1?St[ue]:kt[ue];if(V+=Te&15,Te>>>=4,!(Te>>>8&255))Z[X++]=Te;else{if(Te==256)break;Te-=257;var Oe=Te<8?0:Te-4>>2;Oe>5&&(Oe=0);var Be=X+le[Te];Oe>0&&(Be+=ne(N,V,Oe),V+=Oe),ue=ne(N,V,oe),Te=z>>>1==1?Mt[ue]:Rt[ue],V+=Te&15,Te>>>=4;var we=Te<4?0:Te-2>>1,be=ye[Te];for(we>0&&(be+=ne(N,V,we),V+=we),!G&&se<Be&&(Z=pt(Z,Be+100),se=Z.length);X<Be;)Z[X]=Z[X-be],++X}}}return G?[Z,V+7>>>3]:[Z.slice(0,X),V+7>>>3]}function pr(N,G){var V=N.slice(N.l||0),z=Vt(V,G);return N.l+=z[1],z[0]}function lr(N,G){if(N)typeof console<"u"&&console.error(G);else throw new Error(G)}function Cn(N,G){var V=N;Wr(V,0);var z=[],Z=[],X={FileIndex:z,FullPaths:Z};S(X,{root:G.root});for(var se=V.length-4;(V[se]!=80||V[se+1]!=75||V[se+2]!=5||V[se+3]!=6)&&se>=0;)--se;V.l=se+4,V.l+=4;var ge=V.read_shift(2);V.l+=6;var oe=V.read_shift(4);for(V.l=oe,se=0;se<ge;++se){V.l+=20;var ce=V.read_shift(4),ue=V.read_shift(4),Te=V.read_shift(2),Oe=V.read_shift(2),Be=V.read_shift(2);V.l+=8;var we=V.read_shift(4),be=l(V.slice(V.l+Te,V.l+Te+Oe));V.l+=Te+Oe+Be;var Ye=V.l;V.l=we+4,mn(V,ce,ue,X,be),V.l=Ye}return X}function mn(N,G,V,z,Z){N.l+=2;var X=N.read_shift(2),se=N.read_shift(2),ge=o(N);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var oe=N.read_shift(4),ce=N.read_shift(4),ue=N.read_shift(4),Te=N.read_shift(2),Oe=N.read_shift(2),Be="",we=0;we<Te;++we)Be+=String.fromCharCode(N[N.l++]);if(Oe){var be=l(N.slice(N.l,N.l+Oe));(be[21589]||{}).mt&&(ge=be[21589].mt),((Z||{})[21589]||{}).mt&&(ge=Z[21589].mt)}N.l+=Oe;var Ye=N.slice(N.l,N.l+ce);switch(se){case 8:Ye=re(N,ue);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var Pt=!1;X&8&&(oe=N.read_shift(4),oe==134695760&&(oe=N.read_shift(4),Pt=!0),ce=N.read_shift(4),ue=N.read_shift(4)),ce!=G&&lr(Pt,"Bad compressed size: "+G+" != "+ce),ue!=V&&lr(Pt,"Bad uncompressed size: "+V+" != "+ue),Ai(z,Be,Ye,{unsafe:!0,mt:ge})}function Or(N,G){var V=G||{},z=[],Z=[],X=Ar(1),se=V.compression?8:0,ge=0,oe=0,ce=0,ue=0,Te=0,Oe=N.FullPaths[0],Be=Oe,we=N.FileIndex[0],be=[],Ye=0;for(oe=1;oe<N.FullPaths.length;++oe)if(Be=N.FullPaths[oe].slice(Oe.length),we=N.FileIndex[oe],!(!we.size||!we.content||Be=="Sh33tJ5")){var Pt=ue,Ct=Ar(Be.length);for(ce=0;ce<Be.length;++ce)Ct.write_shift(1,Be.charCodeAt(ce)&127);Ct=Ct.slice(0,Ct.l),be[Te]=d4.buf(we.content,0);var zt=we.content;se==8&&(zt=Q(zt)),X=Ar(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,ge),X.write_shift(2,se),we.mt?s(X,we.mt):X.write_shift(4,0),X.write_shift(-4,be[Te]),X.write_shift(4,zt.length),X.write_shift(4,we.content.length),X.write_shift(2,Ct.length),X.write_shift(2,0),ue+=X.length,z.push(X),ue+=Ct.length,z.push(Ct),ue+=zt.length,z.push(zt),X=Ar(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,ge),X.write_shift(2,se),X.write_shift(4,0),X.write_shift(-4,be[Te]),X.write_shift(4,zt.length),X.write_shift(4,we.content.length),X.write_shift(2,Ct.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Pt),Ye+=X.l,Z.push(X),Ye+=Ct.length,Z.push(Ct),++Te}return X=Ar(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Te),X.write_shift(2,Te),X.write_shift(4,Ye),X.write_shift(4,ue),X.write_shift(2,0),Js([Js(z),Js(Z),X])}var Jr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Qr(N,G){if(N.ctype)return N.ctype;var V=N.name||"",z=V.match(/\.([^\.]+)$/);return z&&Jr[z[1]]||G&&(z=(V=G).match(/[\.\\]([^\.\\])+$/),z&&Jr[z[1]])?Jr[z[1]]:"application/octet-stream"}function ri(N){for(var G=Iv(N),V=[],z=0;z<G.length;z+=76)V.push(G.slice(z,z+76));return V.join(`\r
`)+`\r
`}function zi(N){var G=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var ue=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(ue.length==1?"0"+ue:ue)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var V=[],z=G.split(`\r
`),Z=0;Z<z.length;++Z){var X=z[Z];if(X.length==0){V.push("");continue}for(var se=0;se<X.length;){var ge=76,oe=X.slice(se,se+ge);oe.charAt(ge-1)=="="?ge--:oe.charAt(ge-2)=="="?ge-=2:oe.charAt(ge-3)=="="&&(ge-=3),oe=X.slice(se,se+ge),se+=ge,se<X.length&&(oe+="="),V.push(oe)}}return V.join(`\r
`)}function vo(N){for(var G=[],V=0;V<N.length;++V){for(var z=N[V];V<=N.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+N[++V];G.push(z)}for(var Z=0;Z<G.length;++Z)G[Z]=G[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Di(G.join(`\r
`))}function as(N,G,V){for(var z="",Z="",X="",se,ge=0;ge<10;++ge){var oe=G[ge];if(!oe||oe.match(/^\s*$/))break;var ce=oe.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":z=ce[2].trim();break;case"content-type":X=ce[2].trim();break;case"content-transfer-encoding":Z=ce[2].trim();break}}switch(++ge,Z.toLowerCase()){case"base64":se=Di(Jn(G.slice(ge).join("")));break;case"quoted-printable":se=vo(G.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var ue=Ai(N,z.slice(V.length),se,{unsafe:!0});X&&(ue.ctype=X)}function Ms(N,G){if(te(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var V=G&&G.root||"",z=(_t&&Buffer.isBuffer(N)?N.toString("binary"):te(N)).split(`\r
`),Z=0,X="";for(Z=0;Z<z.length;++Z)if(X=z[Z],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),V||(V=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,V.length)!=V))for(;V.length>0&&(V=V.slice(0,V.length-1),V=V.slice(0,V.lastIndexOf("/")+1),X.slice(0,V.length)!=V););var se=(z[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var ge="--"+(se[1]||""),oe=[],ce=[],ue={FileIndex:oe,FullPaths:ce};S(ue);var Te,Oe=0;for(Z=0;Z<z.length;++Z){var Be=z[Z];Be!==ge&&Be!==ge+"--"||(Oe++&&as(ue,z.slice(Te,Z),V),Te=Z)}return ue}function Tr(N,G){var V=G||{},z=V.boundary||"SheetJS";z="------="+z;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],X=N.FullPaths[0],se=X,ge=N.FileIndex[0],oe=1;oe<N.FullPaths.length;++oe)if(se=N.FullPaths[oe].slice(X.length),ge=N.FileIndex[oe],!(!ge.size||!ge.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var ce=ge.content,ue=_t&&Buffer.isBuffer(ce)?ce.toString("binary"):te(ce),Te=0,Oe=Math.min(1024,ue.length),Be=0,we=0;we<=Oe;++we)(Be=ue.charCodeAt(we))>=32&&Be<128&&++Te;var be=Te>=Oe*4/5;Z.push(z),Z.push("Content-Location: "+(V.root||"file:///C:/SheetJS/")+se),Z.push("Content-Transfer-Encoding: "+(be?"quoted-printable":"base64")),Z.push("Content-Type: "+Qr(ge,se)),Z.push(""),Z.push(be?zi(ue):ri(ue))}return Z.push(z+`--\r
`),Z.join(`\r
`)}function xo(N){var G={};return S(G,N),G}function Ai(N,G,V,z){var Z=z&&z.unsafe;Z||S(N);var X=!Z&&yt.find(N,G);if(!X){var se=N.FullPaths[0];G.slice(0,se.length)==se?se=G:(se.slice(-1)!="/"&&(se+="/"),se=(se+G).replace("//","/")),X={name:i(G),type:2},N.FileIndex.push(X),N.FullPaths.push(se),Z||yt.utils.cfb_gc(N)}return X.content=V,X.size=V?V.length:0,z&&(z.CLSID&&(X.clsid=z.CLSID),z.mt&&(X.mt=z.mt),z.ct&&(X.ct=z.ct)),X}function os(N,G){S(N);var V=yt.find(N,G);if(V){for(var z=0;z<N.FileIndex.length;++z)if(N.FileIndex[z]==V)return N.FileIndex.splice(z,1),N.FullPaths.splice(z,1),!0}return!1}function kn(N,G,V){S(N);var z=yt.find(N,G);if(z){for(var Z=0;Z<N.FileIndex.length;++Z)if(N.FileIndex[Z]==z)return N.FileIndex[Z].name=i(V),N.FullPaths[Z]=V,!0}return!1}function We(N){P(N,!0)}return t.find=F,t.read=K,t.parse=p,t.write=de,t.writeFile=fe,t.utils={cfb_new:xo,cfb_add:Ai,cfb_del:os,cfb_mov:kn,cfb_gc:We,ReadShift:zc,CheckField:GT,prep_blob:Wr,bconcat:Js,use_zlib:j,_deflateRaw:et,_inflateRaw:pr,consts:ke},t}();function p4(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ts(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Mg(e){for(var t=[],r=ts(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var $h=new Date(1899,11,30,0,0,0);function wn(e,t){var r=e.getTime(),n=$h.getTime()+(e.getTimezoneOffset()-$h.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var wT=new Date,m4=$h.getTime()+(wT.getTimezoneOffset()-$h.getTimezoneOffset())*6e4,Fv=wT.getTimezoneOffset();function F0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+m4),t.getTimezoneOffset()!==Fv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Fv)*6e4),t}function g4(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var bv=new Date("2017-02-19T19:06:09.000Z"),ST=isNaN(bv.getFullYear())?new Date("2/19/17"):bv,_4=ST.getFullYear()==2017;function Vr(e,t){var r=new Date(e);if(_4)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(ST.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function to(e,t){if(_t&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Cc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Cc(fT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Cc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Cc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Zr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Zr(e[r]));return t}function ar(e,t){for(var r="";r.length<t;)r+=e;return r}function Ui(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var v4=["january","february","march","april","may","june","july","august","september","october","november","december"];function Al(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&v4.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var x4=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(i),o.push(s[l]);return o}}();function IT(e){return e?e.content&&e.type?to(e.content,!0):e.data?wc(e.data):e.asNodeBuffer&&_t?wc(e.asNodeBuffer().toString("binary")):e.asBinary?wc(e.asBinary()):e._data&&e._data.getContent?wc(to(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function CT(e){if(!e)return null;if(e.data)return wv(e.data);if(e.asNodeBuffer&&_t)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?wv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function y4(e){return e&&e.name.slice(-4)===".bin"?CT(e):IT(e)}function di(e,t){for(var r=e.FullPaths||ts(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Bg(e,t){var r=di(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function xr(e,t,r){if(!r)return y4(Bg(e,t));if(!t)return null;try{return xr(e,t)}catch{return null}}function $n(e,t,r){if(!r)return IT(Bg(e,t));if(!t)return null;try{return $n(e,t)}catch{return null}}function E4(e,t,r){return CT(Bg(e,t))}function Mv(e){for(var t=e.FullPaths||ts(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function T4(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return _t?n=co(r):n=zR(r),yt.utils.cfb_add(e,t,n)}yt.utils.cfb_add(e,t,r)}else e.file(t,r)}function kT(e,t){switch(t.type){case"base64":return yt.read(e,{type:"base64"});case"binary":return yt.read(e,{type:"binary"});case"buffer":case"array":return yt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ic(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var RT=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,A4=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Bv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,w4=/<[^>]*>/g,pn=RT.match(Bv)?Bv:w4,S4=/<\w*:/,I4=/<(\/?)\w+:/;function Je(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(A4),l=0,u="",h=0,p="",m="",_=1;if(o)for(h=0;h!=o.length;++h){for(m=o[h],s=0;s!=m.length&&m.charCodeAt(s)!==61;++s);for(p=m.slice(0,s).trim();m.charCodeAt(s+1)==32;)++s;for(_=(i=m.charCodeAt(s+1))==34||i==39?1:0,u=m.slice(s+1+_,m.length-_),l=0;l!=p.length&&p.charCodeAt(l)!==58;++l);if(l===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=u,n[p.toLowerCase()]=u;else{var v=(l===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(l+1);if(n[v]&&p.slice(l-3,l)=="ext")continue;n[v]=u,n[v.toLowerCase()]=u}}return n}function is(e){return e.replace(I4,"<$1")}var PT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},C4=Mg(PT),wt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(l,u){return PT[l]||String.fromCharCode(parseInt(u,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,u){return String.fromCharCode(parseInt(u,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),k4=/[&<>'"]/g,R4=/[\u0000-\u001f]/g;function Ug(e){var t=e+"";return t.replace(k4,function(r){return C4[r]}).replace(/\n/g,"<br/>").replace(R4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Uv=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Xt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function bd(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Vv(e){var t=xa(2*e.length),r,n,i=1,s=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function zv(e){return co(e,"binary").toString("utf8")}var zf="foo bar baz",Ht=_t&&(zv(zf)==bd(zf)&&zv||Vv(zf)==bd(zf)&&Vv)||bd,Cc=_t?function(e){return co(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Tu=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),NT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),P4=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),N4=/<\/?(?:vt:)?variant>/g,O4=/<(?:vt:)([^>]*)>([\s\S]*)</;function jv(e,t){var r=Je(e),n=e.match(P4(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(N4,"").match(O4);o&&i.push({v:Ht(o[2]),t:o[1]})}),i}var L4=/(^\s|\s$|\n)/;function D4(e){return ts(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function F4(e,t,r){return"<"+e+(r!=null?D4(r):"")+(t!=null?(t.match(L4)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Vg(e){if(_t&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ht(uo(Dg(e)));throw new Error("Bad input format: expected Buffer or string")}var Au=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,b4={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},M4=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function B4(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function U4(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var Hv=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Wv=_t?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:co(t)})):Hv(e)}:Hv,Gv=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Es(e,i)));return n.join("").replace(An,"")},zg=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(An,""):Gv(e,t,r)}:Gv,$v=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},OT=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):$v(e,t,r)}:$v,Zv=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Uo(e,i)));return n.join("")},Hu=_t?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Zv(t,r,n)}:Zv,LT=function(e,t){var r=Gn(e,t);return r>0?Hu(e,t+4,t+4+r-1):""},DT=LT,FT=function(e,t){var r=Gn(e,t);return r>0?Hu(e,t+4,t+4+r-1):""},bT=FT,MT=function(e,t){var r=2*Gn(e,t);return r>0?Hu(e,t+4,t+4+r-1):""},BT=MT,UT=function(t,r){var n=Gn(t,r);return n>0?zg(t,r+4,r+4+n):""},VT=UT,zT=function(e,t){var r=Gn(e,t);return r>0?Hu(e,t+4,t+4+r):""},jT=zT,HT=function(e,t){return B4(e,t)},Zh=HT,WT=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};_t&&(DT=function(t,r){if(!Buffer.isBuffer(t))return LT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},bT=function(t,r){if(!Buffer.isBuffer(t))return FT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},BT=function(t,r){if(!Buffer.isBuffer(t))return MT(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},VT=function(t,r){if(!Buffer.isBuffer(t))return UT(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},jT=function(t,r){if(!Buffer.isBuffer(t))return zT(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Zh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):HT(t,r)},WT=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Uo=function(e,t){return e[t]},Es=function(e,t){return e[t+1]*256+e[t]},V4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Gn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ba=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},z4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function zc(e,t){var r="",n,i,s=[],o,l,u,h;switch(t){case"dbcs":if(h=this.l,_t&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(Es(this,h)),h+=2;e*=2;break;case"utf8":r=Hu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=zg(this,this.l,this.l+e);break;case"wstr":return zc.call(this,e,"dbcs");case"lpstr-ansi":r=DT(this,this.l),e=4+Gn(this,this.l);break;case"lpstr-cp":r=bT(this,this.l),e=4+Gn(this,this.l);break;case"lpwstr":r=BT(this,this.l),e=4+2*Gn(this,this.l);break;case"lpp4":e=4+Gn(this,this.l),r=VT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Gn(this,this.l),r=jT(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Uo(this,this.l+e++))!==0;)s.push(Vf(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=Es(this,this.l+e))!==0;)s.push(Vf(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",h=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Uo(this,h),this.l=h+1,l=zc.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Vf(Es(this,h))),h+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Uo(this,h),this.l=h+1,l=zc.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Vf(Uo(this,h))),h+=1}r=s.join("");break;default:switch(e){case 1:return n=Uo(this,this.l),this.l++,n;case 2:return n=(t==="i"?V4:Es)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ba:z4)(this,this.l),this.l+=4,n):(i=Gn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Zh(this,this.l):i=Zh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=OT(this,this.l,e);break}}return this.l+=e,r}var j4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},H4=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},W4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function G4(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)W4(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,j4(this,t,this.l);break;case 8:if(n=8,r==="f"){U4(this,t,this.l);break}case 16:break;case-4:n=4,H4(this,t,this.l);break}return this.l+=n,this}function GT(e,t){var r=OT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Wr(e,t){e.l=t,e.read_shift=zc,e.chk=GT,e.write_shift=G4}function dn(e,t){e.l+=t}function Ar(e){var t=xa(e);return Wr(t,0),t}function bs(e,t,r){if(e){var n,i,s;Wr(e,e.l||0);for(var o=e.length,l=0,u=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var h=Qh[l]||Qh[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;u=e.l+s;var p=h.f&&h.f(e,s,r);if(e.l=u,t(p,h,l))return}}}function rm(){var e=[],t=_t?256:2048,r=function(h){var p=Ar(h);return Wr(p,0),p},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(h){return n&&h<n.length-n.l?n:(i(),n=r(Math.max(h+1,t)))},o=function(){return i(),Js(e)},l=function(h){i(),n=h,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function jc(e,t,r){var n=Zr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Kv(e,t,r){var n=Zr(e);return n.s=jc(n.s,t.s,r),n.e=jc(n.e,t.s,r),n}function Hc(e,t){if(e.cRel&&e.c<0)for(e=Zr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Zr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=at(e);return!e.cRel&&e.cRel!=null&&(r=K4(r)),!e.rRel&&e.rRel!=null&&(r=$4(r)),r}function Md(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Cr(e.s.c)+":"+(e.e.cRel?"":"$")+Cr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Kr(e.s.r)+":"+(e.e.rRel?"":"$")+Kr(e.e.r):Hc(e.s,t.biff)+":"+Hc(e.e,t.biff)}function jg(e){return parseInt(Z4(e),10)-1}function Kr(e){return""+(e+1)}function $4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Z4(e){return e.replace(/\$(\d+)$/,"$1")}function Hg(e){for(var t=X4(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Cr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function K4(e){return e.replace(/^([A-Z])/,"$$$1")}function X4(e){return e.replace(/^\$([A-Z])/,"$1")}function q4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function En(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function at(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ml(e){var t=e.indexOf(":");return t==-1?{s:En(e),e:En(e)}:{s:En(e.slice(0,t)),e:En(e.slice(t+1))}}function Et(e,t){return typeof t>"u"||typeof t=="number"?Et(e.s,e.e):(typeof e!="string"&&(e=at(e)),typeof t!="string"&&(t=at(t)),e==t?e:e+":"+t)}function or(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Xv(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ei(e.z,r?wn(t):t)}catch{}try{return e.w=Ei((e.XF||{}).numFmtId||(r?14:0),r?wn(t):t)}catch{return""+t}}function Ps(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?po[e.v]||e.v:t==null?Xv(e,e.v):Xv(e,t))}function ka(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function $T(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?En(n.origin):n.origin;o=u.r,l=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var p=or(s["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),o==-1&&(h.e.r=o=p.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=t[m].length;++_)if(!(typeof t[m][_]>"u")){var v={v:t[m][_]},E=o+m,y=l+_;if(h.s.r>E&&(h.s.r=E),h.s.c>y&&(h.s.c=y),h.e.r<E&&(h.e.r=E),h.e.c<y&&(h.e.c=y),t[m][_]&&typeof t[m][_]=="object"&&!Array.isArray(t[m][_])&&!(t[m][_]instanceof Date))v=t[m][_];else if(Array.isArray(v.v)&&(v.f=t[m][_][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||ut[14],n.cellDates?(v.t="d",v.w=Ei(v.z,wn(v.v))):(v.t="n",v.v=wn(v.v),v.w=Ei(v.z,v.v))):v.t="s";if(i)s[E]||(s[E]=[]),s[E][y]&&s[E][y].z&&(v.z=s[E][y].z),s[E][y]=v;else{var w=at({c:y,r:E});s[w]&&s[w].z&&(v.z=s[w].z),s[w]=v}}}return h.s.c<1e7&&(s["!ref"]=Et(h)),s}function Bl(e,t){return $T(null,e,t)}function Y4(e){return e.read_shift(4,"i")}function fn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function J4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Wg(e,t){var r=e.l,n=e.read_shift(1),i=fn(e),s=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),u=0;u!=l;++u)s.push(J4(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var Q4=Wg;function Ti(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function fo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var eP=fn;function Gg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var tP=fn,nm=Gg;function $g(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Zh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ba(t,0)>>2;return r?i/100:i}function ZT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var ho=ZT;function cn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function rP(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var h=$a[i];h&&(t.rgb=Su(h));break;case 2:t.rgb=Su([o,l,u]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function nP(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function KT(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function iP(e){return KT(e,1)}function sP(e){return KT(e,2)}var Zg=2,Nn=3,jf=11,qv=12,Kh=19,Hf=64,aP=65,oP=71,lP=4108,cP=4126,br=80,XT=81,uP=[br,XT],fP={1:{n:"CodePage",t:Zg},2:{n:"Category",t:br},3:{n:"PresentationFormat",t:br},4:{n:"ByteCount",t:Nn},5:{n:"LineCount",t:Nn},6:{n:"ParagraphCount",t:Nn},7:{n:"SlideCount",t:Nn},8:{n:"NoteCount",t:Nn},9:{n:"HiddenCount",t:Nn},10:{n:"MultimediaClipCount",t:Nn},11:{n:"ScaleCrop",t:jf},12:{n:"HeadingPairs",t:lP},13:{n:"TitlesOfParts",t:cP},14:{n:"Manager",t:br},15:{n:"Company",t:br},16:{n:"LinksUpToDate",t:jf},17:{n:"CharacterCount",t:Nn},19:{n:"SharedDoc",t:jf},22:{n:"HyperlinksChanged",t:jf},23:{n:"AppVersion",t:Nn,p:"version"},24:{n:"DigSig",t:aP},26:{n:"ContentType",t:br},27:{n:"ContentStatus",t:br},28:{n:"Language",t:br},29:{n:"Version",t:br},255:{},2147483648:{n:"Locale",t:Kh},2147483651:{n:"Behavior",t:Kh},1919054434:{}},hP={1:{n:"CodePage",t:Zg},2:{n:"Title",t:br},3:{n:"Subject",t:br},4:{n:"Author",t:br},5:{n:"Keywords",t:br},6:{n:"Comments",t:br},7:{n:"Template",t:br},8:{n:"LastAuthor",t:br},9:{n:"RevNumber",t:br},10:{n:"EditTime",t:Hf},11:{n:"LastPrinted",t:Hf},12:{n:"CreatedDate",t:Hf},13:{n:"ModifiedDate",t:Hf},14:{n:"PageCount",t:Nn},15:{n:"WordCount",t:Nn},16:{n:"CharCount",t:Nn},17:{n:"Thumbnail",t:oP},18:{n:"Application",t:br},19:{n:"DocSecurity",t:Nn},255:{},2147483648:{n:"Locale",t:Kh},2147483651:{n:"Behavior",t:Kh},1919054434:{}},Yv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},dP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function pP(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var mP=pP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),$a=Zr(mP),po={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Jv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function gP(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _P(e){var t=gP();if(!e||!e.match)return t;var r={};if((e.match(pn)||[]).forEach(function(n){var i=Je(n);switch(i[0].replace(S4,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Jv[i.ContentType]]!==void 0&&t[Jv[i.ContentType]].push(i.PartName);break}}),t.xmlns!==b4.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var nl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function im(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Wc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(pn)||[]).forEach(function(i){var s=Je(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:Ic(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}var vP="application/vnd.oasis.opendocument.spreadsheet";function xP(e,t){for(var r=Vg(e),n,i;n=Au.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Je(n[0],!1),i.path=="/"&&i.type!==vP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Gc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],yP=function(){for(var e=new Array(Gc.length),t=0;t<Gc.length;++t){var r=Gc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function YT(e){var t={};e=Ht(e);for(var r=0;r<Gc.length;++r){var n=Gc[r],i=e.match(yP[r]);i!=null&&i.length>0&&(t[n[1]]=wt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Vr(t[n[1]]))}return t}var EP=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function JT(e,t,r,n){var i=[];if(typeof e=="string")i=jv(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(p){return{v:p}}));var o=typeof t=="string"?jv(t,n).map(function(p){return p.v}):t,l=0,u=0;if(o.length>0)for(var h=0;h!==i.length;h+=2){switch(u=+i[h+1].v,i[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(l,l+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(l,l+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(l,l+u);break}l+=u}}function TP(e,t,r){var n={};return t||(t={}),e=Ht(e),EP.forEach(function(i){var s=(e.match(Tu(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=wt(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&JT(n.HeadingPairs,n.TitlesOfParts,t,r),t}var AP=/<[^>]+>[^<]*/g;function wP(e,t){var r={},n="",i=e.match(AP);if(i)for(var s=0;s!=i.length;++s){var o=i[s],l=Je(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=wt(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),h=u[0].slice(4),p=u[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=wt(p);break;case"bool":r[n]=Xt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=Vr(p);break;case"cy":case"error":r[n]=wt(p);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var SP={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Bd;function IP(e,t,r){Bd||(Bd=Mg(SP)),t=Bd[t]||t,e[t]=r}function Kg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function QT(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function eA(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function tA(e,t,r){return t===31?eA(e):QT(e,t,r)}function sm(e,t,r){return tA(e,t,r===!1?0:4)}function CP(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return tA(e,t,0)}function kP(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(An,""),e.l-i&2&&(e.l+=2)}return r}function RP(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(An,"");return r}function PP(e){var t=e.l,r=Xh(e,XT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Xh(e,Nn);return[r,n]}function NP(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(PP(e));return r}function Qv(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(An,"").replace(Sc,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function rA(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function OP(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Xh(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==qv&&n!==t&&uP.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===qv?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return QT(e,n,4).replace(An,"");case 31:return eA(e);case 64:return Kg(e);case 65:return rA(e);case 71:return OP(e);case 80:return sm(e,n,!s.raw).replace(An,"");case 81:return CP(e,n).replace(An,"");case 4108:return NP(e);case 4126:case 4127:return n==4127?kP(e):RP(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function ex(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,l=0,u=-1,h={};for(o=0;o!=i;++o){var p=e.read_shift(4),m=e.read_shift(4);s[o]=[p,m+r]}s.sort(function(C,A){return C[1]-A[1]});var _={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var v=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,v=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],v=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],v=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(v=!1,e.l=s[o][1]),v)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var E=t[s[o][0]];if(_[E.n]=Xh(e,E.t,{raw:!0}),E.p==="version"&&(_[E.n]=String(_[E.n]>>16)+"."+("0000"+String(_[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(_[E.n]){case 0:_[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Fi(l=_[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[E.n])}}else if(s[o][0]===1){if(l=_.CodePage=Xh(e,Zg),Fi(l),u!==-1){var y=e.l;e.l=s[u][1],h=Qv(e,l),e.l=y}}else if(s[o][0]===0){if(l===0){u=o,e.l=s[o+1][1];continue}h=Qv(e,l)}else{var w=h[s[o][0]],k;switch(e[e.l]){case 65:e.l+=4,k=rA(e);break;case 30:e.l+=4,k=sm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=sm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=ur(e,4);break;case 64:e.l+=4,k=Vr(Kg(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[w]=k}}return e.l=r+n,_}function tx(e,t,r){var n=e.content;if(!n)return{};Wr(n,0);var i,s,o,l,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),p=n.read_shift(16);if(p!==yt.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),u=n.read_shift(4));var m=ex(n,t),_={SystemIdentifier:h};for(var v in m)_[v]=m[v];if(_.FMTID=s,i===1)return _;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var E;try{E=ex(n,null)}catch{}for(v in E)_[v]=E[v];return _.FMTID=[s,o],_}function $s(e,t){return e.read_shift(t),null}function LP(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function ur(e,t){return e.read_shift(t)===1}function yr(e){return e.read_shift(2,"u")}function nA(e,t){return LP(e,t,yr)}function DP(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Wu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function FP(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,l,u={};i&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var h=s==2?"dbcs-cont":"sbcs-cont",p=t===0?"":e.read_shift(t,h);return i&&(e.l+=4*o),n&&(e.l+=l),u.t=p,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function ro(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Gu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ro(e,n,r)}function mo(e,t,r){if(r.biff>5)return Gu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function bP(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function MP(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(An,"");return n&&(e.l+=24),i}function BP(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(An,"");return r+o}function UP(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return MP(e);case"0303000000000000c000000000000046":return BP(e);default:throw new Error("Unsupported Moniker "+r)}}function Wf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(An,""):"";return r}function VP(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,l,u,h="",p,m;i&16&&(s=Wf(e,r-e.l)),i&128&&(o=Wf(e,r-e.l)),(i&257)===257&&(l=Wf(e,r-e.l)),(i&257)===1&&(u=UP(e,r-e.l)),i&8&&(h=Wf(e,r-e.l)),i&32&&(p=e.read_shift(16)),i&64&&(m=Kg(e)),e.l=r;var _=o||l||u||"";_&&h&&(_+="#"+h),_||(_="#"+h),i&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var v={Target:_};return p&&(v.guid=p),m&&(v.time=m),s&&(v.Tooltip=s),v}function iA(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function sA(e,t){var r=iA(e);return r[3]=0,r}function ss(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function zP(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function jP(e,t,r){return t===0?"":mo(e,t,r)}function HP(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,s,o]}function aA(e){var t=e.read_shift(2),r=$g(e);return[t,r]}function WP(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Wu(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function b0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function oA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var GP=oA;function lA(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function $P(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ZP(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function rn(e){e.l+=2,e.l+=e.read_shift(2)}var KP={0:rn,4:rn,5:rn,6:rn,7:ZP,8:rn,9:rn,10:rn,11:rn,12:rn,13:$P,14:rn,15:rn,16:rn,17:rn,18:rn,19:rn,20:rn,21:lA};function XP(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(KP[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Gf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function qP(e,t){return t===0||e.read_shift(2),1200}function YP(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=mo(e,0,r);return e.read_shift(t+n-e.l),i}function JP(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function QP(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Wu(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function eN(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(FP(e));return s.Count=n,s.Unique=i,s}function tN(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function rN(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function nN(e){var t=zP(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function iN(e){return e.read_shift(2),e.read_shift(4)}function rx(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function sN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:l,Selected:u,TabRatio:h}}function aN(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function oN(){}function lN(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Wu(e,0,r),n}function cN(e){var t=ss(e);return t.isst=e.read_shift(4),t}function uN(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=ss(e);r.biff==2&&e.l++;var s=Gu(e,n-e.l,r);return i.val=s,i}function fN(e,t,r){var n=e.read_shift(2),i=mo(e,0,r);return[n,i]}var hN=mo;function nx(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c:u}}}function dN(e){var t=e.read_shift(2),r=e.read_shift(2),n=aA(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function pN(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(aA(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function mN(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function gN(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(2);return i.patternType=dP[l>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function _N(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=gN(e,t,n.fStyle,r),n}function vN(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function ix(e,t,r){var n=ss(e);(r.biff==2||t==9)&&++e.l;var i=DP(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function xN(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ss(e),i=cn(e);return n.val=i,n}var sx=jP;function yN(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=ro(e,s),l=[];n>e.l;)l.push(Gu(e));return[s,i,o,l]}function ax(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=WP(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var EN=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ox(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var h=ro(e,o,r);i&32&&(h=EN[h.charCodeAt(0)]);var p=n-e.l;r&&r.biff==2&&--p;var m=n==e.l||l===0||!(p>0)?[]:rD(e,p,r,l);return{chKey:s,Name:h,itab:u,rgce:m}}function cA(e,t,r){if(r.biff<8)return TN(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(HP(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function TN(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Wu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function AN(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=ro(e,n,r),o=ro(e,i,r);return[s,o]}function wN(e,t,r){var n=oA(e);e.l++;var i=e.read_shift(1);return t-=8,[nD(e,t,r),i,n]}function lx(e,t,r){var n=GP(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,eD(e,t,r)]}function SN(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function IN(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=mo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,s]}}function CN(e,t,r){return IN(e,t,r)}function kN(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(b0(e));return r}function RN(e,t,r){if(r&&r.biff<8)return NN(e,t,r);var n=lA(e),i=XP(e,t-22,n[1]);return{cmo:n,ft:i}}var PN={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function NN(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((PN[n]||dn)(e,t,r)),{cmo:[i,n,s],ft:o}}function ON(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=bP(e,6,r);var l=e.read_shift(2);e.read_shift(2),yr(e,2);var u=e.read_shift(2);e.l+=u;for(var h=1;h<e.lens.length-1;++h){if(e.l-n!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],m=ro(e,e.lens[h+1]-e.lens[h]-1);if(i+=m,i.length>=(p?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function LN(e,t){var r=b0(e);e.l+=16;var n=VP(e,t-24);return[r,n]}function DN(e,t){e.read_shift(2);var r=b0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(An,""),[r,n]}function FN(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Yv[r]||r,r=e.read_shift(2),t[1]=Yv[r]||r,t}function bN(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(sA(e));return r}function MN(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(sA(e));return r}function BN(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function uA(e,t,r){if(!r.cellStyles)return dn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2);n==2&&(e.l+=2);var h={s:i,e:s,w:o,ixfe:l,flags:u};return(r.biff>=5||!r.biff)&&(h.level=u>>8&7),h}function UN(e,t){var r={};return t<32||(e.l+=16,r.header=cn(e),r.footer=cn(e),e.l+=2),r}function VN(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var zN=ss,jN=nA,HN=Gu;function WN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function GN(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ss(e);++e.l;var i=mo(e,t-7,r);return n.t="str",n.val=i,n}function $N(e){var t=ss(e);++e.l;var r=cn(e);return t.t="n",t.val=r,t}function ZN(e){var t=ss(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function KN(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function XN(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function qN(e,t,r){var n=e.l+t,i=ss(e),s=e.read_shift(2),o=ro(e,s,r);return e.l=n,i.t="str",i.val=o,i}var YN=[2,3,48,49,131,139,140,245],cx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Mg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var h=[],p=xa(1);switch(u.type){case"base64":p=Di(Jn(l));break;case"binary":p=Di(l);break;case"buffer":case"array":p=l;break}Wr(p,0);var m=p.read_shift(1),_=!!(m&136),v=!1,E=!1;switch(m){case 2:break;case 3:break;case 48:v=!0,_=!0;break;case 49:v=!0,_=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var y=0,w=521;m==2&&(y=p.read_shift(2)),p.l+=3,m!=2&&(y=p.read_shift(4)),y>1048576&&(y=1e6),m!=2&&(w=p.read_shift(2));var k=p.read_shift(2),C=u.codepage||1252;m!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(C=e[p[p.l]]),p.l+=1,p.l+=2),E&&(p.l+=36);for(var A=[],U={},q=Math.min(p.length,m==2?521:w-10-(v?264:0)),K=E?32:11;p.l<q&&p[p.l]!=13;)switch(U={},U.name=yu.utils.decode(C,p.slice(p.l,p.l+K)).replace(/[\u0000\r\n].*$/g,""),p.l+=K,U.type=String.fromCharCode(p.read_shift(1)),m!=2&&!E&&(U.offset=p.read_shift(4)),U.len=p.read_shift(1),m==2&&(U.offset=p.read_shift(2)),U.dec=p.read_shift(1),U.name.length&&A.push(U),m!=2&&(p.l+=E?13:14),U.type){case"B":(!v||U.len!=8)&&u.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(p[p.l]!==13&&(p.l=w-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=w;var S=0,R=0;for(h[0]=[],R=0;R!=A.length;++R)h[0][R]=A[R].name;for(;y-- >0;){if(p[p.l]===42){p.l+=k;continue}for(++p.l,h[++S]=[],R=0,R=0;R!=A.length;++R){var P=p.slice(p.l,p.l+A[R].len);p.l+=A[R].len,Wr(P,0);var D=yu.utils.decode(C,P);switch(A[R].type){case"C":D.trim().length&&(h[S][R]=D.replace(/\s+$/,""));break;case"D":D.length===8?h[S][R]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):h[S][R]=D;break;case"F":h[S][R]=parseFloat(D.trim());break;case"+":case"I":h[S][R]=E?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":h[S][R]=!0;break;case"N":case"F":h[S][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));h[S][R]="##MEMO##"+(E?parseInt(D.trim(),10):P.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(h[S][R]=+D||0);break;case"@":h[S][R]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":h[S][R]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":h[S][R]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[S][R]=-P.read_shift(-8,"f");break;case"B":if(v&&A[R].len==8){h[S][R]=P.read_shift(8,"f");break}case"G":case"P":P.l+=A[R].len;break;case"0":if(A[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[R].type)}}}if(m!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return u&&u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=A,h}function n(l,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var p=Bl(r(l,h),h);return p["!cols"]=h.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete h.DBF,p}function i(l,u){try{return ka(n(l,u),u)}catch(h){if(u&&u.WTF)throw h}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,u){var h=u||{};if(+h.codepage>=0&&Fi(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=rm(),m=hm(l,{header:1,raw:!0,cellDates:!0}),_=m[0],v=m.slice(1),E=l["!cols"]||[],y=0,w=0,k=0,C=1;for(y=0;y<_.length;++y){if(((E[y]||{}).DBF||{}).name){_[y]=E[y].DBF.name,++k;continue}if(_[y]!=null){if(++k,typeof _[y]=="number"&&(_[y]=_[y].toString(10)),typeof _[y]!="string")throw new Error("DBF Invalid column name "+_[y]+" |"+typeof _[y]+"|");if(_.indexOf(_[y])!==y){for(w=0;w<1024;++w)if(_.indexOf(_[y]+"_"+w)==-1){_[y]+="_"+w;break}}}}var A=or(l["!ref"]),U=[],q=[],K=[];for(y=0;y<=A.e.c-A.s.c;++y){var S="",R="",P=0,D=[];for(w=0;w<v.length;++w)v[w][y]!=null&&D.push(v[w][y]);if(D.length==0||_[y]==null){U[y]="?";continue}for(w=0;w<D.length;++w){switch(typeof D[w]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=D[w]instanceof Date?"D":"C";break;default:R="C"}P=Math.max(P,String(D[w]).length),S=S&&S!=R?"C":R}P>250&&(P=250),R=((E[y]||{}).DBF||{}).type,R=="C"&&E[y].DBF.len>P&&(P=E[y].DBF.len),S=="B"&&R=="N"&&(S="N",K[y]=E[y].DBF.dec,P=E[y].DBF.len),q[y]=S=="C"||R=="N"?P:s[S]||0,C+=q[y],U[y]=S}var F=p.next(32);for(F.write_shift(4,318902576),F.write_shift(4,v.length),F.write_shift(2,296+32*k),F.write_shift(2,C),y=0;y<4;++y)F.write_shift(4,0);for(F.write_shift(4,0|(+t[cT]||3)<<8),y=0,w=0;y<_.length;++y)if(_[y]!=null){var b=p.next(32),M=(_[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,M,"sbcs"),b.write_shift(1,U[y]=="?"?"C":U[y],"sbcs"),b.write_shift(4,w),b.write_shift(1,q[y]||s[U[y]]||0),b.write_shift(1,K[y]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),w+=q[y]||s[U[y]]||0}var Ce=p.next(264);for(Ce.write_shift(4,13),y=0;y<65;++y)Ce.write_shift(4,0);for(y=0;y<v.length;++y){var Ie=p.next(C);for(Ie.write_shift(1,0),w=0;w<_.length;++w)if(_[w]!=null)switch(U[w]){case"L":Ie.write_shift(1,v[y][w]==null?63:v[y][w]?84:70);break;case"B":Ie.write_shift(8,v[y][w]||0,"f");break;case"N":var Re="0";for(typeof v[y][w]=="number"&&(Re=v[y][w].toFixed(K[w]||0)),k=0;k<q[w]-Re.length;++k)Ie.write_shift(1,32);Ie.write_shift(1,Re,"sbcs");break;case"D":v[y][w]?(Ie.write_shift(4,("0000"+v[y][w].getFullYear()).slice(-4),"sbcs"),Ie.write_shift(2,("00"+(v[y][w].getMonth()+1)).slice(-2),"sbcs"),Ie.write_shift(2,("00"+v[y][w].getDate()).slice(-2),"sbcs")):Ie.write_shift(8,"00000000","sbcs");break;case"C":var ke=String(v[y][w]!=null?v[y][w]:"").slice(0,q[w]);for(Ie.write_shift(1,ke,"sbcs"),k=0;k<q[w]-ke.length;++k)Ie.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),JN=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ts(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,v){var E=e[v];return typeof E=="number"?Sv(E):E},n=function(_,v,E){var y=v.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return y==59?_:Sv(y)};e["|"]=254;function i(_,v){switch(v.type){case"base64":return s(Jn(_),v);case"binary":return s(_,v);case"buffer":return s(_t&&Buffer.isBuffer(_)?_.toString("binary"):uo(_),v);case"array":return s(to(_),v)}throw new Error("Unrecognized type "+v.type)}function s(_,v){var E=_.split(/[\n\r]+/),y=-1,w=-1,k=0,C=0,A=[],U=[],q=null,K={},S=[],R=[],P=[],D=0,F;for(+v.codepage>=0&&Fi(+v.codepage);k!==E.length;++k){D=0;var b=E[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),M=b.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),Ce=M[0],Ie;if(b.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&U.push(b.slice(3).replace(/;;/g,";"));break;case"C":var Re=!1,ke=!1,fe=!1,te=!1,de=-1,Ee=-1;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"A":break;case"X":w=parseInt(M[C].slice(1))-1,ke=!0;break;case"Y":for(y=parseInt(M[C].slice(1))-1,ke||(w=0),F=A.length;F<=y;++F)A[F]=[];break;case"K":Ie=M[C].slice(1),Ie.charAt(0)==='"'?Ie=Ie.slice(1,Ie.length-1):Ie==="TRUE"?Ie=!0:Ie==="FALSE"?Ie=!1:isNaN(Ui(Ie))?isNaN(Al(Ie).getDate())||(Ie=Vr(Ie)):(Ie=Ui(Ie),q!==null&&bl(q)&&(Ie=F0(Ie))),Re=!0;break;case"E":te=!0;var j=hl(M[C].slice(1),{r:y,c:w});A[y][w]=[A[y][w],j];break;case"S":fe=!0,A[y][w]=[A[y][w],"S5S"];break;case"G":break;case"R":de=parseInt(M[C].slice(1))-1;break;case"C":Ee=parseInt(M[C].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+b)}if(Re&&(A[y][w]&&A[y][w].length==2?A[y][w][0]=Ie:A[y][w]=Ie,q=null),fe){if(te)throw new Error("SYLK shared formula cannot have own formula");var re=de>-1&&A[de][Ee];if(!re||!re[1])throw new Error("SYLK shared formula cannot find base");A[y][w][1]=yA(re[1],{r:y-de,c:w-Ee})}break;case"F":var Q=0;for(C=1;C<M.length;++C)switch(M[C].charAt(0)){case"X":w=parseInt(M[C].slice(1))-1,++Q;break;case"Y":for(y=parseInt(M[C].slice(1))-1,F=A.length;F<=y;++F)A[F]=[];break;case"M":D=parseInt(M[C].slice(1))/20;break;case"F":break;case"G":break;case"P":q=U[parseInt(M[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=M[C].slice(1).split(" "),F=parseInt(P[0],10);F<=parseInt(P[1],10);++F)D=parseInt(P[2],10),R[F-1]=D===0?{hidden:!0}:{wch:D},wl(R[F-1]);break;case"C":w=parseInt(M[C].slice(1))-1,R[w]||(R[w]={});break;case"R":y=parseInt(M[C].slice(1))-1,S[y]||(S[y]={}),D>0?(S[y].hpt=D,S[y].hpx=Iu(D)):D===0&&(S[y].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+b)}Q<1&&(q=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+b)}}return S.length>0&&(K["!rows"]=S),R.length>0&&(K["!cols"]=R),v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),[A,K]}function o(_,v){var E=i(_,v),y=E[0],w=E[1],k=Bl(y,v);return ts(w).forEach(function(C){k[C]=w[C]}),k}function l(_,v){return ka(o(_,v),v)}function u(_,v,E,y){var w="C;Y"+(E+1)+";X"+(y+1)+";K";switch(_.t){case"n":w+=_.v||0,_.f&&!_.F&&(w+=";E"+BL(_.f,{r:E,c:y}));break;case"b":w+=_.v?"TRUE":"FALSE";break;case"e":w+=_.w||_.v;break;case"d":w+='"'+(_.w||_.v)+'"';break;case"s":w+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function h(_,v){v.forEach(function(E,y){var w="F;W"+(y+1)+" "+(y+1)+" ";E.hidden?w+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Yh(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=Jh(E.wpx)),typeof E.wch=="number"&&(w+=Math.round(E.wch))),w.charAt(w.length-1)!=" "&&_.push(w)})}function p(_,v){v.forEach(function(E,y){var w="F;";E.hidden?w+="M0;":E.hpt?w+="M"+20*E.hpt+";":E.hpx&&(w+="M"+20*_A(E.hpx)+";"),w.length>2&&_.push(w+"R"+(y+1))})}function m(_,v){var E=["ID;PWXL;N;E"],y=[],w=or(_["!ref"]),k,C=Array.isArray(_),A=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),_["!cols"]&&h(E,_["!cols"]),_["!rows"]&&p(E,_["!rows"]),E.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var U=w.s.r;U<=w.e.r;++U)for(var q=w.s.c;q<=w.e.c;++q){var K=at({r:U,c:q});k=C?(_[U]||[])[q]:_[K],!(!k||k.v==null&&(!k.f||k.F))&&y.push(u(k,_,U,q))}return E.join(A)+A+y.join(A)+A+"E"+A}return{to_workbook:l,to_sheet:o,from_sheet:m}}(),QN=function(){function e(s,o){switch(o.type){case"base64":return t(Jn(s),o);case"binary":return t(s,o);case"buffer":return t(_t&&Buffer.isBuffer(s)?s.toString("binary"):uo(s),o);case"array":return t(to(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),u=-1,h=-1,p=0,m=[];p!==l.length;++p){if(l[p].trim()==="BOT"){m[++u]=[],h=0;continue}if(!(u<0)){var _=l[p].trim().split(","),v=_[0],E=_[1];++p;for(var y=l[p]||"";(y.match(/["]/g)||[]).length&1&&p<l.length-1;)y+=`
`+l[++p];switch(y=y.trim(),+v){case-1:if(y==="BOT"){m[++u]=[],h=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?m[u][h]=!0:y==="FALSE"?m[u][h]=!1:isNaN(Ui(E))?isNaN(Al(E).getDate())?m[u][h]=E:m[u][h]=Vr(E):m[u][h]=Ui(E),++h;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),m[u][h++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(s,o){return Bl(e(s,o),o)}function n(s,o){return ka(r(s,o),o)}var i=function(){var s=function(u,h,p,m,_){u.push(h),u.push(p+","+m),u.push('"'+_.replace(/"/g,'""')+'"')},o=function(u,h,p,m){u.push(h+","+p),u.push(h==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var h=[],p=or(u["!ref"]),m,_=Array.isArray(u);s(h,"TABLE",0,1,"sheetjs"),s(h,"VECTORS",0,p.e.r-p.s.r+1,""),s(h,"TUPLES",0,p.e.c-p.s.c+1,""),s(h,"DATA",0,0,"");for(var v=p.s.r;v<=p.e.r;++v){o(h,-1,0,"BOT");for(var E=p.s.c;E<=p.e.c;++E){var y=at({r:v,c:E});if(m=_?(u[v]||[])[E]:u[y],!m){o(h,1,0,"");continue}switch(m.t){case"n":var w=m.w;!w&&m.v!=null&&(w=m.v),w==null?m.f&&!m.F?o(h,1,0,"="+m.f):o(h,1,0,""):o(h,0,w,"V");break;case"b":o(h,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Ei(m.z||ut[14],wn(Vr(m.v)))),o(h,0,m.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var k=`\r
`,C=h.join(k);return C}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),eO=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,_){for(var v=m.split(`
`),E=-1,y=-1,w=0,k=[];w!==v.length;++w){var C=v[w].trim().split(":");if(C[0]==="cell"){var A=En(C[1]);if(k.length<=A.r)for(E=k.length;E<=A.r;++E)k[E]||(k[E]=[]);switch(E=A.r,y=A.c,C[2]){case"t":k[E][y]=e(C[3]);break;case"v":k[E][y]=+C[3];break;case"vtf":var U=C[C.length-1];case"vtc":switch(C[3]){case"nl":k[E][y]=!!+C[4];break;default:k[E][y]=+C[4];break}C[2]=="vtf"&&(k[E][y]=[k[E][y],U])}}}return _&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),k}function n(m,_){return Bl(r(m,_),_)}function i(m,_){return ka(n(m,_),_)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(m){if(!m||!m["!ref"])return"";for(var _=[],v=[],E,y="",w=Ml(m["!ref"]),k=Array.isArray(m),C=w.s.r;C<=w.e.r;++C)for(var A=w.s.c;A<=w.e.c;++A)if(y=at({r:C,c:A}),E=k?(m[C]||[])[A]:m[y],!(!E||E.v==null||E.t==="z")){switch(v=["cell",y,"t"],E.t){case"s":case"str":v.push(t(E.v));break;case"n":E.f?(v[2]="vtf",v[3]="n",v[4]=E.v,v[5]=t(E.f)):(v[2]="v",v[3]=E.v);break;case"b":v[2]="vt"+(E.f?"f":"c"),v[3]="nl",v[4]=E.v?"1":"0",v[5]=t(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var U=wn(Vr(E.v));v[2]="vtc",v[3]="nd",v[4]=""+U,v[5]=E.w||Ei(E.z||ut[14],U);break;case"e":continue}_.push(v.join(":"))}return _.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function p(m){return[s,o,l,o,h(m),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:p}}(),wu=function(){function e(p,m,_,v,E){E.raw?m[_][v]=p:p===""||(p==="TRUE"?m[_][v]=!0:p==="FALSE"?m[_][v]=!1:isNaN(Ui(p))?isNaN(Al(p).getDate())?m[_][v]=p:m[_][v]=Vr(p):m[_][v]=Ui(p))}function t(p,m){var _=m||{},v=[];if(!p||p.length===0)return v;for(var E=p.split(/[\r\n]/),y=E.length-1;y>=0&&E[y].length===0;)--y;for(var w=10,k=0,C=0;C<=y;++C)k=E[C].indexOf(" "),k==-1?k=E[C].length:k++,w=Math.max(w,k);for(C=0;C<=y;++C){v[C]=[];var A=0;for(e(E[C].slice(0,w).trim(),v,C,A,_),A=1;A<=(E[C].length-w)/10+1;++A)e(E[C].slice(w+(A-1)*10,w+A*10).trim(),v,C,A,_)}return _.sheetRows&&(v=v.slice(0,_.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(p){for(var m={},_=!1,v=0,E=0;v<p.length;++v)(E=p.charCodeAt(v))==34?_=!_:!_&&E in r&&(m[E]=(m[E]||0)+1);E=[];for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&E.push([m[v],v]);if(!E.length){m=n;for(v in m)Object.prototype.hasOwnProperty.call(m,v)&&E.push([m[v],v])}return E.sort(function(y,w){return y[0]-w[0]||n[y[1]]-n[w[1]]}),r[E.pop()[1]]||44}function s(p,m){var _=m||{},v="",E=_.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(v=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(v=p.charAt(4),p=p.slice(6)):v=i(p.slice(0,1024)):_&&_.FS?v=_.FS:v=i(p.slice(0,1024));var w=0,k=0,C=0,A=0,U=0,q=v.charCodeAt(0),K=!1,S=0,R=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var P=_.dateNF!=null?f4(_.dateNF):null;function D(){var F=p.slice(A,U),b={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)b.t="z";else if(_.raw)b.t="s",b.v=F;else if(F.trim().length===0)b.t="s",b.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(b.t="s",b.v=F.slice(2,-1).replace(/""/g,'"')):VL(F)?(b.t="n",b.f=F.slice(1)):(b.t="s",b.v=F);else if(F=="TRUE")b.t="b",b.v=!0;else if(F=="FALSE")b.t="b",b.v=!1;else if(!isNaN(C=Ui(F)))b.t="n",_.cellText!==!1&&(b.w=F),b.v=C;else if(!isNaN(Al(F).getDate())||P&&F.match(P)){b.z=_.dateNF||ut[14];var M=0;P&&F.match(P)&&(F=h4(F,_.dateNF,F.match(P)||[]),M=1),_.cellDates?(b.t="d",b.v=Vr(F,M)):(b.t="n",b.v=wn(Vr(F,M))),_.cellText!==!1&&(b.w=Ei(b.z,b.v instanceof Date?wn(b.v):b.v)),_.cellNF||delete b.z}else b.t="s",b.v=F;if(b.t=="z"||(_.dense?(E[w]||(E[w]=[]),E[w][k]=b):E[at({c:k,r:w})]=b),A=U+1,R=p.charCodeAt(A),y.e.c<k&&(y.e.c=k),y.e.r<w&&(y.e.r=w),S==q)++k;else if(k=0,++w,_.sheetRows&&_.sheetRows<=w)return!0}e:for(;U<p.length;++U)switch(S=p.charCodeAt(U)){case 34:R===34&&(K=!K);break;case q:case 10:case 13:if(!K&&D())break e;break}return U-A>0&&D(),E["!ref"]=Et(y),E}function o(p,m){return!(m&&m.PRN)||m.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?s(p,m):Bl(t(p,m),m)}function l(p,m){var _="",v=m.type=="string"?[0,0,0,0]:r_(p,m);switch(m.type){case"base64":_=Jn(p);break;case"binary":_=p;break;case"buffer":m.codepage==65001?_=p.toString("utf8"):m.codepage&&typeof yu<"u"||(_=_t&&Buffer.isBuffer(p)?p.toString("binary"):uo(p));break;case"array":_=to(p);break;case"string":_=p;break;default:throw new Error("Unrecognized type "+m.type)}return v[0]==239&&v[1]==187&&v[2]==191?_=Ht(_.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?_=Ht(_):m.type=="binary"&&typeof yu<"u",_.slice(0,19)=="socialcalc:version:"?eO.to_sheet(m.type=="string"?_:Ht(_),m):o(_,m)}function u(p,m){return ka(l(p,m),m)}function h(p){for(var m=[],_=or(p["!ref"]),v,E=Array.isArray(p),y=_.s.r;y<=_.e.r;++y){for(var w=[],k=_.s.c;k<=_.e.c;++k){var C=at({r:y,c:k});if(v=E?(p[y]||[])[k]:p[C],!v||v.v==null){w.push("          ");continue}for(var A=(v.w||(Ps(v),v.w)||"").slice(0,10);A.length<10;)A+=" ";w.push(A+(k===0?" ":""))}m.push(w.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:h}}();function tO(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=JN.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return wu.to_workbook(e,t)}}var $c=function(){function e(j,re,Q){if(j){Wr(j,j.l||0);for(var Y=Q.Enum||de;j.l<j.length;){var le=j.read_shift(2),ye=Y[le]||Y[65535],Ne=j.read_shift(2),ee=j.l+Ne,me=ye.f&&ye.f(j,Ne,Q);if(j.l=ee,re(me,ye,le))return}}}function t(j,re){switch(re.type){case"base64":return r(Di(Jn(j)),re);case"binary":return r(Di(j),re);case"buffer":case"array":return r(j,re)}throw"Unsupported type "+re.type}function r(j,re){if(!j)return j;var Q=re||{},Y=Q.dense?[]:{},le="Sheet1",ye="",Ne=0,ee={},me=[],Fe=[],H={s:{r:0,c:0},e:{r:0,c:0}},Ve=Q.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)Q.Enum=de,e(j,function(Pe,ne,De){switch(De){case 0:Q.vers=Pe,Pe>=4096&&(Q.qpro=!0);break;case 6:H=Pe;break;case 204:Pe&&(ye=Pe);break;case 222:ye=Pe;break;case 15:case 51:Q.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:De==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=Q.dateNF||ut[14],Q.cellDates&&(Pe[1].t="d",Pe[1].v=F0(Pe[1].v))),Q.qpro&&Pe[3]>Ne&&(Y["!ref"]=Et(H),ee[le]=Y,me.push(le),Y=Q.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Ne=Pe[3],le=ye||"Sheet"+(Ne+1),ye="");var Me=Q.dense?(Y[Pe[0].r]||[])[Pe[0].c]:Y[at(Pe[0])];if(Me){Me.t=Pe[1].t,Me.v=Pe[1].v,Pe[1].z!=null&&(Me.z=Pe[1].z),Pe[1].f!=null&&(Me.f=Pe[1].f);break}Q.dense?(Y[Pe[0].r]||(Y[Pe[0].r]=[]),Y[Pe[0].r][Pe[0].c]=Pe[1]):Y[at(Pe[0])]=Pe[1];break}},Q);else if(j[2]==26||j[2]==14)Q.Enum=Ee,j[2]==14&&(Q.qpro=!0,j.l=0),e(j,function(Pe,ne,De){switch(De){case 204:le=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>Ne&&(Y["!ref"]=Et(H),ee[le]=Y,me.push(le),Y=Q.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Ne=Pe[3],le="Sheet"+(Ne+1)),Ve>0&&Pe[0].r>=Ve)break;Q.dense?(Y[Pe[0].r]||(Y[Pe[0].r]=[]),Y[Pe[0].r][Pe[0].c]=Pe[1]):Y[at(Pe[0])]=Pe[1],H.e.c<Pe[0].c&&(H.e.c=Pe[0].c),H.e.r<Pe[0].r&&(H.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(Fe[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:Fe[Pe[0]]=Pe[1],Pe[0]==Ne&&(le=Pe[1]);break}},Q);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(Y["!ref"]=Et(H),ee[ye||le]=Y,me.push(ye||le),!Fe.length)return{SheetNames:me,Sheets:ee};for(var je={},tt=[],Ze=0;Ze<Fe.length;++Ze)ee[me[Ze]]?(tt.push(Fe[Ze]||me[Ze]),je[Fe[Ze]]=ee[Fe[Ze]]||ee[me[Ze]]):(tt.push(Fe[Ze]),je[Fe[Ze]]={"!ref":"A1"});return{SheetNames:tt,Sheets:je}}function n(j,re){var Q=re||{};if(+Q.codepage>=0&&Fi(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=rm(),le=or(j["!ref"]),ye=Array.isArray(j),Ne=[];Pi(Y,0,s(1030)),Pi(Y,6,u(le));for(var ee=Math.min(le.e.r,8191),me=le.s.r;me<=ee;++me)for(var Fe=Kr(me),H=le.s.c;H<=le.e.c;++H){me===le.s.r&&(Ne[H]=Cr(H));var Ve=Ne[H]+Fe,je=ye?(j[me]||[])[H]:j[Ve];if(!(!je||je.t=="z"))if(je.t=="n")(je.v|0)==je.v&&je.v>=-32768&&je.v<=32767?Pi(Y,13,v(me,H,je.v)):Pi(Y,14,y(me,H,je.v));else{var tt=Ps(je);Pi(Y,15,m(me,H,tt.slice(0,239)))}}return Pi(Y,1),Y.end()}function i(j,re){var Q=re||{};if(+Q.codepage>=0&&Fi(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=rm();Pi(Y,0,o(j));for(var le=0,ye=0;le<j.SheetNames.length;++le)(j.Sheets[j.SheetNames[le]]||{})["!ref"]&&Pi(Y,27,te(j.SheetNames[le],ye++));var Ne=0;for(le=0;le<j.SheetNames.length;++le){var ee=j.Sheets[j.SheetNames[le]];if(!(!ee||!ee["!ref"])){for(var me=or(ee["!ref"]),Fe=Array.isArray(ee),H=[],Ve=Math.min(me.e.r,8191),je=me.s.r;je<=Ve;++je)for(var tt=Kr(je),Ze=me.s.c;Ze<=me.e.c;++Ze){je===me.s.r&&(H[Ze]=Cr(Ze));var Pe=H[Ze]+tt,ne=Fe?(ee[je]||[])[Ze]:ee[Pe];if(!(!ne||ne.t=="z"))if(ne.t=="n")Pi(Y,23,D(je,Ze,Ne,ne.v));else{var De=Ps(ne);Pi(Y,22,S(je,Ze,Ne,De.slice(0,239)))}}++Ne}}return Pi(Y,1),Y.end()}function s(j){var re=Ar(2);return re.write_shift(2,j),re}function o(j){var re=Ar(26);re.write_shift(2,4096),re.write_shift(2,4),re.write_shift(4,0);for(var Q=0,Y=0,le=0,ye=0;ye<j.SheetNames.length;++ye){var Ne=j.SheetNames[ye],ee=j.Sheets[Ne];if(!(!ee||!ee["!ref"])){++le;var me=Ml(ee["!ref"]);Q<me.e.r&&(Q=me.e.r),Y<me.e.c&&(Y=me.e.c)}}return Q>8191&&(Q=8191),re.write_shift(2,Q),re.write_shift(1,le),re.write_shift(1,Y),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(1,1),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(4,0),re}function l(j,re,Q){var Y={s:{c:0,r:0},e:{c:0,r:0}};return re==8&&Q.qpro?(Y.s.c=j.read_shift(1),j.l++,Y.s.r=j.read_shift(2),Y.e.c=j.read_shift(1),j.l++,Y.e.r=j.read_shift(2),Y):(Y.s.c=j.read_shift(2),Y.s.r=j.read_shift(2),re==12&&Q.qpro&&(j.l+=2),Y.e.c=j.read_shift(2),Y.e.r=j.read_shift(2),re==12&&Q.qpro&&(j.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function u(j){var re=Ar(8);return re.write_shift(2,j.s.c),re.write_shift(2,j.s.r),re.write_shift(2,j.e.c),re.write_shift(2,j.e.r),re}function h(j,re,Q){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(Y[0].c=j.read_shift(1),Y[3]=j.read_shift(1),Y[0].r=j.read_shift(2),j.l+=2):(Y[2]=j.read_shift(1),Y[0].c=j.read_shift(2),Y[0].r=j.read_shift(2)),Y}function p(j,re,Q){var Y=j.l+re,le=h(j,re,Q);if(le[1].t="s",Q.vers==20768){j.l++;var ye=j.read_shift(1);return le[1].v=j.read_shift(ye,"utf8"),le}return Q.qpro&&j.l++,le[1].v=j.read_shift(Y-j.l,"cstr"),le}function m(j,re,Q){var Y=Ar(7+Q.length);Y.write_shift(1,255),Y.write_shift(2,re),Y.write_shift(2,j),Y.write_shift(1,39);for(var le=0;le<Y.length;++le){var ye=Q.charCodeAt(le);Y.write_shift(1,ye>=128?95:ye)}return Y.write_shift(1,0),Y}function _(j,re,Q){var Y=h(j,re,Q);return Y[1].v=j.read_shift(2,"i"),Y}function v(j,re,Q){var Y=Ar(7);return Y.write_shift(1,255),Y.write_shift(2,re),Y.write_shift(2,j),Y.write_shift(2,Q,"i"),Y}function E(j,re,Q){var Y=h(j,re,Q);return Y[1].v=j.read_shift(8,"f"),Y}function y(j,re,Q){var Y=Ar(13);return Y.write_shift(1,255),Y.write_shift(2,re),Y.write_shift(2,j),Y.write_shift(8,Q,"f"),Y}function w(j,re,Q){var Y=j.l+re,le=h(j,re,Q);if(le[1].v=j.read_shift(8,"f"),Q.qpro)j.l=Y;else{var ye=j.read_shift(2);U(j.slice(j.l,j.l+ye),le),j.l+=ye}return le}function k(j,re,Q){var Y=re&32768;return re&=-32769,re=(Y?j:0)+(re>=8192?re-16384:re),(Y?"":"$")+(Q?Cr(re):Kr(re))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(j,re){Wr(j,0);for(var Q=[],Y=0,le="",ye="",Ne="",ee="";j.l<j.length;){var me=j[j.l++];switch(me){case 0:Q.push(j.read_shift(8,"f"));break;case 1:ye=k(re[0].c,j.read_shift(2),!0),le=k(re[0].r,j.read_shift(2),!1),Q.push(ye+le);break;case 2:{var Fe=k(re[0].c,j.read_shift(2),!0),H=k(re[0].r,j.read_shift(2),!1);ye=k(re[0].c,j.read_shift(2),!0),le=k(re[0].r,j.read_shift(2),!1),Q.push(Fe+H+":"+ye+le)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(j.read_shift(2));break;case 6:{for(var Ve="";me=j[j.l++];)Ve+=String.fromCharCode(me);Q.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:ee=Q.pop(),Ne=Q.pop(),Q.push(["AND","OR"][me-20]+"("+Ne+","+ee+")");break;default:if(me<32&&A[me])ee=Q.pop(),Ne=Q.pop(),Q.push(Ne+A[me]+ee);else if(C[me]){if(Y=C[me][1],Y==69&&(Y=j[j.l++]),Y>Q.length){console.error("WK1 bad formula parse 0x"+me.toString(16)+":|"+Q.join("|")+"|");return}var je=Q.slice(-Y);Q.length-=Y,Q.push(C[me][0]+"("+je.join(",")+")")}else return me<=7?console.error("WK1 invalid opcode "+me.toString(16)):me<=24?console.error("WK1 unsupported op "+me.toString(16)):me<=30?console.error("WK1 invalid opcode "+me.toString(16)):me<=115?console.error("WK1 unsupported function opcode "+me.toString(16)):console.error("WK1 unrecognized opcode "+me.toString(16))}}Q.length==1?re[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function q(j){var re=[{c:0,r:0},{t:"n",v:0},0];return re[0].r=j.read_shift(2),re[3]=j[j.l++],re[0].c=j[j.l++],re}function K(j,re){var Q=q(j);return Q[1].t="s",Q[1].v=j.read_shift(re-4,"cstr"),Q}function S(j,re,Q,Y){var le=Ar(6+Y.length);le.write_shift(2,j),le.write_shift(1,Q),le.write_shift(1,re),le.write_shift(1,39);for(var ye=0;ye<Y.length;++ye){var Ne=Y.charCodeAt(ye);le.write_shift(1,Ne>=128?95:Ne)}return le.write_shift(1,0),le}function R(j,re){var Q=q(j);Q[1].v=j.read_shift(2);var Y=Q[1].v>>1;if(Q[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return Q[1].v=Y,Q}function P(j,re){var Q=q(j),Y=j.read_shift(4),le=j.read_shift(4),ye=j.read_shift(2);if(ye==65535)return Y===0&&le===3221225472?(Q[1].t="e",Q[1].v=15):Y===0&&le===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var Ne=ye&32768;return ye=(ye&32767)-16446,Q[1].v=(1-Ne*2)*(le*Math.pow(2,ye+32)+Y*Math.pow(2,ye)),Q}function D(j,re,Q,Y){var le=Ar(14);if(le.write_shift(2,j),le.write_shift(1,Q),le.write_shift(1,re),Y==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var ye=0,Ne=0,ee=0,me=0;return Y<0&&(ye=1,Y=-Y),Ne=Math.log2(Y)|0,Y/=Math.pow(2,Ne-31),me=Y>>>0,me&2147483648||(Y/=2,++Ne,me=Y>>>0),Y-=me,me|=2147483648,me>>>=0,Y*=Math.pow(2,32),ee=Y>>>0,le.write_shift(4,ee),le.write_shift(4,me),Ne+=16383+(ye?32768:0),le.write_shift(2,Ne),le}function F(j,re){var Q=P(j);return j.l+=re-14,Q}function b(j,re){var Q=q(j),Y=j.read_shift(4);return Q[1].v=Y>>6,Q}function M(j,re){var Q=q(j),Y=j.read_shift(8,"f");return Q[1].v=Y,Q}function Ce(j,re){var Q=M(j);return j.l+=re-10,Q}function Ie(j,re){return j[j.l+re-1]==0?j.read_shift(re,"cstr"):""}function Re(j,re){var Q=j[j.l++];Q>re-1&&(Q=re-1);for(var Y="";Y.length<Q;)Y+=String.fromCharCode(j[j.l++]);return Y}function ke(j,re,Q){if(!(!Q.qpro||re<21)){var Y=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var le=j.read_shift(re-21,"cstr");return[Y,le]}}function fe(j,re){for(var Q={},Y=j.l+re;j.l<Y;){var le=j.read_shift(2);if(le==14e3){for(Q[le]=[0,""],Q[le][0]=j.read_shift(2);j[j.l];)Q[le][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return Q}function te(j,re){var Q=Ar(5+j.length);Q.write_shift(2,14e3),Q.write_shift(2,re);for(var Y=0;Y<j.length;++Y){var le=j.charCodeAt(Y);Q[Q.l++]=le>127?95:le}return Q[Q.l++]=0,Q}var de={0:{n:"BOF",f:yr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ie},222:{n:"SHEETNAMELP",f:Re},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:K},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ke},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function rO(e){var t={},r=e.match(pn),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Je(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Og[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var nO=function(){var e=Tu("t"),t=Tu("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:wt(o[1])},u=s.match(t);return u&&(l.s=rO(u[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(l){return l.v})}}(),iO=function(){var t=/(\r\n|\n)/g;function r(i,s,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),sO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,aO=/<(?:\w+:)?r>/,oO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Xg(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=wt(Ht(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ht(e),r&&(n.h=Ug(n.t))):e.match(aO)&&(n.r=Ht(e),n.t=wt(Ht((e.replace(oO,"").match(sO)||[]).join("").replace(pn,""))),r&&(n.h=iO(nO(n.r)))),n):{t:""}}var lO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,cO=/<(?:\w+:)?(?:si|sstItem)>/g,uO=/<\/(?:\w+:)?(?:si|sstItem)>/;function fO(e,t){var r=[],n="";if(!e)return r;var i=e.match(lO);if(i){n=i[2].replace(cO,"").split(uO);for(var s=0;s!=n.length;++s){var o=Xg(n[s].trim(),t);o!=null&&(r[r.length]=o)}i=Je(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function hO(e){return[e.read_shift(4),e.read_shift(4)]}function dO(e,t){var r=[],n=!1;return bs(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function fA(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ws(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function pO(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ws(e,4),t.U=ws(e,4),t.W=ws(e,4),t}function mO(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function gO(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(mO(e));return t}function _O(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function vO(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ws(e,4),t.U=ws(e,4),t.W=ws(e,4),t}function xO(e){var t=vO(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function hA(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function dA(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function yO(e){var t=ws(e);switch(t.Minor){case 2:return[t.Minor,EO(e)];case 3:return[t.Minor,TO()];case 4:return[t.Minor,AO(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function EO(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=hA(e,r),i=dA(e,e.length-e.l);return{t:"Std",h:n,v:i}}function TO(){throw new Error("File is password-protected: ECMA-376 Extensible")}function AO(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(pn,function(s){var o=Je(s);switch(is(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function wO(e,t){var r={},n=r.EncryptionVersionInfo=ws(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=hA(e,i),t-=i,r.EncryptionVerifier=dA(e,t),r}function SO(e){var t={},r=t.EncryptionVersionInfo=ws(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function IO(e){var t=0,r,n=fA(e),i=n.length+1,s,o,l,u,h;for(r=xa(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],l=t&16384?1:0,u=t<<1&32767,h=l|u,t=h^o;return t^52811}var pA=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],u=104,h=o.length-1;h>=0;--h)for(var p=o[h],m=0;m!=7;++m)p&64&&(l^=r[u]),p*=2,--u;return l};return function(o){for(var l=fA(o),u=s(l),h=l.length,p=xa(16),m=0;m!=16;++m)p[m]=0;var _,v,E;for((h&1)===1&&(_=u>>8,p[h]=i(e[0],_),--h,_=u&255,v=l[l.length-1],p[h]=i(v,_));h>0;)--h,_=u>>8,p[h]=i(l[h],_),--h,_=u&255,p[h]=i(l[h],_);for(h=15,E=15-l.length;E>0;)_=u>>8,p[h]=i(e[E],_),--h,--E,_=u&255,p[h]=i(l[h],_),--h,--E;return p}}(),CO=function(e,t,r,n,i){i||(i=t),n||(n=pA(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},kO=function(e){var t=0,r=pA(e);return function(n){var i=CO("",n,t,r);return t=i[1],i[0]}};function RO(e,t,r,n){var i={key:yr(e),verificationBytes:yr(e)};return r.password&&(i.verifier=IO(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=kO(r.password)),i}function PO(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=SO(e):n.Data=wO(e,t),n}function NO(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?PO(e,t-2,n):RO(e,r.biff>=8?t:t-2,r,n),n}var OO=function(){function e(i,s){switch(s.type){case"base64":return t(Jn(i),s);case"binary":return t(i,s);case"buffer":return t(_t&&Buffer.isBuffer(i)?i.toString("binary"):uo(i),s);case"array":return t(to(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},l=o.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(p,m){Array.isArray(l)&&(l[m]=[]);for(var _=/\\\w+\b/g,v=0,E,y=-1;E=_.exec(p);){switch(E[0]){case"\\cell":var w=p.slice(v,_.lastIndex-E[0].length);if(w[0]==" "&&(w=w.slice(1)),++y,w.length){var k={v:w,t:"s"};Array.isArray(l)?l[m][y]=k:l[at({r:m,c:y})]=k}break}v=_.lastIndex}y>h.e.c&&(h.e.c=y)}),l["!ref"]=Et(h),l}function r(i,s){return ka(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=or(i["!ref"]),l,u=Array.isArray(i),h=o.s.r;h<=o.e.r;++h){s.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)s.push("\\cellx"+(p+1));for(s.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var m=at({r:h,c:p});l=u?(i[h]||[])[p]:i[m],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(Ps(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function LO(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Su(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function DO(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(o===0)return[0,0,t];var l=0,u=0,h=i+s;switch(u=o/(h>1?2-h:h),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,u,h/2]}function FO(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],l=6*t,u;if(r!==0)switch(l|0){case 0:case 6:u=i*l,o[0]+=i,o[1]+=u;break;case 1:u=i*(2-l),o[0]+=u,o[1]+=i;break;case 2:u=i*(l-2),o[1]+=i,o[2]+=u;break;case 3:u=i*(4-l),o[1]+=u,o[2]+=i;break;case 4:u=i*(l-4),o[2]+=i,o[0]+=u;break;case 5:u=i*(6-l),o[2]+=u,o[0]+=i;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function qh(e,t){if(t===0)return e;var r=DO(LO(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Su(FO(r))}var mA=6,bO=15,MO=1,yn=mA;function Yh(e){return Math.floor((e+Math.round(128/yn)/256)*yn)}function Jh(e){return Math.floor((e-5)/yn*100+.5)/100}function am(e){return Math.round((e*yn+5)/yn*256)/256}function Ud(e){return am(Jh(Yh(e)))}function qg(e){var t=Math.abs(e-Ud(e)),r=yn;if(t>.005)for(yn=MO;yn<bO;++yn)Math.abs(e-Ud(e))<=t&&(t=Math.abs(e-Ud(e)),r=yn);yn=r}function wl(e){e.width?(e.wpx=Yh(e.width),e.wch=Jh(e.wpx),e.MDW=yn):e.wpx?(e.wch=Jh(e.wpx),e.width=am(e.wch),e.MDW=yn):typeof e.wch=="number"&&(e.width=am(e.wch),e.wpx=Yh(e.width),e.MDW=yn),e.customWidth&&delete e.customWidth}var BO=96,gA=BO;function _A(e){return e*96/gA}function Iu(e){return e*gA/96}var UO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function VO(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(pn)||[]).forEach(function(o){var l=Je(o);switch(is(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=Xt(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=Xt(l.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function zO(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(pn)||[]).forEach(function(o){var l=Je(o);switch(is(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function jO(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(pn)||[]).forEach(function(o){var l=Je(o);switch(is(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=Ht(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?Xt(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?Xt(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?Xt(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?Xt(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?Xt(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?Xt(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?Xt(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Og[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=Xt(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var u=$a[i.color.index];i.color.index==81&&(u=$a[1]),u||(u=$a[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=qh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function HO(e,t,r){t.NumberFmt=[];for(var n=ts(ut),i=0;i<n.length;++i)t.NumberFmt[n[i]]=ut[n[i]];var s=e[0].match(pn);if(s)for(i=0;i<s.length;++i){var o=Je(s[i]);switch(is(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=wt(Ht(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=l,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=l}Ga(l,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var $f=["numFmtId","fillId","fontId","borderId","xfId"],Zf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function WO(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(pn)||[]).forEach(function(s){var o=Je(s),l=0;switch(is(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<$f.length;++l)n[$f[l]]&&(n[$f[l]]=parseInt(n[$f[l]],10));for(l=0;l<Zf.length;++l)n[Zf[l]]&&(n[Zf[l]]=Xt(n[Zf[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Xt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var GO=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,u,h){var p={};if(!l)return p;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=l.match(t))&&HO(m,p,h),(m=l.match(i))&&jO(m,p,u,h),(m=l.match(n))&&zO(m,p,u,h),(m=l.match(s))&&VO(m,p,u,h),(m=l.match(r))&&WO(m,p,h),p}}();function $O(e,t){var r=e.read_shift(2),n=fn(e);return[r,n]}function ZO(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=nP(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var u=e.read_shift(1);switch(u>0&&(n.charset=u),e.l++,n.color=rP(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=fn(e),n}var KO=dn;function XO(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var qO=dn;function YO(e,t,r){var n={};n.NumberFmt=[];for(var i in ut)n.NumberFmt[i]=ut[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return bs(e,function(u,h,p){switch(p){case 44:n.NumberFmt[u[0]]=u[1],Ga(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=qh(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(p),o=!0;break;case 38:s.pop(),o=!1;break;default:if(h.T>0)s.push(p);else if(h.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}var JO=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function QO(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(pn)||[]).forEach(function(i){var s=Je(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[JO.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function eL(){}function tL(){}var rL=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,nL=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,iL=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function sL(e,t,r){t.themeElements={};var n;[["clrScheme",rL,QO],["fontScheme",nL,eL],["fmtScheme",iL,tL]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var aL=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function vA(e,t){(!e||e.length===0)&&(e=oL());var r,n={};if(!(r=e.match(aL)))throw new Error("themeElements not found in theme");return sL(r[0],n,t),n.raw=e,n}function oL(e,t){var r=[RT];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function lL(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=kT(s,{type:"array"})}catch{return}var l=$n(o,"theme/theme/theme1.xml",!0);if(l)return vA(l,r)}}function cL(e){return e.read_shift(4)}function uL(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=fL(e,4);break;case 2:t.xclrValue=iA(e);break;case 3:t.xclrValue=cL(e);break;case 4:e.l+=4;break}return e.l+=8,t}function fL(e,t){return dn(e,t)}function hL(e,t){return dn(e,t)}function dL(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=uL(e);break;case 6:n[1]=hL(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function pL(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(dL(e,r-e.l));return{ixfe:n,ext:s}}function mL(e,t){t.forEach(function(r){switch(r[0]){}})}function gL(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:fn(e)}}function _L(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function vL(e){return e.l+=4,e.read_shift(4)!=0}function xL(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,l=2;return bs(e,function(u,h,p){switch(p){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(m){l==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):l==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:l=u?1:0;break;case 338:l=2;break;case 35:s.push(p),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!h.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function yL(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,o;return e.replace(pn,function(l){var u=Je(l);switch(is(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==u.name&&(o=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):s==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return l}),n}function EL(e){var t=[];if(!e)return t;var r=1;return(e.match(pn)||[]).forEach(function(n){var i=Je(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function TL(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=at(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function AL(e,t,r){var n=[];return bs(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function wL(e,t,r,n){if(!e)return e;var i=n||{},s=!1;bs(e,function(l,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function SL(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function ux(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(o){var l=En(o.ref);if(i?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},i?e[l.r][l.c]=s:e[o.ref]=s;var u=or(e["!ref"]||"BDWGO1000001:A1");u.s.r>l.r&&(u.s.r=l.r),u.e.r<l.r&&(u.e.r=l.r),u.s.c>l.c&&(u.s.c=l.c),u.e.c<l.c&&(u.e.c=l.c);var h=Et(u);h!==e["!ref"]&&(e["!ref"]=h)}s.c||(s.c=[]);var p={a:o.author,t:o.t,r:o.r,T:r};o.h&&(p.h=o.h);for(var m=s.c.length-1;m>=0;--m){if(!r&&s.c[m].T)return;r&&!s.c[m].T&&s.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(p.a==n[m].id){p.a=n[m].name||p.a;break}}s.c.push(p)})}function IL(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var u=Je(l[0]),h={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},p=En(u.ref);if(!(t.sheetRows&&t.sheetRows<=p.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!m&&!!m[1]&&Xg(m[1])||{r:"",t:"",h:""};h.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),h.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=_.h),n.push(h)}}}}),n}function CL(e,t){var r=[],n=!1,i={},s=0;return e.replace(pn,function(l,u){var h=Je(l);switch(is(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=u+l.length;break;case"</text>":i.t=e.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return l}),r}function kL(e,t){var r=[],n=!1;return e.replace(pn,function(s){var o=Je(s);switch(is(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function RL(e){var t={};t.iauthor=e.read_shift(4);var r=ho(e);return t.rfx=r.s,t.ref=at(r.s),e.l+=16,t}var PL=fn;function NL(e,t){var r=[],n=[],i={},s=!1;return bs(e,function(l,u,h){switch(h){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}var OL="application/vnd.ms-office.vbaProject";function LL(e){var t=yt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");yt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),yt.write(t)}function DL(){return{"!type":"dialog"}}function FL(){return{"!type":"dialog"}}function bL(){return{"!type":"macro"}}function ML(){return{"!type":"macro"}}var hl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,o){var l=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var h=s.length>0?parseInt(s,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return l?p+=t.c:--p,u?h+=t.r:--h,i+(l?"":"$")+Cr(p)+(u?"":"$")+Kr(h)}return function(i,s){return t=s,i.replace(e,r)}}(),xA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,BL=function(){return function(t,r){return t.replace(xA,function(n,i,s,o,l,u){var h=Hg(o)-(s?0:r.c),p=jg(u)-(l?0:r.r),m=p==0?"":l?p+1:"["+p+"]",_=h==0?"":s?h+1:"["+h+"]";return i+"R"+m+"C"+_})}}();function yA(e,t){return e.replace(xA,function(r,n,i,s,o,l){return n+(i=="$"?i+s:Cr(Hg(s)+t.c))+(o=="$"?o+l:Kr(jg(l)+t.r))})}function UL(e,t,r){var n=Ml(t),i=n.s,s=En(r),o={r:s.r-i.r,c:s.c-i.c};return yA(e,o)}function VL(e){return e.length!=1}function fx(e){return e.replace(/_xlfn\./g,"")}function _r(e){e.l+=1}function ya(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function EA(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return TA(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=ya(e),l=ya(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function TA(e){var t=ya(e),r=ya(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function zL(e,t,r){if(r.biff<8)return TA(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=ya(e),o=ya(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function AA(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return jL(e);var n=e.read_shift(r&&r.biff==12?4:2),i=ya(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function jL(e){var t=ya(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function HL(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function WL(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return GL(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:l}}function GL(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function $L(e,t,r){var n=(e[e.l++]&96)>>5,i=EA(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function ZL(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=EA(e,s,r);return[n,i,o]}function KL(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function XL(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function qL(e,t,r){var n=(e[e.l++]&96)>>5,i=zL(e,t-1,r);return[n,i]}function YL(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function hx(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function JL(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function QL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function e3(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function t3(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function r3(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function wA(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function n3(e){return e.read_shift(2),wA(e)}function i3(e){return e.read_shift(2),wA(e)}function s3(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=AA(e,0,r);return[n,i]}function a3(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=WL(e,0,r);return[n,i]}function o3(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=AA(e,0,r);return[n,i,s]}function l3(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[cD[i],CA[i],n]}function c3(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:u3(e);return[i,(s[0]===0?CA:lD)[s[1]]]}function u3(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function f3(e,t,r){e.l+=r&&r.biff==2?3:4}function h3(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function d3(e){return e.l++,po[e.read_shift(1)]}function p3(e){return e.l++,e.read_shift(2)}function m3(e){return e.l++,e.read_shift(1)!==0}function g3(e){return e.l++,cn(e)}function _3(e,t,r){return e.l++,Wu(e,t-1,r)}function v3(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=ur(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=po[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=cn(e);break;case 2:r[1]=mo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function x3(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ho:b0)(e));return i}function y3(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=i;++l)o[s][l]=v3(e,r.biff);return o}function E3(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function T3(e,t,r){if(r.biff==5)return A3(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function A3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function w3(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function S3(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function I3(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function C3(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var k3=dn,R3=dn,P3=dn;function $u(e,t,r){return e.l+=2,[HL(e)]}function Yg(e){return e.l+=6,[]}var N3=$u,O3=Yg,L3=Yg,D3=$u;function SA(e){return e.l+=2,[yr(e),e.read_shift(2)&1]}var F3=$u,b3=SA,M3=Yg,B3=$u,U3=$u,V3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function z3(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=V3[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:s}}function j3(e){return e.l+=2,[e.read_shift(4)]}function H3(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function W3(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function G3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function $3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Z3(e){return e.l+=4,[0,0]}var dx={1:{n:"PtgExp",f:h3},2:{n:"PtgTbl",f:P3},3:{n:"PtgAdd",f:_r},4:{n:"PtgSub",f:_r},5:{n:"PtgMul",f:_r},6:{n:"PtgDiv",f:_r},7:{n:"PtgPower",f:_r},8:{n:"PtgConcat",f:_r},9:{n:"PtgLt",f:_r},10:{n:"PtgLe",f:_r},11:{n:"PtgEq",f:_r},12:{n:"PtgGe",f:_r},13:{n:"PtgGt",f:_r},14:{n:"PtgNe",f:_r},15:{n:"PtgIsect",f:_r},16:{n:"PtgUnion",f:_r},17:{n:"PtgRange",f:_r},18:{n:"PtgUplus",f:_r},19:{n:"PtgUminus",f:_r},20:{n:"PtgPercent",f:_r},21:{n:"PtgParen",f:_r},22:{n:"PtgMissArg",f:_r},23:{n:"PtgStr",f:_3},26:{n:"PtgSheet",f:H3},27:{n:"PtgEndSheet",f:W3},28:{n:"PtgErr",f:d3},29:{n:"PtgBool",f:m3},30:{n:"PtgInt",f:p3},31:{n:"PtgNum",f:g3},32:{n:"PtgArray",f:YL},33:{n:"PtgFunc",f:l3},34:{n:"PtgFuncVar",f:c3},35:{n:"PtgName",f:E3},36:{n:"PtgRef",f:s3},37:{n:"PtgArea",f:$L},38:{n:"PtgMemArea",f:w3},39:{n:"PtgMemErr",f:k3},40:{n:"PtgMemNoMem",f:R3},41:{n:"PtgMemFunc",f:S3},42:{n:"PtgRefErr",f:I3},43:{n:"PtgAreaErr",f:KL},44:{n:"PtgRefN",f:a3},45:{n:"PtgAreaN",f:qL},46:{n:"PtgMemAreaN",f:G3},47:{n:"PtgMemNoMemN",f:$3},57:{n:"PtgNameX",f:T3},58:{n:"PtgRef3d",f:o3},59:{n:"PtgArea3d",f:ZL},60:{n:"PtgRefErr3d",f:C3},61:{n:"PtgAreaErr3d",f:XL},255:{}},K3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},X3={1:{n:"PtgElfLel",f:SA},2:{n:"PtgElfRw",f:B3},3:{n:"PtgElfCol",f:N3},6:{n:"PtgElfRwV",f:U3},7:{n:"PtgElfColV",f:D3},10:{n:"PtgElfRadical",f:F3},11:{n:"PtgElfRadicalS",f:M3},13:{n:"PtgElfColS",f:O3},15:{n:"PtgElfColSV",f:L3},16:{n:"PtgElfRadicalLel",f:b3},25:{n:"PtgList",f:z3},29:{n:"PtgSxName",f:j3},255:{}},q3={0:{n:"PtgAttrNoop",f:Z3},1:{n:"PtgAttrSemi",f:r3},2:{n:"PtgAttrIf",f:e3},4:{n:"PtgAttrChoose",f:JL},8:{n:"PtgAttrGoto",f:QL},16:{n:"PtgAttrSum",f:f3},32:{n:"PtgAttrBaxcel",f:hx},33:{n:"PtgAttrBaxcel",f:hx},64:{n:"PtgAttrSpace",f:n3},65:{n:"PtgAttrSpaceSemi",f:i3},128:{n:"PtgAttrIfError",f:t3},255:{}};function Zu(e,t,r,n){if(n.biff<8)return dn(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=y3(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=x3(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&s.push(dn(e,t)),s}function Ku(e,t,r){for(var n=e.l+t,i,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],i=dx[s]||dx[K3[s]],(s===24||s===25)&&(i=(s===24?X3:q3)[e[e.l+1]]),!i||!i.f?dn(e,t):o.push([i.n,i.f(e,t,r)]);return o}function Y3(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var J3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Q3(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function IA(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function px(e,t,r){var n=IA(e,t,r);return n=="#REF"?n:Q3(n,r)}function an(e,t,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},l=[],u,h,p,m=0,_=0,v,E="";if(!e[0]||!e[0][0])return"";for(var y=-1,w="",k=0,C=e[0].length;k<C;++k){var A=e[0][k];switch(A[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),h=l.pop(),y>=0){switch(e[0][y][1][0]){case 0:w=ar(" ",e[0][y][1][1]);break;case 1:w=ar("\r",e[0][y][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}h=h+w,y=-1}l.push(h+J3[A[0]]+u);break;case"PtgIsect":u=l.pop(),h=l.pop(),l.push(h+" "+u);break;case"PtgUnion":u=l.pop(),h=l.pop(),l.push(h+","+u);break;case"PtgRange":u=l.pop(),h=l.pop(),l.push(h+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=jc(A[1][1],o,i),l.push(Hc(p,s));break;case"PtgRefN":p=r?jc(A[1][1],r,i):A[1][1],l.push(Hc(p,s));break;case"PtgRef3d":m=A[1][1],p=jc(A[1][2],o,i),E=px(n,m,i),l.push(E+"!"+Hc(p,s));break;case"PtgFunc":case"PtgFuncVar":var U=A[1][0],q=A[1][1];U||(U=0),U&=127;var K=U==0?[]:l.slice(-U);l.length-=U,q==="User"&&(q=K.shift()),l.push(q+"("+K.join(",")+")");break;case"PtgBool":l.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(A[1]);break;case"PtgNum":l.push(String(A[1]));break;case"PtgStr":l.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(A[1]);break;case"PtgAreaN":v=Kv(A[1][1],r?{s:r}:o,i),l.push(Md(v,i));break;case"PtgArea":v=Kv(A[1][1],o,i),l.push(Md(v,i));break;case"PtgArea3d":m=A[1][1],v=A[1][2],E=px(n,m,i),l.push(E+"!"+Md(v,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=A[1][2];var S=(n.names||[])[_-1]||(n[0]||[])[_],R=S?S.Name:"SH33TJSNAME"+String(_);R&&R.slice(0,6)=="_xlfn."&&!i.xlfn&&(R=R.slice(6)),l.push(R);break;case"PtgNameX":var P=A[1][1];_=A[1][2];var D;if(i.biff<=5)P<0&&(P=-P),n[P]&&(D=n[P][_]);else{var F="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][_]&&n[P][_].itab>0&&(F=n.SheetNames[n[P][_].itab-1]+"!"):F=n.SheetNames[_-1]+"!"),n[P]&&n[P][_])F+=n[P][_].Name;else if(n[0]&&n[0][_])F+=n[0][_].Name;else{var b=(IA(n,P,i)||"").split(";;");b[_-1]?F=b[_-1]:F+="SH33TJSERRX"}l.push(F);break}D||(D={Name:"SH33TJSERRY"}),l.push(D.Name);break;case"PtgParen":var M="(",Ce=")";if(y>=0){switch(w="",e[0][y][1][0]){case 2:M=ar(" ",e[0][y][1][1])+M;break;case 3:M=ar("\r",e[0][y][1][1])+M;break;case 4:Ce=ar(" ",e[0][y][1][1])+Ce;break;case 5:Ce=ar("\r",e[0][y][1][1])+Ce;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}l.push(M+l.pop()+Ce);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":p={c:A[1][1],r:A[1][0]};var Ie={c:r.c,r:r.r};if(n.sharedf[at(p)]){var Re=n.sharedf[at(p)];l.push(an(Re,o,Ie,n,i))}else{var ke=!1;for(u=0;u!=n.arrayf.length;++u)if(h=n.arrayf[u],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){l.push(an(h[1],o,Ie,n,i)),ke=!0;break}ke||l.push(A[1])}break;case"PtgArray":l.push("{"+Y3(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&fe.indexOf(e[0][k][0])==-1){A=e[0][y];var te=!0;switch(A[1][0]){case 4:te=!1;case 0:w=ar(" ",A[1][1]);break;case 5:te=!1;case 1:w=ar("\r",A[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}l.push((te?w:"")+l.pop()+(te?"":w)),y=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function eD(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],dn(e,t-2)];var l=Ku(e,o,r);return t!==o+i&&(s=Zu(e,t-o-i,l,r)),e.l=n,[l,s]}function tD(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],dn(e,t-2)];var l=Ku(e,o,r);return t!==o+i&&(s=Zu(e,t-o-i,l,r)),e.l=n,[l,s]}function rD(e,t,r,n){var i=e.l+t,s=Ku(e,n,r),o;return i!==e.l&&(o=Zu(e,i-e.l,s,r)),[s,o]}function nD(e,t,r){var n=e.l+t,i,s=e.read_shift(2),o=Ku(e,s,r);return s==65535?[[],dn(e,t-2)]:(t!==s+2&&(i=Zu(e,n-s-2,o,r)),[o,i])}function iD(e){var t;if(Es(e,e.l+6)!==65535)return[cn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Vd(e,t,r){var n=e.l+t,i=ss(e);r.biff==2&&++e.l;var s=iD(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=tD(e,n-e.l,r);return{cell:i,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function M0(e,t,r){var n=e.read_shift(4),i=Ku(e,n,r),s=e.read_shift(4),o=s>0?Zu(e,s,i,r):null;return[i,o]}var sD=M0,B0=M0,aD=M0,oD=M0,lD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},CA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function mx(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Zc={},dl={};function Kc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function kA(e,t,r,n,i,s){try{n.cellNF&&(e.z=ut[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Vr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ut[t]==null&&Ga(u4[t]||"General",t),e.t==="e")e.w=e.w||po[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Eu(e.v);else if(e.t==="d"){var o=wn(e.v);(o|0)===o?e.w=o.toString(10):e.w=Eu(o)}else{if(e.v===void 0)return"";e.w=eo(e.v,dl)}else e.t==="d"?e.w=Ei(t,wn(e.v),dl):e.w=Ei(t,e.v,dl)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=qh(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=qh(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function uD(e,t){var r=or(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Et(r))}var fD=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,hD=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,dD=/<(?:\w:)?hyperlink [^>]*>/mg,pD=/"(\w*:\w*)"/,mD=/<(?:\w:)?col\b[^>]*[\/]?>/g,gD=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,_D=/<(?:\w:)?pageMargins[^>]*\/>/g,RA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,vD=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,xD=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function yD(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",m=e.match(hD);m?(h=e.slice(0,m.index),p=e.slice(m.index+m[0].length)):h=p=e;var _=h.match(RA);_?Jg(_[0],l,i,r):(_=h.match(vD))&&ED(_[0],_[1]||"",l,i,r);var v=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var E=h.slice(v,v+50).match(pD);E&&uD(l,E[1])}var y=h.match(xD);y&&y[1]&&CD(y[1],i);var w=[];if(t.cellStyles){var k=h.match(mD);k&&wD(w,k)}m&&kD(m[1],l,t,u,s,o);var C=p.match(gD);C&&(l["!autofilter"]=SD(C[0]));var A=[],U=p.match(fD);if(U)for(v=0;v!=U.length;++v)A[v]=or(U[v].slice(U[v].indexOf('"')+1));var q=p.match(dD);q&&TD(l,q,n);var K=p.match(_D);if(K&&(l["!margins"]=AD(Je(K[0]))),!l["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(l["!ref"]=Et(u)),t.sheetRows>0&&l["!ref"]){var S=or(l["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>u.e.r&&(S.e.r=u.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>u.e.c&&(S.e.c=u.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Et(S))}return w.length>0&&(l["!cols"]=w),A.length>0&&(l["!merges"]=A),l}function Jg(e,t,r,n){var i=Je(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=wt(Ht(i.codeName)))}function ED(e,t,r,n,i){Jg(e.slice(0,e.indexOf(">")),r,n,i)}function TD(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Je(Ht(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+wt(s.location))):(s.Target="#"+wt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=or(s.ref),u=l.s.r;u<=l.e.r;++u)for(var h=l.s.c;h<=l.e.c;++h){var p=at({c:h,r:u});n?(e[u]||(e[u]=[]),e[u][h]||(e[u][h]={t:"z",v:void 0}),e[u][h].l=s):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=s)}}}function AD(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function wD(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Je(t[n],!0);i.hidden&&(i.hidden=Xt(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,qg(i.width)),wl(i);s<=o;)e[s++]=Zr(i)}}function SD(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var ID=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function CD(e,t){t.Views||(t.Views=[{}]),(e.match(ID)||[]).forEach(function(r,n){var i=Je(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Xt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var kD=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Tu("v"),o=Tu("f");return function(u,h,p,m,_,v){for(var E=0,y="",w=[],k=[],C=0,A=0,U=0,q="",K,S,R=0,P=0,D,F,b=0,M=0,Ce=Array.isArray(v.CellXf),Ie,Re=[],ke=[],fe=Array.isArray(h),te=[],de={},Ee=!1,j=!!p.sheetStubs,re=u.split(t),Q=0,Y=re.length;Q!=Y;++Q){y=re[Q].trim();var le=y.length;if(le!==0){var ye=0;e:for(E=0;E<le;++E)switch(y[E]){case">":if(y[E-1]!="/"){++E;break e}if(p&&p.cellStyles){if(S=Je(y.slice(ye,E),!0),R=S.r!=null?parseInt(S.r,10):R+1,P=-1,p.sheetRows&&p.sheetRows<R)continue;de={},Ee=!1,S.ht&&(Ee=!0,de.hpt=parseFloat(S.ht),de.hpx=Iu(de.hpt)),S.hidden=="1"&&(Ee=!0,de.hidden=!0),S.outlineLevel!=null&&(Ee=!0,de.level=+S.outlineLevel),Ee&&(te[R-1]=de)}break;case"<":ye=E;break}if(ye>=E)break;if(S=Je(y.slice(ye,E),!0),R=S.r!=null?parseInt(S.r,10):R+1,P=-1,!(p.sheetRows&&p.sheetRows<R)){m.s.r>R-1&&(m.s.r=R-1),m.e.r<R-1&&(m.e.r=R-1),p&&p.cellStyles&&(de={},Ee=!1,S.ht&&(Ee=!0,de.hpt=parseFloat(S.ht),de.hpx=Iu(de.hpt)),S.hidden=="1"&&(Ee=!0,de.hidden=!0),S.outlineLevel!=null&&(Ee=!0,de.level=+S.outlineLevel),Ee&&(te[R-1]=de)),w=y.slice(E).split(e);for(var Ne=0;Ne!=w.length&&w[Ne].trim().charAt(0)=="<";++Ne);for(w=w.slice(Ne),E=0;E!=w.length;++E)if(y=w[E].trim(),y.length!==0){if(k=y.match(r),C=E,A=0,U=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(C=0,q=k[1],A=0;A!=q.length&&!((U=q.charCodeAt(A)-64)<1||U>26);++A)C=26*C+U;--C,P=C}else++P;for(A=0;A!=y.length&&y.charCodeAt(A)!==62;++A);if(++A,S=Je(y.slice(0,A),!0),S.r||(S.r=at({r:R-1,c:P})),q=y.slice(A),K={t:""},(k=q.match(s))!=null&&k[1]!==""&&(K.v=wt(k[1])),p.cellFormula){if((k=q.match(o))!=null&&k[1]!==""){if(K.f=wt(Ht(k[1])).replace(/\r\n/g,`
`),p.xlfn||(K.f=fx(K.f)),k[0].indexOf('t="array"')>-1)K.F=(q.match(i)||[])[1],K.F.indexOf(":")>-1&&Re.push([or(K.F),K.F]);else if(k[0].indexOf('t="shared"')>-1){F=Je(k[0]);var ee=wt(Ht(k[1]));p.xlfn||(ee=fx(ee)),ke[parseInt(F.si,10)]=[F,ee,S.r]}}else(k=q.match(/<f[^>]*\/>/))&&(F=Je(k[0]),ke[F.si]&&(K.f=UL(ke[F.si][1],ke[F.si][2],S.r)));var me=En(S.r);for(A=0;A<Re.length;++A)me.r>=Re[A][0].s.r&&me.r<=Re[A][0].e.r&&me.c>=Re[A][0].s.c&&me.c<=Re[A][0].e.c&&(K.F=Re[A][1])}if(S.t==null&&K.v===void 0)if(K.f||K.F)K.v=0,K.t="n";else if(j)K.t="z";else continue;else K.t=S.t||"n";switch(m.s.c>P&&(m.s.c=P),m.e.c<P&&(m.e.c=P),K.t){case"n":if(K.v==""||K.v==null){if(!j)continue;K.t="z"}else K.v=parseFloat(K.v);break;case"s":if(typeof K.v>"u"){if(!j)continue;K.t="z"}else D=Zc[parseInt(K.v,10)],K.v=D.t,K.r=D.r,p.cellHTML&&(K.h=D.h);break;case"str":K.t="s",K.v=K.v!=null?Ht(K.v):"",p.cellHTML&&(K.h=Ug(K.v));break;case"inlineStr":k=q.match(n),K.t="s",k!=null&&(D=Xg(k[1]))?(K.v=D.t,p.cellHTML&&(K.h=D.h)):K.v="";break;case"b":K.v=Xt(K.v);break;case"d":p.cellDates?K.v=Vr(K.v,1):(K.v=wn(Vr(K.v,1)),K.t="n");break;case"e":(!p||p.cellText!==!1)&&(K.w=K.v),K.v=qT[K.v];break}if(b=M=0,Ie=null,Ce&&S.s!==void 0&&(Ie=v.CellXf[S.s],Ie!=null&&(Ie.numFmtId!=null&&(b=Ie.numFmtId),p.cellStyles&&Ie.fillId!=null&&(M=Ie.fillId))),kA(K,b,M,p,_,v),p.cellDates&&Ce&&K.t=="n"&&bl(ut[b])&&(K.t="d",K.v=F0(K.v)),S.cm&&p.xlmeta){var Fe=(p.xlmeta.Cell||[])[+S.cm-1];Fe&&Fe.type=="XLDAPR"&&(K.D=!0)}if(fe){var H=En(S.r);h[H.r]||(h[H.r]=[]),h[H.r][H.c]=K}else h[S.r]=K}}}}te.length>0&&(h["!rows"]=te)}}();function RD(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var PD=ho;function ND(){}function OD(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=eP(e),r}function LD(e){var t=Ti(e);return[t]}function DD(e){var t=fo(e);return[t]}function FD(e){var t=Ti(e),r=e.read_shift(1);return[t,r,"b"]}function bD(e){var t=fo(e),r=e.read_shift(1);return[t,r,"b"]}function MD(e){var t=Ti(e),r=e.read_shift(1);return[t,r,"e"]}function BD(e){var t=fo(e),r=e.read_shift(1);return[t,r,"e"]}function UD(e){var t=Ti(e),r=e.read_shift(4);return[t,r,"s"]}function VD(e){var t=fo(e),r=e.read_shift(4);return[t,r,"s"]}function zD(e){var t=Ti(e),r=cn(e);return[t,r,"n"]}function PA(e){var t=fo(e),r=cn(e);return[t,r,"n"]}function jD(e){var t=Ti(e),r=$g(e);return[t,r,"n"]}function HD(e){var t=fo(e),r=$g(e);return[t,r,"n"]}function WD(e){var t=Ti(e),r=Wg(e);return[t,r,"is"]}function GD(e){var t=Ti(e),r=fn(e);return[t,r,"str"]}function $D(e){var t=fo(e),r=fn(e);return[t,r,"str"]}function ZD(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(r.cellFormula){e.l+=2;var l=B0(e,n-e.l,r);o[3]=an(l,null,i,r.supbooks,r)}else e.l=n;return o}function KD(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(r.cellFormula){e.l+=2;var l=B0(e,n-e.l,r);o[3]=an(l,null,i,r.supbooks,r)}else e.l=n;return o}function XD(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var s=cn(e),o=[i,s,"n"];if(r.cellFormula){e.l+=2;var l=B0(e,n-e.l,r);o[3]=an(l,null,i,r.supbooks,r)}else e.l=n;return o}function qD(e,t,r){var n=e.l+t,i=Ti(e);i.r=r["!row"];var s=fn(e),o=[i,s,"str"];if(r.cellFormula){e.l+=2;var l=B0(e,n-e.l,r);o[3]=an(l,null,i,r.supbooks,r)}else e.l=n;return o}var YD=ho;function JD(e,t){var r=e.l+t,n=ho(e),i=Gg(e),s=fn(e),o=fn(e),l=fn(e);e.l=r;var u={rfx:n,relId:i,loc:s,display:l};return o&&(u.Tooltip=o),u}function QD(){}function eF(e,t,r){var n=e.l+t,i=ZT(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var l=sD(e,n-e.l,r);o[1]=l}else e.l=n;return o}function tF(e,t,r){var n=e.l+t,i=ho(e),s=[i];if(r.cellFormula){var o=oD(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}var rF=["left","right","top","bottom","header","footer"];function nF(e){var t={};return rF.forEach(function(r){t[r]=cn(e)}),t}function iF(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function sF(){}function aF(){}function oF(e,t,r,n,i,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var u=l.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,_=!1,v,E,y,w,k,C,A,U,q,K=[];l.biff=12,l["!row"]=0;var S=0,R=!1,P=[],D={},F=l.supbooks||i.supbooks||[[]];if(F.sharedf=D,F.arrayf=P,F.SheetNames=i.SheetNames||i.Sheets.map(function(fe){return fe.name}),!l.supbooks&&(l.supbooks=F,i.Names))for(var b=0;b<i.Names.length;++b)F[0][b+1]=i.Names[b];var M=[],Ce=[],Ie=!1;Qh[16]={n:"BrtShortReal",f:PA};var Re;if(bs(e,function(te,de,Ee){if(!_)switch(Ee){case 148:h=te;break;case 0:v=te,l.sheetRows&&l.sheetRows<=v.r&&(_=!0),U=Kr(w=v.r),l["!row"]=v.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=Iu(te.hpt)),Ce[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:te[2]},te[2]){case"n":E.v=te[1];break;case"s":A=Zc[te[1]],E.v=A.t,E.r=A.r;break;case"b":E.v=!!te[1];break;case"e":E.v=te[1],l.cellText!==!1&&(E.w=po[E.v]);break;case"str":E.t="s",E.v=te[1];break;case"is":E.t="s",E.v=te[1].t;break}if((y=o.CellXf[te[0].iStyleRef])&&kA(E,y.numFmtId,null,l,s,o),k=te[0].c==-1?k+1:te[0].c,l.dense?(u[w]||(u[w]=[]),u[w][k]=E):u[Cr(k)+U]=E,l.cellFormula){for(R=!1,S=0;S<P.length;++S){var j=P[S];v.r>=j[0].s.r&&v.r<=j[0].e.r&&k>=j[0].s.c&&k<=j[0].e.c&&(E.F=Et(j[0]),R=!0)}!R&&te.length>3&&(E.f=te[3])}if(p.s.r>v.r&&(p.s.r=v.r),p.s.c>k&&(p.s.c=k),p.e.r<v.r&&(p.e.r=v.r),p.e.c<k&&(p.e.c=k),l.cellDates&&y&&E.t=="n"&&bl(ut[y.numFmtId])){var re=Va(E.v);re&&(E.t="d",E.v=new Date(re.y,re.m-1,re.d,re.H,re.M,re.S,re.u))}Re&&(Re.type=="XLDAPR"&&(E.D=!0),Re=void 0);break;case 1:case 12:if(!l.sheetStubs||m)break;E={t:"z",v:void 0},k=te[0].c==-1?k+1:te[0].c,l.dense?(u[w]||(u[w]=[]),u[w][k]=E):u[Cr(k)+U]=E,p.s.r>v.r&&(p.s.r=v.r),p.s.c>k&&(p.s.c=k),p.e.r<v.r&&(p.e.r=v.r),p.e.c<k&&(p.e.c=k),Re&&(Re.type=="XLDAPR"&&(E.D=!0),Re=void 0);break;case 176:K.push(te);break;case 49:Re=((l.xlmeta||{}).Cell||[])[te-1];break;case 494:var Q=n["!id"][te.relId];for(Q?(te.Target=Q.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=Q):te.relId==""&&(te.Target="#"+te.loc),w=te.rfx.s.r;w<=te.rfx.e.r;++w)for(k=te.rfx.s.c;k<=te.rfx.e.c;++k)l.dense?(u[w]||(u[w]=[]),u[w][k]||(u[w][k]={t:"z",v:void 0}),u[w][k].l=te):(C=at({c:k,r:w}),u[C]||(u[C]={t:"z",v:void 0}),u[C].l=te);break;case 426:if(!l.cellFormula)break;P.push(te),q=l.dense?u[w][k]:u[Cr(k)+U],q.f=an(te[1],p,{r:v.r,c:k},F,l),q.F=Et(te[0]);break;case 427:if(!l.cellFormula)break;D[at(te[0].s)]=te[1],q=l.dense?u[w][k]:u[Cr(k)+U],q.f=an(te[1],p,{r:v.r,c:k},F,l);break;case 60:if(!l.cellStyles)break;for(;te.e>=te.s;)M[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},Ie||(Ie=!0,qg(te.w/256)),wl(M[te.e+1]);break;case 161:u["!autofilter"]={ref:Et(te)};break;case 476:u["!margins"]=te;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),te.name&&(i.Sheets[r].CodeName=te.name),(te.above||te.left)&&(u["!outline"]={above:te.above,left:te.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),te.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!de.T){if(!m||l.WTF)throw new Error("Unexpected record 0x"+Ee.toString(16))}}},l),delete l.supbooks,delete l["!row"],!u["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=Et(h||p)),l.sheetRows&&u["!ref"]){var ke=or(u["!ref"]);l.sheetRows<=+ke.e.r&&(ke.e.r=l.sheetRows-1,ke.e.r>p.e.r&&(ke.e.r=p.e.r),ke.e.r<ke.s.r&&(ke.s.r=ke.e.r),ke.e.c>p.e.c&&(ke.e.c=p.e.c),ke.e.c<ke.s.c&&(ke.s.c=ke.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Et(ke))}return K.length>0&&(u["!merges"]=K),M.length>0&&(u["!cols"]=M),Ce.length>0&&(u["!rows"]=Ce),u}function lF(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=wt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function cF(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,u=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var _=lF(m);p.s.r=p.s.c=0,p.e.c=l,h=Cr(l),_[0].forEach(function(v,E){o[h+Kr(E)]={t:"n",v,z:_[1]},u=E}),p.e.r<u&&(p.e.r=u),++l}),l>0&&(o["!ref"]=Et(p)),o}function uF(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(RA);return l&&Jg(l[0],s,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function fF(e,t){e.l+=10;var r=fn(e);return{name:r}}function hF(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return bs(e,function(u,h,p){switch(p){case 550:s["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var NA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],dF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],pF=[],mF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function gx(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Xt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function _x(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Xt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function OA(e){_x(e.WBProps,NA),_x(e.CalcPr,mF),gx(e.WBView,dF),gx(e.Sheets,pF),dl.date1904=Xt(e.WBProps.date1904)}var gF="][*?/\\".split("");function _F(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return gF.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var vF=/<\w+:workbook/;function xF(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(pn,function(u,h){var p=Je(u);switch(is(p[0])){case"<?xml":break;case"<workbook":u.match(vF)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=p[i];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":NA.forEach(function(m){if(p[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=Xt(p[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(p[m[0]],10);break;default:r.WBProps[m[0]]=p[m[0]]}}),p.codeName&&(r.WBProps.CodeName=Ht(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=wt(Ht(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Ht(p.name),p.comment&&(s.Comment=p.comment),p.localSheetId&&(s.Sheet=+p.localSheetId),Xt(p.hidden||"0")&&(s.Hidden=!0),o=h+u.length;break;case"</definedName>":s.Ref=wt(Ht(e.slice(o,h))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return u}),M4.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return OA(r),r}function yF(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=nm(e),r.name=fn(e),r}function EF(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?fn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function TF(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function AF(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=tP(e),o=aD(e,0,r),l=Gg(e);e.l=n;var u={Name:s,Ptg:o};return i<268435455&&(u.Sheet=i),l&&(u.Comment=l),u}function wF(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],Qh[16]={n:"BrtFRTArchID$",f:TF},bs(e,function(u,h,p){switch(p){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=an(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,u]):o[0]=[p,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(p),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!h.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},t),OA(r),r.Names=s,r.supbooks=o,r}function SF(e,t,r){return t.slice(-4)===".bin"?wF(e,r):xF(e,r)}function IF(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?oF(e,n,r,i,s,o,l):yD(e,n,r,i,s,o,l)}function CF(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?hF(e,n,r,i,s):uF(e,n,r,i,s)}function kF(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?bL():ML()}function RF(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?DL():FL()}function PF(e,t,r,n){return t.slice(-4)===".bin"?YO(e,r,n):GO(e,r,n)}function NF(e,t,r){return vA(e,r)}function OF(e,t,r){return t.slice(-4)===".bin"?dO(e,r):fO(e,r)}function LF(e,t,r){return t.slice(-4)===".bin"?NL(e,r):IL(e,r)}function DF(e,t,r){return t.slice(-4)===".bin"?AL(e):EL(e)}function FF(e,t,r,n){return r.slice(-4)===".bin"?wL(e,t,r,n):void 0}function bF(e,t,r){return t.slice(-4)===".bin"?xL(e,t,r):yL(e,t,r)}var LA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,DA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ri(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(LA),s,o,l,u;if(i)for(u=0;u!=i.length;++u)s=i[u].match(DA),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function MF(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(LA),i,s,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(DA),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Xc;function BF(e,t){var r=Xc[e]||wt(e);return r==="General"?eo(t):Ei(r,t)}function UF(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Xt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Vr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[wt(t)]=i}function VF(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||po[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Eu(e.v):e.w=eo(e.v):e.w=BF(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Xc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&bl(n)){var i=Va(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function zF(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=UO[n.Pattern]||n.Pattern)}e[t.ID]=t}function jF(e,t,r,n,i,s,o,l,u,h){var p="General",m=n.StyleID,_={};h=h||{};var v=[],E=0;for(m===void 0&&l&&(m=l.StyleID),m===void 0&&o&&(m=o.StyleID);s[m]!==void 0&&(s[m].nf&&(p=s[m].nf),s[m].Interior&&v.push(s[m].Interior),!!s[m].Parent);)m=s[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Xt(e);break;case"String":n.t="s",n.r=Uv(wt(e)),n.v=e.indexOf("<")>-1?wt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Vr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=wt(e):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=qT[e],h.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Uv(t||e));break}if(VF(n,p,h),h.cellFormula!==!1)if(n.Formula){var y=wt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=hl(y,i),delete n.Formula,n.ArrayRange=="RC"?n.F=hl("RC:RC",i):n.ArrayRange&&(n.F=hl(n.ArrayRange,i),u.push([or(n.F),n.F]))}else for(E=0;E<u.length;++E)i.r>=u[E][0].s.r&&i.r<=u[E][0].e.r&&i.c>=u[E][0].s.c&&i.c<=u[E][0].e.c&&(n.F=u[E][1]);h.cellStyles&&(v.forEach(function(w){!_.patternType&&w.patternType&&(_.patternType=w.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function HF(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function jd(e,t){var r=t||{};TT();var n=wc(Vg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ht(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Zr(r);return o.type="string",wu.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ne){i.indexOf("<"+ne)>=0&&(s=!0)}),s)return JF(n,r);Xc={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u=[],h,p={},m=[],_=r.dense?[]:{},v="",E={},y={},w=Ri('<Data ss:Type="String">'),k=0,C=0,A=0,U={s:{r:2e6,c:2e6},e:{r:0,c:0}},q={},K={},S="",R=0,P=[],D={},F={},b=0,M=[],Ce=[],Ie={},Re=[],ke,fe=!1,te=[],de=[],Ee={},j=0,re=0,Q={Sheets:[],WBProps:{date1904:!1}},Y={};Au.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";l=Au.exec(n);)switch(l[3]=(le=l[3]).toLowerCase()){case"data":if(le=="data"){if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break}if(u[u.length-1][1])break;l[1]==="/"?jF(n.slice(k,l.index),S,w,u[u.length-1][0]=="comment"?Ie:E,{c:C,r:A},q,Re[C],y,te,r):(S="",w=Ri(l[0]),k=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(Ce.length>0&&(E.c=Ce),(!r.sheetRows||r.sheetRows>A)&&E.v!==void 0&&(r.dense?(_[A]||(_[A]=[]),_[A][C]=E):_[Cr(C)+Kr(A)]=E),E.HRef&&(E.l={Target:wt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(j=C+(parseInt(E.MergeAcross,10)|0),re=A+(parseInt(E.MergeDown,10)|0),P.push({s:{c:C,r:A},e:{c:j,r:re}})),!r.sheetStubs)E.MergeAcross?C=j+1:++C;else if(E.MergeAcross||E.MergeDown){for(var ye=C;ye<=j;++ye)for(var Ne=A;Ne<=re;++Ne)(ye>C||Ne>A)&&(r.dense?(_[Ne]||(_[Ne]=[]),_[Ne][ye]={t:"z"}):_[Cr(ye)+Kr(Ne)]={t:"z"});C=j+1}else++C;else E=MF(l[0]),E.Index&&(C=+E.Index-1),C<U.s.c&&(U.s.c=C),C>U.e.c&&(U.e.c=C),l[0].slice(-2)==="/>"&&++C,Ce=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(A<U.s.r&&(U.s.r=A),A>U.e.r&&(U.e.r=A),l[0].slice(-2)==="/>"&&(y=Ri(l[0]),y.Index&&(A=+y.Index-1)),C=0,++A):(y=Ri(l[0]),y.Index&&(A=+y.Index-1),Ee={},(y.AutoFitHeight=="0"||y.Height)&&(Ee.hpx=parseInt(y.Height,10),Ee.hpt=_A(Ee.hpx),de[A]=Ee),y.Hidden=="1"&&(Ee.hidden=!0,de[A]=Ee));break;case"worksheet":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"));m.push(v),U.s.r<=U.e.r&&U.s.c<=U.e.c&&(_["!ref"]=Et(U),r.sheetRows&&r.sheetRows<=U.e.r&&(_["!fullref"]=_["!ref"],U.e.r=r.sheetRows-1,_["!ref"]=Et(U))),P.length&&(_["!merges"]=P),Re.length>0&&(_["!cols"]=Re),de.length>0&&(_["!rows"]=de),p[v]=_}else U={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=C=0,u.push([l[3],!1]),h=Ri(l[0]),v=wt(h.Name),_=r.dense?[]:{},P=[],te=[],de=[],Y={name:v,Hidden:0},Q.Sheets.push(Y);break;case"table":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else{if(l[0].slice(-2)=="/>")break;u.push([l[3],!1]),Re=[],fe=!1}break;case"style":l[1]==="/"?zF(q,K,r):K=Ri(l[0]);break;case"numberformat":K.nf=wt(Ri(l[0]).Format||"General"),Xc[K.nf]&&(K.nf=Xc[K.nf]);for(var ee=0;ee!=392&&ut[ee]!=K.nf;++ee);if(ee==392){for(ee=57;ee!=392;++ee)if(ut[ee]==null){Ga(K.nf,ee);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(ke=Ri(l[0]),ke.Hidden&&(ke.hidden=!0,delete ke.Hidden),ke.Width&&(ke.wpx=parseInt(ke.Width,10)),!fe&&ke.wpx>10){fe=!0,yn=mA;for(var me=0;me<Re.length;++me)Re[me]&&wl(Re[me])}fe&&wl(ke),Re[ke.Index-1||Re.length]=ke;for(var Fe=0;Fe<+ke.Span;++Fe)Re[Re.length]=Zr(ke);break;case"namedrange":if(l[1]==="/")break;Q.Names||(Q.Names=[]);var H=Je(l[0]),Ve={Name:H.Name,Ref:hl(H.RefersTo.slice(1),{r:0,c:0})};Q.Sheets.length>0&&(Ve.Sheet=Q.Sheets.length-1),Q.Names.push(Ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?S+=n.slice(R,l.index):R=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;K.Interior=Ri(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?IP(D,le,n.slice(b,l.index)):b=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else u.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"));HF(Ie),Ce.push(Ie)}else u.push([l[3],!1]),h=Ri(l[0]),Ie={a:h.Author};break;case"autofilter":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var je=Ri(l[0]);_["!autofilter"]={ref:hl(je.Range).replace(/\$/g,"")},u.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((h=u.pop())[0]!==l[3])throw new Error("Bad state: "+h.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&u.push([l[3],!0]);break;case"null":break;default:if(u.length==0&&l[3]=="document"||u.length==0&&l[3]=="uof")return Ax(n,r);var tt=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:tt=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:tt=!1}break;case"excelworkbook":switch(l[3]){case"date1904":Q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:tt=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:tt=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(b,l.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else b=l.index+l[0].length;break;case"header":_["!margins"]||Kc(_["!margins"]={},"xlml"),isNaN(+Je(l[0]).Margin)||(_["!margins"].header=+Je(l[0]).Margin);break;case"footer":_["!margins"]||Kc(_["!margins"]={},"xlml"),isNaN(+Je(l[0]).Margin)||(_["!margins"].footer=+Je(l[0]).Margin);break;case"pagemargins":var Ze=Je(l[0]);_["!margins"]||Kc(_["!margins"]={},"xlml"),isNaN(+Ze.Top)||(_["!margins"].top=+Ze.Top),isNaN(+Ze.Left)||(_["!margins"].left=+Ze.Left),isNaN(+Ze.Right)||(_["!margins"].right=+Ze.Right),isNaN(+Ze.Bottom)||(_["!margins"].bottom=+Ze.Bottom);break;case"displayrighttoleft":Q.Views||(Q.Views=[]),Q.Views[0]||(Q.Views[0]={}),Q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:tt=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:tt=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:tt=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:tt=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:tt=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:tt=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:tt=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:tt=!1}break;case"smarttags":break;default:tt=!1;break}if(tt||l[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?UF(F,le,M,n.slice(b,l.index)):(M=l,b=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+u.join("|")}var Pe={};return!r.bookSheets&&!r.bookProps&&(Pe.Sheets=p),Pe.SheetNames=m,Pe.Workbook=Q,Pe.SSF=Zr(ut),Pe.Props=D,Pe.Custprops=F,Pe}function om(e,t){switch(t_(t=t||{}),t.type||"base64"){case"base64":return jd(Jn(e),t);case"binary":case"buffer":case"file":return jd(e,t);case"array":return jd(uo(e),t)}}function WF(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=iP(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=sP(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var GF=[60,1084,2066,2165,2175];function $F(e,t,r,n,i){var s=n,o=[],l=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),r.l+=s;for(var u=Es(r,r.l),h=lm[u],p=0;h!=null&&GF.indexOf(u)>-1;)s=Es(r,r.l+2),p=r.l+4,u==2066?p+=4:(u==2165||u==2175)&&(p+=12),l=r.slice(p,r.l+4+s),o.push(l),r.l+=4+s,h=lm[u=Es(r,r.l)];var m=Js(o);Wr(m,0);var _=0;m.lens=[];for(var v=0;v<o.length;++v)m.lens.push(_),_+=o[v].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,i)}function Zi(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ut[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||po[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Eu(e.v):e.w=eo(e.v):e.w=Ei(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&bl(ut[n]||String(n))){var i=Va(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Kf(e,t,r){return{v:e,ixfe:t,t:r}}function ZF(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},o={},l=null,u=[],h="",p={},m,_="",v,E,y,w,k={},C=[],A,U,q=[],K=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},P=function(et){return et<8?$a[et]:et<64&&K[et-8]||$a[et]},D=function(et,kt,Rt){var Dt=kt.XF.data;if(!(!Dt||!Dt.patternType||!Rt||!Rt.cellStyles)){kt.s={},kt.s.patternType=Dt.patternType;var zr;(zr=Su(P(Dt.icvFore)))&&(kt.s.fgColor={rgb:zr}),(zr=Su(P(Dt.icvBack)))&&(kt.s.bgColor={rgb:zr})}},F=function(et,kt,Rt){if(!(Ee>1)&&!(Rt.sheetRows&&et.r>=Rt.sheetRows)){if(Rt.cellStyles&&kt.XF&&kt.XF.data&&D(et,kt,Rt),delete kt.ixfe,delete kt.XF,m=et,_=at(et),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),et.r<o.s.r&&(o.s.r=et.r),et.c<o.s.c&&(o.s.c=et.c),et.r+1>o.e.r&&(o.e.r=et.r+1),et.c+1>o.e.c&&(o.e.c=et.c+1),Rt.cellFormula&&kt.f){for(var Dt=0;Dt<C.length;++Dt)if(!(C[Dt][0].s.c>et.c||C[Dt][0].s.r>et.r)&&!(C[Dt][0].e.c<et.c||C[Dt][0].e.r<et.r)){kt.F=Et(C[Dt][0]),(C[Dt][0].s.c!=et.c||C[Dt][0].s.r!=et.r)&&delete kt.f,kt.f&&(kt.f=""+an(C[Dt][1],o,et,te,b));break}}Rt.dense?(i[et.r]||(i[et.r]=[]),i[et.r][et.c]=kt):i[_]=kt}},b={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(b.password=t.password);var M,Ce=[],Ie=[],Re=[],ke=[],fe=!1,te=[];te.SheetNames=b.snames,te.sharedf=b.sharedf,te.arrayf=b.arrayf,te.names=[],te.XTI=[];var de=0,Ee=0,j=0,re=[],Q=[],Y;b.codepage=1200,Fi(1200);for(var le=!1;e.l<e.length-1;){var ye=e.l,Ne=e.read_shift(2);if(Ne===0&&de===10)break;var ee=e.l===e.length?0:e.read_shift(2),me=lm[Ne];if(me&&me.f){if(t.bookSheets&&de===133&&Ne!==133)break;if(de=Ne,me.r===2||me.r==12){var Fe=e.read_shift(2);if(ee-=2,!b.enc&&Fe!==Ne&&((Fe&255)<<8|Fe>>8)!==Ne)throw new Error("rt mismatch: "+Fe+"!="+Ne);me.r==12&&(e.l+=10,ee-=10)}var H={};if(Ne===10?H=me.f(e,ee,b):H=$F(Ne,me,e,ee,b),Ee==0&&[9,521,1033,2057].indexOf(de)===-1)continue;switch(Ne){case 34:r.opts.Date1904=S.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(b.enc||(e.l=0),b.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=H;break;case 66:var Ve=Number(H);switch(Ve){case 21010:Ve=1200;break;case 32768:Ve=1e4;break;case 32769:Ve=1252;break}Fi(b.codepage=Ve),le=!0;break;case 317:b.rrtabid=H;break;case 25:b.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:b.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(i["!type"]="dialog"),H.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),H.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:q.push(H);break;case 430:te.push([H]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(H);break;case 24:case 536:Y={Name:H.Name,Ref:an(H.rgce,o,null,te,b)},H.itab>0&&(Y.Sheet=H.itab-1),te.names.push(Y),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(Q[H.itab-1]={ref:Et(H.rgce[0][0][1][2])});break;case 22:b.ExternCount=H;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(H),te.XTI=te.XTI.concat(H);break;case 2196:if(b.biff<8)break;Y!=null&&(Y.Comment=H[1]);break;case 18:i["!protect"]=H;break;case 19:H!==0&&b.WTF&&console.error("Password verifier: "+H);break;case 133:s[H.pos]=H,b.snames.push(H.name);break;case 10:{if(--Ee)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=Et(o),t.sheetRows&&t.sheetRows<=o.e.r){var je=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Et(o),o.e.r=je}o.e.r++,o.e.c++}Ce.length>0&&(i["!merges"]=Ce),Ie.length>0&&(i["!objects"]=Ie),Re.length>0&&(i["!cols"]=Re),ke.length>0&&(i["!rows"]=ke),S.Sheets.push(R)}h===""?p=i:n[h]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[Ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),b.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(b.biff=5,le=!0,Fi(b.codepage=28591)),b.biff==8&&H.BIFFVer==0&&H.dt==16&&(b.biff=2),Ee++)break;if(i=t.dense?[]:{},b.biff<8&&!le&&(le=!0,Fi(b.codepage=t.codepage||1252)),b.biff<5||H.BIFFVer==0&&H.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var tt={pos:e.l-ee,name:h};s[tt.pos]=tt,b.snames.push(h)}else h=(s[ye]||{name:""}).name;H.dt==32&&(i["!type"]="chart"),H.dt==64&&(i["!type"]="macro"),Ce=[],Ie=[],b.arrayf=C=[],Re=[],ke=[],fe=!1,R={Hidden:(s[ye]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[H.r]||[])[H.c]:i[at({c:H.c,r:H.r})])&&++H.c,A={ixfe:H.ixfe,XF:q[H.ixfe]||{},v:H.val,t:"n"},j>0&&(A.z=re[A.ixfe>>8&63]),Zi(A,t,r.opts.Date1904),F({c:H.c,r:H.r},A,t);break;case 5:case 517:A={ixfe:H.ixfe,XF:q[H.ixfe],v:H.val,t:H.t},j>0&&(A.z=re[A.ixfe>>8&63]),Zi(A,t,r.opts.Date1904),F({c:H.c,r:H.r},A,t);break;case 638:A={ixfe:H.ixfe,XF:q[H.ixfe],v:H.rknum,t:"n"},j>0&&(A.z=re[A.ixfe>>8&63]),Zi(A,t,r.opts.Date1904),F({c:H.c,r:H.r},A,t);break;case 189:for(var Ze=H.c;Ze<=H.C;++Ze){var Pe=H.rkrec[Ze-H.c][0];A={ixfe:Pe,XF:q[Pe],v:H.rkrec[Ze-H.c][1],t:"n"},j>0&&(A.z=re[A.ixfe>>8&63]),Zi(A,t,r.opts.Date1904),F({c:Ze,r:H.r},A,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){l=H;break}if(A=Kf(H.val,H.cell.ixfe,H.tt),A.XF=q[A.ixfe],t.cellFormula){var ne=H.formula;if(ne&&ne[0]&&ne[0][0]&&ne[0][0][0]=="PtgExp"){var De=ne[0][0][1][0],Me=ne[0][0][1][1],Qe=at({r:De,c:Me});k[Qe]?A.f=""+an(H.formula,o,H.cell,te,b):A.F=((t.dense?(i[De]||[])[Me]:i[Qe])||{}).F}else A.f=""+an(H.formula,o,H.cell,te,b)}j>0&&(A.z=re[A.ixfe>>8&63]),Zi(A,t,r.opts.Date1904),F(H.cell,A,t),l=H}break;case 7:case 519:if(l)l.val=H,A=Kf(H,l.cell.ixfe,"s"),A.XF=q[A.ixfe],t.cellFormula&&(A.f=""+an(l.formula,o,l.cell,te,b)),j>0&&(A.z=re[A.ixfe>>8&63]),Zi(A,t,r.opts.Date1904),F(l.cell,A,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(H);var st=at(H[0].s);if(v=t.dense?(i[H[0].s.r]||[])[H[0].s.c]:i[st],t.cellFormula&&v){if(!l||!st||!v)break;v.f=""+an(H[1],o,H[0],te,b),v.F=Et(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(_){if(!l)break;k[at(l.cell)]=H[0],v=t.dense?(i[l.cell.r]||[])[l.cell.c]:i[at(l.cell)],(v||{}).f=""+an(H[0],o,m,te,b)}}break;case 253:A=Kf(u[H.isst].t,H.ixfe,"s"),u[H.isst].h&&(A.h=u[H.isst].h),A.XF=q[A.ixfe],j>0&&(A.z=re[A.ixfe>>8&63]),Zi(A,t,r.opts.Date1904),F({c:H.c,r:H.r},A,t);break;case 513:t.sheetStubs&&(A={ixfe:H.ixfe,XF:q[H.ixfe],t:"z"},j>0&&(A.z=re[A.ixfe>>8&63]),Zi(A,t,r.opts.Date1904),F({c:H.c,r:H.r},A,t));break;case 190:if(t.sheetStubs)for(var pt=H.c;pt<=H.C;++pt){var mt=H.ixfe[pt-H.c];A={ixfe:mt,XF:q[mt],t:"z"},j>0&&(A.z=re[A.ixfe>>8&63]),Zi(A,t,r.opts.Date1904),F({c:pt,r:H.r},A,t)}break;case 214:case 516:case 4:A=Kf(H.val,H.ixfe,"s"),A.XF=q[A.ixfe],j>0&&(A.z=re[A.ixfe>>8&63]),Zi(A,t,r.opts.Date1904),F({c:H.c,r:H.r},A,t);break;case 0:case 512:Ee===1&&(o=H);break;case 252:u=H;break;case 1054:if(b.biff==4){re[j++]=H[1];for(var dr=0;dr<j+163&&ut[dr]!=H[1];++dr);dr>=163&&Ga(H[1],j+163)}else Ga(H[1],H[0]);break;case 30:{re[j++]=H;for(var St=0;St<j+163&&ut[St]!=H;++St);St>=163&&Ga(H,j+163)}break;case 229:Ce=Ce.concat(H);break;case 93:Ie[H.cmo[0]]=b.lastobj=H;break;case 438:b.lastobj.TxO=H;break;case 127:b.lastobj.ImData=H;break;case 440:for(w=H[0].s.r;w<=H[0].e.r;++w)for(y=H[0].s.c;y<=H[0].e.c;++y)v=t.dense?(i[w]||[])[y]:i[at({c:y,r:w})],v&&(v.l=H[1]);break;case 2048:for(w=H[0].s.r;w<=H[0].e.r;++w)for(y=H[0].s.c;y<=H[0].e.c;++y)v=t.dense?(i[w]||[])[y]:i[at({c:y,r:w})],v&&v.l&&(v.l.Tooltip=H[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;v=t.dense?(i[H[0].r]||[])[H[0].c]:i[at(H[0])];var Mt=Ie[H[2]];v||(t.dense?(i[H[0].r]||(i[H[0].r]=[]),v=i[H[0].r][H[0].c]={t:"z"}):v=i[at(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),v.c||(v.c=[]),E={a:H[1],t:Mt.TxO.t},v.c.push(E)}break;case 2173:mL(q[H.ixfe],H.ext);break;case 125:{if(!b.cellStyles)break;for(;H.e>=H.s;)Re[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},fe||(fe=!0,qg(H.w/256)),wl(Re[H.e+1])}break;case 520:{var Ut={};H.level!=null&&(ke[H.r]=Ut,Ut.level=H.level),H.hidden&&(ke[H.r]=Ut,Ut.hidden=!0),H.hpt&&(ke[H.r]=Ut,Ut.hpt=H.hpt,Ut.hpx=Iu(H.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Kc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ne]]=H;break;case 161:i["!margins"]||Kc(i["!margins"]={}),i["!margins"].header=H.header,i["!margins"].footer=H.footer;break;case 574:H.RTL&&(S.Views[0].RTL=!0);break;case 146:K=H;break;case 2198:M=H;break;case 140:U=H;break;case 442:h?R.CodeName=H||R.name:S.WBProps.CodeName=H||"ThisWorkbook";break}}else me||console.error("Missing Info for XLS Record 0x"+Ne.toString(16)),e.l+=ee}return r.SheetNames=ts(s).sort(function(Nr,et){return Number(Nr)-Number(et)}).map(function(Nr){return s[Nr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&Q.forEach(function(Nr,et){r.Sheets[r.SheetNames[et]]["!autofilter"]=Nr}),r.Strings=u,r.SSF=Zr(ut),b.enc&&(r.Encryption=b.enc),M&&(r.Themes=M),r.Metadata={},U!==void 0&&(r.Metadata.Country=U),te.names.length>0&&(S.Names=te.names),r.Workbook=S,r}var vx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function KF(e,t,r){var n=yt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=tx(n,fP,vx.DSI);for(var s in i)t[s]=i[s]}catch(h){if(r.WTF)throw h}var o=yt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=tx(o,hP,vx.SI);for(var u in l)t[u]==null&&(t[u]=l[u])}catch(h){if(r.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(JT(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function FA(e,t){t||(t={}),t_(t),uT(),t.codepage&&Lg(t.codepage);var r,n;if(e.FullPaths){if(yt.find(e,"/encryption"))throw new Error("File is password-protected");r=yt.find(e,"!CompObj"),n=yt.find(e,"/Workbook")||yt.find(e,"/Book")}else{switch(t.type){case"base64":e=Di(Jn(e));break;case"binary":e=Di(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Wr(e,0),n={content:e}}var i,s;if(r&&WF(r),t.bookProps&&!t.bookSheets)i={};else{var o=_t?"buffer":"array";if(n&&n.content)i=ZF(n.content,t);else if((s=yt.find(e,"PerfectOffice_MAIN"))&&s.content)i=$c.to_workbook(s.content,(t.type=o,t));else if((s=yt.find(e,"NativeContent_MAIN"))&&s.content)i=$c.to_workbook(s.content,(t.type=o,t));else throw(s=yt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&yt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=LL(e))}var l={};return e.FullPaths&&KF(e,l,t),i.Props=i.Custprops=l,t.bookFiles&&(i.cfb=e),i}var Qh={0:{f:RD},1:{f:LD},2:{f:jD},3:{f:MD},4:{f:FD},5:{f:zD},6:{f:GD},7:{f:UD},8:{f:qD},9:{f:XD},10:{f:ZD},11:{f:KD},12:{f:DD},13:{f:HD},14:{f:BD},15:{f:bD},16:{f:PA},17:{f:$D},18:{f:VD},19:{f:Wg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:AF},40:{},42:{},43:{f:ZO},44:{f:$O},45:{f:KO},46:{f:qO},47:{f:XO},48:{},49:{f:Y4},50:{},51:{f:_L},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:uA},62:{f:WD},63:{f:TL},64:{f:sF},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:dn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:iF},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:OD},148:{f:PD,p:16},151:{f:QD},152:{},153:{f:EF},154:{},155:{},156:{f:yF},157:{},158:{},159:{T:1,f:hO},160:{T:-1},161:{T:1,f:ho},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:YD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gL},336:{T:-1},337:{f:vL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:cA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:eF},427:{f:tF},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nF},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ND},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:JD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:PL},633:{T:1},634:{T:-1},635:{T:1,f:RL},636:{T:-1},637:{f:Q4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:fF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:aF},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},lm={6:{f:Vd},10:{f:$s},12:{f:yr},13:{f:yr},14:{f:ur},15:{f:ur},16:{f:cn},17:{f:ur},18:{f:ur},19:{f:yr},20:{f:sx},21:{f:sx},23:{f:cA},24:{f:ox},25:{f:ur},26:{},27:{},28:{f:CN},29:{},34:{f:ur},35:{f:ax},38:{f:cn},39:{f:cn},40:{f:cn},41:{f:cn},42:{f:ur},43:{f:ur},47:{f:NO},49:{f:lN},51:{f:yr},60:{},61:{f:sN},64:{f:ur},65:{f:oN},66:{f:yr},77:{},80:{},81:{},82:{},85:{f:yr},89:{},90:{},91:{},92:{f:YP},93:{f:RN},94:{},95:{f:ur},96:{},97:{},99:{f:ur},125:{f:uA},128:{f:vN},129:{f:JP},130:{f:yr},131:{f:ur},132:{f:ur},133:{f:QP},134:{},140:{f:FN},141:{f:yr},144:{},146:{f:MN},151:{},152:{},153:{},154:{},155:{},156:{f:yr},157:{},158:{},160:{f:jN},161:{f:UN},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:pN},190:{f:mN},193:{f:$s},197:{},198:{},199:{},200:{},201:{},202:{f:ur},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:yr},220:{},221:{f:ur},222:{},224:{f:_N},225:{f:qP},226:{f:$s},227:{},229:{f:kN},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:eN},253:{f:cN},255:{f:tN},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:nA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ur},353:{f:$s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:yN},431:{f:ur},432:{},433:{},434:{},437:{},438:{f:ON},439:{f:ur},440:{f:LN},441:{},442:{f:Gu},443:{},444:{f:yr},445:{},446:{},448:{f:$s},449:{f:iN,r:2},450:{f:$s},512:{f:nx},513:{f:zN},515:{f:xN},516:{f:uN},517:{f:ix},519:{f:HN},520:{f:rN},523:{},545:{f:lx},549:{f:rx},566:{},574:{f:aN},638:{f:dN},659:{},1048:{},1054:{f:fN},1084:{},1212:{f:wN},2048:{f:DN},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Gf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:$s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:BN,r:12},2173:{f:pL,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ur,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:AN,r:12},2197:{},2198:{f:lL,r:12},2199:{},2200:{},2201:{},2202:{f:SN,r:12},2203:{f:$s},2204:{},2205:{},2206:{},2207:{},2211:{f:nN},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:yr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:VN},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bN},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:nx},1:{},2:{f:ZN},3:{f:$N},4:{f:GN},5:{f:ix},7:{f:KN},8:{},9:{f:Gf},11:{},22:{f:yr},30:{f:hN},31:{},32:{},33:{f:lx},36:{},37:{f:rx},50:{f:XN},62:{},52:{},67:{},68:{f:yr},69:{},86:{},126:{},127:{f:WN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:qN},223:{},234:{},354:{},421:{},518:{f:Vd},521:{f:Gf},536:{f:ox},547:{f:ax},561:{},579:{},1030:{f:Vd},1033:{f:Gf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Pi(e,t,r,n){var i=t;if(!isNaN(i)){var s=(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&WT(r)&&e.push(r)}}function xx(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,l=s&&s.index||e.length,u=x4(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,m=0,_=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(o=0;o<u.length;++o){var y=u[o].trim(),w=y.slice(0,3).toLowerCase();if(w=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}p=0;continue}if(!(w!="<td"&&w!="<th")){var k=y.split(/<\/t[dh]>/i);for(l=0;l<k.length;++l){var C=k[l].trim();if(C.match(/<t[dh]/i)){for(var A=C,U=0;A.charAt(0)=="<"&&(U=A.indexOf(">"))>-1;)A=A.slice(U+1);for(var q=0;q<E.length;++q){var K=E[q];K.s.c==p&&K.s.r<h&&h<=K.e.r&&(p=K.e.c+1,q=-1)}var S=Je(C.slice(0,C.indexOf(">")));_=S.colspan?+S.colspan:1,((m=+S.rowspan)>1||_>1)&&E.push({s:{r:h,c:p},e:{r:h+(m||1)-1,c:p+_-1}});var R=S.t||S["data-t"]||"";if(!A.length){p+=_;continue}if(A=NT(A),v.s.r>h&&(v.s.r=h),v.e.r<h&&(v.e.r=h),v.s.c>p&&(v.s.c=p),v.e.c<p&&(v.e.c=p),!A.length){p+=_;continue}var P={t:"s",v:A};r.raw||!A.trim().length||R=="s"||(A==="TRUE"?P={t:"b",v:!0}:A==="FALSE"?P={t:"b",v:!1}:isNaN(Ui(A))?isNaN(Al(A).getDate())||(P={t:"d",v:Vr(A)},r.cellDates||(P={t:"n",v:wn(P.v)}),P.z=r.dateNF||ut[14]):P={t:"n",v:Ui(A)}),r.dense?(n[h]||(n[h]=[]),n[h][p]=P):n[at({r:h,c:p})]=P,p+=_}}}}return n["!ref"]=Et(v),E.length&&(n["!merges"]=E),n}function XF(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,u=0,h=0;h<i.length;++h)if(!(i[h].s.r>r||i[h].s.c>o)&&!(i[h].e.r<r||i[h].e.c<o)){if(i[h].s.r<r||i[h].s.c<o){l=-1;break}l=i[h].e.r-i[h].s.r+1,u=i[h].e.c-i[h].s.c+1;break}if(!(l<0)){var p=at({r,c:o}),m=n.dense?(e[r]||[])[o]:e[p],_=m&&m.v!=null&&(m.h||Ug(m.w||(Ps(m),m.w)||""))||"",v={};l>1&&(v.rowspan=l),u>1&&(v.colspan=u),n.editable?_='<span contenteditable="true">'+_+"</span>":m&&(v["data-t"]=m&&m.t||"z",m.v!=null&&(v["data-v"]=m.v),m.z!=null&&(v["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+m.l.Target+'">'+_+"</a>")),v.id=(n.id||"sjs")+"-"+p,s.push(F4("td",_,v))}}var E="<tr>";return E+s.join("")+"</tr>"}var qF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',YF="</body></html>";function JF(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ka(xx(r[0],t),t);var n=n_();return r.forEach(function(i,s){i_(n,xx(i,t),"Sheet"+(s+1))}),n}function QF(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function eb(e,t){var r=t||{},n=r.header!=null?r.header:qF,i=r.footer!=null?r.footer:YF,s=[n],o=Ml(e["!ref"]);r.dense=Array.isArray(e),s.push(QF(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(XF(e,o,l,r));return s.push("</table>"+i),s.join("")}function bA(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?En(n.origin):n.origin;i=o.r,s=o.c}var l=t.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,l.length),h={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var p=Ml(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),i==-1&&(h.e.r=i=p.e.r+1)}var m=[],_=0,v=e["!rows"]||(e["!rows"]=[]),E=0,y=0,w=0,k=0,C=0,A=0;for(e["!cols"]||(e["!cols"]=[]);E<l.length&&y<u;++E){var U=l[E];if(yx(U)){if(n.display)continue;v[y]={hidden:!0}}var q=U.children;for(w=k=0;w<q.length;++w){var K=q[w];if(!(n.display&&yx(K))){var S=K.hasAttribute("data-v")?K.getAttribute("data-v"):K.hasAttribute("v")?K.getAttribute("v"):NT(K.innerHTML),R=K.getAttribute("data-z")||K.getAttribute("z");for(_=0;_<m.length;++_){var P=m[_];P.s.c==k+s&&P.s.r<y+i&&y+i<=P.e.r&&(k=P.e.c+1-s,_=-1)}A=+K.getAttribute("colspan")||1,((C=+K.getAttribute("rowspan")||1)>1||A>1)&&m.push({s:{r:y+i,c:k+s},e:{r:y+i+(C||1)-1,c:k+s+(A||1)-1}});var D={t:"s",v:S},F=K.getAttribute("data-t")||K.getAttribute("t")||"";S!=null&&(S.length==0?D.t=F||"z":n.raw||S.trim().length==0||F=="s"||(S==="TRUE"?D={t:"b",v:!0}:S==="FALSE"?D={t:"b",v:!1}:isNaN(Ui(S))?isNaN(Al(S).getDate())||(D={t:"d",v:Vr(S)},n.cellDates||(D={t:"n",v:wn(D.v)}),D.z=n.dateNF||ut[14]):D={t:"n",v:Ui(S)})),D.z===void 0&&R!=null&&(D.z=R);var b="",M=K.getElementsByTagName("A");if(M&&M.length)for(var Ce=0;Ce<M.length&&!(M[Ce].hasAttribute("href")&&(b=M[Ce].getAttribute("href"),b.charAt(0)!="#"));++Ce);b&&b.charAt(0)!="#"&&(D.l={Target:b}),n.dense?(e[y+i]||(e[y+i]=[]),e[y+i][k+s]=D):e[at({c:k+s,r:y+i})]=D,h.e.c<k+s&&(h.e.c=k+s),k+=A}}++y}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),h.e.r=Math.max(h.e.r,y-1+i),e["!ref"]=Et(h),y>=u&&(e["!fullref"]=Et((h.e.r=l.length-E+y-1+i,h))),e}function MA(e,t){var r=t||{},n=r.dense?[]:{};return bA(n,e,t)}function tb(e,t){return ka(MA(e,t),t)}function yx(e){var t="",r=rb(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function rb(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function nb(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=wt(t.replace(/<[^>]*>/g,""));return[r]}var Ex={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function BA(e,t){var r=t||{},n=Vg(e),i=[],s,o,l={name:""},u="",h=0,p,m,_={},v=[],E=r.dense?[]:{},y,w,k={value:""},C="",A=0,U=[],q=-1,K=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,P={},D=[],F={},b=0,M=0,Ce=[],Ie=1,Re=1,ke=[],fe={Names:[]},te={},de=["",""],Ee=[],j={},re="",Q=0,Y=!1,le=!1,ye=0;for(Au.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Au.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?E["!ref"]=Et(S):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(E["!fullref"]=E["!ref"],S.e.r=r.sheetRows-1,E["!ref"]=Et(S)),D.length&&(E["!merges"]=D),Ce.length&&(E["!rows"]=Ce),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),v.push(p.name),_[p.name]=E,le=!1):y[0].charAt(y[0].length-2)!=="/"&&(p=Je(y[0],!1),q=K=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,E=r.dense?[]:{},D=[],Ce=[],le=!0);break;case"table-row-group":y[1]==="/"?--R:++R;break;case"table-row":case"":if(y[1]==="/"){q+=Ie,Ie=1;break}if(m=Je(y[0],!1),m.?q=m.-1:q==-1&&(q=0),Ie=+m["number-rows-repeated"]||1,Ie<10)for(ye=0;ye<Ie;++ye)R>0&&(Ce[q+ye]={level:R});K=-1;break;case"covered-table-cell":y[1]!=="/"&&++K,r.sheetStubs&&(r.dense?(E[q]||(E[q]=[]),E[q][K]={t:"z"}):E[at({r:q,c:K})]={t:"z"}),C="",U=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++K,k=Je(y[0],!1),Re=parseInt(k["number-columns-repeated"]||"1",10),w={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(w.f=mx(wt(k.formula))),(k.||k["value-type"])=="string"&&(w.t="s",w.v=wt(k["string-value"]||""),r.dense?(E[q]||(E[q]=[]),E[q][K]=w):E[at({r:q,c:K})]=w),K+=Re-1;else if(y[1]!=="/"){++K,C="",A=0,U=[],Re=1;var Ne=Ie?q+Ie-1:q;if(K>S.e.c&&(S.e.c=K),K<S.s.c&&(S.s.c=K),q<S.s.r&&(S.s.r=q),Ne>S.e.r&&(S.e.r=Ne),k=Je(y[0],!1),Ee=[],j={},w={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=wt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(b=parseInt(k["number-matrix-rows-spanned"],10)||0,M=parseInt(k["number-matrix-columns-spanned"],10)||0,F={s:{r:q,c:K},e:{r:q+b-1,c:K+M-1}},w.F=Et(F),ke.push([F,w.F])),k.formula)w.f=mx(k.formula);else for(ye=0;ye<ke.length;++ye)q>=ke[ye][0].s.r&&q<=ke[ye][0].e.r&&K>=ke[ye][0].s.c&&K<=ke[ye][0].e.c&&(w.F=ke[ye][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(b=parseInt(k["number-rows-spanned"],10)||0,M=parseInt(k["number-columns-spanned"],10)||0,F={s:{r:q,c:K},e:{r:q+b-1,c:K+M-1}},D.push(F)),k["number-columns-repeated"]&&(Re=parseInt(k["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Xt(k["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(k.value);break;case"percentage":w.t="n",w.v=parseFloat(k.value);break;case"currency":w.t="n",w.v=parseFloat(k.value);break;case"date":w.t="d",w.v=Vr(k["date-value"]),r.cellDates||(w.t="n",w.v=wn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=g4(k["time-value"])/86400,r.cellDates&&(w.t="d",w.v=F0(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(k.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",k["string-value"]!=null&&(C=wt(k["string-value"]),U=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(Y=!1,w.t==="s"&&(w.v=C||"",U.length&&(w.R=U),Y=A==0),te.Target&&(w.l=te),Ee.length>0&&(w.c=Ee,Ee=[]),C&&r.cellText!==!1&&(w.w=C),Y&&(w.t="z",delete w.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=q))for(var ee=0;ee<Ie;++ee){if(Re=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(E[q+ee]||(E[q+ee]=[]),E[q+ee][K]=ee==0?w:Zr(w);--Re>0;)E[q+ee][K+Re]=Zr(w);else for(E[at({r:q+ee,c:K})]=w;--Re>0;)E[at({r:q+ee,c:K+Re})]=Zr(w);S.e.c<=K&&(S.e.c=K)}Re=parseInt(k["number-columns-repeated"]||"1",10),K+=Re-1,Re=0,w={},C="",U=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s;j.t=C,U.length&&(j.R=U),j.a=re,Ee.push(j)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);re="",Q=0,C="",A=0,U=[];break;case"creator":y[1]==="/"?re=n.slice(Q,y.index):Q=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);C="",A=0,U=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(P[l.name]=u,(s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&(u="",l=Je(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Je(y[0],!1),u+=Ex[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Je(y[0],!1),u+=Ex[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(h,y.index);break}else h=y.index+y[0].length;break;case"named-range":o=Je(y[0],!1),de=zd(o["cell-range-address"]);var me={Name:o.name,Ref:de[0]+"!"+de[1]};le&&(me.Sheet=v.length),fe.Names.push(me);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var Fe=nb(n.slice(A,y.index));C=(C.length>0?C+`
`:"")+Fe[0]}else Je(y[0],!1),A=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{de=zd(Je(y[0])["target-range-address"]),_[de[0]]["!autofilter"]={ref:de[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(te=Je(y[0],!1),!te.href)break;te.Target=wt(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(de=zd(te.Target.slice(1)),te.Target="#"+de[0]+"!"+de[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var H={Sheets:_,SheetNames:v,Workbook:fe};return r.bookSheets&&delete H.Sheets,H}function Tx(e,t){t=t||{},di(e,"META-INF/manifest.xml")&&xP(xr(e,"META-INF/manifest.xml"),t);var r=$n(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=BA(Ht(r),t);return di(e,"meta.xml")&&(n.Props=YT(xr(e,"meta.xml"))),n}function Ax(e,t){return BA(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Qg(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function cm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ht(uo(e))}function um(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function wx(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function ib(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Cu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Rr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function un(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Cu(e,r),s=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(s){case 0:{for(var u=r[0];e[r[0]++]>=128;);l=e.slice(u,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Cu(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var h={data:l,type:s};t[i]==null?t[i]=[h]:t[i].push(h)}return t}function e_(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function sb(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Cu(e,n),s=un(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Rr(s[1][0].data),messages:[]};s[2].forEach(function(l){var u=un(l.data),h=Rr(u[3][0].data);o.messages.push({meta:u,data:e.slice(n[0],n[0]+h)}),n[0]+=h}),(t=s[3])!=null&&t[0]&&(o.merge=Rr(s[3][0].data)>>>0>0),r.push(o)}return r}function ab(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Cu(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,h=0;if(s==1?(h=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(h=(t[r[0]++]>>2)+1,s==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[um(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(h>=u)for(i.push(i[0].slice(-u)),h-=u;h>=i[i.length-1].length;)i.push(i[i.length-1]),h-=i[i.length-1].length;i.push(i[0].slice(-u,-u+h))}}var p=um(i);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function ob(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(ab(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return um(t)}function lb(e,t,r,n){var i=Qg(e),s=i.getUint32(4,!0),o=(n>1?12:8)+wx(s&(n>1?3470:398))*4,l=-1,u=-1,h=NaN,p=new Date(2001,0,1);s&512&&(l=i.getUint32(o,!0),o+=4),o+=wx(s&(n>1?12288:4096))*4,s&16&&(u=i.getUint32(o,!0),o+=4),s&32&&(h=i.getFloat64(o,!0),o+=8),s&64&&(p.setTime(p.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:h};break;case 3:m={t:"s",v:t[u]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else if(u>-1)m={t:"s",v:t[u]};else if(!isNaN(h))m={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function cb(e,t,r){var n=Qg(e),i=n.getUint32(8,!0),s=12,o=-1,l=-1,u=NaN,h=NaN,p=new Date(2001,0,1);i&1&&(u=ib(e,s),s+=16),i&2&&(h=n.getFloat64(s,!0),s+=8),i&4&&(p.setTime(p.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(l=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:t[l]};break;case 5:m={t:"d",v:p};break;case 6:m={t:"b",v:h>0};break;case 7:m={t:"n",v:h/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return m}function ub(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return lb(e,t,r,e[0]);case 5:return cb(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function da(e){var t=un(e);return Cu(t[1][0].data)}function Sx(e,t){var r=un(t.data),n=Rr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var l=un(o.data),u=Rr(l[1][0].data)>>>0;switch(n){case 1:s[u]=cm(l[3][0].data);break;case 8:{var h=e[da(l[9][0].data)][0],p=un(h.data),m=e[da(p[1][0].data)][0],_=Rr(m.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var v=un(m.data);s[u]=v[3].map(function(E){return cm(E.data)}).join("")}break}}),s}function fb(e,t){var r,n,i,s,o,l,u,h,p,m,_,v,E,y,w=un(e),k=Rr(w[1][0].data)>>>0,C=Rr(w[2][0].data)>>>0,A=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Rr(w[8][0].data)>0||!1,U,q;if((s=(i=w[7])==null?void 0:i[0])!=null&&s.data&&t!=0)U=(l=(o=w[7])==null?void 0:o[0])==null?void 0:l.data,q=(h=(u=w[6])==null?void 0:u[0])==null?void 0:h.data;else if((m=(p=w[4])==null?void 0:p[0])!=null&&m.data&&t!=1)U=(v=(_=w[4])==null?void 0:_[0])==null?void 0:v.data,q=(y=(E=w[3])==null?void 0:E[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var K=A?4:1,S=Qg(U),R=[],P=0;P<U.length/2;++P){var D=S.getUint16(P*2,!0);D<65535&&R.push([P,D])}if(R.length!=C)throw"Expected ".concat(C," cells, found ").concat(R.length);var F=[];for(P=0;P<R.length-1;++P)F[R[P][0]]=q.subarray(R[P][1]*K,R[P+1][1]*K);return R.length>=1&&(F[R[R.length-1][0]]=q.subarray(R[R.length-1][1]*K)),{R:k,cells:F}}function hb(e,t){var r,n=un(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Rr(n[7][0].data)>>>0>0?1:0:-1,s=e_(n[5],function(o){return fb(o,i)});return{nrows:Rr(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(u,h){if(o[l.R][h])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(h));o[l.R][h]=u}),o},[])}}function db(e,t,r){var n,i=un(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Rr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Rr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Et(s);var o=un(i[4][0].data),l=Sx(e,e[da(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?Sx(e,e[da(o[17][0].data)][0]):[],h=un(o[3][0].data),p=0;h[1].forEach(function(m){var _=un(m.data),v=e[da(_[2][0].data)][0],E=Rr(v.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var y=hb(e,v);y.data.forEach(function(w,k){w.forEach(function(C,A){var U=at({r:p+k,c:A}),q=ub(C,l,u);q&&(r[U]=q)})}),p+=y.nrows})}function pb(e,t){var r=un(t.data),n={"!ref":"A1"},i=e[da(r[2][0].data)],s=Rr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return db(e,i[0],n),n}function mb(e,t){var r,n=un(t.data),i={name:(r=n[1])!=null&&r[0]?cm(n[1][0].data):"",sheets:[]},s=e_(n[2],da);return s.forEach(function(o){e[o].forEach(function(l){var u=Rr(l.meta[1][0].data);u==6e3&&i.sheets.push(pb(e,l))})}),i}function gb(e,t){var r=n_(),n=un(t.data),i=e_(n[1],da);if(i.forEach(function(s){e[s].forEach(function(o){var l=Rr(o.meta[1][0].data);if(l==2){var u=mb(e,o);u.sheets.forEach(function(h,p){i_(r,h,p==0?u.name:u.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Hd(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h;try{h=ob(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var p;try{p=sb(h)}catch(m){return console.log("## "+(m.message||m))}p.forEach(function(m){s[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Rr(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(u){s[u].forEach(function(h){var p=Rr(h.meta[1][0].data)>>>0;if(p==1)if(!l)l=h;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return gb(s,l)}function _b(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function t_(e){_b([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function vb(e){return nl.WS.indexOf(e)>-1?"sheet":e==nl.CS?"chart":e==nl.DS?"dialog":e==nl.MS?"macro":e&&e.length?e:"sheet"}function xb(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,vb(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function yb(e,t,r,n,i,s,o,l,u,h,p,m){try{s[n]=Wc($n(e,r,!0),t);var _=xr(e,t),v;switch(l){case"sheet":v=IF(_,t,i,u,s[n],h,p,m);break;case"chart":if(v=CF(_,t,i,u,s[n],h,p,m),!v||!v["!drawel"])break;var E=Ic(v["!drawel"].Target,t),y=im(E),w=SL($n(e,E,!0),Wc($n(e,y,!0),E)),k=Ic(w,E),C=im(k);v=cF($n(e,k,!0),k,u,Wc($n(e,C,!0),k),h,v);break;case"macro":v=kF(_,t,i,u,s[n],h,p,m);break;case"dialog":v=RF(_,t,i,u,s[n],h,p,m);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=v;var A=[];s&&s[n]&&ts(s[n]).forEach(function(U){var q="";if(s[n][U].Type==nl.CMNT){q=Ic(s[n][U].Target,t);var K=LF(xr(e,q,!0),q,u);if(!K||!K.length)return;ux(v,K,!1)}s[n][U].Type==nl.TCMNT&&(q=Ic(s[n][U].Target,t),A=A.concat(CL(xr(e,q,!0),u)))}),A&&A.length&&ux(v,A,!0,u.people||[])}catch(U){if(u.WTF)throw U}}function fi(e){return e.charAt(0)=="/"?e.slice(1):e}function Eb(e,t){if(TT(),t=t||{},t_(t),di(e,"META-INF/manifest.xml")||di(e,"objectdata.xml"))return Tx(e,t);if(di(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hd<"u"){if(e.FileIndex)return Hd(e);var r=yt.utils.cfb_new();return Mv(e).forEach(function(Ce){T4(r,Ce,E4(e,Ce))}),Hd(r)}throw new Error("Unsupported NUMBERS file")}if(!di(e,"[Content_Types].xml"))throw di(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):di(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Mv(e),i=_P($n(e,"[Content_Types].xml")),s=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",xr(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!xr(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},h={};if(!t.bookSheets&&!t.bookProps){if(Zc=[],i.sst)try{Zc=OF(xr(e,fi(i.sst)),i.sst,t)}catch(Ce){if(t.WTF)throw Ce}t.cellStyles&&i.themes.length&&(u=NF($n(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(h=PF(xr(e,fi(i.style)),i.style,u,t))}i.links.map(function(Ce){try{var Ie=Wc($n(e,im(fi(Ce))),Ce);return FF(xr(e,fi(Ce)),Ie,Ce,t)}catch{}});var p=SF(xr(e,fi(i.workbooks[0])),i.workbooks[0],t),m={},_="";i.coreprops.length&&(_=xr(e,fi(i.coreprops[0]),!0),_&&(m=YT(_)),i.extprops.length!==0&&(_=xr(e,fi(i.extprops[0]),!0),_&&TP(_,m,t)));var v={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(_=$n(e,fi(i.custprops[0]),!0),_&&(v=wP(_,t)));var E={};if((t.bookSheets||t.bookProps)&&(p.Sheets?o=p.Sheets.map(function(Ie){return Ie.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(E.Props=m,E.Custprops=v),t.bookSheets&&typeof o<"u"&&(E.SheetNames=o),t.bookSheets?E.SheetNames:t.bookProps))return E;o={};var y={};t.bookDeps&&i.calcchain&&(y=DF(xr(e,fi(i.calcchain)),i.calcchain));var w=0,k={},C,A;{var U=p.Sheets;m.Worksheets=U.length,m.SheetNames=[];for(var q=0;q!=U.length;++q)m.SheetNames[q]=U[q].name}var K=s?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),R=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");di(e,R)||(R="xl/_rels/workbook."+K+".rels");var P=Wc($n(e,R,!0),R.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=bF(xr(e,fi(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=kL(xr(e,fi(i.people[0])),t)),P&&(P=xb(P,p.Sheets));var D=xr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=m.Worksheets;++w){var F="sheet";if(P&&P[w]?(C="xl/"+P[w][1].replace(/[\/]?xl\//,""),di(e,C)||(C=P[w][1]),di(e,C)||(C=R.replace(/_rels\/.*$/,"")+P[w][1]),F=P[w][2]):(C="xl/worksheets/sheet"+(w+1-D)+"."+K,C=C.replace(/sheet0\./,"sheet.")),A=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(m.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var b=!1,M=0;M!=t.sheets.length;++M)typeof t.sheets[M]=="number"&&t.sheets[M]==w&&(b=1),typeof t.sheets[M]=="string"&&t.sheets[M].toLowerCase()==m.SheetNames[w].toLowerCase()&&(b=1);if(!b)continue e}}yb(e,C,A,m.SheetNames[w],w,k,o,F,t,p,u,h)}return E={Directory:i,Workbook:p,Props:m,Custprops:v,Deps:y,Sheets:o,SheetNames:m.SheetNames,Strings:Zc,Styles:h,Themes:u,SSF:Zr(ut)},t&&t.bookFiles&&(e.files?(E.keys=n,E.files=e.files):(E.keys=[],E.files={},e.FullPaths.forEach(function(Ce,Ie){Ce=Ce.replace(/^Root Entry[\/]/,""),E.keys.push(Ce),E.files[Ce]=e.FileIndex[Ie]}))),t&&t.bookVBA&&(i.vba.length>0?E.vbaraw=xr(e,fi(i.vba[0]),!0):i.defaults&&i.defaults.bin===OL&&(E.vbaraw=xr(e,"xl/vbaProject.bin",!0))),E}function Tb(e,t){var r=t||{},n="Workbook",i=yt.find(e,n);try{if(n="/!DataSpaces/Version",i=yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(pO(i.content),n="/!DataSpaces/DataSpaceMap",i=yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=gO(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=_O(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);xO(i.content)}catch{}if(n="/EncryptionInfo",i=yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=yO(i.content);if(n="/EncryptedPackage",i=yt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function r_(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Jn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Ab(e,t){return yt.find(e,"EncryptedPackage")?Tb(e,t):FA(e,t)}function wb(e,t){var r,n=e,i=t||{};return i.type||(i.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r=kT(n,i),Eb(r,i)}function UA(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return om(e.slice(r),t);default:break e}return wu.to_workbook(e,t)}function Sb(e,t){var r="",n=r_(e,t);switch(t.type){case"base64":r=Jn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=to(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ht(r)),t.type="binary",UA(r,t)}function Ib(e,t){var r=e;return t.type=="base64"&&(r=Jn(r)),r=yu.utils.decode(1200,r.slice(2),"str"),t.type="binary",UA(r,t)}function Cb(e){return e.match(/[^\x00-\x7F]/)?Cc(e):e}function Wd(e,t,r,n){return n?(r.type="string",wu.to_workbook(e,r)):wu.to_workbook(t,r)}function fm(e,t){uT();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return fm(new Uint8Array(e),(r=Zr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),dl={},r.dateNF&&(dl.dateNF=r.dateNF),r.type||(r.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=_t?"buffer":"binary",n=p4(e),typeof Uint8Array<"u"&&!_t&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Cb(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Zr(r),r.type="array",fm(Dg(n),r)}switch((i=r_(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Ab(yt.read(n,r),r);break;case 9:if(i[1]<=8)return FA(n,r);break;case 60:return om(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return tO(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return QN.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?wb(n,r):Wd(e,n,r,s);case 239:return i[3]===60?om(n,r):Wd(e,n,r,s);case 255:if(i[1]===254)return Ib(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return $c.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return $c.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return cx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return OO.to_workbook(n,r);break;case 10:case 13:case 32:return Sb(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return YN.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?cx.to_workbook(n,r):Wd(e,n,r,s)}function kb(e,t,r,n,i,s,o,l){var u=Kr(r),h=l.defval,p=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,_=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!o||e[r])for(var v=t.s.c;v<=t.e.c;++v){var E=o?e[r][v]:e[n[v]+u];if(E===void 0||E.t===void 0){if(h===void 0)continue;s[v]!=null&&(_[s[v]]=h);continue}var y=E.v;switch(E.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(s[v]!=null){if(y==null)if(E.t=="e"&&y===null)_[s[v]]=null;else if(h!==void 0)_[s[v]]=h;else if(p&&y===null)_[s[v]]=null;else continue;else _[s[v]]=p&&(E.t!=="n"||E.t==="n"&&l.rawNumbers!==!1)?y:Ps(E,y,l);y!=null&&(m=!1)}}return{row:_,isempty:m}}function hm(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof p){case"string":u=or(p);break;case"number":u=or(e["!ref"]),u.s.r=p;break;default:u=p}n>0&&(i=0);var m=Kr(u.s.r),_=[],v=[],E=0,y=0,w=Array.isArray(e),k=u.s.r,C=0,A={};w&&!e[k]&&(e[k]=[]);var U=h.skipHidden&&e["!cols"]||[],q=h.skipHidden&&e["!rows"]||[];for(C=u.s.c;C<=u.e.c;++C)if(!(U[C]||{}).hidden)switch(_[C]=Cr(C),r=w?e[k][C]:e[_[C]+m],n){case 1:s[C]=C-u.s.c;break;case 2:s[C]=_[C];break;case 3:s[C]=h.header[C-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Ps(r,null,h),y=A[o]||0,!y)A[o]=1;else{do l=o+"_"+y++;while(A[l]);A[o]=y,A[l]=1}s[C]=l}for(k=u.s.r+i;k<=u.e.r;++k)if(!(q[k]||{}).hidden){var K=kb(e,u,k,_,n,s,w,h);(K.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(v[E++]=K.row)}return v.length=E,v}var Ix=/"/g;function Rb(e,t,r,n,i,s,o,l){for(var u=!0,h=[],p="",m=Kr(r),_=t.s.c;_<=t.e.c;++_)if(n[_]){var v=l.dense?(e[r]||[])[_]:e[n[_]+m];if(v==null)p="";else if(v.v!=null){u=!1,p=""+(l.rawNumbers&&v.t=="n"?v.v:Ps(v,null,l));for(var E=0,y=0;E!==p.length;++E)if((y=p.charCodeAt(E))===i||y===s||y===34||l.forceQuotes){p='"'+p.replace(Ix,'""')+'"';break}p=="ID"&&(p='"ID"')}else v.f!=null&&!v.F?(u=!1,p="="+v.f,p.indexOf(",")>=0&&(p='"'+p.replace(Ix,'""')+'"')):p="";h.push(p)}return l.blankrows===!1&&u?null:h.join(o)}function VA(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=or(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,u=l.charCodeAt(0),h=new RegExp((s=="|"?"\\|":s)+"+$"),p="",m=[];n.dense=Array.isArray(e);for(var _=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(_[E]||{}).hidden||(m[E]=Cr(E));for(var y=0,w=i.s.r;w<=i.e.r;++w)(v[w]||{}).hidden||(p=Rb(e,i,w,m,o,u,s,n),p!=null&&(n.strip&&(p=p.replace(h,"")),(p||n.blankrows!==!1)&&r.push((y++?l:"")+p)));return delete n.dense,r.join("")}function Pb(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=VA(e,t);return r}function Nb(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=or(e["!ref"]),s="",o=[],l,u=[],h=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=Cr(l);for(var p=i.s.r;p<=i.e.r;++p)for(s=Kr(p),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+s,r=h?(e[p]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=t+"="+n}return u}function zA(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?En(n.origin):n.origin;o=u.r,l=u.c}var h,p={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var m=or(s["!ref"]);p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),o==-1&&(o=m.e.r+1,p.e.r=o+t.length-1+i)}else o==-1&&(o=0,p.e.r=t.length-1+i);var _=n.header||[],v=0;t.forEach(function(y,w){ts(y).forEach(function(k){(v=_.indexOf(k))==-1&&(_[v=_.length]=k);var C=y[k],A="z",U="",q=at({c:l+v,r:o+w+i});h=ku(s,q),C&&typeof C=="object"&&!(C instanceof Date)?s[q]=C:(typeof C=="number"?A="n":typeof C=="boolean"?A="b":typeof C=="string"?A="s":C instanceof Date?(A="d",n.cellDates||(A="n",C=wn(C)),U=n.dateNF||ut[14]):C===null&&n.nullError&&(A="e",C=0),h?(h.t=A,h.v=C,delete h.w,delete h.R,U&&(h.z=U)):s[q]=h={t:A,v:C},U&&(h.z=U))})}),p.e.c=Math.max(p.e.c,l+_.length-1);var E=Kr(o);if(i)for(v=0;v<_.length;++v)s[Cr(v+l)+E]={t:"s",v:_[v]};return s["!ref"]=Et(p),s}function Ob(e,t){return zA(null,e,t)}function ku(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=En(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ku(e,at(t)):ku(e,at({r:t,c:r||0}))}function Lb(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function n_(){return{SheetNames:[],Sheets:{}}}function i_(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(_F(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Db(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Lb(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Fb(e,t){return e.z=t,e}function jA(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function bb(e,t,r){return jA(e,"#"+t,r)}function Mb(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Bb(e,t,r,n){for(var i=typeof t!="string"?t:or(t),s=typeof t=="string"?t:Et(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var u=ku(e,o,l);u.t="n",u.F=s,delete u.v,o==i.s.r&&l==i.s.c&&(u.f=r,n&&(u.D=!0))}return e}var Ub={encode_col:Cr,encode_row:Kr,encode_cell:at,encode_range:Et,decode_col:Hg,decode_row:jg,split_cell:q4,decode_cell:En,decode_range:Ml,format_cell:Ps,sheet_add_aoa:$T,sheet_add_json:zA,sheet_add_dom:bA,aoa_to_sheet:Bl,json_to_sheet:Ob,table_to_sheet:MA,table_to_book:tb,sheet_to_csv:VA,sheet_to_txt:Pb,sheet_to_json:hm,sheet_to_html:eb,sheet_to_formulae:Nb,sheet_to_row_object_array:hm,sheet_get_cell:ku,book_new:n_,book_append_sheet:i_,book_set_sheet_visibility:Db,cell_set_number_format:Fb,cell_set_hyperlink:jA,cell_set_internal_link:bb,cell_add_comment:Mb,sheet_set_array_formula:Bb,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Cx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HA=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=i&63|128):(i&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=i&63|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=i&63|128)}return t},Vb=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[r++];t[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[r++],o=e[r++],l=e[r++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;t[n++]=String.fromCharCode(55296+(u>>10)),t[n++]=String.fromCharCode(56320+(u&1023))}else{const s=e[r++],o=e[r++];t[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},WA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<e.length;i+=3){const s=e[i],o=i+1<e.length,l=o?e[i+1]:0,u=i+2<e.length,h=u?e[i+2]:0,p=s>>2,m=(s&3)<<4|l>>4;let _=(l&15)<<2|h>>6,v=h&63;u||(v=64,o||(_=64)),n.push(r[p],r[m],r[_],r[v])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(HA(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):Vb(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<e.length;){const s=r[e.charAt(i++)],l=i<e.length?r[e.charAt(i)]:0;++i;const h=i<e.length?r[e.charAt(i)]:64;++i;const m=i<e.length?r[e.charAt(i)]:64;if(++i,s==null||l==null||h==null||m==null)throw new zb;const _=s<<2|l>>4;if(n.push(_),h!==64){const v=l<<4&240|h>>2;if(n.push(v),m!==64){const E=h<<6&192|m;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class zb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const jb=function(e){const t=HA(e);return WA.encodeByteArray(t,!0)},e0=function(e){return jb(e).replace(/\./g,"")},Hb=function(e){try{return WA.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gb=()=>Wb().__FIREBASE_DEFAULTS__,$b=()=>{if(typeof process>"u"||typeof Cx>"u")return;const e=Cx.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Zb=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Hb(e[1]);return t&&JSON.parse(t)},s_=()=>{try{return Gb()||$b()||Zb()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Kb=e=>{var t,r;return(r=(t=s_())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},Xb=e=>{const t=Kb(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},GA=()=>{var e;return(e=s_())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[e0(JSON.stringify(r)),e0(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jb(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Qb(){var e;const t=(e=s_())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function e6(){return!Qb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function t6(){try{return typeof indexedDB=="object"}catch{return!1}}function r6(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n6="FirebaseError";class Ul extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=n6,Object.setPrototypeOf(this,Ul.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$A.prototype.create)}}class $A{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?i6(s,n):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Ul(i,l,n)}}function i6(e,t){return e.replace(s6,(r,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const s6=/\{\$([^}]+)}/g;function dm(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const i of r){if(!n.includes(i))return!1;const s=e[i],o=t[i];if(kx(s)&&kx(o)){if(!dm(s,o))return!1}else if(s!==o)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function kx(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ns(e){return e&&e._delegate?e._delegate:e}class Ru{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new qb;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(l6(t))try{this.getOrInitializeService({instanceIdentifier:Fa})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(t=Fa){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Fa){return this.instances.has(t)}getOptions(t=Fa){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(i)}return i}onInit(t,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&t(o,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:o6(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=Fa){return this.component?this.component.multipleInstances?t:Fa:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function o6(e){return e===Fa?void 0:e}function l6(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new a6(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tt;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Tt||(Tt={}));const u6={debug:Tt.DEBUG,verbose:Tt.VERBOSE,info:Tt.INFO,warn:Tt.WARN,error:Tt.ERROR,silent:Tt.SILENT},f6=Tt.INFO,h6={[Tt.DEBUG]:"log",[Tt.VERBOSE]:"log",[Tt.INFO]:"info",[Tt.WARN]:"warn",[Tt.ERROR]:"error"},d6=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),i=h6[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class ZA{constructor(t){this.name=t,this._logLevel=f6,this._logHandler=d6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Tt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?u6[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Tt.DEBUG,...t),this._logHandler(this,Tt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Tt.VERBOSE,...t),this._logHandler(this,Tt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Tt.INFO,...t),this._logHandler(this,Tt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Tt.WARN,...t),this._logHandler(this,Tt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Tt.ERROR,...t),this._logHandler(this,Tt.ERROR,...t)}}const p6=(e,t)=>t.some(r=>e instanceof r);let Rx,Px;function m6(){return Rx||(Rx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function g6(){return Px||(Px=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const KA=new WeakMap,pm=new WeakMap,XA=new WeakMap,Gd=new WeakMap,a_=new WeakMap;function _6(e){const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{r(pa(e.result)),i()},o=()=>{n(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(r=>{r instanceof IDBCursor&&KA.set(r,e)}).catch(()=>{}),a_.set(t,e),t}function v6(e){if(pm.has(e))return;const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{r(),i()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});pm.set(e,t)}let mm={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return pm.get(e);if(t==="objectStoreNames")return e.objectStoreNames||XA.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return pa(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function x6(e){mm=e(mm)}function y6(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call($d(this),t,...r);return XA.set(n,t.sort?t.sort():[t]),pa(n)}:g6().includes(e)?function(...t){return e.apply($d(this),t),pa(KA.get(this))}:function(...t){return pa(e.apply($d(this),t))}}function E6(e){return typeof e=="function"?y6(e):(e instanceof IDBTransaction&&v6(e),p6(e,m6())?new Proxy(e,mm):e)}function pa(e){if(e instanceof IDBRequest)return _6(e);if(Gd.has(e))return Gd.get(e);const t=E6(e);return t!==e&&(Gd.set(e,t),a_.set(t,e)),t}const $d=e=>a_.get(e);function T6(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),l=pa(o);return n&&o.addEventListener("upgradeneeded",u=>{n(pa(o.result),u.oldVersion,u.newVersion,pa(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const A6=["get","getKey","getAll","getAllKeys","count"],w6=["put","add","delete","clear"],Zd=new Map;function Nx(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Zd.get(t))return Zd.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=w6.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||A6.includes(r)))return;const s=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(l.shift())),(await Promise.all([h[r](...l),i&&u.done]))[0]};return Zd.set(t,s),s}x6(e=>({...e,get:(t,r,n)=>Nx(t,r)||e.get(t,r,n),has:(t,r)=>!!Nx(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(I6(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function I6(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const gm="@firebase/app",Ox="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os=new ZA("@firebase/app"),C6="@firebase/app-compat",k6="@firebase/analytics-compat",R6="@firebase/analytics",P6="@firebase/app-check-compat",N6="@firebase/app-check",O6="@firebase/auth",L6="@firebase/auth-compat",D6="@firebase/database",F6="@firebase/data-connect",b6="@firebase/database-compat",M6="@firebase/functions",B6="@firebase/functions-compat",U6="@firebase/installations",V6="@firebase/installations-compat",z6="@firebase/messaging",j6="@firebase/messaging-compat",H6="@firebase/performance",W6="@firebase/performance-compat",G6="@firebase/remote-config",$6="@firebase/remote-config-compat",Z6="@firebase/storage",K6="@firebase/storage-compat",X6="@firebase/firestore",q6="@firebase/vertexai-preview",Y6="@firebase/firestore-compat",J6="firebase",Q6="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="[DEFAULT]",eM={[gm]:"fire-core",[C6]:"fire-core-compat",[R6]:"fire-analytics",[k6]:"fire-analytics-compat",[N6]:"fire-app-check",[P6]:"fire-app-check-compat",[O6]:"fire-auth",[L6]:"fire-auth-compat",[D6]:"fire-rtdb",[F6]:"fire-data-connect",[b6]:"fire-rtdb-compat",[M6]:"fire-fn",[B6]:"fire-fn-compat",[U6]:"fire-iid",[V6]:"fire-iid-compat",[z6]:"fire-fcm",[j6]:"fire-fcm-compat",[H6]:"fire-perf",[W6]:"fire-perf-compat",[G6]:"fire-rc",[$6]:"fire-rc-compat",[Z6]:"fire-gcs",[K6]:"fire-gcs-compat",[X6]:"fire-fst",[Y6]:"fire-fst-compat",[q6]:"fire-vertex","fire-js":"fire-js",[J6]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0=new Map,tM=new Map,vm=new Map;function Lx(e,t){try{e.container.addComponent(t)}catch(r){Os.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function r0(e){const t=e.name;if(vm.has(t))return Os.debug(`There were multiple attempts to register component ${t}.`),!1;vm.set(t,e);for(const r of t0.values())Lx(r,e);for(const r of tM.values())Lx(r,e);return!0}function rM(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nM={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ma=new $A("app","Firebase",nM);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ru("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ma.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sM=Q6;function qA(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:_m,automaticDataCollectionEnabled:!1},t),i=n.name;if(typeof i!="string"||!i)throw ma.create("bad-app-name",{appName:String(i)});if(r||(r=GA()),!r)throw ma.create("no-options");const s=t0.get(i);if(s){if(dm(r,s.options)&&dm(n,s.config))return s;throw ma.create("duplicate-app",{appName:i})}const o=new c6(i);for(const u of vm.values())o.addComponent(u);const l=new iM(r,n,o);return t0.set(i,l),l}function aM(e=_m){const t=t0.get(e);if(!t&&e===_m&&GA())return qA();if(!t)throw ma.create("no-app",{appName:e});return t}function pl(e,t,r){var n;let i=(n=eM[e])!==null&&n!==void 0?n:e;r&&(i+=`-${r}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${t}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Os.warn(l.join(" "));return}r0(new Ru(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oM="firebase-heartbeat-database",lM=1,Pu="firebase-heartbeat-store";let Kd=null;function YA(){return Kd||(Kd=T6(oM,lM,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Pu)}catch(r){console.warn(r)}}}}).catch(e=>{throw ma.create("idb-open",{originalErrorMessage:e.message})})),Kd}async function cM(e){try{const r=(await YA()).transaction(Pu),n=await r.objectStore(Pu).get(JA(e));return await r.done,n}catch(t){if(t instanceof Ul)Os.warn(t.message);else{const r=ma.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Os.warn(r.message)}}}async function Dx(e,t){try{const n=(await YA()).transaction(Pu,"readwrite");await n.objectStore(Pu).put(t,JA(e)),await n.done}catch(r){if(r instanceof Ul)Os.warn(r.message);else{const n=ma.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Os.warn(n.message)}}}function JA(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM=1024,fM=30*24*60*60*1e3;class hM{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new pM(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Fx();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=fM}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Os.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Fx(),{heartbeatsToSend:n,unsentEntries:i}=dM(this._heartbeatsCache.heartbeats),s=e0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Os.warn(r),""}}}function Fx(){return new Date().toISOString().substring(0,10)}function dM(e,t=uM){const r=[];let n=e.slice();for(const i of e){const s=r.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),bx(r)>t){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),bx(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class pM{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return t6()?r6().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await cM(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Dx(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Dx(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function bx(e){return e0(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mM(e){r0(new Ru("platform-logger",t=>new S6(t),"PRIVATE")),r0(new Ru("heartbeat",t=>new hM(t),"PRIVATE")),pl(gm,Ox,e),pl(gm,Ox,"esm2017"),pl("fire-js","")}mM("");var gM="firebase",_M="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pl(gM,_M,"app");var Mx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Za,QA;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(S,R){function P(){}P.prototype=R.prototype,S.D=R.prototype,S.prototype=new P,S.prototype.constructor=S,S.C=function(D,F,b){for(var M=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)M[Ce-2]=arguments[Ce];return R.prototype[F].apply(D,M)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,R,P){P||(P=0);var D=Array(16);if(typeof R=="string")for(var F=0;16>F;++F)D[F]=R.charCodeAt(P++)|R.charCodeAt(P++)<<8|R.charCodeAt(P++)<<16|R.charCodeAt(P++)<<24;else for(F=0;16>F;++F)D[F]=R[P++]|R[P++]<<8|R[P++]<<16|R[P++]<<24;R=S.g[0],P=S.g[1],F=S.g[2];var b=S.g[3],M=R+(b^P&(F^b))+D[0]+3614090360&4294967295;R=P+(M<<7&4294967295|M>>>25),M=b+(F^R&(P^F))+D[1]+3905402710&4294967295,b=R+(M<<12&4294967295|M>>>20),M=F+(P^b&(R^P))+D[2]+606105819&4294967295,F=b+(M<<17&4294967295|M>>>15),M=P+(R^F&(b^R))+D[3]+3250441966&4294967295,P=F+(M<<22&4294967295|M>>>10),M=R+(b^P&(F^b))+D[4]+4118548399&4294967295,R=P+(M<<7&4294967295|M>>>25),M=b+(F^R&(P^F))+D[5]+1200080426&4294967295,b=R+(M<<12&4294967295|M>>>20),M=F+(P^b&(R^P))+D[6]+2821735955&4294967295,F=b+(M<<17&4294967295|M>>>15),M=P+(R^F&(b^R))+D[7]+4249261313&4294967295,P=F+(M<<22&4294967295|M>>>10),M=R+(b^P&(F^b))+D[8]+1770035416&4294967295,R=P+(M<<7&4294967295|M>>>25),M=b+(F^R&(P^F))+D[9]+2336552879&4294967295,b=R+(M<<12&4294967295|M>>>20),M=F+(P^b&(R^P))+D[10]+4294925233&4294967295,F=b+(M<<17&4294967295|M>>>15),M=P+(R^F&(b^R))+D[11]+2304563134&4294967295,P=F+(M<<22&4294967295|M>>>10),M=R+(b^P&(F^b))+D[12]+1804603682&4294967295,R=P+(M<<7&4294967295|M>>>25),M=b+(F^R&(P^F))+D[13]+4254626195&4294967295,b=R+(M<<12&4294967295|M>>>20),M=F+(P^b&(R^P))+D[14]+2792965006&4294967295,F=b+(M<<17&4294967295|M>>>15),M=P+(R^F&(b^R))+D[15]+1236535329&4294967295,P=F+(M<<22&4294967295|M>>>10),M=R+(F^b&(P^F))+D[1]+4129170786&4294967295,R=P+(M<<5&4294967295|M>>>27),M=b+(P^F&(R^P))+D[6]+3225465664&4294967295,b=R+(M<<9&4294967295|M>>>23),M=F+(R^P&(b^R))+D[11]+643717713&4294967295,F=b+(M<<14&4294967295|M>>>18),M=P+(b^R&(F^b))+D[0]+3921069994&4294967295,P=F+(M<<20&4294967295|M>>>12),M=R+(F^b&(P^F))+D[5]+3593408605&4294967295,R=P+(M<<5&4294967295|M>>>27),M=b+(P^F&(R^P))+D[10]+38016083&4294967295,b=R+(M<<9&4294967295|M>>>23),M=F+(R^P&(b^R))+D[15]+3634488961&4294967295,F=b+(M<<14&4294967295|M>>>18),M=P+(b^R&(F^b))+D[4]+3889429448&4294967295,P=F+(M<<20&4294967295|M>>>12),M=R+(F^b&(P^F))+D[9]+568446438&4294967295,R=P+(M<<5&4294967295|M>>>27),M=b+(P^F&(R^P))+D[14]+3275163606&4294967295,b=R+(M<<9&4294967295|M>>>23),M=F+(R^P&(b^R))+D[3]+4107603335&4294967295,F=b+(M<<14&4294967295|M>>>18),M=P+(b^R&(F^b))+D[8]+1163531501&4294967295,P=F+(M<<20&4294967295|M>>>12),M=R+(F^b&(P^F))+D[13]+2850285829&4294967295,R=P+(M<<5&4294967295|M>>>27),M=b+(P^F&(R^P))+D[2]+4243563512&4294967295,b=R+(M<<9&4294967295|M>>>23),M=F+(R^P&(b^R))+D[7]+1735328473&4294967295,F=b+(M<<14&4294967295|M>>>18),M=P+(b^R&(F^b))+D[12]+2368359562&4294967295,P=F+(M<<20&4294967295|M>>>12),M=R+(P^F^b)+D[5]+4294588738&4294967295,R=P+(M<<4&4294967295|M>>>28),M=b+(R^P^F)+D[8]+2272392833&4294967295,b=R+(M<<11&4294967295|M>>>21),M=F+(b^R^P)+D[11]+1839030562&4294967295,F=b+(M<<16&4294967295|M>>>16),M=P+(F^b^R)+D[14]+4259657740&4294967295,P=F+(M<<23&4294967295|M>>>9),M=R+(P^F^b)+D[1]+2763975236&4294967295,R=P+(M<<4&4294967295|M>>>28),M=b+(R^P^F)+D[4]+1272893353&4294967295,b=R+(M<<11&4294967295|M>>>21),M=F+(b^R^P)+D[7]+4139469664&4294967295,F=b+(M<<16&4294967295|M>>>16),M=P+(F^b^R)+D[10]+3200236656&4294967295,P=F+(M<<23&4294967295|M>>>9),M=R+(P^F^b)+D[13]+681279174&4294967295,R=P+(M<<4&4294967295|M>>>28),M=b+(R^P^F)+D[0]+3936430074&4294967295,b=R+(M<<11&4294967295|M>>>21),M=F+(b^R^P)+D[3]+3572445317&4294967295,F=b+(M<<16&4294967295|M>>>16),M=P+(F^b^R)+D[6]+76029189&4294967295,P=F+(M<<23&4294967295|M>>>9),M=R+(P^F^b)+D[9]+3654602809&4294967295,R=P+(M<<4&4294967295|M>>>28),M=b+(R^P^F)+D[12]+3873151461&4294967295,b=R+(M<<11&4294967295|M>>>21),M=F+(b^R^P)+D[15]+530742520&4294967295,F=b+(M<<16&4294967295|M>>>16),M=P+(F^b^R)+D[2]+3299628645&4294967295,P=F+(M<<23&4294967295|M>>>9),M=R+(F^(P|~b))+D[0]+4096336452&4294967295,R=P+(M<<6&4294967295|M>>>26),M=b+(P^(R|~F))+D[7]+1126891415&4294967295,b=R+(M<<10&4294967295|M>>>22),M=F+(R^(b|~P))+D[14]+2878612391&4294967295,F=b+(M<<15&4294967295|M>>>17),M=P+(b^(F|~R))+D[5]+4237533241&4294967295,P=F+(M<<21&4294967295|M>>>11),M=R+(F^(P|~b))+D[12]+1700485571&4294967295,R=P+(M<<6&4294967295|M>>>26),M=b+(P^(R|~F))+D[3]+2399980690&4294967295,b=R+(M<<10&4294967295|M>>>22),M=F+(R^(b|~P))+D[10]+4293915773&4294967295,F=b+(M<<15&4294967295|M>>>17),M=P+(b^(F|~R))+D[1]+2240044497&4294967295,P=F+(M<<21&4294967295|M>>>11),M=R+(F^(P|~b))+D[8]+1873313359&4294967295,R=P+(M<<6&4294967295|M>>>26),M=b+(P^(R|~F))+D[15]+4264355552&4294967295,b=R+(M<<10&4294967295|M>>>22),M=F+(R^(b|~P))+D[6]+2734768916&4294967295,F=b+(M<<15&4294967295|M>>>17),M=P+(b^(F|~R))+D[13]+1309151649&4294967295,P=F+(M<<21&4294967295|M>>>11),M=R+(F^(P|~b))+D[4]+4149444226&4294967295,R=P+(M<<6&4294967295|M>>>26),M=b+(P^(R|~F))+D[11]+3174756917&4294967295,b=R+(M<<10&4294967295|M>>>22),M=F+(R^(b|~P))+D[2]+718787259&4294967295,F=b+(M<<15&4294967295|M>>>17),M=P+(b^(F|~R))+D[9]+3951481745&4294967295,S.g[0]=S.g[0]+R&4294967295,S.g[1]=S.g[1]+(F+(M<<21&4294967295|M>>>11))&4294967295,S.g[2]=S.g[2]+F&4294967295,S.g[3]=S.g[3]+b&4294967295}n.prototype.u=function(S,R){R===void 0&&(R=S.length);for(var P=R-this.blockSize,D=this.B,F=this.h,b=0;b<R;){if(F==0)for(;b<=P;)i(this,S,b),b+=this.blockSize;if(typeof S=="string"){for(;b<R;)if(D[F++]=S.charCodeAt(b++),F==this.blockSize){i(this,D),F=0;break}}else for(;b<R;)if(D[F++]=S[b++],F==this.blockSize){i(this,D),F=0;break}}this.h=F,this.o+=R},n.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var R=1;R<S.length-8;++R)S[R]=0;var P=8*this.o;for(R=S.length-8;R<S.length;++R)S[R]=P&255,P/=256;for(this.u(S),S=Array(16),R=P=0;4>R;++R)for(var D=0;32>D;D+=8)S[P++]=this.g[R]>>>D&255;return S};function s(S,R){var P=l;return Object.prototype.hasOwnProperty.call(P,S)?P[S]:P[S]=R(S)}function o(S,R){this.h=R;for(var P=[],D=!0,F=S.length-1;0<=F;F--){var b=S[F]|0;D&&b==R||(P[F]=b,D=!1)}this.g=P}var l={};function u(S){return-128<=S&&128>S?s(S,function(R){return new o([R|0],0>R?-1:0)}):new o([S|0],0>S?-1:0)}function h(S){if(isNaN(S)||!isFinite(S))return m;if(0>S)return w(h(-S));for(var R=[],P=1,D=0;S>=P;D++)R[D]=S/P|0,P*=4294967296;return new o(R,0)}function p(S,R){if(S.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(S.charAt(0)=="-")return w(p(S.substring(1),R));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=h(Math.pow(R,8)),D=m,F=0;F<S.length;F+=8){var b=Math.min(8,S.length-F),M=parseInt(S.substring(F,F+b),R);8>b?(b=h(Math.pow(R,b)),D=D.j(b).add(h(M))):(D=D.j(P),D=D.add(h(M)))}return D}var m=u(0),_=u(1),v=u(16777216);e=o.prototype,e.m=function(){if(y(this))return-w(this).m();for(var S=0,R=1,P=0;P<this.g.length;P++){var D=this.i(P);S+=(0<=D?D:4294967296+D)*R,R*=4294967296}return S},e.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(E(this))return"0";if(y(this))return"-"+w(this).toString(S);for(var R=h(Math.pow(S,6)),P=this,D="";;){var F=U(P,R).g;P=k(P,F.j(R));var b=((0<P.g.length?P.g[0]:P.h)>>>0).toString(S);if(P=F,E(P))return b+D;for(;6>b.length;)b="0"+b;D=b+D}},e.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function E(S){if(S.h!=0)return!1;for(var R=0;R<S.g.length;R++)if(S.g[R]!=0)return!1;return!0}function y(S){return S.h==-1}e.l=function(S){return S=k(this,S),y(S)?-1:E(S)?0:1};function w(S){for(var R=S.g.length,P=[],D=0;D<R;D++)P[D]=~S.g[D];return new o(P,~S.h).add(_)}e.abs=function(){return y(this)?w(this):this},e.add=function(S){for(var R=Math.max(this.g.length,S.g.length),P=[],D=0,F=0;F<=R;F++){var b=D+(this.i(F)&65535)+(S.i(F)&65535),M=(b>>>16)+(this.i(F)>>>16)+(S.i(F)>>>16);D=M>>>16,b&=65535,M&=65535,P[F]=M<<16|b}return new o(P,P[P.length-1]&-2147483648?-1:0)};function k(S,R){return S.add(w(R))}e.j=function(S){if(E(this)||E(S))return m;if(y(this))return y(S)?w(this).j(w(S)):w(w(this).j(S));if(y(S))return w(this.j(w(S)));if(0>this.l(v)&&0>S.l(v))return h(this.m()*S.m());for(var R=this.g.length+S.g.length,P=[],D=0;D<2*R;D++)P[D]=0;for(D=0;D<this.g.length;D++)for(var F=0;F<S.g.length;F++){var b=this.i(D)>>>16,M=this.i(D)&65535,Ce=S.i(F)>>>16,Ie=S.i(F)&65535;P[2*D+2*F]+=M*Ie,C(P,2*D+2*F),P[2*D+2*F+1]+=b*Ie,C(P,2*D+2*F+1),P[2*D+2*F+1]+=M*Ce,C(P,2*D+2*F+1),P[2*D+2*F+2]+=b*Ce,C(P,2*D+2*F+2)}for(D=0;D<R;D++)P[D]=P[2*D+1]<<16|P[2*D];for(D=R;D<2*R;D++)P[D]=0;return new o(P,0)};function C(S,R){for(;(S[R]&65535)!=S[R];)S[R+1]+=S[R]>>>16,S[R]&=65535,R++}function A(S,R){this.g=S,this.h=R}function U(S,R){if(E(R))throw Error("division by zero");if(E(S))return new A(m,m);if(y(S))return R=U(w(S),R),new A(w(R.g),w(R.h));if(y(R))return R=U(S,w(R)),new A(w(R.g),R.h);if(30<S.g.length){if(y(S)||y(R))throw Error("slowDivide_ only works with positive integers.");for(var P=_,D=R;0>=D.l(S);)P=q(P),D=q(D);var F=K(P,1),b=K(D,1);for(D=K(D,2),P=K(P,2);!E(D);){var M=b.add(D);0>=M.l(S)&&(F=F.add(P),b=M),D=K(D,1),P=K(P,1)}return R=k(S,F.j(R)),new A(F,R)}for(F=m;0<=S.l(R);){for(P=Math.max(1,Math.floor(S.m()/R.m())),D=Math.ceil(Math.log(P)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),b=h(P),M=b.j(R);y(M)||0<M.l(S);)P-=D,b=h(P),M=b.j(R);E(b)&&(b=_),F=F.add(b),S=k(S,M)}return new A(F,S)}e.A=function(S){return U(this,S).h},e.and=function(S){for(var R=Math.max(this.g.length,S.g.length),P=[],D=0;D<R;D++)P[D]=this.i(D)&S.i(D);return new o(P,this.h&S.h)},e.or=function(S){for(var R=Math.max(this.g.length,S.g.length),P=[],D=0;D<R;D++)P[D]=this.i(D)|S.i(D);return new o(P,this.h|S.h)},e.xor=function(S){for(var R=Math.max(this.g.length,S.g.length),P=[],D=0;D<R;D++)P[D]=this.i(D)^S.i(D);return new o(P,this.h^S.h)};function q(S){for(var R=S.g.length+1,P=[],D=0;D<R;D++)P[D]=S.i(D)<<1|S.i(D-1)>>>31;return new o(P,S.h)}function K(S,R){var P=R>>5;R%=32;for(var D=S.g.length-P,F=[],b=0;b<D;b++)F[b]=0<R?S.i(b+P)>>>R|S.i(b+P+1)<<32-R:S.i(b+P);return new o(F,S.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,QA=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=p,Za=o}).apply(typeof Mx<"u"?Mx:typeof self<"u"?self:typeof window<"u"?window:{});var Xf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ew,kc,tw,hh,xm,rw,nw,iw;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,x,I){return f==Array.prototype||f==Object.prototype||(f[x]=I.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xf=="object"&&Xf];for(var x=0;x<f.length;++x){var I=f[x];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var n=r(this);function i(f,x){if(x)e:{var I=n;f=f.split(".");for(var B=0;B<f.length-1;B++){var ie=f[B];if(!(ie in I))break e;I=I[ie]}f=f[f.length-1],B=I[f],x=x(B),x!=B&&x!=null&&t(I,f,{configurable:!0,writable:!0,value:x})}}function s(f,x){f instanceof String&&(f+="");var I=0,B=!1,ie={next:function(){if(!B&&I<f.length){var pe=I++;return{value:x(pe,f[pe]),done:!1}}return B=!0,{done:!0,value:void 0}}};return ie[Symbol.iterator]=function(){return ie},ie}i("Array.prototype.values",function(f){return f||function(){return s(this,function(x,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(f){var x=typeof f;return x=x!="object"?x:f?Array.isArray(f)?"array":x:"null",x=="array"||x=="object"&&typeof f.length=="number"}function h(f){var x=typeof f;return x=="object"&&f!=null||x=="function"}function p(f,x,I){return f.call.apply(f.bind,arguments)}function m(f,x,I){if(!f)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var ie=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ie,B),f.apply(x,ie)}}return function(){return f.apply(x,arguments)}}function _(f,x,I){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,_.apply(null,arguments)}function v(f,x){var I=Array.prototype.slice.call(arguments,1);return function(){var B=I.slice();return B.push.apply(B,arguments),f.apply(this,B)}}function E(f,x){function I(){}I.prototype=x.prototype,f.aa=x.prototype,f.prototype=new I,f.prototype.constructor=f,f.Qb=function(B,ie,pe){for(var Le=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)Le[Nt-2]=arguments[Nt];return x.prototype[ie].apply(B,Le)}}function y(f){const x=f.length;if(0<x){const I=Array(x);for(let B=0;B<x;B++)I[B]=f[B];return I}return[]}function w(f,x){for(let I=1;I<arguments.length;I++){const B=arguments[I];if(u(B)){const ie=f.length||0,pe=B.length||0;f.length=ie+pe;for(let Le=0;Le<pe;Le++)f[ie+Le]=B[Le]}else f.push(B)}}class k{constructor(x,I){this.i=x,this.j=I,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function C(f){return/^[\s\xa0]*$/.test(f)}function A(){var f=l.navigator;return f&&(f=f.userAgent)?f:""}function U(f){return U[" "](f),f}U[" "]=function(){};var q=A().indexOf("Gecko")!=-1&&!(A().toLowerCase().indexOf("webkit")!=-1&&A().indexOf("Edge")==-1)&&!(A().indexOf("Trident")!=-1||A().indexOf("MSIE")!=-1)&&A().indexOf("Edge")==-1;function K(f,x,I){for(const B in f)x.call(I,f[B],B,f)}function S(f,x){for(const I in f)x.call(void 0,f[I],I,f)}function R(f){const x={};for(const I in f)x[I]=f[I];return x}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(f,x){let I,B;for(let ie=1;ie<arguments.length;ie++){B=arguments[ie];for(I in B)f[I]=B[I];for(let pe=0;pe<P.length;pe++)I=P[pe],Object.prototype.hasOwnProperty.call(B,I)&&(f[I]=B[I])}}function F(f){var x=1;f=f.split(":");const I=[];for(;0<x&&f.length;)I.push(f.shift()),x--;return f.length&&I.push(f.join(":")),I}function b(f){l.setTimeout(()=>{throw f},0)}function M(){var f=te;let x=null;return f.g&&(x=f.g,f.g=f.g.next,f.g||(f.h=null),x.next=null),x}class Ce{constructor(){this.h=this.g=null}add(x,I){const B=Ie.get();B.set(x,I),this.h?this.h.next=B:this.g=B,this.h=B}}var Ie=new k(()=>new Re,f=>f.reset());class Re{constructor(){this.next=this.g=this.h=null}set(x,I){this.h=x,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let ke,fe=!1,te=new Ce,de=()=>{const f=l.Promise.resolve(void 0);ke=()=>{f.then(Ee)}};var Ee=()=>{for(var f;f=M();){try{f.h.call(f.g)}catch(I){b(I)}var x=Ie;x.j(f),100>x.h&&(x.h++,f.next=x.g,x.g=f)}fe=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function re(f,x){this.type=f,this.g=this.target=x,this.defaultPrevented=!1}re.prototype.h=function(){this.defaultPrevented=!0};var Q=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var f=!1,x=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const I=()=>{};l.addEventListener("test",I,x),l.removeEventListener("test",I,x)}catch{}return f}();function Y(f,x){if(re.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var I=this.type=f.type,B=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=x,x=f.relatedTarget){if(q){e:{try{U(x.nodeName);var ie=!0;break e}catch{}ie=!1}ie||(x=null)}}else I=="mouseover"?x=f.fromElement:I=="mouseout"&&(x=f.toElement);this.relatedTarget=x,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:le[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Y.aa.h.call(this)}}E(Y,re);var le={2:"touch",3:"pen",4:"mouse"};Y.prototype.h=function(){Y.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ye="closure_listenable_"+(1e6*Math.random()|0),Ne=0;function ee(f,x,I,B,ie){this.listener=f,this.proxy=null,this.src=x,this.type=I,this.capture=!!B,this.ha=ie,this.key=++Ne,this.da=this.fa=!1}function me(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Fe(f){this.src=f,this.g={},this.h=0}Fe.prototype.add=function(f,x,I,B,ie){var pe=f.toString();f=this.g[pe],f||(f=this.g[pe]=[],this.h++);var Le=Ve(f,x,B,ie);return-1<Le?(x=f[Le],I||(x.fa=!1)):(x=new ee(x,this.src,pe,!!B,ie),x.fa=I,f.push(x)),x};function H(f,x){var I=x.type;if(I in f.g){var B=f.g[I],ie=Array.prototype.indexOf.call(B,x,void 0),pe;(pe=0<=ie)&&Array.prototype.splice.call(B,ie,1),pe&&(me(x),f.g[I].length==0&&(delete f.g[I],f.h--))}}function Ve(f,x,I,B){for(var ie=0;ie<f.length;++ie){var pe=f[ie];if(!pe.da&&pe.listener==x&&pe.capture==!!I&&pe.ha==B)return ie}return-1}var je="closure_lm_"+(1e6*Math.random()|0),tt={};function Ze(f,x,I,B,ie){if(Array.isArray(x)){for(var pe=0;pe<x.length;pe++)Ze(f,x[pe],I,B,ie);return null}return I=dr(I),f&&f[ye]?f.K(x,I,h(B)?!!B.capture:!1,ie):Pe(f,x,I,!1,B,ie)}function Pe(f,x,I,B,ie,pe){if(!x)throw Error("Invalid event type");var Le=h(ie)?!!ie.capture:!!ie,Nt=pt(f);if(Nt||(f[je]=Nt=new Fe(f)),I=Nt.add(x,I,B,Le,pe),I.proxy)return I;if(B=ne(),I.proxy=B,B.src=f,B.listener=I,f.addEventListener)Q||(ie=Le),ie===void 0&&(ie=!1),f.addEventListener(x.toString(),B,ie);else if(f.attachEvent)f.attachEvent(Qe(x.toString()),B);else if(f.addListener&&f.removeListener)f.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return I}function ne(){function f(I){return x.call(f.src,f.listener,I)}const x=st;return f}function De(f,x,I,B,ie){if(Array.isArray(x))for(var pe=0;pe<x.length;pe++)De(f,x[pe],I,B,ie);else B=h(B)?!!B.capture:!!B,I=dr(I),f&&f[ye]?(f=f.i,x=String(x).toString(),x in f.g&&(pe=f.g[x],I=Ve(pe,I,B,ie),-1<I&&(me(pe[I]),Array.prototype.splice.call(pe,I,1),pe.length==0&&(delete f.g[x],f.h--)))):f&&(f=pt(f))&&(x=f.g[x.toString()],f=-1,x&&(f=Ve(x,I,B,ie)),(I=-1<f?x[f]:null)&&Me(I))}function Me(f){if(typeof f!="number"&&f&&!f.da){var x=f.src;if(x&&x[ye])H(x.i,f);else{var I=f.type,B=f.proxy;x.removeEventListener?x.removeEventListener(I,B,f.capture):x.detachEvent?x.detachEvent(Qe(I),B):x.addListener&&x.removeListener&&x.removeListener(B),(I=pt(x))?(H(I,f),I.h==0&&(I.src=null,x[je]=null)):me(f)}}}function Qe(f){return f in tt?tt[f]:tt[f]="on"+f}function st(f,x){if(f.da)f=!0;else{x=new Y(x,this);var I=f.listener,B=f.ha||f.src;f.fa&&Me(f),f=I.call(B,x)}return f}function pt(f){return f=f[je],f instanceof Fe?f:null}var mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function dr(f){return typeof f=="function"?f:(f[mt]||(f[mt]=function(x){return f.handleEvent(x)}),f[mt])}function St(){j.call(this),this.i=new Fe(this),this.M=this,this.F=null}E(St,j),St.prototype[ye]=!0,St.prototype.removeEventListener=function(f,x,I,B){De(this,f,x,I,B)};function Mt(f,x){var I,B=f.F;if(B)for(I=[];B;B=B.F)I.push(B);if(f=f.M,B=x.type||x,typeof x=="string")x=new re(x,f);else if(x instanceof re)x.target=x.target||f;else{var ie=x;x=new re(B,f),D(x,ie)}if(ie=!0,I)for(var pe=I.length-1;0<=pe;pe--){var Le=x.g=I[pe];ie=Ut(Le,B,!0,x)&&ie}if(Le=x.g=f,ie=Ut(Le,B,!0,x)&&ie,ie=Ut(Le,B,!1,x)&&ie,I)for(pe=0;pe<I.length;pe++)Le=x.g=I[pe],ie=Ut(Le,B,!1,x)&&ie}St.prototype.N=function(){if(St.aa.N.call(this),this.i){var f=this.i,x;for(x in f.g){for(var I=f.g[x],B=0;B<I.length;B++)me(I[B]);delete f.g[x],f.h--}}this.F=null},St.prototype.K=function(f,x,I,B){return this.i.add(String(f),x,!1,I,B)},St.prototype.L=function(f,x,I,B){return this.i.add(String(f),x,!0,I,B)};function Ut(f,x,I,B){if(x=f.i.g[String(x)],!x)return!0;x=x.concat();for(var ie=!0,pe=0;pe<x.length;++pe){var Le=x[pe];if(Le&&!Le.da&&Le.capture==I){var Nt=Le.listener,mr=Le.ha||Le.src;Le.fa&&H(f.i,Le),ie=Nt.call(mr,B)!==!1&&ie}}return ie&&!B.defaultPrevented}function Nr(f,x,I){if(typeof f=="function")I&&(f=_(f,I));else if(f&&typeof f.handleEvent=="function")f=_(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:l.setTimeout(f,x||0)}function et(f){f.g=Nr(()=>{f.g=null,f.i&&(f.i=!1,et(f))},f.l);const x=f.h;f.h=null,f.m.apply(null,x)}class kt extends j{constructor(x,I){super(),this.m=x,this.l=I,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:et(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rt(f){j.call(this),this.h=f,this.g={}}E(Rt,j);var Dt=[];function zr(f){K(f.g,function(x,I){this.g.hasOwnProperty(I)&&Me(x)},f),f.g={}}Rt.prototype.N=function(){Rt.aa.N.call(this),zr(this)},Rt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ti=l.JSON.stringify,Ke=l.JSON.parse,Vt=class{stringify(f){return l.JSON.stringify(f,void 0)}parse(f){return l.JSON.parse(f,void 0)}};function pr(){}pr.prototype.h=null;function lr(f){return f.h||(f.h=f.i())}function Cn(){}var mn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Or(){re.call(this,"d")}E(Or,re);function Jr(){re.call(this,"c")}E(Jr,re);var Qr={},ri=null;function zi(){return ri=ri||new St}Qr.La="serverreachability";function vo(f){re.call(this,Qr.La,f)}E(vo,re);function as(f){const x=zi();Mt(x,new vo(x))}Qr.STAT_EVENT="statevent";function Ms(f,x){re.call(this,Qr.STAT_EVENT,f),this.stat=x}E(Ms,re);function Tr(f){const x=zi();Mt(x,new Ms(x,f))}Qr.Ma="timingevent";function xo(f,x){re.call(this,Qr.Ma,f),this.size=x}E(xo,re);function Ai(f,x){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){f()},x)}function os(){this.g=!0}os.prototype.xa=function(){this.g=!1};function kn(f,x,I,B,ie,pe){f.info(function(){if(f.g)if(pe)for(var Le="",Nt=pe.split("&"),mr=0;mr<Nt.length;mr++){var vt=Nt[mr].split("=");if(1<vt.length){var bt=vt[0];vt=vt[1];var Qt=bt.split("_");Le=2<=Qt.length&&Qt[1]=="type"?Le+(bt+"="+vt+"&"):Le+(bt+"=redacted&")}}else Le=null;else Le=pe;return"XMLHTTP REQ ("+B+") [attempt "+ie+"]: "+x+`
`+I+`
`+Le})}function We(f,x,I,B,ie,pe,Le){f.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+ie+"]: "+x+`
`+I+`
`+pe+" "+Le})}function N(f,x,I,B){f.info(function(){return"XMLHTTP TEXT ("+x+"): "+V(f,I)+(B?" "+B:"")})}function G(f,x){f.info(function(){return"TIMEOUT: "+x})}os.prototype.info=function(){};function V(f,x){if(!f.g)return x;if(!x)return null;try{var I=JSON.parse(x);if(I){for(f=0;f<I.length;f++)if(Array.isArray(I[f])){var B=I[f];if(!(2>B.length)){var ie=B[1];if(Array.isArray(ie)&&!(1>ie.length)){var pe=ie[0];if(pe!="noop"&&pe!="stop"&&pe!="close")for(var Le=1;Le<ie.length;Le++)ie[Le]=""}}}}return ti(I)}catch{return x}}var z={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Z={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},X;function se(){}E(se,pr),se.prototype.g=function(){return new XMLHttpRequest},se.prototype.i=function(){return{}},X=new se;function ge(f,x,I,B){this.j=f,this.i=x,this.l=I,this.R=B||1,this.U=new Rt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oe}function oe(){this.i=null,this.g="",this.h=!1}var ce={},ue={};function Te(f,x,I){f.L=1,f.v=si(ir(x)),f.m=I,f.P=!0,Oe(f,null)}function Oe(f,x){f.F=Date.now(),be(f),f.A=ir(f.v);var I=f.A,B=f.R;Array.isArray(B)||(B=[String(B)]),rf(I.i,"t",B),f.C=0,I=f.j.J,f.h=new oe,f.g=uf(f.j,I?x:null,!f.m),0<f.O&&(f.M=new kt(_(f.Y,f,f.g),f.O)),x=f.U,I=f.g,B=f.ca;var ie="readystatechange";Array.isArray(ie)||(ie&&(Dt[0]=ie.toString()),ie=Dt);for(var pe=0;pe<ie.length;pe++){var Le=Ze(I,ie[pe],B||x.handleEvent,!1,x.h||x);if(!Le)break;x.g[Le.key]=Le}x=f.H?R(f.H):{},f.m?(f.u||(f.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,x)):(f.u="GET",f.g.ea(f.A,f.u,null,x)),as(),kn(f.i,f.u,f.A,f.l,f.R,f.m)}ge.prototype.ca=function(f){f=f.target;const x=this.M;x&&gn(f)==3?x.j():this.Y(f)},ge.prototype.Y=function(f){try{if(f==this.g)e:{const Qt=gn(this.g);var x=this.g.Ba();const Hs=this.g.Z();if(!(3>Qt)&&(Qt!=3||this.g&&(this.h.h||this.g.oa()||tc(this.g)))){this.J||Qt!=4||x==7||(x==8||0>=Hs?as(3):as(2)),Pt(this);var I=this.g.Z();this.X=I;t:if(Be(this)){var B=tc(this.g);f="";var ie=B.length,pe=gn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){zt(this),Ct(this);var Le="";break t}this.h.i=new l.TextDecoder}for(x=0;x<ie;x++)this.h.h=!0,f+=this.h.i.decode(B[x],{stream:!(pe&&x==ie-1)});B.length=0,this.h.g+=f,this.C=0,Le=this.h.g}else Le=this.g.oa();if(this.o=I==200,We(this.i,this.u,this.A,this.l,this.R,Qt,I),this.o){if(this.T&&!this.K){t:{if(this.g){var Nt,mr=this.g;if((Nt=mr.g?mr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(Nt)){var vt=Nt;break t}}vt=null}if(I=vt)N(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Bn(this,I);else{this.o=!1,this.s=3,Tr(12),zt(this),Ct(this);break e}}if(this.P){I=!0;let cr;for(;!this.J&&this.C<Le.length;)if(cr=we(this,Le),cr==ue){Qt==4&&(this.s=4,Tr(14),I=!1),N(this.i,this.l,null,"[Incomplete Response]");break}else if(cr==ce){this.s=4,Tr(15),N(this.i,this.l,Le,"[Invalid Chunk]"),I=!1;break}else N(this.i,this.l,cr,null),Bn(this,cr);if(Be(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qt!=4||Le.length!=0||this.h.h||(this.s=1,Tr(16),I=!1),this.o=this.o&&I,!I)N(this.i,this.l,Le,"[Invalid Chunked Response]"),zt(this),Ct(this);else if(0<Le.length&&!this.W){this.W=!0;var bt=this.j;bt.g==this&&bt.ba&&!bt.M&&(bt.j.info("Great, no buffering proxy detected. Bytes received: "+Le.length),ko(bt),bt.M=!0,Tr(11))}}else N(this.i,this.l,Le,null),Bn(this,Le);Qt==4&&zt(this),this.o&&!this.J&&(Qt==4?nc(this.j,this):(this.o=!1,be(this)))}else td(this.g),I==400&&0<Le.indexOf("Unknown SID")?(this.s=3,Tr(12)):(this.s=0,Tr(13)),zt(this),Ct(this)}}}catch{}finally{}};function Be(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function we(f,x){var I=f.C,B=x.indexOf(`
`,I);return B==-1?ue:(I=Number(x.substring(I,B)),isNaN(I)?ce:(B+=1,B+I>x.length?ue:(x=x.slice(B,B+I),f.C=B+I,x)))}ge.prototype.cancel=function(){this.J=!0,zt(this)};function be(f){f.S=Date.now()+f.I,Ye(f,f.I)}function Ye(f,x){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Ai(_(f.ba,f),x)}function Pt(f){f.B&&(l.clearTimeout(f.B),f.B=null)}ge.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(G(this.i,this.A),this.L!=2&&(as(),Tr(17)),zt(this),this.s=2,Ct(this)):Ye(this,this.S-f)};function Ct(f){f.j.G==0||f.J||nc(f.j,f)}function zt(f){Pt(f);var x=f.M;x&&typeof x.ma=="function"&&x.ma(),f.M=null,zr(f.U),f.g&&(x=f.g,f.g=null,x.abort(),x.ma())}function Bn(f,x){try{var I=f.j;if(I.G!=0&&(I.g==f||rt(I.h,f))){if(!f.K&&rt(I.h,f)&&I.G==3){try{var B=I.Da.g.parse(x)}catch{B=null}if(Array.isArray(B)&&B.length==3){var ie=B;if(ie[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<f.F)Po(I),Io(I);else break e;Co(I),Tr(18)}}else I.za=ie[1],0<I.za-I.T&&37500>ie[2]&&I.F&&I.v==0&&!I.C&&(I.C=Ai(_(I.Za,I),6e3));if(1>=ni(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else hs(I,11)}else if((f.K||I.g==f)&&Po(I),!C(x))for(ie=I.Da.g.parse(x),x=0;x<ie.length;x++){let vt=ie[x];if(I.T=vt[0],vt=vt[1],I.G==2)if(vt[0]=="c"){I.K=vt[1],I.ia=vt[2];const bt=vt[3];bt!=null&&(I.la=bt,I.j.info("VER="+I.la));const Qt=vt[4];Qt!=null&&(I.Aa=Qt,I.j.info("SVER="+I.Aa));const Hs=vt[5];Hs!=null&&typeof Hs=="number"&&0<Hs&&(B=1.5*Hs,I.L=B,I.j.info("backChannelRequestTimeoutMs_="+B)),B=I;const cr=f.g;if(cr){const Oo=cr.g?cr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Oo){var pe=B.h;pe.g||Oo.indexOf("spdy")==-1&&Oo.indexOf("quic")==-1&&Oo.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(Bt(pe,pe.h),pe.h=null))}if(B.D){const Wi=cr.g?cr.g.getResponseHeader("X-HTTP-Session-Id"):null;Wi&&(B.ya=Wi,nt(B.I,B.D,Wi))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-f.F,I.j.info("Handshake RTT: "+I.R+"ms")),B=I;var Le=f;if(B.qa=No(B,B.J?B.ia:null,B.W),Le.K){Pa(B.h,Le);var Nt=Le,mr=B.L;mr&&(Nt.I=mr),Nt.B&&(Pt(Nt),be(Nt)),B.g=Le}else Ci(B);0<I.i.length&&js(I)}else vt[0]!="stop"&&vt[0]!="close"||hs(I,7);else I.G==3&&(vt[0]=="stop"||vt[0]=="close"?vt[0]=="stop"?hs(I,7):So(I):vt[0]!="noop"&&I.l&&I.l.ta(vt),I.v=0)}}as(4)}catch{}}var Un=class{constructor(f,x){this.g=f,this.map=x}};function wi(f){this.l=f||10,l.PerformanceNavigationTiming?(f=l.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Vn(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function ni(f){return f.h?1:f.g?f.g.size:0}function rt(f,x){return f.h?f.h==x:f.g?f.g.has(x):!1}function Bt(f,x){f.g?f.g.add(x):f.h=x}function Pa(f,x){f.h&&f.h==x?f.h=null:f.g&&f.g.has(x)&&f.g.delete(x)}wi.prototype.cancel=function(){if(this.i=ls(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function ls(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let x=f.i;for(const I of f.g.values())x=x.concat(I.D);return x}return y(f.i)}function Bs(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(u(f)){for(var x=[],I=f.length,B=0;B<I;B++)x.push(f[B]);return x}x=[],I=0;for(B in f)x[I++]=f[B];return x}function Hl(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(u(f)||typeof f=="string"){var x=[];f=f.length;for(var I=0;I<f;I++)x.push(I);return x}x=[],I=0;for(const B in f)x[I++]=B;return x}}}function ct(f,x){if(f.forEach&&typeof f.forEach=="function")f.forEach(x,void 0);else if(u(f)||typeof f=="string")Array.prototype.forEach.call(f,x,void 0);else for(var I=Hl(f),B=Bs(f),ie=B.length,pe=0;pe<ie;pe++)x.call(void 0,B[pe],I&&I[pe],f)}var $t=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wl(f,x){if(f){f=f.split("&");for(var I=0;I<f.length;I++){var B=f[I].indexOf("="),ie=null;if(0<=B){var pe=f[I].substring(0,B);ie=f[I].substring(B+1)}else pe=f[I];x(pe,ie?decodeURIComponent(ie.replace(/\+/g," ")):"")}}}function ii(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof ii){this.h=f.h,yo(this,f.j),this.o=f.o,this.g=f.g,cs(this,f.s),this.l=f.l;var x=f.i,I=new us;I.i=x.i,x.g&&(I.g=new Map(x.g),I.h=x.h),ji(this,I),this.m=f.m}else f&&(x=String(f).match($t))?(this.h=!1,yo(this,x[1]||"",!0),this.o=Si(x[2]||""),this.g=Si(x[3]||"",!0),cs(this,x[4]),this.l=Si(x[5]||"",!0),ji(this,x[6]||"",!0),this.m=Si(x[7]||"")):(this.h=!1,this.i=new us(null,this.h))}ii.prototype.toString=function(){var f=[],x=this.j;x&&f.push(Ii(x,Us,!0),":");var I=this.g;return(I||x=="file")&&(f.push("//"),(x=this.o)&&f.push(Ii(x,Us,!0),"@"),f.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&f.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&f.push("/"),f.push(Ii(I,I.charAt(0)=="/"?Zl:$l,!0))),(I=this.i.toString())&&f.push("?",I),(I=this.m)&&f.push("#",Ii(I,Kl)),f.join("")};function ir(f){return new ii(f)}function yo(f,x,I){f.j=I?Si(x,!0):x,f.j&&(f.j=f.j.replace(/:$/,""))}function cs(f,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);f.s=x}else f.s=null}function ji(f,x,I){x instanceof us?(f.i=x,ai(f.i,f.h)):(I||(x=Ii(x,Eo)),f.i=new us(x,f.h))}function nt(f,x,I){f.i.set(x,I)}function si(f){return nt(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Si(f,x){return f?x?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Ii(f,x,I){return typeof f=="string"?(f=encodeURI(f).replace(x,Gl),I&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Gl(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Us=/[#\/\?@]/g,$l=/[#\?:]/g,Zl=/[#\?]/g,Eo=/[#\?@]/g,Kl=/#/g;function us(f,x){this.h=this.g=null,this.i=f||null,this.j=!!x}function zn(f){f.g||(f.g=new Map,f.h=0,f.i&&Wl(f.i,function(x,I){f.add(decodeURIComponent(x.replace(/\+/g," ")),I)}))}e=us.prototype,e.add=function(f,x){zn(this),this.i=null,f=Xe(this,f);var I=this.g.get(f);return I||this.g.set(f,I=[]),I.push(x),this.h+=1,this};function Xl(f,x){zn(f),x=Xe(f,x),f.g.has(x)&&(f.i=null,f.h-=f.g.get(x).length,f.g.delete(x))}function To(f,x){return zn(f),x=Xe(f,x),f.g.has(x)}e.forEach=function(f,x){zn(this),this.g.forEach(function(I,B){I.forEach(function(ie){f.call(x,ie,B,this)},this)},this)},e.na=function(){zn(this);const f=Array.from(this.g.values()),x=Array.from(this.g.keys()),I=[];for(let B=0;B<x.length;B++){const ie=f[B];for(let pe=0;pe<ie.length;pe++)I.push(x[B])}return I},e.V=function(f){zn(this);let x=[];if(typeof f=="string")To(this,f)&&(x=x.concat(this.g.get(Xe(this,f))));else{f=Array.from(this.g.values());for(let I=0;I<f.length;I++)x=x.concat(f[I])}return x},e.set=function(f,x){return zn(this),this.i=null,f=Xe(this,f),To(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[x]),this.h+=1,this},e.get=function(f,x){return f?(f=this.V(f),0<f.length?String(f[0]):x):x};function rf(f,x,I){Xl(f,x),0<I.length&&(f.i=null,f.g.set(Xe(f,x),y(I)),f.h+=I.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],x=Array.from(this.g.keys());for(var I=0;I<x.length;I++){var B=x[I];const pe=encodeURIComponent(String(B)),Le=this.V(B);for(B=0;B<Le.length;B++){var ie=pe;Le[B]!==""&&(ie+="="+encodeURIComponent(String(Le[B]))),f.push(ie)}}return this.i=f.join("&")};function Xe(f,x){return x=String(x),f.j&&(x=x.toLowerCase()),x}function ai(f,x){x&&!f.j&&(zn(f),f.i=null,f.g.forEach(function(I,B){var ie=B.toLowerCase();B!=ie&&(Xl(this,B),rf(this,ie,I))},f)),f.j=x}function Ft(f,x){const I=new os;if(l.Image){const B=new Image;B.onload=v(oi,I,"TestLoadImage: loaded",!0,x,B),B.onerror=v(oi,I,"TestLoadImage: error",!1,x,B),B.onabort=v(oi,I,"TestLoadImage: abort",!1,x,B),B.ontimeout=v(oi,I,"TestLoadImage: timeout",!1,x,B),l.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=f}else x(!1)}function nf(f,x){const I=new os,B=new AbortController,ie=setTimeout(()=>{B.abort(),oi(I,"TestPingServer: timeout",!1,x)},1e4);fetch(f,{signal:B.signal}).then(pe=>{clearTimeout(ie),pe.ok?oi(I,"TestPingServer: ok",!0,x):oi(I,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(ie),oi(I,"TestPingServer: error",!1,x)})}function oi(f,x,I,B,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),B(I)}catch{}}function ql(){this.g=new Vt}function Yl(f,x,I){const B=I||"";try{ct(f,function(ie,pe){let Le=ie;h(ie)&&(Le=ti(ie)),x.push(B+pe+"="+encodeURIComponent(Le))})}catch(ie){throw x.push(B+"type="+encodeURIComponent("_badmap")),ie}}function li(f){this.l=f.Ub||null,this.j=f.eb||!1}E(li,pr),li.prototype.g=function(){return new Vs(this.l,this.j)},li.prototype.i=function(f){return function(){return f}}({});function Vs(f,x){St.call(this),this.D=f,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Vs,St),e=Vs.prototype,e.open=function(f,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=x,this.readyState=1,jn(this)},e.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(x.body=f),(this.D||l).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Jt(this)),this.readyState=0},e.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,jn(this)),this.g&&(this.readyState=3,jn(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;zs(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function zs(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}e.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var x=f.value?f.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!f.done}))&&(this.response=this.responseText+=x)}f.done?Jt(this):jn(this),this.readyState==3&&zs(this)}},e.Ra=function(f){this.g&&(this.response=this.responseText=f,Jt(this))},e.Qa=function(f){this.g&&(this.response=f,Jt(this))},e.ga=function(){this.g&&Jt(this)};function Jt(f){f.readyState=4,f.l=null,f.j=null,f.v=null,jn(f)}e.setRequestHeader=function(f,x){this.u.append(f,x)},e.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],x=this.h.entries();for(var I=x.next();!I.done;)I=I.value,f.push(I[0]+": "+I[1]),I=x.next();return f.join(`\r
`)};function jn(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Vs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Jl(f){let x="";return K(f,function(I,B){x+=B,x+=":",x+=I,x+=`\r
`}),x}function Ao(f,x,I){e:{for(B in I){var B=!1;break e}B=!0}B||(I=Jl(I),typeof f=="string"?I!=null&&encodeURIComponent(String(I)):nt(f,x,I))}function Zt(f){St.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Zt,St);var sf=/^https?$/i,Ql=["POST","PUT"];e=Zt.prototype,e.Ha=function(f){this.J=f},e.ea=function(f,x,I,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);x=x?x.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():X.g(),this.v=this.o?lr(this.o):lr(X),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(x,String(f),!0),this.B=!1}catch(pe){af(this,pe);return}if(f=I||"",I=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var ie in B)I.set(ie,B[ie]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const pe of B.keys())I.set(pe,B.get(pe));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(I.keys()).find(pe=>pe.toLowerCase()=="content-type"),ie=l.FormData&&f instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Ql,x,void 0))||B||ie||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,Le]of I)this.g.setRequestHeader(pe,Le);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Rn(this),this.u=!0,this.g.send(f),this.u=!1}catch(pe){af(this,pe)}};function af(f,x){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=x,f.m=5,ec(f),wo(f)}function ec(f){f.A||(f.A=!0,Mt(f,"complete"),Mt(f,"error"))}e.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Mt(this,"complete"),Mt(this,"abort"),wo(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),wo(this,!0)),Zt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?ht(this):this.bb())},e.bb=function(){ht(this)};function ht(f){if(f.h&&typeof o<"u"&&(!f.v[1]||gn(f)!=4||f.Z()!=2)){if(f.u&&gn(f)==4)Nr(f.Ea,0,f);else if(Mt(f,"readystatechange"),gn(f)==4){f.h=!1;try{const Le=f.Z();e:switch(Le){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var I;if(!(I=x)){var B;if(B=Le===0){var ie=String(f.D).match($t)[1]||null;!ie&&l.self&&l.self.location&&(ie=l.self.location.protocol.slice(0,-1)),B=!sf.test(ie?ie.toLowerCase():"")}I=B}if(I)Mt(f,"complete"),Mt(f,"success");else{f.m=6;try{var pe=2<gn(f)?f.g.statusText:""}catch{pe=""}f.l=pe+" ["+f.Z()+"]",ec(f)}}finally{wo(f)}}}}function wo(f,x){if(f.g){Rn(f);const I=f.g,B=f.v[0]?()=>{}:null;f.g=null,f.v=null,x||Mt(f,"ready");try{I.onreadystatechange=B}catch{}}}function Rn(f){f.I&&(l.clearTimeout(f.I),f.I=null)}e.isActive=function(){return!!this.g};function gn(f){return f.g?f.g.readyState:0}e.Z=function(){try{return 2<gn(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(f){if(this.g){var x=this.g.responseText;return f&&x.indexOf(f)==0&&(x=x.substring(f.length)),Ke(x)}};function tc(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function td(f){const x={};f=(f.g&&2<=gn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<f.length;B++){if(C(f[B]))continue;var I=F(f[B]);const ie=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const pe=x[ie]||[];x[ie]=pe,pe.push(I)}S(x,function(B){return B.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function fs(f,x,I){return I&&I.internalChannelParams&&I.internalChannelParams[f]||x}function of(f){this.Aa=0,this.i=[],this.j=new os,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=fs("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=fs("baseRetryDelayMs",5e3,f),this.cb=fs("retryDelaySeedMs",1e4,f),this.Wa=fs("forwardChannelMaxRetries",2,f),this.wa=fs("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new wi(f&&f.concurrentRequestLimit),this.Da=new ql,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=of.prototype,e.la=8,e.G=1,e.connect=function(f,x,I,B){Tr(0),this.W=f,this.H=x||{},I&&B!==void 0&&(this.H.OSID=I,this.H.OAID=B),this.F=this.X,this.I=No(this,null,this.W),js(this)};function So(f){if(lf(f),f.G==3){var x=f.U++,I=ir(f.I);if(nt(I,"SID",f.K),nt(I,"RID",x),nt(I,"TYPE","terminate"),Na(f,I),x=new ge(f,f.j,x),x.L=2,x.v=si(ir(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(x.v.toString(),"")}catch{}!I&&l.Image&&(new Image().src=x.v,I=!0),I||(x.g=uf(x.j,null),x.g.ea(x.v)),x.F=Date.now(),be(x)}cf(f)}function Io(f){f.g&&(ko(f),f.g.cancel(),f.g=null)}function lf(f){Io(f),f.u&&(l.clearTimeout(f.u),f.u=null),Po(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&l.clearTimeout(f.s),f.s=null)}function js(f){if(!Vn(f.h)&&!f.s){f.s=!0;var x=f.Ga;ke||de(),fe||(ke(),fe=!0),te.add(x,f),f.B=0}}function rd(f,x){return ni(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=x.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Ai(_(f.Ga,f,x),ic(f,f.B)),f.B++,!0)}e.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const ie=new ge(this,this.j,f);let pe=this.o;if(this.S&&(pe?(pe=R(pe),D(pe,this.S)):pe=this.S),this.m!==null||this.O||(ie.H=pe,pe=null),this.P)e:{for(var x=0,I=0;I<this.i.length;I++){t:{var B=this.i[I];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(x+=B,4096<x){x=I;break e}if(x===4096||I===this.i.length-1){x=I+1;break e}}x=1e3}else x=1e3;x=rc(this,ie,x),I=ir(this.I),nt(I,"RID",f),nt(I,"CVER",22),this.D&&nt(I,"X-HTTP-Session-Id",this.D),Na(this,I),pe&&(this.O?x="headers="+encodeURIComponent(String(Jl(pe)))+"&"+x:this.m&&Ao(I,this.m,pe)),Bt(this.h,ie),this.Ua&&nt(I,"TYPE","init"),this.P?(nt(I,"$req",x),nt(I,"SID","null"),ie.T=!0,Te(ie,I,null)):Te(ie,I,x),this.G=2}}else this.G==3&&(f?Hn(this,f):this.i.length==0||Vn(this.h)||Hn(this))};function Hn(f,x){var I;x?I=x.l:I=f.U++;const B=ir(f.I);nt(B,"SID",f.K),nt(B,"RID",I),nt(B,"AID",f.T),Na(f,B),f.m&&f.o&&Ao(B,f.m,f.o),I=new ge(f,f.j,I,f.B+1),f.m===null&&(I.H=f.o),x&&(f.i=x.D.concat(f.i)),x=rc(f,I,1e3),I.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Bt(f.h,I),Te(I,B,x)}function Na(f,x){f.H&&K(f.H,function(I,B){nt(x,B,I)}),f.l&&ct({},function(I,B){nt(x,B,I)})}function rc(f,x,I){I=Math.min(f.i.length,I);var B=f.l?_(f.l.Na,f.l,f):null;e:{var ie=f.i;let pe=-1;for(;;){const Le=["count="+I];pe==-1?0<I?(pe=ie[0].g,Le.push("ofs="+pe)):pe=0:Le.push("ofs="+pe);let Nt=!0;for(let mr=0;mr<I;mr++){let vt=ie[mr].g;const bt=ie[mr].map;if(vt-=pe,0>vt)pe=Math.max(0,ie[mr].g-100),Nt=!1;else try{Yl(bt,Le,"req"+vt+"_")}catch{B&&B(bt)}}if(Nt){B=Le.join("&");break e}}}return f=f.i.splice(0,I),x.D=f,B}function Ci(f){if(!f.g&&!f.u){f.Y=1;var x=f.Fa;ke||de(),fe||(ke(),fe=!0),te.add(x,f),f.v=0}}function Co(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Ai(_(f.Fa,f),ic(f,f.v)),f.v++,!0)}e.Fa=function(){if(this.u=null,Ro(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Ai(_(this.ab,this),f)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Tr(10),Io(this),Ro(this))};function ko(f){f.A!=null&&(l.clearTimeout(f.A),f.A=null)}function Ro(f){f.g=new ge(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var x=ir(f.qa);nt(x,"RID","rpc"),nt(x,"SID",f.K),nt(x,"AID",f.T),nt(x,"CI",f.F?"0":"1"),!f.F&&f.ja&&nt(x,"TO",f.ja),nt(x,"TYPE","xmlhttp"),Na(f,x),f.m&&f.o&&Ao(x,f.m,f.o),f.L&&(f.g.I=f.L);var I=f.g;f=f.ia,I.L=1,I.v=si(ir(x)),I.m=null,I.P=!0,Oe(I,f)}e.Za=function(){this.C!=null&&(this.C=null,Io(this),Co(this),Tr(19))};function Po(f){f.C!=null&&(l.clearTimeout(f.C),f.C=null)}function nc(f,x){var I=null;if(f.g==x){Po(f),ko(f),f.g=null;var B=2}else if(rt(f.h,x))I=x.D,Pa(f.h,x),B=1;else return;if(f.G!=0){if(x.o)if(B==1){I=x.m?x.m.length:0,x=Date.now()-x.F;var ie=f.B;B=zi(),Mt(B,new xo(B,I)),js(f)}else Ci(f);else if(ie=x.s,ie==3||ie==0&&0<x.X||!(B==1&&rd(f,x)||B==2&&Co(f)))switch(I&&0<I.length&&(x=f.h,x.i=x.i.concat(I)),ie){case 1:hs(f,5);break;case 4:hs(f,10);break;case 3:hs(f,6);break;default:hs(f,2)}}}function ic(f,x){let I=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(I*=2),I*x}function hs(f,x){if(f.j.info("Error code "+x),x==2){var I=_(f.fb,f),B=f.Xa;const ie=!B;B=new ii(B||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||yo(B,"https"),si(B),ie?Ft(B.toString(),I):nf(B.toString(),I)}else Tr(2);f.G=0,f.l&&f.l.sa(x),cf(f),lf(f)}e.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Tr(2)):(this.j.info("Failed to ping google.com"),Tr(1))};function cf(f){if(f.G=0,f.ka=[],f.l){const x=ls(f.h);(x.length!=0||f.i.length!=0)&&(w(f.ka,x),w(f.ka,f.i),f.h.i.length=0,y(f.i),f.i.length=0),f.l.ra()}}function No(f,x,I){var B=I instanceof ii?ir(I):new ii(I);if(B.g!="")x&&(B.g=x+"."+B.g),cs(B,B.s);else{var ie=l.location;B=ie.protocol,x=x?x+"."+ie.hostname:ie.hostname,ie=+ie.port;var pe=new ii(null);B&&yo(pe,B),x&&(pe.g=x),ie&&cs(pe,ie),I&&(pe.l=I),B=pe}return I=f.D,x=f.ya,I&&x&&nt(B,I,x),nt(B,"VER",f.la),Na(f,B),B}function uf(f,x,I){if(x&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=f.Ca&&!f.pa?new Zt(new li({eb:I})):new Zt(f.pa),x.Ha(f.J),x}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function sc(){}e=sc.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function Oa(){}Oa.prototype.g=function(f,x){return new Lr(f,x)};function Lr(f,x){St.call(this),this.g=new of(x),this.l=f,this.h=x&&x.messageUrlParams||null,f=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(f?f["X-WebChannel-Content-Type"]=x.messageContentType:f={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(f?f["X-WebChannel-Client-Profile"]=x.va:f={"X-WebChannel-Client-Profile":x.va}),this.g.S=f,(f=x&&x.Sb)&&!C(f)&&(this.g.m=f),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!C(x)&&(this.g.D=x,f=this.h,f!==null&&x in f&&(f=this.h,x in f&&delete f[x])),this.j=new ci(this)}E(Lr,St),Lr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Lr.prototype.close=function(){So(this.g)},Lr.prototype.o=function(f){var x=this.g;if(typeof f=="string"){var I={};I.__data__=f,f=I}else this.u&&(I={},I.__data__=ti(f),f=I);x.i.push(new Un(x.Ya++,f)),x.G==3&&js(x)},Lr.prototype.N=function(){this.g.l=null,delete this.j,So(this.g),delete this.g,Lr.aa.N.call(this)};function Hi(f){Or.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var x=f.__sm__;if(x){e:{for(const I in x){f=I;break e}f=void 0}(this.i=f)&&(f=this.i,x=x!==null&&f in x?x[f]:void 0),this.data=x}else this.data=f}E(Hi,Or);function ff(){Jr.call(this),this.status=1}E(ff,Jr);function ci(f){this.g=f}E(ci,sc),ci.prototype.ua=function(){Mt(this.g,"a")},ci.prototype.ta=function(f){Mt(this.g,new Hi(f))},ci.prototype.sa=function(f){Mt(this.g,new ff)},ci.prototype.ra=function(){Mt(this.g,"b")},Oa.prototype.createWebChannel=Oa.prototype.g,Lr.prototype.send=Lr.prototype.o,Lr.prototype.open=Lr.prototype.m,Lr.prototype.close=Lr.prototype.close,iw=function(){return new Oa},nw=function(){return zi()},rw=Qr,xm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},z.NO_ERROR=0,z.TIMEOUT=8,z.HTTP_ERROR=6,hh=z,Z.COMPLETE="complete",tw=Z,Cn.EventType=mn,mn.OPEN="a",mn.CLOSE="b",mn.ERROR="c",mn.MESSAGE="d",St.prototype.listen=St.prototype.K,kc=Cn,Zt.prototype.listenOnce=Zt.prototype.L,Zt.prototype.getLastError=Zt.prototype.Ka,Zt.prototype.getLastErrorCode=Zt.prototype.Ba,Zt.prototype.getStatus=Zt.prototype.Z,Zt.prototype.getResponseJson=Zt.prototype.Oa,Zt.prototype.getResponseText=Zt.prototype.oa,Zt.prototype.send=Zt.prototype.ea,Zt.prototype.setWithCredentials=Zt.prototype.Ha,ew=Zt}).apply(typeof Xf<"u"?Xf:typeof self<"u"?self:typeof window<"u"?window:{});const Bx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}sn.UNAUTHENTICATED=new sn(null),sn.GOOGLE_CREDENTIALS=new sn("google-credentials-uid"),sn.FIRST_PARTY=new sn("first-party-uid"),sn.MOCK_USER=new sn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no=new ZA("@firebase/firestore");function vc(){return no.logLevel}function He(e,...t){if(no.logLevel<=Tt.DEBUG){const r=t.map(o_);no.debug(`Firestore (${Vl}): ${e}`,...r)}}function Ls(e,...t){if(no.logLevel<=Tt.ERROR){const r=t.map(o_);no.error(`Firestore (${Vl}): ${e}`,...r)}}function Sl(e,...t){if(no.logLevel<=Tt.WARN){const r=t.map(o_);no.warn(`Firestore (${Vl}): ${e}`,...r)}}function o_(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(e="Unexpected state"){const t=`FIRESTORE (${Vl}) INTERNAL ASSERTION FAILED: `+e;throw Ls(t),new Error(t)}function Lt(e,t){e||it()}function lt(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ge extends Ul{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class vM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(sn.UNAUTHENTICATED))}shutdown(){}}class xM{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class yM{constructor(t){this.t=t,this.currentUser=sn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){Lt(this.o===void 0);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let s=new Ss;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ss,t.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=s;t.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{He("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(He("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ss)}},0),o()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(He("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Lt(typeof n.accessToken=="string"),new sw(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Lt(t===null||typeof t=="string"),new sn(t)}}class EM{constructor(t,r,n){this.l=t,this.h=r,this.P=n,this.type="FirstParty",this.user=sn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class TM{constructor(t,r,n){this.l=t,this.h=r,this.P=n}getToken(){return Promise.resolve(new EM(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(sn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AM{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wM{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){Lt(this.o===void 0);const n=s=>{s.error!=null&&He("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,He("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>n(s))};const i=s=>{He("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):He("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(Lt(typeof r.token=="string"),this.R=r.token,new AM(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SM(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=SM(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=t.charAt(i[s]%t.length))}return n}}function It(e,t){return e<t?-1:e>t?1:0}function Il(e,t,r){return e.length===t.length&&e.every((n,i)=>r(n,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Ge(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ge(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new Ge(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ge(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Pr.fromMillis(Date.now())}static fromDate(t){return Pr.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*r));return new Pr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?It(this.nanoseconds,t.nanoseconds):It(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(t){this.timestamp=t}static fromTimestamp(t){return new ot(t)}static min(){return new ot(new Pr(0,0))}static max(){return new ot(new Pr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(t,r,n){r===void 0?r=0:r>t.length&&it(),n===void 0?n=t.length-r:n>t.length-r&&it(),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return Nu.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof Nu?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let i=0;i<n;i++){const s=t.get(i),o=r.get(i);if(s<o)return-1;if(s>o)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class Yt extends Nu{construct(t,r,n){return new Yt(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new Ge(xe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Yt(r)}static emptyPath(){return new Yt([])}}const IM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gr extends Nu{construct(t,r,n){return new Gr(t,r,n)}static isValidIdentifier(t){return IM.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gr.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Gr(["__name__"])}static fromServerFormat(t){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Ge(xe.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;i<t.length;){const l=t[i];if(l==="\\"){if(i+1===t.length)throw new Ge(xe.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Ge(xe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(n+=l,i++):(s(),i++)}if(s(),o)throw new Ge(xe.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Gr(r)}static emptyPath(){return new Gr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(t){this.path=t}static fromPath(t){return new $e(Yt.fromString(t))}static fromName(t){return new $e(Yt.fromString(t).popFirst(5))}static empty(){return new $e(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Yt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return Yt.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new $e(new Yt(t.slice()))}}function CM(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,i=ot.fromTimestamp(n===1e9?new Pr(r+1,0):new Pr(r,n));return new Ea(i,$e.empty(),t)}function kM(e){return new Ea(e.readTime,e.key,-1)}class Ea{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new Ea(ot.min(),$e.empty(),-1)}static max(){return new Ea(ot.max(),$e.empty(),-1)}}function RM(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=$e.comparator(e.documentKey,t.documentKey),r!==0?r:It(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xu(e){if(e.code!==xe.FAILED_PRECONDITION||e.message!==PM)throw e;He("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&it(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new Ae((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof Ae?r:Ae.resolve(r)}catch(r){return Ae.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):Ae.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):Ae.reject(r)}static resolve(t){return new Ae((r,n)=>{r(t)})}static reject(t){return new Ae((r,n)=>{n(t)})}static waitFor(t){return new Ae((r,n)=>{let i=0,s=0,o=!1;t.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&r()},u=>n(u))}),o=!0,s===i&&r()})}static or(t){let r=Ae.resolve(!1);for(const n of t)r=r.next(i=>i?Ae.resolve(i):n());return r}static forEach(t,r){const n=[];return t.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(t,r){return new Ae((n,i)=>{const s=t.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;r(t[h]).next(p=>{o[h]=p,++l,l===s&&n(o)},p=>i(p))}})}static doWhile(t,r){return new Ae((n,i)=>{const s=()=>{t()===!0?r().next(()=>{s()},i):n()};s()})}}function OM(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function qu(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}l_.oe=-1;function U0(e){return e==null}function n0(e){return e===0&&1/e==-1/0}function LM(e){return typeof e=="number"&&Number.isInteger(e)&&!n0(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function go(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function ow(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(t,r){this.comparator=t,this.root=r||Hr.EMPTY}insert(t,r){return new nr(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,Hr.BLACK,null,null))}remove(t){return new nr(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Hr.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new qf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new qf(this.root,t,this.comparator,!1)}getReverseIterator(){return new qf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new qf(this.root,t,this.comparator,!0)}}class qf{constructor(t,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=r?n(t.key,r):1,r&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Hr{constructor(t,r,n,i,s){this.key=t,this.value=r,this.color=n??Hr.RED,this.left=i??Hr.EMPTY,this.right=s??Hr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,i,s){return new Hr(t??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(t,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Hr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,i=this;if(r(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(t,i.key)===0){if(i.right.isEmpty())return Hr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Hr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Hr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw it();const t=this.left.check();if(t!==this.right.check())throw it();return t+(this.isRed()?0:1)}}Hr.EMPTY=null,Hr.RED=!0,Hr.BLACK=!1;Hr.EMPTY=new class{constructor(){this.size=0}get key(){throw it()}get value(){throw it()}get color(){throw it()}get left(){throw it()}get right(){throw it()}copy(t,r,n,i,s){return this}insert(t,r,n){return new Hr(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(t){this.comparator=t,this.data=new nr(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;r(i.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new Vx(this.data.getIterator())}getIteratorFrom(t){return new Vx(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof Xr)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new Xr(this.comparator);return r.data=t,r}}class Vx{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(t){this.fields=t,t.sort(Gr.comparator)}static empty(){return new Kn([])}unionWith(t){let r=new Xr(Gr.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new Kn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return Il(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new lw("Invalid base64 string: "+s):s}}(t);return new Yr(r)}static fromUint8Array(t){const r=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(t);return new Yr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return It(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Yr.EMPTY_BYTE_STRING=new Yr("");const DM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ta(e){if(Lt(!!e),typeof e=="string"){let t=0;const r=DM.exec(e);if(Lt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),t=Number(i)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:fr(e.seconds),nanos:fr(e.nanos)}}function fr(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function io(e){return typeof e=="string"?Yr.fromBase64String(e):Yr.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c_(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function u_(e){const t=e.mapValue.fields.__previous_value__;return c_(t)?u_(t):t}function Ou(e){const t=Ta(e.mapValue.fields.__local_write_time__.timestampValue);return new Pr(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(t,r,n,i,s,o,l,u,h){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Lu{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new Lu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Lu&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf={mapValue:{}};function so(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?c_(e)?4:MM(e)?9007199254740991:bM(e)?10:11:it()}function rs(e,t){if(e===t)return!0;const r=so(e);if(r!==so(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ou(e).isEqual(Ou(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Ta(i.timestampValue),l=Ta(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return io(i.bytesValue).isEqual(io(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return fr(i.geoPointValue.latitude)===fr(s.geoPointValue.latitude)&&fr(i.geoPointValue.longitude)===fr(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return fr(i.integerValue)===fr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=fr(i.doubleValue),l=fr(s.doubleValue);return o===l?n0(o)===n0(l):isNaN(o)&&isNaN(l)}return!1}(e,t);case 9:return Il(e.arrayValue.values||[],t.arrayValue.values||[],rs);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(Ux(o)!==Ux(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!rs(o[u],l[u])))return!1;return!0}(e,t);default:return it()}}function Du(e,t){return(e.values||[]).find(r=>rs(r,t))!==void 0}function Cl(e,t){if(e===t)return 0;const r=so(e),n=so(t);if(r!==n)return It(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return It(e.booleanValue,t.booleanValue);case 2:return function(s,o){const l=fr(s.integerValue||s.doubleValue),u=fr(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(e,t);case 3:return zx(e.timestampValue,t.timestampValue);case 4:return zx(Ou(e),Ou(t));case 5:return It(e.stringValue,t.stringValue);case 6:return function(s,o){const l=io(s),u=io(o);return l.compareTo(u)}(e.bytesValue,t.bytesValue);case 7:return function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=It(l[h],u[h]);if(p!==0)return p}return It(l.length,u.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,o){const l=It(fr(s.latitude),fr(o.latitude));return l!==0?l:It(fr(s.longitude),fr(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return jx(e.arrayValue,t.arrayValue);case 10:return function(s,o){var l,u,h,p;const m=s.fields||{},_=o.fields||{},v=(l=m.value)===null||l===void 0?void 0:l.arrayValue,E=(u=_.value)===null||u===void 0?void 0:u.arrayValue,y=It(((h=v==null?void 0:v.values)===null||h===void 0?void 0:h.length)||0,((p=E==null?void 0:E.values)===null||p===void 0?void 0:p.length)||0);return y!==0?y:jx(v,E)}(e.mapValue,t.mapValue);case 11:return function(s,o){if(s===Yf.mapValue&&o===Yf.mapValue)return 0;if(s===Yf.mapValue)return 1;if(o===Yf.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let m=0;m<u.length&&m<p.length;++m){const _=It(u[m],p[m]);if(_!==0)return _;const v=Cl(l[u[m]],h[p[m]]);if(v!==0)return v}return It(u.length,p.length)}(e.mapValue,t.mapValue);default:throw it()}}function zx(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return It(e,t);const r=Ta(e),n=Ta(t),i=It(r.seconds,n.seconds);return i!==0?i:It(r.nanos,n.nanos)}function jx(e,t){const r=e.values||[],n=t.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=Cl(r[i],n[i]);if(s)return s}return It(r.length,n.length)}function kl(e){return ym(e)}function ym(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=Ta(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return io(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return $e.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=ym(s);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const o of n)s?s=!1:i+=",",i+=`${o}:${ym(r.fields[o])}`;return i+"}"}(e.mapValue):it()}function Em(e){return!!e&&"integerValue"in e}function f_(e){return!!e&&"arrayValue"in e}function Hx(e){return!!e&&"nullValue"in e}function Wx(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function dh(e){return!!e&&"mapValue"in e}function bM(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function qc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return go(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=qc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=qc(e.arrayValue.values[r]);return t}return Object.assign({},e)}function MM(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(t){this.value=t}static empty(){return new Ln({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!dh(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=qc(r)}setAll(t){let r=Gr.emptyPath(),n={},i=[];t.forEach((o,l)=>{if(!r.isImmediateParentOf(l)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=l.popLast()}o?n[l.lastSegment()]=qc(o):i.push(l.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(t){const r=this.field(t.popLast());dh(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return rs(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=r.mapValue.fields[t.get(n)];dh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(t,r,n){go(r,(i,s)=>t[i]=s);for(const i of n)delete t[i]}clone(){return new Ln(qc(this.value))}}function cw(e){const t=[];return go(e.fields,(r,n)=>{const i=new Gr([r]);if(dh(n)){const s=cw(n.mapValue).fields;if(s.length===0)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)}),new Kn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(t,r,n,i,s,o,l){this.key=t,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(t){return new ln(t,0,ot.min(),ot.min(),ot.min(),Ln.empty(),0)}static newFoundDocument(t,r,n,i){return new ln(t,1,r,ot.min(),n,i,0)}static newNoDocument(t,r){return new ln(t,2,r,ot.min(),ot.min(),Ln.empty(),0)}static newUnknownDocument(t,r){return new ln(t,3,r,ot.min(),ot.min(),Ln.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ln.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ln.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ot.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof ln&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(t,r){this.position=t,this.inclusive=r}}function Gx(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(s.field.isKeyField()?n=$e.comparator($e.fromName(o.referenceValue),r.key):n=Cl(o,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function $x(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!rs(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(t,r="asc"){this.field=t,this.dir=r}}function BM(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{}class Sr extends uw{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new VM(t,r,n):r==="array-contains"?new HM(t,n):r==="in"?new WM(t,n):r==="not-in"?new GM(t,n):r==="array-contains-any"?new $M(t,n):new Sr(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new zM(t,n):new jM(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Cl(r,this.value)):r!==null&&so(this.value)===so(r)&&this.matchesComparison(Cl(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return it()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ns extends uw{constructor(t,r){super(),this.filters=t,this.op=r,this.ae=null}static create(t,r){return new ns(t,r)}matches(t){return fw(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fw(e){return e.op==="and"}function hw(e){return UM(e)&&fw(e)}function UM(e){for(const t of e.filters)if(t instanceof ns)return!1;return!0}function Tm(e){if(e instanceof Sr)return e.field.canonicalString()+e.op.toString()+kl(e.value);if(hw(e))return e.filters.map(t=>Tm(t)).join(",");{const t=e.filters.map(r=>Tm(r)).join(",");return`${e.op}(${t})`}}function dw(e,t){return e instanceof Sr?function(n,i){return i instanceof Sr&&n.op===i.op&&n.field.isEqual(i.field)&&rs(n.value,i.value)}(e,t):e instanceof ns?function(n,i){return i instanceof ns&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,o,l)=>s&&dw(o,i.filters[l]),!0):!1}(e,t):void it()}function pw(e){return e instanceof Sr?function(r){return`${r.field.canonicalString()} ${r.op} ${kl(r.value)}`}(e):e instanceof ns?function(r){return r.op.toString()+" {"+r.getFilters().map(pw).join(" ,")+"}"}(e):"Filter"}class VM extends Sr{constructor(t,r,n){super(t,r,n),this.key=$e.fromName(n.referenceValue)}matches(t){const r=$e.comparator(t.key,this.key);return this.matchesComparison(r)}}class zM extends Sr{constructor(t,r){super(t,"in",r),this.keys=mw("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class jM extends Sr{constructor(t,r){super(t,"not-in",r),this.keys=mw("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function mw(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>$e.fromName(n.referenceValue))}class HM extends Sr{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return f_(r)&&Du(r.arrayValue,this.value)}}class WM extends Sr{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&Du(this.value.arrayValue,r)}}class GM extends Sr{constructor(t,r){super(t,"not-in",r)}matches(t){if(Du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!Du(this.value.arrayValue,r)}}class $M extends Sr{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!f_(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Du(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(t,r=null,n=[],i=[],s=null,o=null,l=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function Zx(e,t=null,r=[],n=[],i=null,s=null,o=null){return new ZM(e,t,r,n,i,s,o)}function h_(e){const t=lt(e);if(t.ue===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>Tm(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),U0(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>kl(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>kl(n)).join(",")),t.ue=r}return t.ue}function d_(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!BM(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!dw(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!$x(e.startAt,t.startAt)&&$x(e.endAt,t.endAt)}function Am(e){return $e.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(t,r=null,n=[],i=[],s=null,o="F",l=null,u=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function KM(e,t,r,n,i,s,o,l){return new V0(e,t,r,n,i,s,o,l)}function p_(e){return new V0(e)}function Kx(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function XM(e){return e.collectionGroup!==null}function Yc(e){const t=lt(e);if(t.ce===null){t.ce=[];const r=new Set;for(const s of t.explicitOrderBy)t.ce.push(s),r.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Xr(Gr.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(t).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||t.ce.push(new s0(s,n))}),r.has(Gr.keyField().canonicalString())||t.ce.push(new s0(Gr.keyField(),n))}return t.ce}function Qi(e){const t=lt(e);return t.le||(t.le=qM(t,Yc(e))),t.le}function qM(e,t){if(e.limitType==="F")return Zx(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new s0(i.field,s)});const r=e.endAt?new i0(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new i0(e.startAt.position,e.startAt.inclusive):null;return Zx(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function wm(e,t,r){return new V0(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function z0(e,t){return d_(Qi(e),Qi(t))&&e.limitType===t.limitType}function gw(e){return`${h_(Qi(e))}|lt:${e.limitType}`}function Vo(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>pw(i)).join(", ")}]`),U0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>kl(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>kl(i)).join(",")),`Target(${n})`}(Qi(e))}; limitType=${e.limitType})`}function j0(e,t){return t.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):$e.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(e,t)&&function(n,i){for(const s of Yc(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(n,i){return!(n.startAt&&!function(o,l,u){const h=Gx(o,l,u);return o.inclusive?h<=0:h<0}(n.startAt,Yc(n),i)||n.endAt&&!function(o,l,u){const h=Gx(o,l,u);return o.inclusive?h>=0:h>0}(n.endAt,Yc(n),i))}(e,t)}function YM(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function _w(e){return(t,r)=>{let n=!1;for(const i of Yc(e)){const s=JM(i,t,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function JM(e,t,r){const n=e.field.isKeyField()?$e.comparator(t.key,r.key):function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?Cl(u,h):it()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return it()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,r]);i.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){go(this.inner,(r,n)=>{for(const[i,s]of n)t(i,s)})}isEmpty(){return ow(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QM=new nr($e.comparator);function Ds(){return QM}const vw=new nr($e.comparator);function Rc(...e){let t=vw;for(const r of e)t=t.insert(r.key,r);return t}function xw(e){let t=vw;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function za(){return Jc()}function yw(){return Jc()}function Jc(){return new zl(e=>e.toString(),(e,t)=>e.isEqual(t))}const e5=new nr($e.comparator),t5=new Xr($e.comparator);function gt(...e){let t=t5;for(const r of e)t=t.add(r);return t}const r5=new Xr(It);function n5(){return r5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m_(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:n0(t)?"-0":t}}function Ew(e){return{integerValue:""+e}}function i5(e,t){return LM(t)?Ew(t):m_(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(){this._=void 0}}function s5(e,t,r){return e instanceof a0?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&c_(s)&&(s=u_(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(r,t):e instanceof Fu?Aw(e,t):e instanceof bu?ww(e,t):function(i,s){const o=Tw(i,s),l=Xx(o)+Xx(i.Pe);return Em(o)&&Em(i.Pe)?Ew(l):m_(i.serializer,l)}(e,t)}function a5(e,t,r){return e instanceof Fu?Aw(e,t):e instanceof bu?ww(e,t):r}function Tw(e,t){return e instanceof o0?function(n){return Em(n)||function(s){return!!s&&"doubleValue"in s}(n)}(t)?t:{integerValue:0}:null}class a0 extends H0{}class Fu extends H0{constructor(t){super(),this.elements=t}}function Aw(e,t){const r=Sw(t);for(const n of e.elements)r.some(i=>rs(i,n))||r.push(n);return{arrayValue:{values:r}}}class bu extends H0{constructor(t){super(),this.elements=t}}function ww(e,t){let r=Sw(t);for(const n of e.elements)r=r.filter(i=>!rs(i,n));return{arrayValue:{values:r}}}class o0 extends H0{constructor(t,r){super(),this.serializer=t,this.Pe=r}}function Xx(e){return fr(e.integerValue||e.doubleValue)}function Sw(e){return f_(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function o5(e,t){return e.field.isEqual(t.field)&&function(n,i){return n instanceof Fu&&i instanceof Fu||n instanceof bu&&i instanceof bu?Il(n.elements,i.elements,rs):n instanceof o0&&i instanceof o0?rs(n.Pe,i.Pe):n instanceof a0&&i instanceof a0}(e.transform,t.transform)}class l5{constructor(t,r){this.version=t,this.transformResults=r}}class vi{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new vi}static exists(t){return new vi(void 0,t)}static updateTime(t){return new vi(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ph(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class W0{}function Iw(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new g_(e.key,vi.none()):new Yu(e.key,e.data,vi.none());{const r=e.data,n=Ln.empty();let i=new Xr(Gr.comparator);for(let s of t.fields)if(!i.has(s)){let o=r.field(s);o===null&&s.length>1&&(s=s.popLast(),o=r.field(s)),o===null?n.delete(s):n.set(s,o),i=i.add(s)}return new Ra(e.key,n,new Kn(i.toArray()),vi.none())}}function c5(e,t,r){e instanceof Yu?function(i,s,o){const l=i.value.clone(),u=Yx(i.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(e,t,r):e instanceof Ra?function(i,s,o){if(!ph(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=Yx(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(Cw(i)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(e,t,r):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,r)}function Qc(e,t,r,n){return e instanceof Yu?function(s,o,l,u){if(!ph(s.precondition,o))return l;const h=s.value.clone(),p=Jx(s.fieldTransforms,u,o);return h.setAll(p),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(e,t,r,n):e instanceof Ra?function(s,o,l,u){if(!ph(s.precondition,o))return l;const h=Jx(s.fieldTransforms,u,o),p=o.data;return p.setAll(Cw(s)),p.setAll(h),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(e,t,r,n):function(s,o,l){return ph(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(e,t,r)}function u5(e,t){let r=null;for(const n of e.fieldTransforms){const i=t.data.field(n.field),s=Tw(n.transform,i||null);s!=null&&(r===null&&(r=Ln.empty()),r.set(n.field,s))}return r||null}function qx(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Il(n,i,(s,o)=>o5(s,o))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Yu extends W0{constructor(t,r,n,i=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ra extends W0{constructor(t,r,n,i,s=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Cw(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function Yx(e,t,r){const n=new Map;Lt(e.length===r.length);for(let i=0;i<r.length;i++){const s=e[i],o=s.transform,l=t.data.field(s.field);n.set(s.field,a5(o,l,r[i]))}return n}function Jx(e,t,r){const n=new Map;for(const i of e){const s=i.transform,o=r.data.field(i.field);n.set(i.field,s5(s,o,t))}return n}class g_ extends W0{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class f5 extends W0{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(t,r,n,i){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&c5(s,t,n[i])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=Qc(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=Qc(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=yw();return this.mutations.forEach(i=>{const s=t.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=r.has(i.key)?null:l;const u=Iw(o,l);u!==null&&n.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(ot.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),gt())}isEqual(t){return this.batchId===t.batchId&&Il(this.mutations,t.mutations,(r,n)=>qx(r,n))&&Il(this.baseMutations,t.baseMutations,(r,n)=>qx(r,n))}}class __{constructor(t,r,n,i){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(t,r,n){Lt(t.mutations.length===n.length);let i=function(){return e5}();const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new __(t,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d5{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p5{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vr,xt;function m5(e){switch(e){default:return it();case xe.CANCELLED:case xe.UNKNOWN:case xe.DEADLINE_EXCEEDED:case xe.RESOURCE_EXHAUSTED:case xe.INTERNAL:case xe.UNAVAILABLE:case xe.UNAUTHENTICATED:return!1;case xe.INVALID_ARGUMENT:case xe.NOT_FOUND:case xe.ALREADY_EXISTS:case xe.PERMISSION_DENIED:case xe.FAILED_PRECONDITION:case xe.ABORTED:case xe.OUT_OF_RANGE:case xe.UNIMPLEMENTED:case xe.DATA_LOSS:return!0}}function kw(e){if(e===void 0)return Ls("GRPC error has no .code"),xe.UNKNOWN;switch(e){case vr.OK:return xe.OK;case vr.CANCELLED:return xe.CANCELLED;case vr.UNKNOWN:return xe.UNKNOWN;case vr.DEADLINE_EXCEEDED:return xe.DEADLINE_EXCEEDED;case vr.RESOURCE_EXHAUSTED:return xe.RESOURCE_EXHAUSTED;case vr.INTERNAL:return xe.INTERNAL;case vr.UNAVAILABLE:return xe.UNAVAILABLE;case vr.UNAUTHENTICATED:return xe.UNAUTHENTICATED;case vr.INVALID_ARGUMENT:return xe.INVALID_ARGUMENT;case vr.NOT_FOUND:return xe.NOT_FOUND;case vr.ALREADY_EXISTS:return xe.ALREADY_EXISTS;case vr.PERMISSION_DENIED:return xe.PERMISSION_DENIED;case vr.FAILED_PRECONDITION:return xe.FAILED_PRECONDITION;case vr.ABORTED:return xe.ABORTED;case vr.OUT_OF_RANGE:return xe.OUT_OF_RANGE;case vr.UNIMPLEMENTED:return xe.UNIMPLEMENTED;case vr.DATA_LOSS:return xe.DATA_LOSS;default:return it()}}(xt=vr||(vr={}))[xt.OK=0]="OK",xt[xt.CANCELLED=1]="CANCELLED",xt[xt.UNKNOWN=2]="UNKNOWN",xt[xt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xt[xt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xt[xt.NOT_FOUND=5]="NOT_FOUND",xt[xt.ALREADY_EXISTS=6]="ALREADY_EXISTS",xt[xt.PERMISSION_DENIED=7]="PERMISSION_DENIED",xt[xt.UNAUTHENTICATED=16]="UNAUTHENTICATED",xt[xt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xt[xt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xt[xt.ABORTED=10]="ABORTED",xt[xt.OUT_OF_RANGE=11]="OUT_OF_RANGE",xt[xt.UNIMPLEMENTED=12]="UNIMPLEMENTED",xt[xt.INTERNAL=13]="INTERNAL",xt[xt.UNAVAILABLE=14]="UNAVAILABLE",xt[xt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g5(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _5=new Za([4294967295,4294967295],0);function Qx(e){const t=g5().encode(e),r=new QA;return r.update(t),new Uint8Array(r.digest())}function ey(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Za([r,n],0),new Za([i,s],0)]}class v_{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Pc(`Invalid padding: ${r}`);if(n<0)throw new Pc(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new Pc(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new Pc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*t.length-r,this.Te=Za.fromNumber(this.Ie)}Ee(t,r,n){let i=t.add(r.multiply(Za.fromNumber(n)));return i.compare(_5)===1&&(i=new Za([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const r=Qx(t),[n,i]=ey(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,i,s);if(!this.de(o))return!1}return!0}static create(t,r,n){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new v_(s,i,r);return n.forEach(l=>o.insert(l)),o}insert(t){if(this.Ie===0)return;const r=Qx(t),[n,i]=ey(r);for(let s=0;s<this.hashCount;s++){const o=this.Ee(n,i,s);this.Ae(o)}}Ae(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class Pc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(t,r,n,i,s){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const i=new Map;return i.set(t,Ju.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new G0(ot.min(),i,new nr(It),Ds(),gt())}}class Ju{constructor(t,r,n,i,s){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new Ju(n,r,gt(),gt(),gt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(t,r,n,i){this.Re=t,this.removedTargetIds=r,this.key=n,this.Ve=i}}class Rw{constructor(t,r){this.targetId=t,this.me=r}}class Pw{constructor(t,r,n=Yr.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=i}}class ty{constructor(){this.fe=0,this.ge=ny(),this.pe=Yr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=gt(),r=gt(),n=gt();return this.ge.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:it()}}),new Ju(this.pe,this.ye,t,r,n)}Ce(){this.we=!1,this.ge=ny()}Fe(t,r){this.we=!0,this.ge=this.ge.insert(t,r)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,Lt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class v5{constructor(t){this.Le=t,this.Be=new Map,this.ke=Ds(),this.qe=ry(),this.Qe=new nr(It)}Ke(t){for(const r of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(r,t.Ve):this.Ue(r,t.key,t.Ve);for(const r of t.removedTargetIds)this.Ue(r,t.key,t.Ve)}We(t){this.forEachTarget(t,r=>{const n=this.Ge(r);switch(t.state){case 0:this.ze(r)&&n.De(t.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(t.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(t.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(t.resumeToken));break;default:it()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(t){const r=t.targetId,n=t.me.count,i=this.Je(r);if(i){const s=i.target;if(Am(s))if(n===0){const o=new $e(s.path);this.Ue(r,o,ln.newNoDocument(o,ot.min()))}else Lt(n===1);else{const o=this.Ye(r);if(o!==n){const l=this.Ze(t),u=l?this.Xe(l,t,o):1;if(u!==0){this.je(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,h)}}}}}Ze(t){const r=t.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let o,l;try{o=io(n).toUint8Array()}catch(u){if(u instanceof lw)return Sl("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new v_(o,i,s)}catch(u){return Sl(u instanceof Pc?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(t,r,n){return r.me.count===n-this.nt(t,r.targetId)?0:2}nt(t,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(l)||(this.Ue(r,s,null),i++)}),i}rt(t){const r=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&Am(l.target)){const u=new $e(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,ln.newNoDocument(u,t))}s.be&&(r.set(o,s.ve()),s.Ce())}});let n=gt();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(t));const i=new G0(t,r,this.Qe,this.ke,n);return this.ke=Ds(),this.qe=ry(),this.Qe=new nr(It),i}$e(t,r){if(!this.ze(t))return;const n=this.it(t,r.key)?2:0;this.Ge(t).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(t))}Ue(t,r,n){if(!this.ze(t))return;const i=this.Ge(t);this.it(t,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(t)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(t){this.Be.delete(t)}Ye(t){const r=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let r=this.Be.get(t);return r||(r=new ty,this.Be.set(t,r)),r}st(t){let r=this.qe.get(t);return r||(r=new Xr(It),this.qe=this.qe.insert(t,r)),r}ze(t){const r=this.Je(t)!==null;return r||He("WatchChangeAggregator","Detected inactive target",t),r}Je(t){const r=this.Be.get(t);return r&&r.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new ty),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.Ue(t,r,null)})}it(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function ry(){return new nr($e.comparator)}function ny(){return new nr($e.comparator)}const x5={asc:"ASCENDING",desc:"DESCENDING"},y5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},E5={and:"AND",or:"OR"};class T5{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function Sm(e,t){return e.useProto3Json||U0(t)?t:{value:t}}function l0(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Nw(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function A5(e,t){return l0(e,t.toTimestamp())}function es(e){return Lt(!!e),ot.fromTimestamp(function(r){const n=Ta(r);return new Pr(n.seconds,n.nanos)}(e))}function x_(e,t){return Im(e,t).canonicalString()}function Im(e,t){const r=function(i){return new Yt(["projects",i.projectId,"databases",i.database])}(e).child("documents");return t===void 0?r:r.child(t)}function Ow(e){const t=Yt.fromString(e);return Lt(Mw(t)),t}function Cm(e,t){return x_(e.databaseId,t.path)}function Xd(e,t){const r=Ow(t);if(r.get(1)!==e.databaseId.projectId)throw new Ge(xe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Ge(xe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new $e(Dw(r))}function Lw(e,t){return x_(e.databaseId,t)}function w5(e){const t=Ow(e);return t.length===4?Yt.emptyPath():Dw(t)}function km(e){return new Yt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Dw(e){return Lt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function iy(e,t,r){return{name:Cm(e,t),fields:r.value.mapValue.fields}}function S5(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:it()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(h,p){return h.useProto3Json?(Lt(p===void 0||typeof p=="string"),Yr.fromBase64String(p||"")):(Lt(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Yr.fromUint8Array(p||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&function(h){const p=h.code===void 0?xe.UNKNOWN:kw(h.code);return new Ge(p,h.message||"")}(o);r=new Pw(n,i,s,l||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const i=Xd(e,n.document.name),s=es(n.document.updateTime),o=n.document.createTime?es(n.document.createTime):ot.min(),l=new Ln({mapValue:{fields:n.document.fields}}),u=ln.newFoundDocument(i,s,o,l),h=n.targetIds||[],p=n.removedTargetIds||[];r=new mh(h,p,u.key,u)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const i=Xd(e,n.document),s=n.readTime?es(n.readTime):ot.min(),o=ln.newNoDocument(i,s),l=n.removedTargetIds||[];r=new mh([],l,o.key,o)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const i=Xd(e,n.document),s=n.removedTargetIds||[];r=new mh([],s,i,null)}else{if(!("filter"in t))return it();{t.filter;const n=t.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,o=new p5(i,s),l=n.targetId;r=new Rw(l,o)}}return r}function I5(e,t){let r;if(t instanceof Yu)r={update:iy(e,t.key,t.value)};else if(t instanceof g_)r={delete:Cm(e,t.key)};else if(t instanceof Ra)r={update:iy(e,t.key,t.data),updateMask:F5(t.fieldMask)};else{if(!(t instanceof f5))return it();r={verify:Cm(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof a0)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Fu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof bu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof o0)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw it()}(0,n))),t.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:A5(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:it()}(e,t.precondition)),r}function C5(e,t){return e&&e.length>0?(Lt(t!==void 0),e.map(r=>function(i,s){let o=i.updateTime?es(i.updateTime):es(s);return o.isEqual(ot.min())&&(o=es(s)),new l5(o,i.transformResults||[])}(r,t))):[]}function k5(e,t){return{documents:[Lw(e,t.path)]}}function R5(e,t){const r={structuredQuery:{}},n=t.path;let i;t.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Lw(e,i);const s=function(h){if(h.length!==0)return bw(ns.create(h,"and"))}(t.filters);s&&(r.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(p=>function(_){return{field:zo(_.field),direction:O5(_.dir)}}(p))}(t.orderBy);o&&(r.structuredQuery.orderBy=o);const l=Sm(e,t.limit);return l!==null&&(r.structuredQuery.limit=l),t.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(t.endAt)),{_t:r,parent:i}}function P5(e){let t=w5(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Lt(n===1);const p=r.from[0];p.allDescendants?i=p.collectionId:t=t.child(p.collectionId)}let s=[];r.where&&(s=function(m){const _=Fw(m);return _ instanceof ns&&hw(_)?_.getFilters():[_]}(r.where));let o=[];r.orderBy&&(o=function(m){return m.map(_=>function(E){return new s0(jo(E.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(_))}(r.orderBy));let l=null;r.limit&&(l=function(m){let _;return _=typeof m=="object"?m.value:m,U0(_)?null:_}(r.limit));let u=null;r.startAt&&(u=function(m){const _=!!m.before,v=m.values||[];return new i0(v,_)}(r.startAt));let h=null;return r.endAt&&(h=function(m){const _=!m.before,v=m.values||[];return new i0(v,_)}(r.endAt)),KM(t,i,o,s,l,"F",u,h)}function N5(e,t){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return it()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function Fw(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=jo(r.unaryFilter.field);return Sr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=jo(r.unaryFilter.field);return Sr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=jo(r.unaryFilter.field);return Sr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=jo(r.unaryFilter.field);return Sr.create(o,"!=",{nullValue:"NULL_VALUE"});default:return it()}}(e):e.fieldFilter!==void 0?function(r){return Sr.create(jo(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return it()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return ns.create(r.compositeFilter.filters.map(n=>Fw(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return it()}}(r.compositeFilter.op))}(e):it()}function O5(e){return x5[e]}function L5(e){return y5[e]}function D5(e){return E5[e]}function zo(e){return{fieldPath:e.canonicalString()}}function jo(e){return Gr.fromServerFormat(e.fieldPath)}function bw(e){return e instanceof Sr?function(r){if(r.op==="=="){if(Wx(r.value))return{unaryFilter:{field:zo(r.field),op:"IS_NAN"}};if(Hx(r.value))return{unaryFilter:{field:zo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Wx(r.value))return{unaryFilter:{field:zo(r.field),op:"IS_NOT_NAN"}};if(Hx(r.value))return{unaryFilter:{field:zo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zo(r.field),op:L5(r.op),value:r.value}}}(e):e instanceof ns?function(r){const n=r.getFilters().map(i=>bw(i));return n.length===1?n[0]:{compositeFilter:{op:D5(r.op),filters:n}}}(e):it()}function F5(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function Mw(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(t,r,n,i,s=ot.min(),o=ot.min(),l=Yr.EMPTY_BYTE_STRING,u=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(t){return new ia(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(t){this.ct=t}}function M5(e){const t=P5({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?wm(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{constructor(){this.un=new U5}addToCollectionParentIndex(t,r){return this.un.add(r),Ae.resolve()}getCollectionParents(t,r){return Ae.resolve(this.un.getEntries(r))}addFieldIndex(t,r){return Ae.resolve()}deleteFieldIndex(t,r){return Ae.resolve()}deleteAllFieldIndexes(t){return Ae.resolve()}createTargetIndexes(t,r){return Ae.resolve()}getDocumentsMatchingTarget(t,r){return Ae.resolve(null)}getIndexType(t,r){return Ae.resolve(0)}getFieldIndexes(t,r){return Ae.resolve([])}getNextCollectionGroupToUpdate(t){return Ae.resolve(null)}getMinOffset(t,r){return Ae.resolve(Ea.min())}getMinOffsetFromCollectionGroup(t,r){return Ae.resolve(Ea.min())}updateCollectionGroup(t,r,n){return Ae.resolve()}updateIndexEntries(t,r){return Ae.resolve()}}class U5{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),i=this.index[r]||new Xr(Yt.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(t){const r=t.lastSegment(),n=t.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(t){return(this.index[t]||new Xr(Yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new Rl(0)}static kn(){return new Rl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V5{constructor(){this.changes=new zl(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,ln.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ae.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z5{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j5{constructor(t,r,n,i){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(t,r))).next(i=>(n!==null&&Qc(n.mutation,i,Kn.empty(),Pr.now()),i))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,gt()).next(()=>n))}getLocalViewOfDocuments(t,r,n=gt()){const i=za();return this.populateOverlays(t,i,r).next(()=>this.computeViews(t,r,i,n).next(s=>{let o=Rc();return s.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(t,r){const n=za();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,gt()))}populateOverlays(t,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((o,l)=>{r.set(o,l)})})}computeViews(t,r,n,i){let s=Ds();const o=Jc(),l=function(){return Jc()}();return r.forEach((u,h)=>{const p=n.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof Ra)?s=s.insert(h.key,h):p!==void 0?(o.set(h.key,p.mutation.getFieldMask()),Qc(p.mutation,h,p.mutation.getFieldMask(),Pr.now())):o.set(h.key,Kn.empty())}),this.recalculateAndSaveOverlays(t,s).next(u=>(u.forEach((h,p)=>o.set(h,p)),r.forEach((h,p)=>{var m;return l.set(h,new z5(p,(m=o.get(h))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(t,r){const n=Jc();let i=new nr((o,l)=>o-l),s=gt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(o=>{for(const l of o)l.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let p=n.get(u)||Kn.empty();p=l.applyToLocalView(h,p),n.set(u,p);const m=(i.get(l.batchId)||gt()).add(u);i=i.insert(l.batchId,m)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,m=yw();p.forEach(_=>{if(!s.has(_)){const v=Iw(r.get(_),n.get(_));v!==null&&m.set(_,v),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(t,h,m))}return Ae.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,i){return function(o){return $e.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):XM(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,i):this.getDocumentsMatchingCollectionQuery(t,r,n,i)}getNextDocuments(t,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,i-s.size):Ae.resolve(za());let l=-1,u=s;return o.next(h=>Ae.forEach(h,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(p)?Ae.resolve():this.remoteDocumentCache.getEntry(t,p).next(_=>{u=u.insert(p,_)}))).next(()=>this.populateOverlays(t,h,s)).next(()=>this.computeViews(t,u,h,gt())).next(p=>({batchId:l,changes:xw(p)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new $e(r)).next(n=>{let i=Rc();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(t,r,n,i){const s=r.collectionGroup;let o=Rc();return this.indexManager.getCollectionParents(t,s).next(l=>Ae.forEach(l,u=>{const h=function(m,_){return new V0(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(r,u.child(s));return this.getDocumentsMatchingCollectionQuery(t,h,n,i).next(p=>{p.forEach((m,_)=>{o=o.insert(m,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,s,i))).next(o=>{s.forEach((u,h)=>{const p=h.getKey();o.get(p)===null&&(o=o.insert(p,ln.newInvalidDocument(p)))});let l=Rc();return o.forEach((u,h)=>{const p=s.get(u);p!==void 0&&Qc(p.mutation,h,Kn.empty(),Pr.now()),j0(r,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,r){return Ae.resolve(this.hr.get(r))}saveBundleMetadata(t,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:es(i.createTime)}}(r)),Ae.resolve()}getNamedQuery(t,r){return Ae.resolve(this.Pr.get(r))}saveNamedQuery(t,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:M5(i.bundledQuery),readTime:es(i.readTime)}}(r)),Ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{constructor(){this.overlays=new nr($e.comparator),this.Ir=new Map}getOverlay(t,r){return Ae.resolve(this.overlays.get(r))}getOverlays(t,r){const n=za();return Ae.forEach(r,i=>this.getOverlay(t,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((i,s)=>{this.ht(t,r,s)}),Ae.resolve()}removeOverlaysForBatchId(t,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),Ae.resolve()}getOverlaysForCollection(t,r,n){const i=za(),s=r.length+1,o=new $e(r.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>n&&i.set(u.getKey(),u)}return Ae.resolve(i)}getOverlaysForCollectionGroup(t,r,n,i){let s=new nr((h,p)=>h-p);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let p=s.get(h.largestBatchId);p===null&&(p=za(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=za(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=i)););return Ae.resolve(l)}ht(t,r,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new d5(r,n));let s=this.Ir.get(r);s===void 0&&(s=gt(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(){this.sessionToken=Yr.EMPTY_BYTE_STRING}getSessionToken(t){return Ae.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,Ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(){this.Tr=new Xr(Mr.Er),this.dr=new Xr(Mr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,r){const n=new Mr(t,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.Vr(new Mr(t,r))}mr(t,r){t.forEach(n=>this.removeReference(n,r))}gr(t){const r=new $e(new Yt([])),n=new Mr(r,t),i=new Mr(r,t+1),s=[];return this.dr.forEachInRange([n,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const r=new $e(new Yt([])),n=new Mr(r,t),i=new Mr(r,t+1);let s=gt();return this.dr.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(t){const r=new Mr(t,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class Mr{constructor(t,r){this.key=t,this.wr=r}static Er(t,r){return $e.comparator(t.key,r.key)||It(t.wr,r.wr)}static Ar(t,r){return It(t.wr,r.wr)||$e.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Xr(Mr.Er)}checkEmpty(t){return Ae.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new h5(s,r,n,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new Mr(l.key,s)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast());return Ae.resolve(o)}lookupMutationBatch(t,r){return Ae.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return Ae.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Ae.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return Ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new Mr(r,0),i=new Mr(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],o=>{const l=this.Dr(o.wr);s.push(l)}),Ae.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new Xr(It);return r.forEach(i=>{const s=new Mr(i,0),o=new Mr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{n=n.add(l.wr)})}),Ae.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,i=n.length+1;let s=n;$e.isDocumentKey(s)||(s=s.child(""));const o=new Mr(new $e(s),0);let l=new Xr(It);return this.br.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(l=l.add(u.wr)),!0)},o),Ae.resolve(this.Cr(l))}Cr(t){const r=[];return t.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(t,r){Lt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Ae.forEach(r.mutations,i=>{const s=new Mr(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.br=n})}On(t){}containsKey(t,r){const n=new Mr(r,0),i=this.br.firstAfterOrEqual(n);return Ae.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Ae.resolve()}Fr(t,r){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const r=this.vr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5{constructor(t){this.Mr=t,this.docs=function(){return new nr($e.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return Ae.resolve(n?n.document.mutableCopy():ln.newInvalidDocument(r))}getEntries(t,r){let n=Ds();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():ln.newInvalidDocument(i))}),Ae.resolve(n)}getDocumentsMatchingQuery(t,r,n,i){let s=Ds();const o=r.path,l=new $e(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||RM(kM(p),n)<=0||(i.has(p.key)||j0(r,p))&&(s=s.insert(p.key,p.mutableCopy()))}return Ae.resolve(s)}getAllFromCollectionGroup(t,r,n,i){it()}Or(t,r){return Ae.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new K5(this)}getSize(t){return Ae.resolve(this.size)}}class K5 extends V5{constructor(t){super(),this.cr=t}applyChanges(t){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(t,i)):this.cr.removeEntry(n)}),Ae.waitFor(r)}getFromCache(t,r){return this.cr.getEntry(t,r)}getAllFromCache(t,r){return this.cr.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(t){this.persistence=t,this.Nr=new zl(r=>h_(r),d_),this.lastRemoteSnapshotVersion=ot.min(),this.highestTargetId=0,this.Lr=0,this.Br=new y_,this.targetCount=0,this.kr=Rl.Bn()}forEachTarget(t,r){return this.Nr.forEach((n,i)=>r(i)),Ae.resolve()}getLastRemoteSnapshotVersion(t){return Ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Ae.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),Ae.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Ae.resolve()}Kn(t){this.Nr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.kr=new Rl(r),this.highestTargetId=r),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,r){return this.Kn(r),this.targetCount+=1,Ae.resolve()}updateTargetData(t,r){return this.Kn(r),Ae.resolve()}removeTargetData(t,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Ae.resolve()}removeTargets(t,r,n){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(t,l.targetId)),i++)}),Ae.waitFor(s).next(()=>i)}getTargetCount(t){return Ae.resolve(this.targetCount)}getTargetData(t,r){const n=this.Nr.get(r)||null;return Ae.resolve(n)}addMatchingKeys(t,r,n){return this.Br.Rr(r,n),Ae.resolve()}removeMatchingKeys(t,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(o=>{s.push(i.markPotentiallyOrphaned(t,o))}),Ae.waitFor(s)}removeMatchingKeysForTargetId(t,r){return this.Br.gr(r),Ae.resolve()}getMatchingKeysForTargetId(t,r){const n=this.Br.yr(r);return Ae.resolve(n)}containsKey(t,r){return Ae.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q5{constructor(t,r){this.qr={},this.overlays={},this.Qr=new l_(0),this.Kr=!1,this.Kr=!0,this.$r=new G5,this.referenceDelegate=t(this),this.Ur=new X5(this),this.indexManager=new B5,this.remoteDocumentCache=function(i){return new Z5(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new b5(r),this.Gr=new H5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new W5,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.qr[t.toKey()];return n||(n=new $5(r,this.referenceDelegate),this.qr[t.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,r,n){He("MemoryPersistence","Starting transaction:",t);const i=new Y5(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(t,r){return Ae.or(Object.values(this.qr).map(n=>()=>n.containsKey(t,r)))}}class Y5 extends NM{constructor(t){super(),this.currentSequenceNumber=t}}class E_{constructor(t){this.persistence=t,this.Jr=new y_,this.Yr=null}static Zr(t){return new E_(t)}get Xr(){if(this.Yr)return this.Yr;throw it()}addReference(t,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Ae.resolve()}removeReference(t,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Ae.resolve()}markPotentiallyOrphaned(t,r){return this.Xr.add(r.toString()),Ae.resolve()}removeTarget(t,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(t,r))}zr(){this.Yr=new Set}jr(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ae.forEach(this.Xr,n=>{const i=$e.fromPath(n);return this.ei(t,i).next(s=>{s||r.removeEntry(i,ot.min())})}).next(()=>(this.Yr=null,r.apply(t)))}updateLimboDocument(t,r){return this.ei(t,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(t){return 0}ei(t,r){return Ae.or([()=>Ae.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Hr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(t,r,n,i){this.targetId=t,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(t,r){let n=gt(),i=gt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new T_(t,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return e6()?8:OM(Jb())>0?6:4}()}initialize(t,r){this.Ji=t,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(t,r,n,i){const s={result:null};return this.Yi(t,r).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(t,r,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new J5;return this.Xi(t,r,o).next(l=>{if(s.result=l,this.zi)return this.es(t,r,o,l.size)})}).next(()=>s.result)}es(t,r,n,i){return n.documentReadCount<this.ji?(vc()<=Tt.DEBUG&&He("QueryEngine","SDK will not create cache indexes for query:",Vo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Ae.resolve()):(vc()<=Tt.DEBUG&&He("QueryEngine","Query:",Vo(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(vc()<=Tt.DEBUG&&He("QueryEngine","The SDK decides to create cache indexes for query:",Vo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Qi(r))):Ae.resolve())}Yi(t,r){if(Kx(r))return Ae.resolve(null);let n=Qi(r);return this.indexManager.getIndexType(t,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=wm(r,null,"F"),n=Qi(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(s=>{const o=gt(...s);return this.Ji.getDocuments(t,o).next(l=>this.indexManager.getMinOffset(t,n).next(u=>{const h=this.ts(r,l);return this.ns(r,h,o,u.readTime)?this.Yi(t,wm(r,null,"F")):this.rs(t,h,r,u)}))})))}Zi(t,r,n,i){return Kx(r)||i.isEqual(ot.min())?Ae.resolve(null):this.Ji.getDocuments(t,n).next(s=>{const o=this.ts(r,s);return this.ns(r,o,n,i)?Ae.resolve(null):(vc()<=Tt.DEBUG&&He("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Vo(r)),this.rs(t,o,r,CM(i,-1)).next(l=>l))})}ts(t,r){let n=new Xr(_w(t));return r.forEach((i,s)=>{j0(t,s)&&(n=n.add(s))}),n}ns(t,r,n,i){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const s=t.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(t,r,n){return vc()<=Tt.DEBUG&&He("QueryEngine","Using full collection scan to execute query:",Vo(r)),this.Ji.getDocumentsMatchingQuery(t,r,Ea.min(),n)}rs(t,r,n,i){return this.Ji.getDocumentsMatchingQuery(t,n,i).next(s=>(r.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(t,r,n,i){this.persistence=t,this.ss=r,this.serializer=i,this.os=new nr(It),this._s=new zl(s=>h_(s),d_),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(n)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new j5(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.os))}}function t8(e,t,r,n){return new e8(e,t,r,n)}async function Bw(e,t){const r=lt(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(t),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let u=gt();for(const h of i){o.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of s){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return r.localDocuments.getDocuments(n,u).next(h=>({hs:h,removedBatchIds:o,addedBatchIds:l}))})})}function r8(e,t){const r=lt(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=t.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const m=h.batch,_=m.keys();let v=Ae.resolve();return _.forEach(E=>{v=v.next(()=>p.getEntry(u,E)).next(y=>{const w=h.docVersions.get(E);Lt(w!==null),y.version.compareTo(w)<0&&(m.applyToRemoteDocument(y,h),y.isValidDocument()&&(y.setReadTime(h.commitVersion),p.addEntry(y)))})}),v.next(()=>l.mutationQueue.removeMutationBatch(u,m))}(r,n,t,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=gt();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(t))).next(()=>r.localDocuments.getDocuments(n,i))})}function Uw(e){const t=lt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Ur.getLastRemoteSnapshotVersion(r))}function n8(e,t){const r=lt(e),n=t.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const l=[];t.targetChanges.forEach((p,m)=>{const _=i.get(m);if(!_)return;l.push(r.Ur.removeMatchingKeys(s,p.removedDocuments,m).next(()=>r.Ur.addMatchingKeys(s,p.addedDocuments,m)));let v=_.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(m)!==null?v=v.withResumeToken(Yr.EMPTY_BYTE_STRING,ot.min()).withLastLimboFreeSnapshotVersion(ot.min()):p.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(p.resumeToken,n)),i=i.insert(m,v),function(y,w,k){return y.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(_,v,p)&&l.push(r.Ur.updateTargetData(s,v))});let u=Ds(),h=gt();if(t.documentUpdates.forEach(p=>{t.resolvedLimboDocuments.has(p)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(i8(s,o,t.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!n.isEqual(ot.min())){const p=r.Ur.getLastRemoteSnapshotVersion(s).next(m=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(p)}return Ae.waitFor(l).next(()=>o.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(r.os=i,s))}function i8(e,t,r){let n=gt(),i=gt();return r.forEach(s=>n=n.add(s)),t.getEntries(e,n).next(s=>{let o=Ds();return r.forEach((l,u)=>{const h=s.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(ot.min())?(t.removeEntry(l,u.readTime),o=o.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(l,u)):He("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:o,Is:i}})}function s8(e,t){const r=lt(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function a8(e,t){const r=lt(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,t).next(s=>s?(i=s,Ae.resolve(i)):r.Ur.allocateTargetId(n).next(o=>(i=new ia(t,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(t,n.targetId)),n})}async function Rm(e,t,r){const n=lt(e),i=n.os.get(t),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!qu(o))throw o;He("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}n.os=n.os.remove(t),n._s.delete(i.target)}function sy(e,t,r){const n=lt(e);let i=ot.min(),s=gt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,p){const m=lt(u),_=m._s.get(p);return _!==void 0?Ae.resolve(m.os.get(_)):m.Ur.getTargetData(h,p)}(n,o,Qi(t)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{s=u})}).next(()=>n.ss.getDocumentsMatchingQuery(o,t,r?i:ot.min(),r?s:gt())).next(l=>(o8(n,YM(t),l),{documents:l,Ts:s})))}function o8(e,t,r){let n=e.us.get(t)||ot.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),e.us.set(t,n)}class ay{constructor(){this.activeTargetIds=n5()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class l8{constructor(){this.so=new ay,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t,r=!0){return r&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,r,n){this.oo[t]=r}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new ay,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c8{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){He("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){He("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jf=null;function qd(){return Jf===null?Jf=function(){return 268435456+Math.round(2147483648*Math.random())}():Jf++,"0x"+Jf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f8{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nn="WebChannelConnection";class h8 extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,o){const l=qd(),u=this.xo(r,n.toUriEncodedString());He("RestConnection",`Sending RPC '${r}' ${l}:`,u,i);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,s,o),this.No(r,u,h,i).then(p=>(He("RestConnection",`Received RPC '${r}' ${l}: `,p),p),p=>{throw Sl("RestConnection",`RPC '${r}' ${l} failed with error: `,p,"url: ",u,"request:",i),p})}Lo(r,n,i,s,o,l){return this.Mo(r,n,i,s,o)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>r[o]=s),i&&i.headers.forEach((s,o)=>r[o]=s)}xo(r,n){const i=u8[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,r,n,i){const s=qd();return new Promise((o,l)=>{const u=new ew;u.setWithCredentials(!0),u.listenOnce(tw.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case hh.NO_ERROR:const p=u.getResponseJson();He(nn,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(p)),o(p);break;case hh.TIMEOUT:He(nn,`RPC '${t}' ${s} timed out`),l(new Ge(xe.DEADLINE_EXCEEDED,"Request time out"));break;case hh.HTTP_ERROR:const m=u.getStatus();if(He(nn,`RPC '${t}' ${s} failed with status:`,m,"response text:",u.getResponseText()),m>0){let _=u.getResponseJson();Array.isArray(_)&&(_=_[0]);const v=_==null?void 0:_.error;if(v&&v.status&&v.message){const E=function(w){const k=w.toLowerCase().replace(/_/g,"-");return Object.values(xe).indexOf(k)>=0?k:xe.UNKNOWN}(v.status);l(new Ge(E,v.message))}else l(new Ge(xe.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new Ge(xe.UNAVAILABLE,"Connection failed."));break;default:it()}}finally{He(nn,`RPC '${t}' ${s} completed.`)}});const h=JSON.stringify(i);He(nn,`RPC '${t}' ${s} sending request:`,i),u.send(r,"POST",h,n,15)})}Bo(t,r,n){const i=qd(),s=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=iw(),l=nw(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const p=s.join("");He(nn,`Creating RPC '${t}' stream ${i}: ${p}`,u);const m=o.createWebChannel(p,u);let _=!1,v=!1;const E=new f8({Io:w=>{v?He(nn,`Not sending because RPC '${t}' stream ${i} is closed:`,w):(_||(He(nn,`Opening RPC '${t}' stream ${i} transport.`),m.open(),_=!0),He(nn,`RPC '${t}' stream ${i} sending:`,w),m.send(w))},To:()=>m.close()}),y=(w,k,C)=>{w.listen(k,A=>{try{C(A)}catch(U){setTimeout(()=>{throw U},0)}})};return y(m,kc.EventType.OPEN,()=>{v||(He(nn,`RPC '${t}' stream ${i} transport opened.`),E.yo())}),y(m,kc.EventType.CLOSE,()=>{v||(v=!0,He(nn,`RPC '${t}' stream ${i} transport closed`),E.So())}),y(m,kc.EventType.ERROR,w=>{v||(v=!0,Sl(nn,`RPC '${t}' stream ${i} transport errored:`,w),E.So(new Ge(xe.UNAVAILABLE,"The operation could not be completed")))}),y(m,kc.EventType.MESSAGE,w=>{var k;if(!v){const C=w.data[0];Lt(!!C);const A=C,U=A.error||((k=A[0])===null||k===void 0?void 0:k.error);if(U){He(nn,`RPC '${t}' stream ${i} received error:`,U);const q=U.status;let K=function(P){const D=vr[P];if(D!==void 0)return kw(D)}(q),S=U.message;K===void 0&&(K=xe.INTERNAL,S="Unknown error status: "+q+" with message "+U.message),v=!0,E.So(new Ge(K,S)),m.close()}else He(nn,`RPC '${t}' stream ${i} received:`,C),E.bo(C)}}),y(l,rw.STAT_EVENT,w=>{w.stat===xm.PROXY?He(nn,`RPC '${t}' stream ${i} detected buffering proxy`):w.stat===xm.NOPROXY&&He(nn,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.wo()},0),E}}function Yd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0(e){return new T5(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(t,r,n=1e3,i=1.5,s=6e4){this.ui=t,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&He("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(t,r,n,i,s,o,l,u){this.ui=t,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Vw(t,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():r&&r.code===xe.RESOURCE_EXHAUSTED?(Ls(r.toString()),Ls("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===xe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(r)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{t(()=>{const i=new Ge(xe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(t,r){const n=this.h_(this.Yo);this.stream=this.T_(t,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return He("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return r=>{this.ui.enqueueAndForget(()=>this.Yo===t?r():(He("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class d8 extends zw{constructor(t,r,n,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,o),this.serializer=s}T_(t,r){return this.connection.Bo("Listen",t,r)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const r=S5(this.serializer,t),n=function(s){if(!("targetChange"in s))return ot.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ot.min():o.readTime?es(o.readTime):ot.min()}(t);return this.listener.d_(r,n)}A_(t){const r={};r.database=km(this.serializer),r.addTarget=function(s,o){let l;const u=o.target;if(l=Am(u)?{documents:k5(s,u)}:{query:R5(s,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Nw(s,o.resumeToken);const h=Sm(s,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo(ot.min())>0){l.readTime=l0(s,o.snapshotVersion.toTimestamp());const h=Sm(s,o.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,t);const n=N5(this.serializer,t);n&&(r.labels=n),this.a_(r)}R_(t){const r={};r.database=km(this.serializer),r.removeTarget=t,this.a_(r)}}class p8 extends zw{constructor(t,r,n,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,r){return this.connection.Bo("Write",t,r)}E_(t){return Lt(!!t.streamToken),this.lastStreamToken=t.streamToken,Lt(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){Lt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const r=C5(t.writeResults,t.commitTime),n=es(t.commitTime);return this.listener.g_(n,r)}p_(){const t={};t.database=km(this.serializer),this.a_(t)}m_(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>I5(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8 extends class{}{constructor(t,r,n,i){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Ge(xe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(t,Im(r,n),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ge(xe.UNKNOWN,s.toString())})}Lo(t,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(t,Im(r,n),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ge(xe.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class g8{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ls(r),this.D_=!1):He("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _8{constructor(t,r,n,i,s){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{n.enqueueAndForget(async()=>{_o(this)&&(He("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=lt(u);h.L_.add(4),await Qu(h),h.q_.set("Unknown"),h.L_.delete(4),await Z0(h)}(this))})}),this.q_=new g8(n,i)}}async function Z0(e){if(_o(e))for(const t of e.B_)await t(!0)}async function Qu(e){for(const t of e.B_)await t(!1)}function jw(e,t){const r=lt(e);r.N_.has(t.targetId)||(r.N_.set(t.targetId,t),I_(r)?S_(r):jl(r).r_()&&w_(r,t))}function A_(e,t){const r=lt(e),n=jl(r);r.N_.delete(t),n.r_()&&Hw(r,t),r.N_.size===0&&(n.r_()?n.o_():_o(r)&&r.q_.set("Unknown"))}function w_(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ot.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}jl(e).A_(t)}function Hw(e,t){e.Q_.xe(t),jl(e).R_(t)}function S_(e){e.Q_=new v5({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),jl(e).start(),e.q_.v_()}function I_(e){return _o(e)&&!jl(e).n_()&&e.N_.size>0}function _o(e){return lt(e).L_.size===0}function Ww(e){e.Q_=void 0}async function v8(e){e.q_.set("Online")}async function x8(e){e.N_.forEach((t,r)=>{w_(e,t)})}async function y8(e,t){Ww(e),I_(e)?(e.q_.M_(t),S_(e)):e.q_.set("Unknown")}async function E8(e,t,r){if(e.q_.set("Online"),t instanceof Pw&&t.state===2&&t.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(e,t)}catch(n){He("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await c0(e,n)}else if(t instanceof mh?e.Q_.Ke(t):t instanceof Rw?e.Q_.He(t):e.Q_.We(t),!r.isEqual(ot.min()))try{const n=await Uw(e.localStore);r.compareTo(n)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=s.N_.get(h);p&&s.N_.set(h,p.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,h)=>{const p=s.N_.get(u);if(!p)return;s.N_.set(u,p.withResumeToken(Yr.EMPTY_BYTE_STRING,p.snapshotVersion)),Hw(s,u);const m=new ia(p.target,u,h,p.sequenceNumber);w_(s,m)}),s.remoteSyncer.applyRemoteEvent(l)}(e,r)}catch(n){He("RemoteStore","Failed to raise snapshot:",n),await c0(e,n)}}async function c0(e,t,r){if(!qu(t))throw t;e.L_.add(1),await Qu(e),e.q_.set("Offline"),r||(r=()=>Uw(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{He("RemoteStore","Retrying IndexedDB access"),await r(),e.L_.delete(1),await Z0(e)})}function Gw(e,t){return t().catch(r=>c0(e,r,t))}async function K0(e){const t=lt(e),r=Aa(t);let n=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;T8(t);)try{const i=await s8(t.localStore,n);if(i===null){t.O_.length===0&&r.o_();break}n=i.batchId,A8(t,i)}catch(i){await c0(t,i)}$w(t)&&Zw(t)}function T8(e){return _o(e)&&e.O_.length<10}function A8(e,t){e.O_.push(t);const r=Aa(e);r.r_()&&r.V_&&r.m_(t.mutations)}function $w(e){return _o(e)&&!Aa(e).n_()&&e.O_.length>0}function Zw(e){Aa(e).start()}async function w8(e){Aa(e).p_()}async function S8(e){const t=Aa(e);for(const r of e.O_)t.m_(r.mutations)}async function I8(e,t,r){const n=e.O_.shift(),i=__.from(n,t,r);await Gw(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await K0(e)}async function C8(e,t){t&&Aa(e).V_&&await async function(n,i){if(function(o){return m5(o)&&o!==xe.ABORTED}(i.code)){const s=n.O_.shift();Aa(n).s_(),await Gw(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await K0(n)}}(e,t),$w(e)&&Zw(e)}async function ly(e,t){const r=lt(e);r.asyncQueue.verifyOperationInProgress(),He("RemoteStore","RemoteStore received new credentials");const n=_o(r);r.L_.add(3),await Qu(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.L_.delete(3),await Z0(r)}async function k8(e,t){const r=lt(e);t?(r.L_.delete(2),await Z0(r)):t||(r.L_.add(2),await Qu(r),r.q_.set("Unknown"))}function jl(e){return e.K_||(e.K_=function(r,n,i){const s=lt(r);return s.w_(),new d8(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Eo:v8.bind(null,e),Ro:x8.bind(null,e),mo:y8.bind(null,e),d_:E8.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),I_(e)?S_(e):e.q_.set("Unknown")):(await e.K_.stop(),Ww(e))})),e.K_}function Aa(e){return e.U_||(e.U_=function(r,n,i){const s=lt(r);return s.w_(),new p8(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:w8.bind(null,e),mo:C8.bind(null,e),f_:S8.bind(null,e),g_:I8.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await K0(e)):(await e.U_.stop(),e.O_.length>0&&(He("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))})),e.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(t,r,n,i,s){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Ss,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,i,s){const o=Date.now()+n,l=new C_(t,r,o,i,s);return l.start(n),l}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ge(xe.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function k_(e,t){if(Ls("AsyncQueue",`${t}: ${e}`),qu(e))return new Ge(xe.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(t){this.comparator=t?(r,n)=>t(r,n)||$e.comparator(r.key,n.key):(r,n)=>$e.comparator(r.key,n.key),this.keyedMap=Rc(),this.sortedSet=new nr(this.comparator)}static emptySet(t){return new ml(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof ml)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new ml;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(){this.W_=new nr($e.comparator)}track(t){const r=t.doc.key,n=this.W_.get(r);n?t.type!==0&&n.type===3?this.W_=this.W_.insert(r,t):t.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.W_=this.W_.remove(r):t.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):it():this.W_=this.W_.insert(r,t)}G_(){const t=[];return this.W_.inorderTraversal((r,n)=>{t.push(n)}),t}}class Pl{constructor(t,r,n,i,s,o,l,u,h){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,r,n,i,s){const o=[];return r.forEach(l=>{o.push({type:0,doc:l})}),new Pl(t,r,ml.emptySet(r),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&z0(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class P8{constructor(){this.queries=uy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=lt(r),s=i.queries;i.queries=uy(),s.forEach((o,l)=>{for(const u of l.j_)u.onError(n)})})(this,new Ge(xe.ABORTED,"Firestore shutting down"))}}function uy(){return new zl(e=>gw(e),z0)}async function Kw(e,t){const r=lt(e);let n=3;const i=t.query;let s=r.queries.get(i);s?!s.H_()&&t.J_()&&(n=2):(s=new R8,n=t.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(o){const l=k_(o,`Initialization of query '${Vo(t.query)}' failed`);return void t.onError(l)}r.queries.set(i,s),s.j_.push(t),t.Z_(r.onlineState),s.z_&&t.X_(s.z_)&&R_(r)}async function Xw(e,t){const r=lt(e),n=t.query;let i=3;const s=r.queries.get(n);if(s){const o=s.j_.indexOf(t);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=t.J_()?0:1:!s.H_()&&t.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function N8(e,t){const r=lt(e);let n=!1;for(const i of t){const s=i.query,o=r.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(n=!0);o.z_=i}}n&&R_(r)}function O8(e,t,r){const n=lt(e),i=n.queries.get(t);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(t)}function R_(e){e.Y_.forEach(t=>{t.next()})}var Pm,fy;(fy=Pm||(Pm={})).ea="default",fy.Cache="cache";class qw{constructor(t,r,n){this.query=t,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(t){if(!this.options.includeMetadataChanges){const n=[];for(const i of t.docChanges)i.type!==3&&n.push(i);t=new Pl(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.na?this.ia(t)&&(this.ta.next(t),r=!0):this.sa(t,this.onlineState)&&(this.oa(t),r=!0),this.ra=t,r}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),r=!0),r}sa(t,r){if(!t.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(t){t=Pl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==Pm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{constructor(t){this.key=t}}class Jw{constructor(t){this.key=t}}class L8{constructor(t,r){this.query=t,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=gt(),this.mutatedKeys=gt(),this.Aa=_w(t),this.Ra=new ml(this.Aa)}get Va(){return this.Ta}ma(t,r){const n=r?r.fa:new cy,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((p,m)=>{const _=i.get(p),v=j0(this.query,m)?m:null,E=!!_&&this.mutatedKeys.has(_.key),y=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let w=!1;_&&v?_.data.isEqual(v.data)?E!==y&&(n.track({type:3,doc:v}),w=!0):this.ga(_,v)||(n.track({type:2,doc:v}),w=!0,(u&&this.Aa(v,u)>0||h&&this.Aa(v,h)<0)&&(l=!0)):!_&&v?(n.track({type:0,doc:v}),w=!0):_&&!v&&(n.track({type:1,doc:_}),w=!0,(u||h)&&(l=!0)),w&&(v?(o=o.add(v),s=y?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),n.track({type:1,doc:p})}return{Ra:o,fa:n,ns:l,mutatedKeys:s}}ga(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n,i){const s=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const o=t.fa.G_();o.sort((p,m)=>function(v,E){const y=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return it()}};return y(v)-y(E)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(n),i=i!=null&&i;const l=r&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,h=u!==this.Ea;return this.Ea=u,o.length!==0||h?{snapshot:new Pl(this.query,t.Ra,s,o,t.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new cy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=gt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return t.forEach(n=>{this.da.has(n)||r.push(new Jw(n))}),this.da.forEach(n=>{t.has(n)||r.push(new Yw(n))}),r}ba(t){this.Ta=t.Ts,this.da=gt();const r=this.ma(t.documents);return this.applyChanges(r,!0)}Da(){return Pl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class D8{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class F8{constructor(t){this.key=t,this.va=!1}}class b8{constructor(t,r,n,i,s,o){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new zl(l=>gw(l),z0),this.Ma=new Map,this.xa=new Set,this.Oa=new nr($e.comparator),this.Na=new Map,this.La=new y_,this.Ba={},this.ka=new Map,this.qa=Rl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function M8(e,t,r=!0){const n=iS(e);let i;const s=n.Fa.get(t);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Qw(n,t,r,!0),i}async function B8(e,t){const r=iS(e);await Qw(r,t,!0,!1)}async function Qw(e,t,r,n){const i=await a8(e.localStore,Qi(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,r);let l;return n&&(l=await U8(e,t,s,o==="current",i.resumeToken)),e.isPrimaryClient&&r&&jw(e.remoteStore,i),l}async function U8(e,t,r,n,i){e.Ka=(m,_,v)=>async function(y,w,k,C){let A=w.view.ma(k);A.ns&&(A=await sy(y.localStore,w.query,!1).then(({documents:S})=>w.view.ma(S,A)));const U=C&&C.targetChanges.get(w.targetId),q=C&&C.targetMismatches.get(w.targetId)!=null,K=w.view.applyChanges(A,y.isPrimaryClient,U,q);return dy(y,w.targetId,K.wa),K.snapshot}(e,m,_,v);const s=await sy(e.localStore,t,!0),o=new L8(t,s.Ts),l=o.ma(s.documents),u=Ju.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",i),h=o.applyChanges(l,e.isPrimaryClient,u);dy(e,r,h.wa);const p=new D8(t,r,o);return e.Fa.set(t,p),e.Ma.has(r)?e.Ma.get(r).push(t):e.Ma.set(r,[t]),h.snapshot}async function V8(e,t,r){const n=lt(e),i=n.Fa.get(t),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(o=>!z0(o,t))),void n.Fa.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Rm(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&A_(n.remoteStore,i.targetId),Nm(n,i.targetId)}).catch(Xu)):(Nm(n,i.targetId),await Rm(n.localStore,i.targetId,!0))}async function z8(e,t){const r=lt(e),n=r.Fa.get(t),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),A_(r.remoteStore,n.targetId))}async function j8(e,t,r){const n=X8(e);try{const i=await function(o,l){const u=lt(o),h=Pr.now(),p=l.reduce((v,E)=>v.add(E.key),gt());let m,_;return u.persistence.runTransaction("Locally write mutations","readwrite",v=>{let E=Ds(),y=gt();return u.cs.getEntries(v,p).next(w=>{E=w,E.forEach((k,C)=>{C.isValidDocument()||(y=y.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(v,E)).next(w=>{m=w;const k=[];for(const C of l){const A=u5(C,m.get(C.key).overlayedDocument);A!=null&&k.push(new Ra(C.key,A,cw(A.value.mapValue),vi.exists(!0)))}return u.mutationQueue.addMutationBatch(v,h,k,l)}).next(w=>{_=w;const k=w.applyToLocalDocumentSet(m,y);return u.documentOverlayCache.saveOverlays(v,w.batchId,k)})}).then(()=>({batchId:_.batchId,changes:xw(m)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(i.batchId),function(o,l,u){let h=o.Ba[o.currentUser.toKey()];h||(h=new nr(It)),h=h.insert(l,u),o.Ba[o.currentUser.toKey()]=h}(n,i.batchId,r),await ef(n,i.changes),await K0(n.remoteStore)}catch(i){const s=k_(i,"Failed to persist write");r.reject(s)}}async function eS(e,t){const r=lt(e);try{const n=await n8(r.localStore,t);t.targetChanges.forEach((i,s)=>{const o=r.Na.get(s);o&&(Lt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Lt(o.va):i.removedDocuments.size>0&&(Lt(o.va),o.va=!1))}),await ef(r,n,t)}catch(n){await Xu(n)}}function hy(e,t,r){const n=lt(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,o)=>{const l=o.view.Z_(t);l.snapshot&&i.push(l.snapshot)}),function(o,l){const u=lt(o);u.onlineState=l;let h=!1;u.queries.forEach((p,m)=>{for(const _ of m.j_)_.Z_(l)&&(h=!0)}),h&&R_(u)}(n.eventManager,t),i.length&&n.Ca.d_(i),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function H8(e,t,r){const n=lt(e);n.sharedClientState.updateQueryState(t,"rejected",r);const i=n.Na.get(t),s=i&&i.key;if(s){let o=new nr($e.comparator);o=o.insert(s,ln.newNoDocument(s,ot.min()));const l=gt().add(s),u=new G0(ot.min(),new Map,new nr(It),o,l);await eS(n,u),n.Oa=n.Oa.remove(s),n.Na.delete(t),P_(n)}else await Rm(n.localStore,t,!1).then(()=>Nm(n,t,r)).catch(Xu)}async function W8(e,t){const r=lt(e),n=t.batch.batchId;try{const i=await r8(r.localStore,t);rS(r,n,null),tS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await ef(r,i)}catch(i){await Xu(i)}}async function G8(e,t,r){const n=lt(e);try{const i=await function(o,l){const u=lt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(m=>(Lt(m!==null),p=m.keys(),u.mutationQueue.removeMutationBatch(h,m))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(n.localStore,t);rS(n,t,r),tS(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await ef(n,i)}catch(i){await Xu(i)}}function tS(e,t){(e.ka.get(t)||[]).forEach(r=>{r.resolve()}),e.ka.delete(t)}function rS(e,t,r){const n=lt(e);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(t);s&&(r?s.reject(r):s.resolve(),i=i.remove(t)),n.Ba[n.currentUser.toKey()]=i}}function Nm(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Ma.get(t))e.Fa.delete(n),r&&e.Ca.$a(n,r);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(n=>{e.La.containsKey(n)||nS(e,n)})}function nS(e,t){e.xa.delete(t.path.canonicalString());const r=e.Oa.get(t);r!==null&&(A_(e.remoteStore,r),e.Oa=e.Oa.remove(t),e.Na.delete(r),P_(e))}function dy(e,t,r){for(const n of r)n instanceof Yw?(e.La.addReference(n.key,t),$8(e,n)):n instanceof Jw?(He("SyncEngine","Document no longer in limbo: "+n.key),e.La.removeReference(n.key,t),e.La.containsKey(n.key)||nS(e,n.key)):it()}function $8(e,t){const r=t.key,n=r.path.canonicalString();e.Oa.get(r)||e.xa.has(n)||(He("SyncEngine","New document in limbo: "+r),e.xa.add(n),P_(e))}function P_(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const r=new $e(Yt.fromString(t)),n=e.qa.next();e.Na.set(n,new F8(r)),e.Oa=e.Oa.insert(r,n),jw(e.remoteStore,new ia(Qi(p_(r.path)),n,"TargetPurposeLimboResolution",l_.oe))}}async function ef(e,t,r){const n=lt(e),i=[],s=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((l,u)=>{o.push(n.Ka(u,t,r).then(h=>{var p;if((h||r)&&n.isPrimaryClient){const m=h?!h.fromCache:(p=r==null?void 0:r.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;n.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(h){i.push(h);const m=T_.Wi(u.targetId,h);s.push(m)}}))}),await Promise.all(o),n.Ca.d_(i),await async function(u,h){const p=lt(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Ae.forEach(h,_=>Ae.forEach(_.$i,v=>p.persistence.referenceDelegate.addReference(m,_.targetId,v)).next(()=>Ae.forEach(_.Ui,v=>p.persistence.referenceDelegate.removeReference(m,_.targetId,v)))))}catch(m){if(!qu(m))throw m;He("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const _=m.targetId;if(!m.fromCache){const v=p.os.get(_),E=v.snapshotVersion,y=v.withLastLimboFreeSnapshotVersion(E);p.os=p.os.insert(_,y)}}}(n.localStore,s))}async function Z8(e,t){const r=lt(e);if(!r.currentUser.isEqual(t)){He("SyncEngine","User change. New user:",t.toKey());const n=await Bw(r.localStore,t);r.currentUser=t,function(s,o){s.ka.forEach(l=>{l.forEach(u=>{u.reject(new Ge(xe.CANCELLED,o))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await ef(r,n.hs)}}function K8(e,t){const r=lt(e),n=r.Na.get(t);if(n&&n.va)return gt().add(n.key);{let i=gt();const s=r.Ma.get(t);if(!s)return i;for(const o of s){const l=r.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function iS(e){const t=lt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=eS.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=K8.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=H8.bind(null,t),t.Ca.d_=N8.bind(null,t.eventManager),t.Ca.$a=O8.bind(null,t.eventManager),t}function X8(e){const t=lt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=W8.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=G8.bind(null,t),t}class u0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=$0(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),await this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)}ja(t,r){return null}Ha(t,r){return null}za(t){return t8(this.persistence,new Q5,t.initialUser,this.serializer)}Ga(t){return new q5(E_.Zr,this.serializer)}Wa(t){return new l8}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}u0.provider={build:()=>new u0};class Om{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>hy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Z8.bind(null,this.syncEngine),await k8(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new P8}()}createDatastore(t){const r=$0(t.databaseInfo.databaseId),n=function(s){return new h8(s)}(t.databaseInfo);return function(s,o,l,u){return new m8(s,o,l,u)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,i,s,o,l){return new _8(n,i,s,o,l)}(this.localStore,this.datastore,t.asyncQueue,r=>hy(this.syncEngine,r,0),function(){return oy.D()?new oy:new c8}())}createSyncEngine(t,r){return function(i,s,o,l,u,h,p){const m=new b8(i,s,o,l,u,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(i){const s=lt(i);He("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Qu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Om.provider={build:()=>new Om};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ya(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ya(this.observer.error,t):Ls("Uncaught Error in snapshot listener:",t.toString()))}Za(){this.muted=!0}Ya(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q8{constructor(t,r,n,i,s){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=sn.UNAUTHENTICATED,this.clientId=aw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{He("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(He("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ss;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=k_(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function Jd(e,t){e.asyncQueue.verifyOperationInProgress(),He("FirestoreClient","Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Bw(t.localStore,i),n=i)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function py(e,t){e.asyncQueue.verifyOperationInProgress();const r=await Y8(e);He("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(n=>ly(t.remoteStore,n)),e.setAppCheckTokenChangeListener((n,i)=>ly(t.remoteStore,i)),e._onlineComponents=t}async function Y8(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){He("FirestoreClient","Using user provided OfflineComponentProvider");try{await Jd(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(i){return i.name==="FirebaseError"?i.code===xe.FAILED_PRECONDITION||i.code===xe.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Sl("Error using user provided cache. Falling back to memory cache: "+r),await Jd(e,new u0)}}else He("FirestoreClient","Using default OfflineComponentProvider"),await Jd(e,new u0);return e._offlineComponents}async function aS(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(He("FirestoreClient","Using user provided OnlineComponentProvider"),await py(e,e._uninitializedComponentsProvider._online)):(He("FirestoreClient","Using default OnlineComponentProvider"),await py(e,new Om))),e._onlineComponents}function J8(e){return aS(e).then(t=>t.syncEngine)}async function oS(e){const t=await aS(e),r=t.eventManager;return r.onListen=M8.bind(null,t.syncEngine),r.onUnlisten=V8.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=B8.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=z8.bind(null,t.syncEngine),r}function Q8(e,t,r={}){const n=new Ss;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,h){const p=new sS({next:_=>{p.Za(),o.enqueueAndForget(()=>Xw(s,m));const v=_.docs.has(l);!v&&_.fromCache?h.reject(new Ge(xe.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&_.fromCache&&u&&u.source==="server"?h.reject(new Ge(xe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new qw(p_(l.path),p,{includeMetadataChanges:!0,_a:!0});return Kw(s,m)}(await oS(e),e.asyncQueue,t,r,n)),n.promise}function e9(e,t,r={}){const n=new Ss;return e.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,h){const p=new sS({next:_=>{p.Za(),o.enqueueAndForget(()=>Xw(s,m)),_.fromCache&&u.source==="server"?h.reject(new Ge(xe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new qw(l,p,{includeMetadataChanges:!0,_a:!0});return Kw(s,m)}(await oS(e),e.asyncQueue,t,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lS(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(e,t,r){if(!r)throw new Ge(xe.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function t9(e,t,r,n){if(t===!0&&n===!0)throw new Ge(xe.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function gy(e){if(!$e.isDocumentKey(e))throw new Ge(xe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function _y(e){if($e.isDocumentKey(e))throw new Ge(xe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function N_(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":it()}function wa(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ge(xe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=N_(e);throw new Ge(xe.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new Ge(xe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Ge(xe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}t9("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lS((n=t.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ge(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ge(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ge(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class X0{constructor(t,r,n,i){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new vy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ge(xe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Ge(xe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new vy(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new vM;switch(n.type){case"firstParty":return new TM(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ge(xe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=my.get(r);n&&(He("ComponentProvider","Removing Datastore"),my.delete(r),n.terminate())}(this),Promise.resolve()}}function r9(e,t,r,n={}){var i;const s=(e=wa(e,X0))._getSettings(),o=`${t}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Sl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let l,u;if(typeof n.mockUserToken=="string")l=n.mockUserToken,u=sn.MOCK_USER;else{l=Yb(n.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new Ge(xe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new sn(h)}e._authCredentials=new xM(new sw(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new q0(this.firestore,t,this._query)}}class qn{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ga(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new qn(this.firestore,t,this._key)}}class ga extends q0{constructor(t,r,n){super(t,r,p_(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new qn(this.firestore,null,new $e(t))}withConverter(t){return new ga(this.firestore,t,this._path)}}function eu(e,t,...r){if(e=Ns(e),cS("collection","path",t),e instanceof X0){const n=Yt.fromString(t,...r);return _y(n),new ga(e,null,n)}{if(!(e instanceof qn||e instanceof ga))throw new Ge(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Yt.fromString(t,...r));return _y(n),new ga(e.firestore,null,n)}}function gh(e,t,...r){if(e=Ns(e),arguments.length===1&&(t=aw.newId()),cS("doc","path",t),e instanceof X0){const n=Yt.fromString(t,...r);return gy(n),new qn(e,null,new $e(n))}{if(!(e instanceof qn||e instanceof ga))throw new Ge(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Yt.fromString(t,...r));return gy(n),new qn(e.firestore,e instanceof ga?e.converter:null,new $e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Vw(this,"async_queue_retry"),this.Vu=()=>{const n=Yd();n&&He("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=t;const r=Yd();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const r=Yd();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Ss;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!qu(t))throw t;He("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const r=this.mu.then(()=>(this.du=!0,t().catch(n=>{this.Eu=n,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(n);throw Ls("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(t,r,n){this.fu(),this.Ru.indexOf(t)>-1&&(r=0);const i=C_.createAndSchedule(this,t,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&it()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const r of this.Tu)if(r.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const r=this.Tu.indexOf(t);this.Tu.splice(r,1)}}class tf extends X0{constructor(t,r,n,i){super(t,r,n,i),this.type="firestore",this._queue=new xy,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new xy(t),this._firestoreClient=void 0,await t}}}function n9(e,t){const r=typeof e=="object"?e:aM(),n=typeof e=="string"?e:"(default)",i=rM(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=Xb("firestore");s&&r9(i,...s)}return i}function Y0(e){if(e._terminated)throw new Ge(xe.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||i9(e),e._firestoreClient}function i9(e){var t,r,n;const i=e._freezeSettings(),s=function(l,u,h,p){return new FM(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,lS(p.experimentalLongPollingOptions),p.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new q8(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Nl(Yr.fromBase64String(t))}catch(r){throw new Ge(xe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new Nl(Yr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Ge(xe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Ge(xe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Ge(xe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return It(this._lat,t._lat)||It(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s9=/^__.*__$/;class a9{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new Ra(t,this.data,this.fieldMask,r,this.fieldTransforms):new Yu(t,this.data,r,this.fieldTransforms)}}class uS{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return new Ra(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function fS(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it()}}class F_{constructor(t,r,n,i,s,o){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(t){return new F_(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),i=this.Fu({path:n,xu:!1});return i.Ou(t),i}Nu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(t){return this.Fu({path:void 0,xu:!0})}Bu(t){return f0(t,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ou(this.path.get(t))}Ou(t){if(t.length===0)throw this.Bu("Document fields must not be empty");if(fS(this.Cu)&&s9.test(t))throw this.Bu('Document fields cannot begin and end with "__"')}}class o9{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||$0(t)}Qu(t,r,n,i=!1){return new F_({Cu:t,methodName:r,qu:n,path:Gr.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function hS(e){const t=e._freezeSettings(),r=$0(e._databaseId);return new o9(e._databaseId,!!t.ignoreUndefinedProperties,r)}function dS(e,t,r,n,i,s={}){const o=e.Qu(s.merge||s.mergeFields?2:0,t,r,i);b_("Data must be an object, but it was:",o,n);const l=pS(n,o);let u,h;if(s.merge)u=new Kn(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const p=[];for(const m of s.mergeFields){const _=Lm(t,m,r);if(!o.contains(_))throw new Ge(xe.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);gS(p,_)||p.push(_)}u=new Kn(p),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new a9(new Ln(l),u,h)}class Q0 extends O_{_toFieldTransform(t){if(t.Cu!==2)throw t.Cu===1?t.Bu(`${this._methodName}() can only appear at the top level of your update data`):t.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Q0}}function l9(e,t,r,n){const i=e.Qu(1,t,r);b_("Data must be an object, but it was:",i,n);const s=[],o=Ln.empty();go(n,(u,h)=>{const p=M_(t,u,r);h=Ns(h);const m=i.Nu(p);if(h instanceof Q0)s.push(p);else{const _=ed(h,m);_!=null&&(s.push(p),o.set(p,_))}});const l=new Kn(s);return new uS(o,l,i.fieldTransforms)}function c9(e,t,r,n,i,s){const o=e.Qu(1,t,r),l=[Lm(t,n,r)],u=[i];if(s.length%2!=0)throw new Ge(xe.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)l.push(Lm(t,s[_])),u.push(s[_+1]);const h=[],p=Ln.empty();for(let _=l.length-1;_>=0;--_)if(!gS(h,l[_])){const v=l[_];let E=u[_];E=Ns(E);const y=o.Nu(v);if(E instanceof Q0)h.push(v);else{const w=ed(E,y);w!=null&&(h.push(v),p.set(v,w))}}const m=new Kn(h);return new uS(p,m,o.fieldTransforms)}function ed(e,t){if(mS(e=Ns(e)))return b_("Unsupported field value:",t,e),pS(e,t);if(e instanceof O_)return function(n,i){if(!fS(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&t.Cu!==4)throw t.Bu("Nested arrays are not supported");return function(n,i){const s=[];let o=0;for(const l of n){let u=ed(l,i.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(e,t)}return function(n,i){if((n=Ns(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return i5(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Pr.fromDate(n);return{timestampValue:l0(i.serializer,s)}}if(n instanceof Pr){const s=new Pr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:l0(i.serializer,s)}}if(n instanceof L_)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Nl)return{bytesValue:Nw(i.serializer,n._byteString)};if(n instanceof qn){const s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:x_(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof D_)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return m_(l.serializer,u)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${N_(n)}`)}(e,t)}function pS(e,t){const r={};return ow(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):go(e,(n,i)=>{const s=ed(i,t.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function mS(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Pr||e instanceof L_||e instanceof Nl||e instanceof qn||e instanceof O_||e instanceof D_)}function b_(e,t,r){if(!mS(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=N_(r);throw n==="an object"?t.Bu(e+" a custom object"):t.Bu(e+" "+n)}}function Lm(e,t,r){if((t=Ns(t))instanceof J0)return t._internalPath;if(typeof t=="string")return M_(e,t);throw f0("Field path arguments must be of type string or ",e,!1,void 0,r)}const u9=new RegExp("[~\\*/\\[\\]]");function M_(e,t,r){if(t.search(u9)>=0)throw f0(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new J0(...t.split("."))._internalPath}catch{throw f0(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function f0(e,t,r,n,i){const s=n&&!n.isEmpty(),o=i!==void 0;let l=`Function ${t}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${n}`),o&&(u+=` in document ${i}`),u+=")"),new Ge(xe.INVALID_ARGUMENT,l+e+u)}function gS(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(t,r,n,i,s){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new f9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(vS("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class f9 extends _S{data(){return super.data()}}function vS(e,t){return typeof t=="string"?M_(e,t):t instanceof J0?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h9(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Ge(xe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class d9{convertValue(t,r="none"){switch(so(t)){case 0:return null;case 1:return t.booleanValue;case 2:return fr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(io(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw it()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return go(t,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(t){var r,n,i;const s=(i=(n=(r=t.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>fr(o.doubleValue));return new D_(s)}convertGeoPoint(t){return new L_(fr(t.latitude),fr(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=u_(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Ou(t));default:return null}}convertTimestamp(t){const r=Ta(t);return new Pr(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=Yt.fromString(t);Lt(Mw(n));const i=new Lu(n.get(1),n.get(3)),s=new $e(n.popFirst(5));return i.isEqual(r)||Ls(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class yS extends _S{constructor(t,r,n,i,s,o){super(t,r,n,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new _h(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(vS("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class _h extends yS{data(t={}){return super.data(t)}}class p9{constructor(t,r,n,i){this._firestore=t,this._userDataWriter=r,this._snapshot=i,this.metadata=new Nc(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new _h(this._firestore,this._userDataWriter,n.key,n,new Nc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ge(xe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const u=new _h(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Nc(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new _h(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Nc(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),p=o.indexOf(l.doc.key)),{type:m9(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function m9(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g9(e){e=wa(e,qn);const t=wa(e.firestore,tf);return Q8(Y0(t),e._key).then(r=>v9(t,e,r))}class ES extends d9{constructor(t){super(),this.firestore=t}convertBytes(t){return new Nl(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new qn(this.firestore,null,r)}}function Dm(e){e=wa(e,q0);const t=wa(e.firestore,tf),r=Y0(t),n=new ES(t);return h9(e._query),e9(r,e._query).then(i=>new p9(t,n,e,i))}function _9(e,t,r){e=wa(e,qn);const n=wa(e.firestore,tf),i=xS(e.converter,t,r);return TS(n,[dS(hS(n),"setDoc",e._key,i,e.converter!==null,r).toMutation(e._key,vi.none())])}function TS(e,t){return function(n,i){const s=new Ss;return n.asyncQueue.enqueueAndForget(async()=>j8(await J8(n),i,s)),s.promise}(Y0(e),t)}function v9(e,t,r){const n=r.docs.get(t._key),i=new ES(e);return new yS(e,i,t._key,n,new Nc(r.hasPendingWrites,r.fromCache),t.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(t,r){this._firestore=t,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=hS(t)}set(t,r,n){this._verifyNotCommitted();const i=Qd(t,this._firestore),s=xS(i.converter,r,n),o=dS(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,vi.none())),this}update(t,r,n,...i){this._verifyNotCommitted();const s=Qd(t,this._firestore);let o;return o=typeof(r=Ns(r))=="string"||r instanceof J0?c9(this._dataReader,"WriteBatch.update",s._key,r,n,i):l9(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(o.toMutation(s._key,vi.exists(!0))),this}delete(t){this._verifyNotCommitted();const r=Qd(t,this._firestore);return this._mutations=this._mutations.concat(new g_(r._key,vi.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ge(xe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Qd(e,t){if((e=Ns(e)).firestore!==t)throw new Ge(xe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AS(e){return Y0(e=wa(e,tf)),new x9(e,t=>TS(e,t))}(function(t,r=!0){(function(i){Vl=i})(sM),r0(new Ru("firestore",(n,{instanceIdentifier:i,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new tf(new yM(n.getProvider("auth-internal")),new wM(n.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ge(xe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lu(h.options.projectId,p)}(o,i),o);return s=Object.assign({useFetchStreams:r},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),pl(Bx,"4.7.3",t),pl(Bx,"4.7.3","esm2017")})();const y9={apiKey:"AIzaSyBH--1LKAUn0oBTbVX6W_YOkrXhkBjNork",authDomain:"mapainternos.firebaseapp.com",projectId:"mapainternos",storageBucket:"mapainternos.firebasestorage.app",messagingSenderId:"433575120554",appId:"1:433575120554:web:309328a519284a9f818ad3",measurementId:"G-FW611VFQGL"},E9=qA(y9),vs=n9(E9),Fr="#195c97",il="#329584",Kt="#ffffff",T9="#f8f9fa",ep=e=>e.replace(/[^a-zA-Z0-9]/g,"_"),A9=`
 body { margin: 0; background-color: ${Kt}; color: #333; font-family: 'Segoe UI', sans-serif; }
 
 /* Scrollbar simple para tema claro */
 .custom-scrollbar::-webkit-scrollbar { width: 6px; }
 .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
 .custom-scrollbar::-webkit-scrollbar-thumb { background: #ccc; border-radius: 10px; }
 .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #999; }
 
 /* Tooltip para las etiquetas del mapa */
 .leaflet-tooltip.label-mapa {
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid ${Fr};
  color: #333; 
  font-weight: 700; 
  font-size: 11px;
  border-radius: 6px; 
  padding: 2px 8px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  backdrop-filter: blur(4px);
 }
 .leaflet-tooltip-bottom:before { border-bottom-color: rgba(255, 255, 255, 0.95); }
 
 .fade-in { animation: fadeIn 0.4s ease-out; }
 @keyframes fadeIn { from { opacity: 0; transform { translateY(5px); } } to { opacity: 1; transform { translateY(0); } } }

 .chart-bar-bg { background: #e0e0e0; border-radius: 4px; height: 8px; overflow: hidden; width: 100%; margin-top: 4px; }
 .chart-bar-fill { height: 100%; border-radius: 4px; transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1); }

 /* Estilos para el nuevo buscador de sedes (Profesional) */
 .autocomplete-container { position: relative; width: 100%; }
 .autocomplete-list { 
  position: absolute; 
  top: calc(100% + 5px); 
  left: 0; 
  right: 0; 
  z-index: 1000; 
  background-color: ${Kt}; 
  border: 1px solid ${Fr}; 
  max-height: 250px; 
  overflow-y: auto; 
  box-shadow: 0 6px 12px rgba(0,0,0,0.2);
  border-radius: 6px; 
 }
 .autocomplete-item {
  padding: 10px 12px;
  cursor: pointer;
  font-size: 13px;
  color: #333;
  border-bottom: 1px solid #f0f0f0;
  display: block; 
 }
 .autocomplete-item:last-child { border-bottom: none; }
 .autocomplete-item:hover { background-color: #e6f7ff; color: ${Fr}; }
 .autocomplete-item-details { 
    font-size: 10px; 
    font-weight: 600; 
    display: block; 
    margin-top: 2px;
    color: #666; 
}
 /* Estilo para el elemento seleccionado en la lista (para asegurar visibilidad) */
 .centro-seleccionado {
  background-color: #e6f7ff !important;
  border-color: ${Fr} !important;
 }
`,Ho={"RIS 1":"#10b981","RIS 2":"#facc15","RIS 3":"#f97316","RIS 4":"#3b82f6","RIS 5":"#ef4444","RIS 6":"#8b5cf6","RIS 7":"#ec4899",DEFAULT:"#64748b","SIN RIS":"#94a3b8",HOSPITAL:"#f43f5e",INSTITUTO:"#a855f7"},wS={LIMA:"RIS 1","CERCADO DE LIMA":"RIS 1",BREA:"RIS 2","JESUS MARIA":"RIS 2","PUEBLO LIBRE":"RIS 2","MAGDALENA DEL MAR":"RIS 3","SAN MIGUEL":"RIS 3",LINCE:"RIS 4","SAN ISIDRO":"RIS 4",MIRAFLORES:"RIS 4","SAN BORJA":"RIS 4",SURQUILLO:"RIS 4","LA VICTORIA":"RIS 5","SAN LUIS":"RIS 5","EL AGUSTINO":"RIS 5","SANTA ANITA":"RIS 5","SAN JUAN DE LURIGANCHO":"RIS 6",RIMAC:"RIS 7",INDEPENDENCIA:"RIS 7",COMAS:"RIS 7"},w9=Object.keys(wS).sort(),Qf=(e,t="")=>{const r=t.toUpperCase();if(r.startsWith("HOSPITAL"))return Ho.HOSPITAL;if(r.startsWith("INSTITUTO"))return Ho.INSTITUTO;const n=Object.keys(Ho).find(i=>(e||"").toUpperCase().includes(i));return n?Ho[n]:Ho.DEFAULT},S9={claro:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",satelite:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"},Xs=e=>e?String(e).toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^A-Z0-9 ]/g,"").trim():"",I9=(e,t)=>{const r=Xs(e).replace(/\s+/g,""),n=Xs(t).replace(/\s+/g,"");return r===n?1:r.includes(n)||n.includes(r)?.95:0},yy=e=>e?typeof e=="number"?new Date(Math.round((e-25569)*86400*1e3)).toLocaleDateString("es-PE",{day:"2-digit",month:"2-digit",year:"numeric"}):String(e).trim():"",Ey=e=>!e.startsWith("HS ")&&!e.startsWith("INST ")&&!e.startsWith("HOSPITAL")&&!e.startsWith("INSTITUTO"),C9=["PRIVADA DEL NORTE","CSAR VALLEJO","MAYOR DE SAN MARCOS","SAN MARTIN DE PORRES","PERUANA CAYETANO HEREDIA","CONTINENTAL","NORBERT WIENER","CIENTIFICA DEL SUR","RICARDO PALMA","CIENCIAS Y HUMANIDADES","DANIEL ALCIDES CARRION","FEDERICO VILLARREAL","TECNOLGICA DEL PER","SAN JUAN BAUTISTA","MARIA AUXILIADORA","PERUANA DE CIENCIAS APLICADAS","LE CORDON BLEU","ENRIQUE GUZMAN Y VALLE","CATOLICA SEDES SAPIENTIAE","PERUANA UNION","PIURA","ALTIPLANO DE PUNO","HERMILIO VALDIZAN"],k9=["OBSTETRICIA","ENFERMERIA","PSICOLOGA","MEDICINA HUMANA","LABORATORIO CLINICO Y ANATOMIA PATOLOGICA","NUTRICION","ODONTOLOGA","BIOLOGIA","RADIOLOGIA","TERAPIA FISICA Y REHABILITACIN","TERAPIA OCUPACIONAL","TERAPIA DE LENGUAJE","OPTOMETRA"],Ty=e=>{const t=e.toUpperCase();return t.includes("PRIMERA")||t.includes("1RA")||t==="1"?1:t.includes("SEGUNDA")||t.includes("2DA")||t==="2"?2:t.includes("TERCERA")||t.includes("3RA")||t==="3"?3:99},xc=[{id:"r1_1",ris:"RIS 1",nombre:"CS CONDE DE LA VEGA",lat:-12.038921,lng:-77.050464,distrito:"CERCADO DE LIMA"},{id:"r1_2",ris:"RIS 1",nombre:"CS CONTROL DE ZOONOSIS",lat:-12.049798,lng:-77.06224,distrito:"CERCADO DE LIMA"},{id:"r1_3",ris:"RIS 1",nombre:"CS ITS Y VIH RAUL PATRUCCO PUIG",lat:-12.052736,lng:-77.022955,distrito:"LA VICTORIA"},{id:"r1_4",ris:"RIS 1",nombre:"CS JUAN PEREZ CARRANZA",lat:-12.053413,lng:-77.022688,distrito:"LA VICTORIA"},{id:"r1_5",ris:"RIS 1",nombre:"CS MIRONES",lat:-12.050879,lng:-77.067292,distrito:"CERCADO DE LIMA"},{id:"r1_6",ris:"RIS 1",nombre:"CS MIRONES BAJO",lat:-12.050897,lng:-77.067321,distrito:"CERCADO DE LIMA"},{id:"r1_7",ris:"RIS 1",nombre:"CS SAN SEBASTIAN",lat:-12.042331,lng:-77.038673,distrito:"CERCADO DE LIMA"},{id:"r1_8",ris:"RIS 1",nombre:"CS UNIDAD VECINAL N3",lat:-12.051273,lng:-77.08233,distrito:"CERCADO DE LIMA"},{id:"r1_9",ris:"RIS 1",nombre:"CS VILLA MARIA DEL PERPETUO SOCORRO",lat:-12.037751,lng:-77.054586,distrito:"CERCADO DE LIMA"},{id:"r1_11",ris:"RIS 1",nombre:"CSMC MIRONES BAJO",lat:-12.037769,lng:-77.081481,distrito:"CERCADO DE LIMA"},{id:"r1_12",ris:"RIS 1",nombre:"CSMC SAN MARCOS",lat:-12.055392,lng:-77.082387,distrito:"PUEBLO LIBRE"},{id:"r1_13",ris:"RIS 1",nombre:"PS PALERMO",lat:-12.040929,lng:-77.068914,distrito:"CERCADO DE LIMA"},{id:"r1_14",ris:"RIS 1",nombre:"PS RESCATE",lat:-12.041065,lng:-77.062272,distrito:"CERCADO DE LIMA"},{id:"r1_15",ris:"RIS 1",nombre:"PS SANTA ROSA",lat:-12.044848,lng:-77.111266,distrito:"CALLAO"},{id:"r2_1",ris:"RIS 2",nombre:"CS BREA",lat:-12.063762,lng:-77.057869,distrito:"BREA"},{id:"r2_2",ris:"RIS 2",nombre:"CS CHACRA COLORADA",lat:-12.053863,lng:-77.048067,distrito:"BREA"},{id:"r2_3",ris:"RIS 2",nombre:"CS HUACA PANDO",lat:-12.061594,lng:-77.083254,distrito:"PUEBLO LIBRE"},{id:"r2_4",ris:"RIS 2",nombre:"CS JESUS MARIA",lat:-12.077688,lng:-77.053306,distrito:"JESUS MARIA"},{id:"r2_5",ris:"RIS 2",nombre:"CS SAN MIGUEL",lat:-12.081167,lng:-77.09853,distrito:"SAN MIGUEL"},{id:"r2_6",ris:"RIS 2",nombre:"CSM EXCELENCIA SAN MIGUEL",lat:-12.081396,lng:-77.101266,distrito:"SAN MIGUEL"},{id:"r2_7",ris:"RIS 2",nombre:"CSMC HONORIO DELGADO",lat:-12.069174,lng:-77.058068,distrito:"BREA"},{id:"r2_8",ris:"RIS 2",nombre:"CSMC JESUS MARIA",lat:-12.07406,lng:-77.043524,distrito:"JESUS MARIA"},{id:"r2_9",ris:"RIS 2",nombre:"CSMC MAGDALENA",lat:-12.088394,lng:-77.063122,distrito:"MAGDALENA DEL MAR"},{id:"r2_10",ris:"RIS 2",nombre:"CSMI MAGDALENA",lat:-12.088383,lng:-77.06876,distrito:"MAGDALENA DEL MAR"},{id:"r2_11",ris:"RIS 2",nombre:"LABORATORIO REFERENCIAL",lat:-12.088656,lng:-77.067946,distrito:"MAGDALENA DEL MAR"},{id:"r3_1",ris:"RIS 3",nombre:"CS LINCE",lat:-12.081669,lng:-77.031994,distrito:"LINCE"},{id:"r3_2",ris:"RIS 3",nombre:"CS SAM ATANACIO DE PEDREGAL",lat:-12.1209,lng:-76.998887,distrito:"SURQUILLO"},{id:"r3_3",ris:"RIS 3",nombre:"CS SAN ISIDRO",lat:-12.106575,lng:-77.05512,distrito:"SAN ISIDRO"},{id:"r3_4",ris:"RIS 3",nombre:"CS SANTA CRUZ MIRAFLORES",lat:-12.118628,lng:-77.036754,distrito:"MIRAFLORES"},{id:"r3_5",ris:"RIS 3",nombre:"CS VILLA VICTORIA PORVENIR",lat:-12.10857,lng:-77.012094,distrito:"SURQUILLO"},{id:"r3_6",ris:"RIS 3",nombre:"CSMC SAN BORJA",lat:-12.108779,lng:-77.00647,distrito:"SAN BORJA"},{id:"r3_7",ris:"RIS 3",nombre:"CSMC SAN ISIDRO",lat:-12.107595,lng:-77.050509,distrito:"SAN ISIDRO"},{id:"r3_8",ris:"RIS 3",nombre:"CSMC SURQUILLO",lat:-12.118613,lng:-77.019213,distrito:"SURQUILLO"},{id:"r3_9",ris:"RIS 3",nombre:"CSMI SURQUILLO",lat:-12.118262,lng:-77.022244,distrito:"SURQUILLO"},{id:"r4_1",ris:"RIS 4",nombre:"CS EL PINO",lat:-12.066881,lng:-76.998619,distrito:"EL AGUSTINO"},{id:"r4_2",ris:"RIS 4",nombre:"CS MAX ARIAS SCHREIBER",lat:-12.059194,lng:-77.032271,distrito:"LA VICTORIA"},{id:"r4_3",ris:"RIS 4",nombre:"CS SAN COSME",lat:-12.061765,lng:-77.006846,distrito:"LA VICTORIA"},{id:"r4_4",ris:"RIS 4",nombre:"CS SAN LUIS",lat:-12.07445,lng:-76.997255,distrito:"SAN LUIS"},{id:"r4_5",ris:"RIS 4",nombre:"CS TODOS LOS SANTOS SAN BORJA",lat:-12.101842,lng:-76.993428,distrito:"SAN BORJA"},{id:"r4_6",ris:"RIS 4",nombre:"CSMC LA VICTORIA",lat:-12.071107,lng:-77.013469,distrito:"LA VICTORIA"},{id:"r4_7",ris:"RIS 4",nombre:"CSMC SAN COSME",lat:-12.061978,lng:-77.005306,distrito:"LA VICTORIA"},{id:"r4_8",ris:"RIS 4",nombre:"CSMI EL PORVENIR",lat:-12.067469,lng:-77.020826,distrito:"LA VICTORIA"},{id:"r4_9",ris:"RIS 4",nombre:"PS EL PINO",lat:-12.06586,lng:-77.002467,distrito:"EL AGUSTINO"},{id:"r4_10",ris:"RIS 4",nombre:"PS JARDN ROSA DE SANTA MARA",lat:-12.044257,lng:-77.01443,distrito:"EL AGUSTINO"},{id:"r4_11",ris:"RIS 4",nombre:"PS SAN JUAN MASIAS",lat:-12.084071,lng:-77.00246,distrito:"SAN LUIS"},{id:"r5_1",ris:"RIS 5",nombre:"CS CAJA DE AGUA",lat:-12.026599,lng:-77.014879,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_2",ris:"RIS 5",nombre:"CS CAMPOY",lat:-12.016004,lng:-76.965389,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_3",ris:"RIS 5",nombre:"CS CHACARILLA DE OTERO",lat:-12.020881,lng:-77.006867,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_4",ris:"RIS 5",nombre:"CS DANIEL ALCIDES CARRION",lat:-12.023003,lng:-76.977023,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_5",ris:"RIS 5",nombre:"CS LA HUAYRONA",lat:-11.993822,lng:-77.00658,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_6",ris:"RIS 5",nombre:"CS LA LIBERTAD",lat:-12.003994,lng:-76.995829,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_7",ris:"RIS 5",nombre:"CS MANGOMARCA",lat:-12.010634,lng:-76.979585,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_8",ris:"RIS 5",nombre:"CS SAN FERNANDO",lat:-12.0023,lng:-77.010607,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_9",ris:"RIS 5",nombre:"CS SANTA FE DE TOTORITA",lat:-11.996876,lng:-76.996041,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_10",ris:"RIS 5",nombre:"CS SANTA ROSA DE LIMA",lat:-12.005101,lng:-77.016472,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_11",ris:"RIS 5",nombre:"CS ZARATE",lat:-12.022964,lng:-76.994557,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_12",ris:"RIS 5",nombre:"CSMC JAVIER MARIATEGUI",lat:-12.017147,lng:-77.000884,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_13",ris:"RIS 5",nombre:"CSMC MANGOMARCA",lat:-12.019114,lng:-76.984995,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_14",ris:"RIS 5",nombre:"CSMC VILLA CAMPOY",lat:-12.007232,lng:-76.965202,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_15",ris:"RIS 5",nombre:"PS 15 DE ENERO",lat:-12.010915,lng:-77.01859,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_16",ris:"RIS 5",nombre:"PS AZCARRUNZ ALTO",lat:-12.017052,lng:-77.000957,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_1",ris:"RIS 6",nombre:"CS BAYOVAR",lat:-11.951986,lng:-76.991581,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_2",ris:"RIS 6",nombre:"CS GANIMENDES",lat:-11.983037,lng:-77.011447,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_3",ris:"RIS 6",nombre:"CS HUASCAR II",lat:-11.966623,lng:-77.010997,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_4",ris:"RIS 6",nombre:"CS HUASCAR XV",lat:-11.955447,lng:-77.002372,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_5",ris:"RIS 6",nombre:"CS MEDALLA MILAGROSA",lat:-11.976887,lng:-77.006001,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_6",ris:"RIS 6",nombre:"CS SAN HILARION",lat:-11.995438,lng:-77.01583,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_7",ris:"RIS 6",nombre:"CSMC JAIME ZUBIETA",lat:-11.962834,lng:-76.98873,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_8",ris:"RIS 6",nombre:"CSMC NUEVO PER",lat:-12.0029,lng:-77.018166,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_9",ris:"RIS 6",nombre:"PS AYACUCHO",lat:-11.987161,lng:-77.017107,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_10",ris:"RIS 6",nombre:"PS PROYECTOS ESPECIALES",lat:-11.955769,lng:-76.992456,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_11",ris:"RIS 6",nombre:"PS SAGRADA FAMILIA",lat:-11.976341,lng:-76.988859,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_1",ris:"RIS 7",nombre:"CS 10 DE OCTUBRE",lat:-11.944904,lng:-76.987643,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_2",ris:"RIS 7",nombre:"CS CRUZ DE MOTUPE",lat:-11.940364,lng:-76.974795,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_3",ris:"RIS 7",nombre:"CS ENRIQUE MONTENEGRO",lat:-11.937029,lng:-76.971134,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_4",ris:"RIS 7",nombre:"CS JAIME ZUBIETA",lat:-11.963164,lng:-76.988935,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_5",ris:"RIS 7",nombre:"CS JOSE CARLOS MARIATEGUI",lat:-11.94384,lng:-76.984472,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_6",ris:"RIS 7",nombre:"CS JUAN PABLO II",lat:-11.952272,lng:-77.077927,distrito:"SAN MARTIN DE PORRES"},{id:"r7_7",ris:"RIS 7",nombre:"CS SANTA MARIA",lat:-11.964929,lng:-76.975984,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_8",ris:"RIS 7",nombre:"PS CESAR VALLEJO",lat:-11.939452,lng:-76.965759,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_9",ris:"RIS 7",nombre:"PS JOSE CARLOS MARIATEGUI V ETAPA",lat:-11.931092,lng:-76.990411,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_10",ris:"RIS 7",nombre:"PS MARISCAL CACERES",lat:-11.949206,lng:-76.98108,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_11",ris:"RIS 7",nombre:"PS TUPAC AMARU II",lat:-11.955745,lng:-76.975792,distrito:"SAN JUAN DE LURIGANCHO"},{id:"h_1",ris:"SIN RIS",nombre:"HOSPITAL NACIONAL DOS DE MAYO",lat:-12.056369,lng:-77.016048,tipo:"HOSPITAL",distrito:"CERCADO DE LIMA"},{id:"h_2",ris:"SIN RIS",nombre:"HOSPITAL NACIONAL ARZOBISPO LOAYZA",lat:-12.049516,lng:-77.042667,tipo:"HOSPITAL",distrito:"CERCADO DE LIMA"},{id:"h_3",ris:"SIN RIS",nombre:"HOSPITAL SAN JUAN DE LURIGANCHO",lat:-11.966064,lng:-77.003482,tipo:"HOSPITAL",distrito:"SAN JUAN DE LURIGANCHO"},{id:"h_4",ris:"SIN RIS",nombre:"HOSPITAL NACIONAL SAN BARTOLOME",lat:-12.049583,lng:-77.04211,tipo:"HOSPITAL",distrito:"CERCADO DE LIMA"},{id:"h_5",ris:"SIN RIS",nombre:"HOSPITAL DE EMERGENCIAS JOSE CASIMIRO ULLOA",lat:-12.127835,lng:-77.017796,tipo:"HOSPITAL",distrito:"MIRAFLORES"},{id:"h_6",ris:"SIN RIS",nombre:"HOSPITAL SANTA ROSA",lat:-12.071516,lng:-77.06107,tipo:"HOSPITAL",distrito:"PUEBLO LIBRE"},{id:"h_7",ris:"SIN RIS",nombre:"HOSPITAL VICTOR LARCO HERRERA",lat:-12.097315,lng:-77.064832,tipo:"HOSPITAL",distrito:"MAGDALENA DEL MAR"},{id:"h_8",ris:"SIN RIS",nombre:"HOSPITAL DE EMERGENCIAS PEDITRICAS",lat:-12.058125,lng:-77.021607,tipo:"HOSPITAL",distrito:"LA VICTORIA"},{id:"i_1",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE ENFERMEDADES NEOPLSICAS",lat:-12.11232,lng:-76.998266,tipo:"INSTITUTO",distrito:"SAN BORJA"},{id:"i_2",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE SALUD DEL NIO-BREA",lat:-12.064247,lng:-77.04572,tipo:"INSTITUTO",distrito:"BREA"},{id:"i_3",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE SALUD DEL NIO-SAN BORJA",lat:-12.085823,lng:-76.992491,tipo:"INSTITUTO",distrito:"SAN BORJA"},{id:"i_4",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL MATERNO PERINATAL",lat:-12.052537,lng:-77.022163,tipo:"INSTITUTO",distrito:"CERCADO DE LIMA"},{id:"i_5",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE CIENCIAS NEUROLGICAS",lat:-12.045887,lng:-77.015878,tipo:"INSTITUTO",distrito:"CERCADO DE LIMA"}],R9=({center:e,zoom:t})=>{const r=iT();return _e.useEffect(()=>{r.flyTo(e,t,{duration:1.5})},[e,t,r]),null},Ay=({data:e})=>{const t=Ka.useMemo(()=>{const n={},i={};e.forEach(o=>{var l;(l=o.detallesVisuales)==null||l.forEach(u=>{const h=u.carrera||"OTROS",p=u.universidad||"OTROS";n[h]=(n[h]||0)+1,i[p]=(i[p]||0)+1})});const s=(o,l)=>l[1]-o[1];return{carreras:Object.entries(n).sort(s),universidades:Object.entries(i).sort(s)}},[e]),r=(n,i,s,o)=>W.jsxs("div",{style:{marginBottom:"8px",display:"flex",alignItems:"center",fontSize:"11px"},children:[W.jsx("div",{style:{width:"120px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"#666",textAlign:"right",paddingRight:"10px"},children:n}),W.jsx("div",{style:{flex:1,background:"#e0e0e0",height:"8px",borderRadius:"4px",overflow:"hidden"},children:W.jsx("div",{style:{width:`${i/s*100}%`,background:o,height:"100%",borderRadius:"4px"}})}),W.jsx("div",{style:{width:"30px",paddingLeft:"10px",fontWeight:"700",color:"#333"},children:i})]},n);return e.length===0?W.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#999",fontSize:"12px"},children:"No hay datos para mostrar."}):W.jsxs("div",{className:"fade-in",children:[W.jsxs("div",{style:{marginBottom:"20px"},children:[W.jsx("h4",{style:{color:Fr,fontSize:"10px",fontWeight:"800",textTransform:"uppercase",marginBottom:"10px",borderBottom:"1px solid #ddd",paddingBottom:"5px"},children:"Por Carrera"}),t.carreras.map(([n,i])=>r(n,i,t.carreras[0][1],Fr))]}),W.jsxs("div",{children:[W.jsx("h4",{style:{color:il,fontSize:"10px",fontWeight:"800",textTransform:"uppercase",marginBottom:"10px",borderBottom:"1px solid #ddd",paddingBottom:"5px"},children:"Por Universidad"}),t.universidades.map(([n,i])=>r(n,i,t.universidades[0][1],il))]})]})},P9=()=>{const e=K2(),t=_e.useRef(null);_e.useEffect(()=>{const ee=document.createElement("style");return ee.innerHTML=A9,document.head.appendChild(ee),()=>{document.head.removeChild(ee)}},[]);const[r,n]=_e.useState(null),[i,s]=_e.useState([-12.05,-77.06]),[o,l]=_e.useState(12),[u,h]=_e.useState("claro"),[p,m]=_e.useState("lista"),[_,v]=_e.useState("todos"),[E,y]=_e.useState("todos"),[w,k]=_e.useState(""),[C,A]=_e.useState("todas"),[U,q]=_e.useState("todas"),[K,S]=_e.useState(""),[R,P]=_e.useState([]),[D,F]=_e.useState([]),[b,M]=_e.useState(null),[Ce,Ie]=_e.useState([]),[Re,ke]=_e.useState([]),fe=_e.useRef(null);_e.useEffect(()=>{fetch("https://raw.githubusercontent.com/yurivilc/peru-geojson/master/lima_callao_distritos.geojson").then(ee=>ee.json()).then(ee=>n(ee)).catch(console.error),j()},[]),_e.useEffect(()=>{if(K.length>2){const ee=Xs(K),me=D.filter(Fe=>Xs(Fe.nombre).includes(ee));P(me)}else P([])},[K,D]);const te=ee=>{ee.lat&&ee.lng&&ee.lat!==0&&ee.lng!==0&&(s([ee.lat,ee.lng]),l(16)),M(ee.nombre),setTimeout(()=>{const me=document.getElementById(`centro-${ep(ee.nombre)}`);me&&t.current&&me.scrollIntoView({behavior:"smooth",block:"nearest"})},100),S(""),P([])},de=ee=>{const me=ee.properties.NOMBDIST||ee.properties.NOMB_DIST||"",Fe=Xs(me),H=wS[Fe]||"DEFAULT",Ve=Ho[H],je=(_==="todos"||H===_)&&(E==="todos"||Fe===Xs(E));return{fillColor:Ve,weight:H!=="DEFAULT"?1:.5,opacity:1,color:Kt,fillOpacity:je?.5:.1}},Ee=ee=>{const me=new Set,Fe=new Set;ee.forEach(H=>{var Ve;return(Ve=H.detalles)==null?void 0:Ve.forEach(je=>{je.universidad&&je.universidad!=="SIN UNIVERSIDAD"&&me.add(je.universidad),je.carrera&&je.carrera!=="SIN CARRERA"&&Fe.add(je.carrera)})}),Ie(Array.from(me).sort()),ke(Array.from(Fe).sort())},j=async()=>{try{const me=(await Dm(eu(vs,"centros"))).docs.map(Ve=>({id:Ve.id,...Ve.data(),detalles:Ve.data().detalles||[]})),Fe={};me.forEach(Ve=>{Fe[Ve.nombre]=Ve});let H=xc.map(Ve=>{const je=Fe[Ve.nombre];return je?{...Ve,...je}:{...Ve,cantidad:0,detalles:[]}});me.forEach(Ve=>{H.find(je=>je.nombre===Ve.nombre)||H.push(Ve)}),F(H),Ee(H)}catch(ee){console.error("Error:",ee),F(xc.map(me=>({...me,cantidad:0,detalles:[]})))}},re=async ee=>{var H;const me=(H=ee.target.files)==null?void 0:H[0];if(!me)return;const Fe=new FileReader;Fe.onload=async Ve=>{var je;try{const tt=(je=Ve.target)==null?void 0:je.result,Ze=fm(tt,{type:"array"}),Pe=Ze.Sheets[Ze.SheetNames[0]],ne=Ub.sheet_to_json(Pe,{defval:""});if(ne.length===0){alert("Excel vaco.");return}const De=ne[0],Me=Object.keys(De),Qe=Me.find(Ke=>Ke.includes("DNI")),st=Me.find(Ke=>Ke.includes("SEDE")&&Ke.includes("DOCENTE"));if(!st||!Qe){alert(" Error de columnas.");return}const pt={},mt=Me.find(Ke=>Ke.includes("ESTABLECIMIENTO")),dr=Me.find(Ke=>Ke.includes("NOMBRE_ROTACION")),St=Me.find(Ke=>Ke.includes("CARRERA")),Mt=Me.find(Ke=>Ke.includes("UNIVERSIDAD")),Ut=Me.find(Ke=>Ke.includes("FACULTAD")),Nr=Me.find(Ke=>Ke.includes("FECHA")&&Ke.includes("INICIO")),et=Me.find(Ke=>Ke.includes("FECHA")&&(Ke.includes("FIN")||Ke.includes("TERMINO"))),kt=Me.find(Ke=>Ke==="TIPO");ne.forEach(Ke=>{const Vt=String(Ke[Qe]).trim(),pr=String(Ke[st]).trim(),lr=mt?String(Ke[mt]).trim():pr,Cn=dr?String(Ke[dr]).trim():"Rotacin",mn=St?String(Ke[St]).trim().toUpperCase():"SIN CARRERA",Or=Mt?String(Ke[Mt]).trim().toUpperCase():"SIN UNIVERSIDAD",Jr=Ut?String(Ke[Ut]).trim():"",Qr=Nr?yy(Ke[Nr]):"",ri=et?yy(Ke[et]):"",zi=kt?String(Ke[kt]):"";!Vt||Vt==="undefined"||(pt[Vt]||(pt[Vt]={dni:Vt,carrera:mn,universidad:Or,facultad:Jr,rotaciones:[]}),pt[Vt].rotaciones.push({nombre:Cn,establecimiento:lr,fechaInicio:Qr,fechaFin:ri,tipo:zi}))});const Rt={};xc.forEach(Ke=>{Rt[Ke.nombre]={...Ke,cantidad:0,detalles:[]}});let Dt=0,zr=0;const ti=new Set;if(ne.forEach(Ke=>{const Vt=String(Ke[Qe]).trim(),pr=String(Ke[st]).trim();if(!Vt||!pr)return;let lr="",Cn=!1;const mn=xc.find(Or=>Xs(Or.nombre)===Xs(pr));if(mn)lr=mn.nombre,Cn=!0;else{let Or=0,Jr="";xc.forEach(Qr=>{const ri=I9(pr,Qr.nombre);ri>.7&&ri>Or&&(Or=ri,Jr=Qr.nombre)}),Jr&&(lr=Jr,Cn=!0)}if(Cn||(lr=pr,Rt[lr]||(Rt[lr]={id:`auto_${Math.random().toString(36).substr(2,9)}`,ris:"HOSPITALES",nombre:lr,lat:-12.046374,lng:-77.042793,cantidad:0,detalles:[],sinCoordenadas:!0},zr++)),pt[Vt]){const Or=`${lr}-${Vt}`;ti.has(Or)||(Rt[lr].detalles||(Rt[lr].detalles=[]),Rt[lr].cantidad+=1,Rt[lr].detalles.push(pt[Vt]),ti.add(Or),Dt++)}}),confirm(`Procesamiento Finalizado:
 Total Internos: ${Dt}
 Centros Nuevos: ${zr}

Subir a la nube?`)){const Ke=AS(vs);let Vt=0;for(const pr of Object.values(Rt))(pr.cantidad>0||!pr.sinCoordenadas)&&(Ke.set(gh(eu(vs,"centros"),pr.nombre.replace(/[\/\s\.]/g,"_")),pr),Vt++),Vt>=450&&(await Ke.commit(),Vt=0);Vt>0&&await Ke.commit(),alert(" Carga completa."),j()}}catch(tt){console.error(tt),alert("Error al procesar.")}},Fe.readAsArrayBuffer(me)},Q=D.map(ee=>{const Fe=(ee.detalles||[]).filter(H=>{const Ve=w===""||H.dni.includes(w),je=C==="todas"||(H.universidad||"").includes(C),tt=U==="todas"||(H.carrera||"").includes(U);return Ve&&je&&tt}).map(H=>({...H,rotaciones:[...H.rotaciones].sort((Ve,je)=>Ty(Ve.nombre)-Ty(je.nombre))}));return{...ee,cantidadVisual:Fe.length,detallesVisuales:Fe}}).filter(ee=>{const me=_==="todos"||ee.ris&&ee.ris.includes(_),Fe=E==="todos"||ee.distrito&&ee.distrito===E,H=ee.cantidadVisual>0,Ve=b===ee.nombre;return w!==""||C!=="todas"||U!=="todas"?me&&Fe&&H||Ve:me&&Fe||Ve}).sort((ee,me)=>me.cantidadVisual-ee.cantidadVisual),Y=Q.reduce((ee,me)=>ee+me.cantidadVisual,0),le=D.filter(ee=>Ey(ee.nombre)).length,ye=Q.filter(ee=>Ey(ee.nombre)&&ee.cantidadVisual>0).length,Ne=(ee,me,Fe)=>{b===ee?M(null):(M(ee),me!==0&&Fe!==0?(s([me,Fe]),l(16)):(s([-12.05,-77.06]),l(12)),setTimeout(()=>{const H=document.getElementById(`centro-${ep(ee)}`);H&&t.current&&H.scrollIntoView({behavior:"smooth",block:"nearest"})},100))};return W.jsxs("div",{className:"dashboard-container",style:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:Kt,color:"#333"},children:[W.jsxs("div",{style:{background:Fr,padding:"0 24px",height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #104169",zIndex:50},children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[W.jsx("div",{style:{background:il,width:"40px",height:"40px",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center"},children:W.jsx("i",{className:"fas fa-map-marked-alt",style:{fontSize:"20px",color:Kt}})}),W.jsxs("div",{children:[W.jsxs("h1",{style:{margin:0,fontSize:"20px",fontWeight:"800",color:Kt},children:["GEO",W.jsx("span",{style:{color:il},children:"INTERNOS"})," ",W.jsx("span",{style:{color:Kt,fontSize:"14px",border:"1px solid ${BLANCO_PRINCIPAL}",padding:"2px 6px",borderRadius:"4px"},children:"2025"})]}),W.jsx("p",{style:{margin:"2px 0 0 0",fontSize:"11px",color:"#dddddd"},children:"FUENTE - INTERNAO 2025 - UFDI"})]})]}),W.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[W.jsxs("select",{value:u,onChange:ee=>h(ee.target.value),style:{background:Kt,color:Fr,border:"1px solid #ccc",borderRadius:"6px",padding:"8px 16px",fontWeight:"600",fontSize:"12px",cursor:"pointer"},children:[W.jsx("option",{value:"claro",children:"Mapa Claro"}),W.jsx("option",{value:"satelite",children:"Satlite"})]}),W.jsxs("button",{onClick:()=>e("/adjudicacion2026"),style:{background:il,border:"2px solid ${BLANCO_PRINCIPAL}",color:Kt,borderRadius:"6px",padding:"8px 16px",fontWeight:"700",fontSize:"12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},children:["Ir a Adjudicacin 2026 ",W.jsx("i",{className:"fas fa-arrow-right"})]}),W.jsx("button",{onClick:()=>{var ee;return(ee=fe.current)==null?void 0:ee.click()},style:{background:Kt,color:Fr,border:"1px solid ${AZUL_PRINCIPAL}",borderRadius:"6px",padding:"8px 16px",fontWeight:"600",fontSize:"12px",cursor:"pointer"},children:"Actualizar Data 2025"}),W.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:re,style:{display:"none"},ref:fe})]})]}),W.jsxs("div",{style:{padding:"15px 24px",background:Kt,borderBottom:"1px solid #ccc",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",alignItems:"start"},children:[W.jsxs("div",{className:"autocomplete-container",style:{gridColumn:"span 1"},children:[W.jsx("input",{type:"text",placeholder:"Buscar Sede (Hospital/CS/Inst)...",value:K,onChange:ee=>S(ee.target.value),style:{width:"100%",padding:"8px 8px 8px 12px",borderRadius:R.length>0?"6px 6px 0 0":"6px",border:`1px solid ${R.length>0?Fr:"#ccc"}`,background:Kt,color:"#333",fontSize:"13px",boxSizing:"border-box"}}),R.length>0&&W.jsx("div",{className:"autocomplete-list",style:{borderRadius:"0 0 6px 6px",borderTop:"none"},children:R.map(ee=>W.jsxs("div",{className:"autocomplete-item",onClick:()=>te(ee),children:[W.jsx("div",{style:{fontWeight:600},children:ee.nombre}),W.jsxs("span",{className:"autocomplete-item-details",style:{color:Qf(ee.ris,ee.nombre)},children:[ee.distrito," / ",ee.ris==="SIN RIS"?ee.nombre.startsWith("HOSPITAL")?"HOSPITAL":"INSTITUTO":ee.ris]})]},ee.id||ee.nombre))})]}),W.jsx("div",{style:{position:"relative"},children:W.jsx("input",{type:"text",placeholder:"Buscar DNI...",value:w,onChange:ee=>k(ee.target.value),style:{width:"100%",padding:"8px 8px 8px 12px",borderRadius:"6px",border:"1px solid #ccc",background:Kt,color:"#333",fontSize:"13px",boxSizing:"border-box"}})}),W.jsxs("select",{value:E,onChange:ee=>y(ee.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #ccc",background:Kt,color:"#333",fontSize:"13px"},children:[" ",W.jsx("option",{value:"todos",children:" Todos los Distritos"})," ",w9.map(ee=>W.jsx("option",{value:ee,children:ee},ee))," "]}),W.jsxs("select",{value:C,onChange:ee=>A(ee.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #ccc",background:Kt,color:"#333",fontSize:"13px"},children:[" ",W.jsx("option",{value:"todas",children:" Universidades"})," ",C9.map(ee=>W.jsx("option",{value:ee,children:ee},ee))," "]}),W.jsxs("select",{value:U,onChange:ee=>q(ee.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",border:"1px solid #ccc",background:Kt,color:"#333",fontSize:"13px"},children:[" ",W.jsx("option",{value:"todas",children:" Carreras"})," ",k9.map(ee=>W.jsx("option",{value:ee,children:ee},ee))," "]}),W.jsxs("div",{style:{display:"flex",gap:"2px",background:Kt,padding:"2px",borderRadius:"6px",border:"1px solid #ccc"},children:[" ",["todos","RIS 1","RIS 2","RIS 3","RIS 4","RIS 5","RIS 6","RIS 7"].map(ee=>W.jsx("button",{onClick:()=>v(ee),style:{flexGrow:1,padding:"6px 4px",fontSize:"10px",fontWeight:"700",border:"none",borderRadius:"4px",cursor:"pointer",background:_===ee?Qf(ee==="todos"?"DEFAULT":ee):"transparent",color:_===ee?Kt:"#666"},children:ee==="todos"?"ALL":ee.replace("RIS ","R")},ee))," "]})]}),W.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[W.jsx("div",{style:{flex:3,position:"relative",borderRight:"1px solid #ccc"},children:W.jsxs(oT,{center:i,zoom:o,style:{height:"100%",width:"100%",background:"#f0f0f0"},zoomControl:!1,children:[W.jsx(R9,{center:i,zoom:o}),W.jsx(lT,{url:S9[u],attribution:" CARTO"}),r&&W.jsx(aT,{data:r,style:de}),Q.map((ee,me)=>{if(ee.sinCoordenadas)return null;const Fe=b===ee.nombre,H=Qf(ee.ris,ee.nombre),Ve=Fe||E!=="todos"||C!=="todas"||U!=="todas";return W.jsxs(sT,{center:[ee.lat,ee.lng],pathOptions:{color:Fe?Fr:H,fillColor:Fe?Kt:H,fillOpacity:Fe?.3:.8,weight:Fe?3:0,dashArray:Fe?"4,4":""},radius:Fe?10:6,eventHandlers:{click:()=>Ne(ee.nombre,ee.lat,ee.lng)},children:[Ve&&W.jsxs(jh,{direction:"top",offset:[0,-10],opacity:1,permanent:!0,className:"label-mapa",children:[" ",ee.nombre.replace("CS ","").replace("CSMC ","").replace("PS ","")," (",ee.cantidadVisual,") "]}),!Ve&&W.jsxs(jh,{direction:"top",offset:[0,-5],opacity:1,children:[" ",ee.nombre,": ",ee.cantidadVisual," "]})]},me)})]})}),W.jsxs("div",{style:{flex:1,minWidth:"320px",background:T9,display:"flex",flexDirection:"column"},children:[W.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #ccc"},children:[W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px"},children:[W.jsxs("div",{style:{background:"#eee",padding:"12px",borderRadius:"8px",flex:1,marginRight:"10px"},children:[W.jsx("div",{style:{fontSize:"10px",fontWeight:"700",color:Fr,textTransform:"uppercase"},children:"Internos"}),W.jsx("div",{style:{fontSize:"24px",fontWeight:"800",color:"#333"},children:Y})]}),W.jsxs("div",{style:{background:"#eee",padding:"12px",borderRadius:"8px",flex:1},children:[W.jsx("div",{style:{fontSize:"10px",fontWeight:"700",color:il,textTransform:"uppercase"},children:"Sedes"}),W.jsxs("div",{style:{fontSize:"24px",fontWeight:"800",color:"#333"},children:[ye," ",W.jsxs("span",{style:{fontSize:"14px",color:"#999"},children:["/ ",le]})]})]})]}),W.jsxs("div",{style:{display:"flex",background:Kt,borderRadius:"8px",padding:"4px",border:"1px solid #ccc"},children:[W.jsx("button",{onClick:()=>m("lista"),style:{flex:1,padding:"8px",borderRadius:"6px",border:"none",background:p==="lista"?Fr:"transparent",color:p==="lista"?Kt:Fr,fontWeight:"700",cursor:"pointer"},children:"LISTA"}),W.jsx("button",{onClick:()=>m("reportes"),style:{flex:1,padding:"8px",borderRadius:"6px",border:"none",background:p==="reportes"?Fr:"transparent",color:p==="reportes"?Kt:Fr,fontWeight:"700",cursor:"pointer"},children:"REPORTES"})]})]}),W.jsx("div",{ref:t,style:{flex:1,overflowY:"auto",padding:"15px"},className:"custom-scrollbar",children:p==="lista"?Q.map(ee=>{var H;const me=b===ee.nombre,Fe=Qf(ee.ris,ee.nombre);return W.jsxs("div",{id:`centro-${ep(ee.nombre)}`,className:me?"centro-seleccionado":"",style:{marginBottom:"10px",border:`1px solid ${me?Fe:"#eee"}`,borderRadius:"8px",background:Kt,overflow:"hidden"},children:[W.jsxs("div",{onClick:()=>Ne(ee.nombre,ee.lat,ee.lng),style:{padding:"12px 15px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",background:me?`${Fr}10`:"transparent"},children:[W.jsxs("div",{style:{overflow:"hidden",flex:1},children:[W.jsx("div",{style:{fontWeight:"700",color:"#333",fontSize:"13px"},children:ee.nombre}),W.jsx("span",{style:{fontSize:"10px",fontWeight:"700",color:Fe},children:ee.ris})]}),W.jsx("span",{style:{background:"#e0e0e0",color:"#333",fontSize:"11px",fontWeight:"700",padding:"2px 8px",borderRadius:"10px",border:"1px solid #ccc"},children:ee.cantidadVisual})]}),me&&W.jsxs("div",{style:{padding:"0",background:"#f0f0f0",borderTop:"1px solid #eee"},children:[ee.detallesVisuales&&ee.detallesVisuales.length>0&&W.jsx("div",{style:{padding:"15px",background:Kt,borderBottom:"1px solid #eee"},children:W.jsx(Ay,{data:[ee]})}),W.jsx("div",{style:{padding:"15px"},children:(H=ee.detallesVisuales)==null?void 0:H.map((Ve,je)=>W.jsxs("div",{style:{marginBottom:"10px",paddingBottom:"10px",borderBottom:"1px dashed #ccc"},children:[W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",fontWeight:"700",color:"#333",marginBottom:"4px"},children:[W.jsx("span",{children:Ve.dni}),W.jsx("span",{style:{color:Fr},children:Ve.carrera})]}),W.jsx("div",{style:{color:"#666",fontSize:"10px",marginBottom:"8px"},children:Ve.universidad}),W.jsx("div",{style:{paddingLeft:"8px",borderLeft:"2px solid #ccc"},children:Ve.rotaciones.map((tt,Ze)=>W.jsxs("div",{style:{fontSize:"11px",marginBottom:"2px",color:"#333"},children:[W.jsxs("b",{style:{color:Fe},children:[tt.nombre,":"]})," ",tt.establecimiento]},Ze))})]},je))})]})]},ee.nombre)}):W.jsxs("div",{className:"fade-in",children:[W.jsxs("div",{style:{marginBottom:"10px",fontSize:"12px",color:"#666",textAlign:"center",fontStyle:"italic"},children:["Resumen: ",E!=="todos"?E:"Global"]}),W.jsx(Ay,{data:Q})]})})]})]})]})},N9=`
  body { margin: 0; background-color: #f8fafc; color: #334155; font-family: 'Segoe UI', Roboto, sans-serif; }
  
  /* SCROLLBAR */
  .custom-scrollbar::-webkit-scrollbar { width: 8px; height: 8px; }
  .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
  .custom-scrollbar::-webkit-scrollbar-thumb { background: #195c97; border-radius: 10px; }
  .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #0c4a6e; }
  
  /* MAPA TOOLTIP */
  .leaflet-tooltip.label-mapa {
    background-color: #195c97 !important;
    border: 2px solid #329584 !important;
    color: #ffffff !important;
    font-weight: 700 !important;
    font-size: 11px !important;
    border-radius: 6px !important;
    padding: 3px 8px !important;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
  }
  .leaflet-tooltip-bottom:before { border-bottom-color: #195c97 !important; }
  
  /* ANIMACIONES */
  .fade-in { animation: fadeIn 0.3s ease-out; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

  /* GRFICOS */
  .chart-row { display: flex; align-items: center; margin-bottom: 12px; }
  .chart-label-container { width: 240px; text-align: right; padding-right: 15px; display: flex; align-items: center; justify-content: flex-end; }
  .chart-label { font-size: 11px; color: #475569; font-weight: 600; line-height: 1.2; white-space: normal; }
  .chart-track { flex: 1; background: #e2e8f0; height: 16px; border-radius: 4px; overflow: hidden; position: relative; border: 1px solid #cbd5e1; }
  .chart-fill { height: 100%; border-radius: 3px; transition: width 0.8s ease; display: flex; align-items: center; justify-content: flex-end; padding-right: 5px; }
  .chart-value-label { font-size: 10px; font-weight: 800; color: white; text-shadow: 0 1px 1px rgba(0,0,0,0.3); }
  .chart-total { width: 45px; padding-left: 10px; font-weight: 800; color: #1e293b; font-size: 12px; }

  /* MODAL */
  .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(15, 23, 42, 0.7); display: flex; justify-content: center; align-items: center; z-index: 10000; backdrop-filter: blur(5px); }
  .modal-content { background: #ffffff; padding: 0; border-radius: 16px; width: 95%; max-width: 1200px; height: 90vh; border: 1px solid #e2e8f0; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); display: flex; flexDirection: column; overflow: hidden; }
  .modal-header { padding: 15px 25px; background: #195c97; border-bottom: 1px solid #0c4a6e; display: flex; justify-content: space-between; align-items: center; color: white; }
  .modal-body { padding: 25px; overflow-y: auto; flex: 1; background: #f8fafc; }
  .modal-footer { padding: 15px 25px; background: #f1f5f9; border-top: 1px solid #e2e8f0; display: flex; justify-content: flex-end; gap: 10px; }
  
  /* GESTIN MANUAL */
  .edit-card-container { background: #ffffff; border: 1px solid #cbd5e1; border-radius: 10px; padding: 15px; margin-bottom: 15px; transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
  .edit-card-container:hover { border-color: #195c97; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
  
  .uni-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; margin-top: 15px; }
  .uni-item { background: #f8fafc; border: 1px solid #e2e8f0; padding: 8px; border-radius: 6px; display: flex; justify-content: space-between; align-items: center; }
  .uni-item.active { border-color: #329584; background: #ecfdf5; }
  
  /* INPUTS */
  .input-plaza { background: #ffffff; border: 1px solid #94a3b8; color: #1e293b; padding: 5px; border-radius: 4px; width: 50px; text-align: center; font-weight: bold; font-size: 12px; }
  .input-plaza:focus { outline: none; border-color: #329584; box-shadow: 0 0 0 2px rgba(50, 149, 132, 0.2); }
  .input-total { background: #ffffff; border: 2px solid #195c97; color: #195c97; font-size: 14px; width: 80px; padding: 5px; text-align: center; font-weight: 800; border-radius: 6px; }

  /* TIEMPOS */
  .time-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; }
  .time-card { background: #ffffff; border: 1px solid #e2e8f0; border-radius: 10px; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
  .time-field { display: flex; align-items: center; justify-content: space-between; margin-top: 8px; background: #f1f5f9; padding: 5px 8px; border-radius: 6px; }
  .input-meses-card { background: #ffffff; border: 1px solid #cbd5e1; color: #d97706; padding: 4px; border-radius: 4px; width: 70px; text-align: center; font-weight: 700; font-size: 11px; }
  
  /* KPI CARDS */
  .kpi-card { background: #ffffff; border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px; flex: 1; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
  .kpi-title { font-size: 11px; color: #64748b; font-weight: 700; text-transform: uppercase; margin-bottom: 5px; }
  .kpi-value { font-size: 22px; font-weight: 800; color: #195c97; }
  .kpi-sub { font-size: 10px; color: #94a3b8; }
  
  .career-select { background-color: #ffffff; color: #195c97; font-weight: 700; border: 2px solid #195c97; padding: 6px 12px; border-radius: 6px; cursor: pointer; }
  .map-select { background-color: #ffffff; color: #334155; border: 1px solid #cbd5e1; padding: 6px; border-radius: 6px; font-size: 12px; cursor: pointer; }

  /* BOTONES */
  .btn-modern { border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 700; display: flex; align-items: center; gap: 6px; transition: all 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
  .btn-modern:hover { transform: translateY(-1px); box-shadow: 0 2px 5px rgba(0,0,0,0.15); }
  .btn-close { background: #94a3b8; color: white; }
  .btn-save { background: #329584; color: white; }
  .btn-edit { background: #195c97; color: white; }
  .close-modal-btn { background: transparent; border: none; color: white; font-size: 24px; cursor: pointer; opacity: 0.8; }
  .close-modal-btn:hover { opacity: 1; }
  
  /* FOOTER */
  .source-footer { position: fixed; bottom: 10px; right: 10px; font-size: 10px; color: rgba(255,255,255,0.5); z-index: 9999; pointer-events: none; }
`,tp=[{id:"TODAS",label:" TODAS LAS CARRERAS"},{id:"MEDICINA",label:"MEDICINA HUMANA"},{id:"ENFERMERIA",label:"ENFERMERA"},{id:"OBSTETRICIA",label:"OBSTETRICIA"},{id:"ODONTOLOGIA",label:"ODONTOLOGA"},{id:"FARMACIA",label:"FARMACIA Y BIOQUMICA"},{id:"NUTRICION",label:"NUTRICIN"},{id:"PSICOLOGIA",label:"PSICOLOGA"},{id:"TRABAJO_SOCIAL",label:"TRABAJO SOCIAL"},{id:"BIOLOGIA",label:"BIOLOGA"},{id:"TM_LABORATORIO",label:"TM: LABORATORIO CLNICO"},{id:"TM_TERAPIA_FISICA",label:"TM: TERAPIA FSICA"},{id:"TM_RADIOLOGIA",label:"TM: RADIOLOGA"},{id:"TM_TERAPIA_OCUPACIONAL",label:"TM: TERAPIA OCUPACIONAL"},{id:"TM_TERAPIA_LENGUAJE",label:"TM: TERAPIA DE LENGUAJE"},{id:"TM_OPTOMETRIA",label:"TM: OPTOMETRA"}],wy=["UNIVERSIDAD NACIONAL MAYOR DE SAN MARCOS","UNIVERSIDAD NACIONAL FEDERICO VILLARREAL","UNIVERSIDAD ENRIQUE GUZMAN Y VALLE","UNIVERSIDAD PERUANA CAYETANO HEREDIA","UNIVERSIDAD SAN MARTIN DE PORRES","UNIVERSIDAD PERUANA UNION","UNIVERSIDAD FEMENINA DEL SAGRADO CORAZON","UNIVERSIDAD CSAR VALLEJO","UNIVERSIDAD PERUANA DE CIENCIAS APLICADAS","UNIVERSIDAD PRIVADA DEL NORTE","UNIVERSIDAD PRIVADA NORBERT WIENER","UNIVERSIDAD SAN JUAN BAUTISTA","UNIVERSIDAD TECNOLGICA DEL PER","UNIVERSIDAD CIENTIFICA DEL SUR","UNIVERSIDAD RICARDO PALMA","UNIVERSIDAD CATOLICA SEDES SAPIENTIAE","UNIVERSIDAD CONTINENTAL","UNIVERSIDAD CIENCIAS Y HUMANIDADES","UNIVERSIDAD MARIA AUXILIADORA","UNIVERSIDAD LE CORDON BLEU","UNIVERSIDAD DE PIURA","UNIVERSIDAD NACIONAL DANIEL ALCIDES CARRION","UNIVERSIDAD NACIONAL HERMILIO VALDIZAN","UNIVERSIDAD NACIONAL DE TRUJILLO","UNIVERSIDAD NACIONAL DEL ALTIPLANO DE PUNO","UNIVERSIDAD FRANKLIN ROOSEVELT","UNIVERSIDAD SAN IGNACIO DE LOYOLA","UNIVERSIDAD JOS FAUSTINO SNCHEZ CARRIN","UNIVERSIDAD DE LIMA"],Wo={"RIS 1":"#329584","RIS 2":"#f59e0b","RIS 3":"#f97316","RIS 4":"#3b82f6","RIS 5":"#ef4444","RIS 6":"#8b5cf6","RIS 7":"#ec4899","SIN RIS":"#94a3b8",HOSPITAL:"#195c97",INSTITUTO:"#6366f1",DEFAULT:"#64748b"},SS={LIMA:"RIS 1","CERCADO DE LIMA":"RIS 1",BRENA:"RIS 2",BREA:"RIS 2","JESUS MARIA":"RIS 2","PUEBLO LIBRE":"RIS 2","MAGDALENA DEL MAR":"RIS 3","SAN MIGUEL":"RIS 3",LINCE:"RIS 4","SAN ISIDRO":"RIS 4",MIRAFLORES:"RIS 4","SAN BORJA":"RIS 4",SURQUILLO:"RIS 4","LA VICTORIA":"RIS 5","SAN LUIS":"RIS 5","EL AGUSTINO":"RIS 5","SANTA ANITA":"RIS 5","SAN JUAN DE LURIGANCHO":"RIS 6",RIMAC:"RIS 7",INDEPENDENCIA:"RIS 7",COMAS:"RIS 7"},Sy={claro:{url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",name:" Claro"},oscuro:{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",name:" Oscuro"},satelite:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",name:" Satlite"}},O9=Object.keys(SS).sort(),rp=(e,t="")=>{const r=t.toUpperCase();if(r.startsWith("HOSPITAL"))return Wo.HOSPITAL;if(r.startsWith("INSTITUTO"))return Wo.INSTITUTO;const n=Object.keys(Wo).find(i=>(e||"").toUpperCase().includes(i));return n?Wo[n]:Wo.DEFAULT},Iy=e=>e?String(e).toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^A-Z0-9 ]/g,"").trim():"",np=[{id:"r1_1",ris:"RIS 1",nombre:"CS CONDE DE LA VEGA",lat:-12.038921,lng:-77.050464,distrito:"CERCADO DE LIMA"},{id:"r1_2",ris:"RIS 1",nombre:"CS CONTROL DE ZOONOSIS",lat:-12.049798,lng:-77.06224,distrito:"CERCADO DE LIMA"},{id:"r1_3",ris:"RIS 1",nombre:"CS ITS Y VIH RAUL PATRUCCO PUIG",lat:-12.052736,lng:-77.022955,distrito:"LA VICTORIA"},{id:"r1_4",ris:"RIS 1",nombre:"CS JUAN PEREZ CARRANZA",lat:-12.053413,lng:-77.022688,distrito:"LA VICTORIA"},{id:"r1_5",ris:"RIS 1",nombre:"CS MIRONES",lat:-12.050879,lng:-77.067292,distrito:"CERCADO DE LIMA"},{id:"r1_6",ris:"RIS 1",nombre:"CS MIRONES BAJO",lat:-12.050897,lng:-77.067321,distrito:"CERCADO DE LIMA"},{id:"r1_7",ris:"RIS 1",nombre:"CS SAN SEBASTIAN",lat:-12.042331,lng:-77.038673,distrito:"CERCADO DE LIMA"},{id:"r1_8",ris:"RIS 1",nombre:"CS UNIDAD VECINAL N3",lat:-12.051273,lng:-77.08233,distrito:"CERCADO DE LIMA"},{id:"r1_9",ris:"RIS 1",nombre:"CS VILLA MARIA DEL PERPETUO SOCORRO",lat:-12.037751,lng:-77.054586,distrito:"CERCADO DE LIMA"},{id:"r1_10",ris:"RIS 1",nombre:"CSMC KUYANAKUSUN",lat:-12.037769,lng:-77.081481,distrito:"CERCADO DE LIMA"},{id:"r1_11",ris:"RIS 1",nombre:"CSMC MIRONES BAJO",lat:-12.037769,lng:-77.081481,distrito:"CERCADO DE LIMA"},{id:"r1_12",ris:"RIS 1",nombre:"CSMC SAN MARCOS",lat:-12.055392,lng:-77.082387,distrito:"PUEBLO LIBRE"},{id:"r1_13",ris:"RIS 1",nombre:"PS PALERMO",lat:-12.040929,lng:-77.068914,distrito:"CERCADO DE LIMA"},{id:"r1_14",ris:"RIS 1",nombre:"PS RESCATE",lat:-12.041065,lng:-77.062272,distrito:"CERCADO DE LIMA"},{id:"r1_15",ris:"RIS 1",nombre:"PS SANTA ROSA",lat:-12.044848,lng:-77.111266,distrito:"CALLAO"},{id:"r2_1",ris:"RIS 2",nombre:"CS BREA",lat:-12.063762,lng:-77.057869,distrito:"BREA"},{id:"r2_2",ris:"RIS 2",nombre:"CS CHACRA COLORADA",lat:-12.053863,lng:-77.048067,distrito:"BREA"},{id:"r2_3",ris:"RIS 2",nombre:"CS HUACA PANDO",lat:-12.061594,lng:-77.083254,distrito:"PUEBLO LIBRE"},{id:"r2_4",ris:"RIS 2",nombre:"CS JESUS MARIA",lat:-12.077688,lng:-77.053306,distrito:"JESUS MARIA"},{id:"r2_5",ris:"RIS 2",nombre:"CS SAN MIGUEL",lat:-12.081167,lng:-77.09853,distrito:"SAN MIGUEL"},{id:"r2_6",ris:"RIS 2",nombre:"CSM EXCELENCIA SAN MIGUEL",lat:-12.081396,lng:-77.101266,distrito:"SAN MIGUEL"},{id:"r2_7",ris:"RIS 2",nombre:"CSMC HONORIO DELGADO",lat:-12.069174,lng:-77.058068,distrito:"BREA"},{id:"r2_8",ris:"RIS 2",nombre:"CSMC JESUS MARIA",lat:-12.07406,lng:-77.043524,distrito:"JESUS MARIA"},{id:"r2_9",ris:"RIS 2",nombre:"CSMC MAGDALENA",lat:-12.088394,lng:-77.063122,distrito:"MAGDALENA DEL MAR"},{id:"r2_10",ris:"RIS 2",nombre:"CSMI MAGDALENA",lat:-12.088383,lng:-77.06876,distrito:"MAGDALENA DEL MAR"},{id:"r2_11",ris:"RIS 2",nombre:"LABORATORIO REFERENCIAL",lat:-12.088656,lng:-77.067946,distrito:"MAGDALENA DEL MAR"},{id:"r3_1",ris:"RIS 3",nombre:"CS LINCE",lat:-12.081669,lng:-77.031994,distrito:"LINCE"},{id:"r3_2",ris:"RIS 3",nombre:"CS SAM ATANACIO DE PEDREGAL",lat:-12.1209,lng:-76.998887,distrito:"SURQUILLO"},{id:"r3_3",ris:"RIS 3",nombre:"CS SAN ISIDRO",lat:-12.106575,lng:-77.05512,distrito:"SAN ISIDRO"},{id:"r3_4",ris:"RIS 3",nombre:"CS SANTA CRUZ MIRAFLORES",lat:-12.118628,lng:-77.036754,distrito:"MIRAFLORES"},{id:"r3_5",ris:"RIS 3",nombre:"CS VILLA VICTORIA PORVENIR",lat:-12.10857,lng:-77.012094,distrito:"SURQUILLO"},{id:"r3_6",ris:"RIS 3",nombre:"CSMC SAN BORJA",lat:-12.108779,lng:-77.00647,distrito:"SAN BORJA"},{id:"r3_7",ris:"RIS 3",nombre:"CSMC SAN ISIDRO",lat:-12.107595,lng:-77.050509,distrito:"SAN ISIDRO"},{id:"r3_8",ris:"RIS 3",nombre:"CSMC SURQUILLO",lat:-12.118613,lng:-77.019213,distrito:"SURQUILLO"},{id:"r3_9",ris:"RIS 3",nombre:"CSMI SURQUILLO",lat:-12.118262,lng:-77.022244,distrito:"SURQUILLO"},{id:"r4_1",ris:"RIS 4",nombre:"CS EL PINO",lat:-12.066881,lng:-76.998619,distrito:"EL AGUSTINO"},{id:"r4_2",ris:"RIS 4",nombre:"CS MAX ARIAS SCHREIBER",lat:-12.059194,lng:-77.032271,distrito:"LA VICTORIA"},{id:"r4_3",ris:"RIS 4",nombre:"CS SAN COSME",lat:-12.061765,lng:-77.006846,distrito:"LA VICTORIA"},{id:"r4_4",ris:"RIS 4",nombre:"CS SAN LUIS",lat:-12.07445,lng:-76.997255,distrito:"SAN LUIS"},{id:"r4_5",ris:"RIS 4",nombre:"CS TODOS LOS SANTOS SAN BORJA",lat:-12.101842,lng:-76.993428,distrito:"SAN BORJA"},{id:"r4_6",ris:"RIS 4",nombre:"CSMC LA VICTORIA",lat:-12.071107,lng:-77.013469,distrito:"LA VICTORIA"},{id:"r4_7",ris:"RIS 4",nombre:"CSMC SAN COSME",lat:-12.061978,lng:-77.005306,distrito:"LA VICTORIA"},{id:"r4_8",ris:"RIS 4",nombre:"CSMI EL PORVENIR",lat:-12.067469,lng:-77.020826,distrito:"LA VICTORIA"},{id:"r4_9",ris:"RIS 4",nombre:"PS EL PINO",lat:-12.06586,lng:-77.002467,distrito:"EL AGUSTINO"},{id:"r4_10",ris:"RIS 4",nombre:"PS JARDN ROSA DE SANTA MARA",lat:-12.044257,lng:-77.01443,distrito:"EL AGUSTINO"},{id:"r4_11",ris:"RIS 4",nombre:"PS SAN JUAN MASIAS",lat:-12.084071,lng:-77.00246,distrito:"SAN LUIS"},{id:"r5_1",ris:"RIS 5",nombre:"CS CAJA DE AGUA",lat:-12.026599,lng:-77.014879,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_2",ris:"RIS 5",nombre:"CS CAMPOY",lat:-12.016004,lng:-76.965389,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_3",ris:"RIS 5",nombre:"CS CHACARILLA DE OTERO",lat:-12.020881,lng:-77.006867,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_4",ris:"RIS 5",nombre:"CS DANIEL ALCIDES CARRION",lat:-12.023003,lng:-76.977023,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_5",ris:"RIS 5",nombre:"CS LA HUAYRONA",lat:-11.993822,lng:-77.00658,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_6",ris:"RIS 5",nombre:"CS LA LIBERTAD",lat:-12.003994,lng:-76.995829,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_7",ris:"RIS 5",nombre:"CS MANGOMARCA",lat:-12.010634,lng:-76.979585,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_8",ris:"RIS 5",nombre:"CS SAN FERNANDO",lat:-12.0023,lng:-77.010607,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_9",ris:"RIS 5",nombre:"CS SANTA FE DE TOTORITA",lat:-11.996876,lng:-76.996041,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_10",ris:"RIS 5",nombre:"CS SANTA ROSA DE LIMA",lat:-12.005101,lng:-77.016472,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_11",ris:"RIS 5",nombre:"CS ZARATE",lat:-12.022964,lng:-76.994557,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_12",ris:"RIS 5",nombre:"CSMC JAVIER MARIATEGUI",lat:-12.017147,lng:-77.000884,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_13",ris:"RIS 5",nombre:"CSMC MANGOMARCA",lat:-12.019114,lng:-76.984995,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_14",ris:"RIS 5",nombre:"CSMC VILLA CAMPOY",lat:-12.007232,lng:-76.965202,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_15",ris:"RIS 5",nombre:"PS 15 DE ENERO",lat:-12.010915,lng:-77.01859,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r5_16",ris:"RIS 5",nombre:"PS AZCARRUNZ ALTO",lat:-12.017052,lng:-77.000957,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_1",ris:"RIS 6",nombre:"CS BAYOVAR",lat:-11.951986,lng:-76.991581,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_2",ris:"RIS 6",nombre:"CS GANIMENDES",lat:-11.983037,lng:-77.011447,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_3",ris:"RIS 6",nombre:"CS HUASCAR II",lat:-11.966623,lng:-77.010997,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_4",ris:"RIS 6",nombre:"CS HUASCAR XV",lat:-11.955447,lng:-77.002372,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_5",ris:"RIS 6",nombre:"CS MEDALLA MILAGROSA",lat:-11.976887,lng:-77.006001,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_6",ris:"RIS 6",nombre:"CS SAN HILARION",lat:-11.995438,lng:-77.01583,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_7",ris:"RIS 6",nombre:"CSMC JAIME ZUBIETA",lat:-11.962834,lng:-76.98873,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_8",ris:"RIS 6",nombre:"CSMC NUEVO PER",lat:-12.0029,lng:-77.018166,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_9",ris:"RIS 6",nombre:"PS AYACUCHO",lat:-11.987161,lng:-77.017107,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_10",ris:"RIS 6",nombre:"PS PROYECTOS ESPECIALES",lat:-11.955769,lng:-76.992456,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r6_11",ris:"RIS 6",nombre:"PS SAGRADA FAMILIA",lat:-11.976341,lng:-76.988859,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_1",ris:"RIS 7",nombre:"CS 10 DE OCTUBRE",lat:-11.944904,lng:-76.987643,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_2",ris:"RIS 7",nombre:"CS CRUZ DE MOTUPE",lat:-11.940364,lng:-76.974795,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_3",ris:"RIS 7",nombre:"CS ENRIQUE MONTENEGRO",lat:-11.937029,lng:-76.971134,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_4",ris:"RIS 7",nombre:"CS JAIME ZUBIETA",lat:-11.963164,lng:-76.988935,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_5",ris:"RIS 7",nombre:"CS JOSE CARLOS MARIATEGUI",lat:-11.94384,lng:-76.984472,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_6",ris:"RIS 7",nombre:"CS JUAN PABLO II",lat:-11.952272,lng:-77.077927,distrito:"SAN MARTIN DE PORRES"},{id:"r7_7",ris:"RIS 7",nombre:"CS SANTA MARIA",lat:-11.964929,lng:-76.975984,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_8",ris:"RIS 7",nombre:"PS CESAR VALLEJO",lat:-11.939452,lng:-76.965759,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_9",ris:"RIS 7",nombre:"PS JOSE CARLOS MARIATEGUI V ETAPA",lat:-11.931092,lng:-76.990411,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_10",ris:"RIS 7",nombre:"PS MARISCAL CACERES",lat:-11.949206,lng:-76.98108,distrito:"SAN JUAN DE LURIGANCHO"},{id:"r7_11",ris:"RIS 7",nombre:"PS TUPAC AMARU II",lat:-11.955745,lng:-76.975792,distrito:"SAN JUAN DE LURIGANCHO"},{id:"h_1",ris:"SIN RIS",nombre:"HOSPITAL NACIONAL DOS DE MAYO",lat:-12.056369,lng:-77.016048,distrito:"CERCADO DE LIMA",tipo:"HOSPITAL"},{id:"h_2",ris:"SIN RIS",nombre:"HOSPITAL NACIONAL ARZOBISPO LOAYZA",lat:-12.049516,lng:-77.042667,distrito:"CERCADO DE LIMA",tipo:"HOSPITAL"},{id:"h_3",ris:"SIN RIS",nombre:"HOSPITAL SAN JUAN DE LURIGANCHO",lat:-11.966064,lng:-77.003482,distrito:"SAN JUAN DE LURIGANCHO",tipo:"HOSPITAL"},{id:"h_4",ris:"SIN RIS",nombre:"HOSPITAL NACIONAL SAN BARTOLOME",lat:-12.049583,lng:-77.04211,distrito:"CERCADO DE LIMA",tipo:"HOSPITAL"},{id:"h_5",ris:"SIN RIS",nombre:"HOSPITAL DE EMERGENCIAS JOSE CASIMIRO ULLOA",lat:-12.127835,lng:-77.017796,distrito:"MIRAFLORES",tipo:"HOSPITAL"},{id:"h_6",ris:"SIN RIS",nombre:"HOSPITAL SANTA ROSA",lat:-12.071516,lng:-77.06107,distrito:"PUEBLO LIBRE",tipo:"HOSPITAL"},{id:"h_7",ris:"SIN RIS",nombre:"HOSPITAL VICTOR LARCO HERRERA",lat:-12.097315,lng:-77.064832,distrito:"MAGDALENA DEL MAR",tipo:"HOSPITAL"},{id:"h_8",ris:"SIN RIS",nombre:"HOSPITAL DE EMERGENCIAS PEDITRICAS",lat:-12.058125,lng:-77.021607,distrito:"LA VICTORIA",tipo:"HOSPITAL"},{id:"i_1",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE ENFERMEDADES NEOPLSICAS",lat:-12.11232,lng:-76.998266,distrito:"SAN BORJA",tipo:"INSTITUTO"},{id:"i_2",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE SALUD DEL NIO-BREA",lat:-12.064247,lng:-77.04572,distrito:"BREA",tipo:"INSTITUTO"},{id:"i_3",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE SALUD DEL NIO-SAN BORJA",lat:-12.085823,lng:-76.992491,distrito:"SAN BORJA",tipo:"INSTITUTO"},{id:"i_4",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL MATERNO PERINATAL",lat:-12.052537,lng:-77.022163,distrito:"CERCADO DE LIMA",tipo:"INSTITUTO"},{id:"i_5",ris:"SIN RIS",nombre:"INSTITUTO NACIONAL DE CIENCIAS NEUROLGICAS",lat:-12.045887,lng:-77.015878,distrito:"CERCADO DE LIMA",tipo:"INSTITUTO"}],L9=({center:e,zoom:t})=>{const r=iT();return _e.useEffect(()=>{r.flyTo(e,t,{duration:1.5})},[e,t,r]),null},D9=({data:e,tiempos:t})=>{const r=e.filter(_=>!_.nombre.startsWith("HOSPITAL")&&!_.nombre.startsWith("INSTITUTO")),n=e.filter(_=>_.nombre.startsWith("HOSPITAL")||_.nombre.startsWith("INSTITUTO")),i=r.reduce((_,v)=>_+v.capacidadTotal,0),s=r.reduce((_,v)=>_+v.cantidad,0);r.reduce((_,v)=>_+v.disponible,0);const o=n.reduce((_,v)=>_+v.capacidadTotal,0),l=n.reduce((_,v)=>_+v.cantidad,0);n.reduce((_,v)=>_+v.disponible,0);const u=i>0?s/i*100:0,h=o>0?l/o*100:0,p=Ka.useMemo(()=>{const _={};e.forEach(E=>{E.desglose&&E.desglose.forEach(y=>{_[y.universidad]=(_[y.universidad]||0)+y.cantidad})});const v=(E,y)=>y[1]-E[1];return Object.entries(_).sort(v)},[e]);if(e.length===0)return W.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#64748b",fontSize:"14px",fontStyle:"italic"},children:"No hay datos registrados."});const m=p.length>0?p[0][1]:1;return W.jsxs("div",{className:"fade-in",style:{paddingRight:"10px"},children:[W.jsxs("h4",{style:{color:"#195c97",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"15px",borderBottom:"2px solid #195c97",paddingBottom:"5px"},children:[W.jsx("i",{className:"fas fa-chart-pie mr-2"})," Adjudicacin por Nivel"]}),W.jsxs("div",{style:{marginBottom:"20px",background:"#ffffff",padding:"15px",borderRadius:"10px",border:"1px solid #e2e8f0",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[W.jsx("div",{style:{fontSize:"12px",fontWeight:"700",color:"#329584",marginBottom:"8px"},children:"PRIMER NIVEL (CS/PS)"}),W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"11px",color:"#64748b",marginBottom:"6px"},children:[W.jsxs("span",{children:["Adjudicado: ",W.jsx("b",{children:s})]}),W.jsxs("span",{children:["Total: ",W.jsx("b",{children:i})]})]}),W.jsx("div",{style:{width:"100%",height:"14px",background:"#f1f5f9",borderRadius:"7px",overflow:"hidden",border:"1px solid #cbd5e1"},children:W.jsx("div",{style:{width:`${u}%`,height:"100%",background:"#329584",transition:"width 0.8s ease"}})}),W.jsxs("div",{style:{textAlign:"right",fontSize:"10px",color:"#329584",marginTop:"4px"},children:[u.toFixed(1),"% Ocupado"]})]}),W.jsxs("div",{style:{marginBottom:"25px",background:"#ffffff",padding:"15px",borderRadius:"10px",border:"1px solid #e2e8f0",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[W.jsx("div",{style:{fontSize:"12px",fontWeight:"700",color:"#195c97",marginBottom:"8px"},children:"HOSPITALES E INSTITUTOS"}),W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"11px",color:"#64748b",marginBottom:"6px"},children:[W.jsxs("span",{children:["Adjudicado: ",W.jsx("b",{children:l})]}),W.jsxs("span",{children:["Total: ",W.jsx("b",{children:o})]})]}),W.jsx("div",{style:{width:"100%",height:"14px",background:"#f1f5f9",borderRadius:"7px",overflow:"hidden",border:"1px solid #cbd5e1"},children:W.jsx("div",{style:{width:`${h}%`,height:"100%",background:"#195c97",transition:"width 0.8s ease"}})}),W.jsxs("div",{style:{textAlign:"right",fontSize:"10px",color:"#195c97",marginTop:"4px"},children:[h.toFixed(1),"% Ocupado"]})]}),t&&Object.keys(t).length>0&&W.jsxs("div",{style:{marginBottom:"25px"},children:[W.jsxs("h4",{style:{color:"#f59e0b",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"10px",borderBottom:"2px solid #f59e0b",paddingBottom:"5px"},children:[W.jsx("i",{className:"fas fa-clock mr-2"})," Tiempos (Meses)"]}),W.jsxs("div",{className:"time-table-container",children:[W.jsxs("div",{className:"time-row time-header",children:[W.jsx("span",{children:"UNIVERSIDAD"}),W.jsx("span",{style:{textAlign:"center"},children:"CS/PS"}),W.jsx("span",{style:{textAlign:"center"},children:"HOSP"})]}),Object.entries(t).map(([_,v])=>W.jsxs("div",{className:"time-row",children:[W.jsx("span",{style:{color:"#334155",fontWeight:"600",fontSize:"10px"},children:_}),W.jsx("span",{style:{textAlign:"center",color:"#329584",fontWeight:"700",fontSize:"11px"},children:v.mesesPrimerNivel||"-"}),W.jsx("span",{style:{textAlign:"center",color:"#195c97",fontWeight:"700",fontSize:"11px"},children:v.mesesHospital||"-"})]},_))]})]}),W.jsxs("h4",{style:{color:"#64748b",fontSize:"11px",fontWeight:"800",textTransform:"uppercase",marginBottom:"15px",borderBottom:"2px solid #94a3b8",paddingBottom:"5px"},children:[W.jsx("i",{className:"fas fa-university mr-2"})," Asignacin Total"]}),W.jsx("div",{style:{paddingBottom:"20px"},children:p.map(([_,v])=>W.jsxs("div",{className:"chart-row",children:[W.jsx("div",{className:"chart-label-container",children:W.jsx("span",{className:"chart-label",children:_})}),W.jsx("div",{className:"chart-track",children:W.jsx("div",{className:"chart-fill",style:{width:`${v/m*100}%`,background:"#195c97"},children:W.jsx("span",{className:"chart-value-label",children:v})})}),W.jsx("div",{className:"chart-total",children:v})]},_))})]})},F9=()=>{var Pe;const e=K2();_e.useEffect(()=>{const ne=document.createElement("style");return ne.innerHTML=N9,document.head.appendChild(ne),()=>{document.head.removeChild(ne)}},[]);const[t,r]=_e.useState(null),[n,i]=_e.useState([-12.05,-77.06]),[s,o]=_e.useState(12),[l,u]=_e.useState("claro"),[h,p]=_e.useState("lista"),[m,_]=_e.useState("MEDICINA"),[v,E]=_e.useState("todos"),[y,w]=_e.useState("todos"),[k,C]=_e.useState(""),[A,U]=_e.useState([]),[q,K]=_e.useState(null),[S,R]=_e.useState(!1),[P,D]=_e.useState(null),[F,b]=_e.useState({}),[M,Ce]=_e.useState(0),[Ie,Re]=_e.useState(""),[ke,fe]=_e.useState(!1),[te,de]=_e.useState({}),[Ee,j]=_e.useState("todos");_e.useEffect(()=>{fetch("https://raw.githubusercontent.com/yurivilc/peru-geojson/master/lima_callao_distritos.geojson").then(ne=>ne.json()).then(ne=>r(ne)).catch(console.error)},[]),_e.useEffect(()=>{(async()=>{m==="TODAS"?await Q():(await Y(m),await le(m))})()},[m]);const re=ne=>{const De=ne.properties.NOMBDIST||ne.properties.NOMB_DIST||"",Me=Iy(De),Qe=SS[Me]||"DEFAULT",st=Wo[Qe],pt=y==="todos"||Me===Iy(y);return{fillColor:st,weight:Qe!=="DEFAULT"?1:.5,opacity:1,color:"white",fillOpacity:pt?.5:.1}},Q=async()=>{let ne={};np.forEach(De=>{ne[De.nombre]={...De,capacidadTotal:0,cantidad:0,desglose:[],disponible:0}});for(const De of tp)if(De.id!=="TODAS")try{(await Dm(eu(vs,`adjudicacion_2026_${De.id}`))).docs.forEach(Qe=>{const st=Qe.data();ne[st.nombre]&&(ne[st.nombre].capacidadTotal+=st.capacidadTotal||0,ne[st.nombre].cantidad+=st.cantidad||0,ne[st.nombre].disponible+=st.disponible||0,st.desglose&&st.desglose.forEach(pt=>{ne[st.nombre].desglose.push({universidad:`${pt.universidad} (${De.label.substring(0,3)})`,cantidad:pt.cantidad})}))})}catch{}U(Object.values(ne)),de({})},Y=async ne=>{try{const De=`adjudicacion_2026_${ne}`,Qe=(await Dm(eu(vs,De))).docs.map(mt=>({id:mt.id,...mt.data()})),st={};Qe.forEach(mt=>{st[mt.nombre]=mt});let pt=np.map(mt=>{const dr=st[mt.nombre];return dr?{...mt,...dr}:{...mt,capacidadTotal:0,desglose:[],disponible:0,cantidad:0}});U(pt)}catch(De){console.error(De),U(np.map(Me=>({...Me,capacidadTotal:0,desglose:[],disponible:0,cantidad:0})))}},le=async ne=>{try{const De=gh(vs,"config_tiempos_2026",ne),Me=await g9(De);Me.exists()?de(Me.data()):de({})}catch(De){console.error("Error loading times:",De)}},ye=async()=>{try{await _9(gh(vs,"config_tiempos_2026",m),te),fe(!1),alert(" Tiempos guardados.")}catch(ne){console.error(ne),alert("Error al guardar.")}},Ne=(ne,De,Me)=>{de(Qe=>({...Qe,[ne]:{...Qe[ne],[De]:Me}}))},ee=ne=>{D(ne.nombre),Ce(ne.capacidadTotal||0);const De={};ne.desglose&&ne.desglose.forEach(Me=>De[Me.universidad]=Me.cantidad),b(De)},me=(ne,De)=>{b(Me=>({...Me,[ne]:parseInt(De)||0}))},Fe=async()=>{if(!P)return;const ne=A.find(st=>st.nombre===P);if(!ne)return;const De=[];let Me=0;if(Object.entries(F).forEach(([st,pt])=>{pt>0&&(De.push({universidad:st,cantidad:pt}),Me+=pt)}),Me>M&&!confirm(` Cuidado: Asignaste ${Me}, pero la oferta es ${M}. Guardar?`))return;const Qe={...ne,capacidadTotal:M,desglose:De,cantidad:Me,disponible:M-Me};try{const st=`adjudicacion_2026_${m}`;await AS(vs).set(gh(eu(vs,st),P.replace(/[\/\s\.]/g,"_")),Qe).commit(),U(pt=>pt.map(mt=>mt.nombre===P?Qe:mt)),D(null)}catch(st){console.error(st),alert("Error al guardar.")}},H=A.map(ne=>ne).filter(ne=>{const De=y==="todos"||ne.distrito&&ne.distrito===y,Me=k===""||ne.nombre.includes(k.toUpperCase());let Qe=!0;v==="HOSP"?Qe=ne.ris==="SIN RIS":v!=="todos"&&(Qe=ne.ris===v);let st=!0;return Ee==="libres"&&(st=ne.disponible>0),Ee==="ocupados"&&(st=ne.cantidad>0),De&&Me&&Qe&&st}).sort((ne,De)=>De.capacidadTotal-ne.capacidadTotal),Ve=A.filter(ne=>ne.nombre.includes(Ie.toUpperCase())),je=H.reduce((ne,De)=>ne+De.capacidadTotal,0),tt=H.reduce((ne,De)=>ne+De.disponible,0),Ze=(ne,De,Me)=>{q===ne?K(null):(K(ne),De!==0&&De!==-12.046374&&(i([De,Me]),o(16)))};return W.jsxs("div",{className:"dashboard-container",style:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"#f8fafc",color:"#1e293b"},children:[W.jsxs("div",{style:{background:"#ffffff",padding:"0 24px",height:"70px",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #e2e8f0",zIndex:50,boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[W.jsx("div",{style:{background:"#195c97",width:"40px",height:"40px",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center"},children:W.jsx("i",{className:"fas fa-calendar-check",style:{fontSize:"20px",color:"white"}})}),W.jsxs("div",{children:[W.jsxs("h1",{style:{margin:0,fontSize:"20px",fontWeight:"800",color:"#195c97"},children:["ADJUDICACIN ",W.jsx("span",{style:{color:"#329584"},children:"2026"})]}),W.jsx("p",{style:{margin:"2px 0 0 0",fontSize:"11px",opacity:.6},children:"GESTIN DE PLAZAS"})]})]}),W.jsxs("div",{style:{display:"flex",gap:"10px"},children:[W.jsx("select",{value:l,onChange:ne=>u(ne.target.value),className:"map-select",children:Object.entries(Sy).map(([ne,De])=>W.jsx("option",{value:ne,children:De.name},ne))}),W.jsxs("button",{onClick:()=>fe(!0),disabled:m==="TODAS",className:"btn-modern btn-edit",style:{opacity:m==="TODAS"?.5:1},children:[W.jsx("i",{className:"fas fa-clock"})," Tiempos"]}),W.jsxs("button",{onClick:()=>R(!0),disabled:m==="TODAS",className:"btn-modern btn-save",style:{opacity:m==="TODAS"?.5:1},children:[W.jsx("i",{className:"fas fa-edit"})," Gestin Manual"]}),W.jsxs("button",{onClick:()=>e("/"),className:"btn-modern btn-close",children:[W.jsx("i",{className:"fas fa-arrow-left"})," Volver 2025"]})]})]}),W.jsxs("div",{style:{padding:"15px 24px",background:"#f1f5f9",borderBottom:"1px solid #cbd5e1",display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",marginRight:"15px"},children:[W.jsx("span",{style:{fontSize:"12px",color:"#195c97",marginRight:"8px",fontWeight:"700"},children:"CARRERA:"}),W.jsx("select",{value:m,onChange:ne=>_(ne.target.value),className:"career-select",style:{width:"240px"},children:tp.map(ne=>W.jsxs("option",{value:ne.id,children:[" ",ne.label]},ne.id))})]}),W.jsx("div",{style:{position:"relative",flex:1},children:W.jsx("input",{type:"text",placeholder:"Buscar Sede...",value:k,onChange:ne=>C(ne.target.value.toUpperCase()),style:{width:"100%",padding:"8px 8px 8px 12px",borderRadius:"6px",border:"1px solid #cbd5e1",background:"#ffffff",color:"#1e293b",fontSize:"13px",boxSizing:"border-box"}})}),W.jsxs("select",{value:Ee,onChange:ne=>j(ne.target.value),style:{width:"140px",padding:"8px",borderRadius:"6px",border:"1px solid #cbd5e1",background:"#ffffff",color:"#334155",fontSize:"13px"},children:[W.jsx("option",{value:"todos",children:" Todos"}),W.jsx("option",{value:"libres",children:" Libres"}),W.jsx("option",{value:"ocupados",children:" Ocupados"})]}),W.jsxs("select",{value:y,onChange:ne=>w(ne.target.value),style:{width:"180px",padding:"8px",borderRadius:"6px",border:"1px solid #cbd5e1",background:"#ffffff",color:"#334155",fontSize:"13px"},children:[" ",W.jsx("option",{value:"todos",children:" Todos los Distritos"})," ",O9.map(ne=>W.jsx("option",{value:ne,children:ne},ne))," "]}),W.jsx("button",{onClick:()=>E(v==="HOSP"?"todos":"HOSP"),className:"btn-modern",style:{background:v==="HOSP"?"#f43f5e":"#ffffff",color:v==="HOSP"?"white":"#f43f5e",border:"1px solid #f43f5e"},children:" HOSP/INST"})]}),ke&&W.jsx("div",{className:"modal-overlay",children:W.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",height:"80vh"},children:[W.jsxs("div",{className:"modal-header",children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[W.jsx("i",{className:"fas fa-clock",style:{fontSize:"20px"}}),W.jsx("h3",{style:{margin:0},children:"Tiempos de Rotacin (Meses)"})]}),W.jsx("button",{onClick:()=>fe(!1),className:"close-modal-btn",children:""})]}),W.jsx("div",{className:"modal-body custom-scrollbar",style:{padding:"20px",background:"#f8fafc"},children:W.jsx("div",{className:"time-grid",children:wy.map(ne=>{var De,Me;return W.jsxs("div",{className:"time-card",children:[W.jsx("div",{style:{fontSize:"12px",fontWeight:"700",color:"#334155",marginBottom:"10px",borderBottom:"1px solid #e2e8f0",paddingBottom:"5px",minHeight:"32px",display:"flex",alignItems:"center"},children:ne}),W.jsxs("div",{className:"time-field",children:[W.jsx("span",{className:"time-icon",children:""})," ",W.jsx("span",{style:{fontSize:"11px",color:"#329584"},children:"Primer Nivel"}),W.jsx("input",{type:"text",className:"input-meses-card",placeholder:"-",value:((De=te[ne])==null?void 0:De.mesesPrimerNivel)||"",onChange:Qe=>Ne(ne,"mesesPrimerNivel",Qe.target.value)})]}),W.jsxs("div",{className:"time-field",children:[W.jsx("span",{className:"time-icon",children:""})," ",W.jsx("span",{style:{fontSize:"11px",color:"#195c97"},children:"Hospital"}),W.jsx("input",{type:"text",className:"input-meses-card",placeholder:"-",value:((Me=te[ne])==null?void 0:Me.mesesHospital)||"",onChange:Qe=>Ne(ne,"mesesHospital",Qe.target.value)})]})]},ne)})})}),W.jsx("div",{className:"modal-footer",children:W.jsx("button",{onClick:ye,className:"btn-modern btn-save",children:"GUARDAR CAMBIOS"})})]})}),S&&W.jsx("div",{className:"modal-overlay",children:W.jsxs("div",{className:"modal-content",children:[W.jsxs("div",{className:"modal-header",children:[W.jsxs("h3",{style:{margin:0},children:["Gestin Manual: ",(Pe=tp.find(ne=>ne.id===m))==null?void 0:Pe.label]}),W.jsxs("div",{style:{display:"flex",gap:"10px"},children:[W.jsx("input",{type:"text",placeholder:"Filtrar lista...",value:Ie,onChange:ne=>Re(ne.target.value),className:"input-plaza",style:{width:"200px",textAlign:"left",border:"1px solid white"}}),W.jsx("button",{onClick:()=>R(!1),className:"close-modal-btn",children:""})]})]}),W.jsx("div",{className:"modal-body custom-scrollbar",children:Ve.map(ne=>W.jsxs("div",{className:"edit-card-container",children:[W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px",alignItems:"center"},children:[W.jsxs("div",{style:{flex:1},children:[W.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[W.jsx("i",{className:`fas ${ne.nombre.startsWith("CS")?"fa-clinic-medical":"fa-hospital"}`,style:{color:rp(ne.ris,ne.tipo)}}),W.jsx("span",{style:{fontWeight:"700",color:"#1e293b",fontSize:"14px"},children:ne.nombre})]}),W.jsxs("div",{style:{fontSize:"11px",color:"#64748b",marginTop:"4px",marginLeft:"26px"},children:["Ofertado: ",W.jsx("b",{style:{color:"#1e293b"},children:ne.capacidadTotal})," | Libre: ",W.jsx("b",{style:{color:ne.disponible>0?"#329584":"#ef4444"},children:ne.disponible})]})]}),W.jsx("div",{style:{display:"flex",gap:"10px"},children:P===ne.nombre?W.jsxs(W.Fragment,{children:[W.jsx("button",{onClick:()=>D(null),className:"btn-modern btn-close",children:"CERRAR"}),W.jsx("button",{onClick:Fe,className:"btn-modern btn-save",children:"GUARDAR"})]}):W.jsx("button",{onClick:()=>ee(ne),className:"btn-modern btn-edit",children:"EDITAR"})})]}),P===ne.nombre?W.jsxs("div",{style:{background:"#f1f5f9",padding:"20px",borderRadius:"10px",border:"1px solid #cbd5e1",animation:"fadeIn 0.3s"},children:[W.jsxs("div",{style:{marginBottom:"20px",display:"flex",alignItems:"center",gap:"15px",borderBottom:"1px solid #e2e8f0",paddingBottom:"15px"},children:[W.jsx("label",{style:{fontSize:"13px",fontWeight:"800",color:"#329584",textTransform:"uppercase"},children:"Capacidad Total:"}),W.jsx("input",{type:"number",min:"0",className:"input-total",value:M,onChange:De=>Ce(parseInt(De.target.value)||0)})]}),W.jsx("div",{className:"uni-grid",children:wy.map(De=>W.jsxs("div",{className:`uni-item ${F[De]>0?"active":""}`,children:[W.jsx("span",{className:"uni-label",title:De,children:De}),W.jsx("input",{type:"number",min:"0",className:"input-plaza",value:F[De]||"",onChange:Me=>me(De,Me.target.value),placeholder:"0"})]},De))})]}):W.jsx("div",{style:{fontSize:"10px",color:"#64748b",display:"flex",flexWrap:"wrap",gap:"6px",paddingLeft:"24px",marginTop:"5px"},children:ne.desglose&&ne.desglose.length>0?ne.desglose.map(De=>W.jsxs("span",{style:{background:"#e0f2fe",padding:"4px 8px",borderRadius:"4px",border:"1px solid #bae6fd",color:"#0369a1",display:"flex",alignItems:"center",gap:"5px"},children:[W.jsx("span",{style:{maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:De.universidad}),W.jsx("b",{style:{color:"#0c4a6e",background:"#bae6fd",padding:"1px 6px",borderRadius:"3px"},children:De.cantidad})]},De.universidad)):W.jsx("span",{style:{opacity:.5,fontStyle:"italic"},children:"Sin asignaciones registradas."})})]},ne.nombre))})]})}),W.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[W.jsx("div",{style:{flex:3,position:"relative",borderRight:"1px solid #cbd5e1"},children:W.jsxs(oT,{center:n,zoom:s,style:{height:"100%",width:"100%",background:"#e2e8f0"},zoomControl:!1,children:[W.jsx(L9,{center:n,zoom:s}),W.jsx(lT,{url:Sy[l].url,attribution:" CARTO"}),t&&W.jsx(aT,{data:t,style:re}),H.map((ne,De)=>{if(ne.sinCoordenadas)return null;const Me=q===ne.nombre,Qe=rp(ne.ris,ne.tipo);return W.jsxs(sT,{center:[ne.lat,ne.lng],pathOptions:{color:Me?"#195c97":Qe,fillColor:Me?"white":Qe,fillOpacity:Me?.5:.8,weight:Me?4:0,dashArray:Me?"4,4":""},radius:Me?12:6,eventHandlers:{click:()=>Ze(ne.nombre,ne.lat,ne.lng)},children:[Me&&W.jsxs(jh,{direction:"top",offset:[0,-10],opacity:1,permanent:!0,className:"label-mapa",children:[" ",ne.nombre," (Libres: ",ne.disponible,") "]}),!Me&&W.jsxs(jh,{direction:"top",offset:[0,-5],opacity:1,children:[" ",ne.nombre,": ",ne.disponible," libres "]})]},De)})]})}),W.jsxs("div",{style:{flex:1,minWidth:"340px",background:"#ffffff",display:"flex",flexDirection:"column",boxShadow:"-5px 0 15px rgba(0,0,0,0.05)"},children:[W.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #e2e8f0",background:"#f8fafc"},children:[W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px",gap:"10px"},children:[W.jsxs("div",{style:{background:"#195c97",padding:"15px",borderRadius:"10px",flex:1,textAlign:"center",color:"white",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[W.jsx("div",{style:{fontSize:"11px",fontWeight:"800",textTransform:"uppercase",opacity:.8},children:"Total Ofertado"}),W.jsx("div",{style:{fontSize:"28px",fontWeight:"900",marginTop:"5px"},children:je})]}),W.jsxs("div",{style:{background:"#329584",padding:"15px",borderRadius:"10px",flex:1,textAlign:"center",color:"white",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[W.jsx("div",{style:{fontSize:"11px",fontWeight:"800",textTransform:"uppercase",opacity:.8},children:"Disponible Total"}),W.jsx("div",{style:{fontSize:"28px",fontWeight:"900",marginTop:"5px"},children:tt})]})]}),W.jsxs("div",{style:{display:"flex",background:"#f1f5f9",borderRadius:"8px",padding:"4px",border:"1px solid #e2e8f0"},children:[W.jsx("button",{onClick:()=>p("lista"),style:{flex:1,padding:"10px",borderRadius:"6px",border:"none",background:h==="lista"?"#ffffff":"transparent",color:h==="lista"?"#195c97":"#64748b",fontWeight:"700",cursor:"pointer",boxShadow:h==="lista"?"0 2px 5px rgba(0,0,0,0.1)":"none"},children:"SEDES"}),W.jsx("button",{onClick:()=>p("reportes"),style:{flex:1,padding:"10px",borderRadius:"6px",border:"none",background:h==="reportes"?"#ffffff":"transparent",color:h==="reportes"?"#195c97":"#64748b",fontWeight:"700",cursor:"pointer",boxShadow:h==="reportes"?"0 2px 5px rgba(0,0,0,0.1)":"none"},children:"GRFICOS"})]})]}),W.jsx("div",{style:{flex:1,overflowY:"auto",padding:"15px",background:"#ffffff"},className:"custom-scrollbar",children:h==="lista"?H.map(ne=>{var Qe;const De=q===ne.nombre,Me=rp(ne.ris,ne.tipo);return W.jsxs("div",{style:{marginBottom:"12px",border:`1px solid ${De?Me:"#e2e8f0"}`,borderRadius:"10px",background:"#ffffff",overflow:"hidden",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",transition:"all 0.2s"},children:[W.jsxs("div",{onClick:()=>Ze(ne.nombre,ne.lat,ne.lng),style:{padding:"12px 15px",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",background:De?`${Me}10`:"transparent"},children:[W.jsxs("div",{style:{overflow:"hidden",flex:1,display:"flex",alignItems:"center",gap:"10px"},children:[W.jsx("i",{className:"fas fa-map-marker-alt",style:{color:Me,fontSize:"16px"}}),W.jsxs("div",{children:[W.jsx("div",{style:{fontWeight:"700",color:"#334155",fontSize:"13px"},children:ne.nombre}),W.jsxs("div",{style:{fontSize:"11px",color:"#64748b"},children:["Capacidad: ",W.jsx("b",{children:ne.capacidadTotal})]})]})]}),W.jsxs("span",{style:{background:ne.disponible>0?"#d1fae5":"#fee2e2",color:ne.disponible>0?"#059669":"#dc2626",fontSize:"11px",fontWeight:"800",padding:"4px 10px",borderRadius:"12px",minWidth:"70px",textAlign:"center"},children:[ne.disponible," Libres"]})]}),De&&W.jsxs("div",{style:{padding:"15px",background:"#f8fafc",borderTop:"1px solid #e2e8f0",animation:"fadeIn 0.2s ease-out"},children:[W.jsxs("div",{style:{fontSize:"11px",color:"#195c97",marginBottom:"12px",fontWeight:"800",letterSpacing:"0.5px"},children:["ASIGNADO (",ne.cantidad,"):"]}),(Qe=ne.desglose)==null?void 0:Qe.map((st,pt)=>W.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",fontSize:"12px",background:"#ffffff",padding:"8px 10px",borderRadius:"6px",border:"1px solid #e2e8f0"},children:[W.jsx("span",{style:{color:"#334155",fontWeight:"600",width:"80%"},children:st.universidad}),W.jsx("span",{style:{fontWeight:"800",color:"#195c97"},children:st.cantidad})]},pt)),(!ne.desglose||ne.desglose.length===0)&&W.jsx("div",{style:{fontSize:"12px",color:"#94a3b8",fontStyle:"italic",padding:"10px",textAlign:"center"},children:"Sin asignaciones registradas."})]})]},ne.nombre)}):W.jsx("div",{className:"fade-in",children:W.jsx(D9,{data:H,tiempos:te})})}),W.jsx("div",{className:"source-footer",style:{padding:"10px",fontSize:"10px",color:"#94a3b8",textAlign:"right",borderTop:"1px solid #e2e8f0"},children:"Fuente: Adjudicacin 2026 - UFDI"})]})]})]})};function b9(){return W.jsx(AR,{children:W.jsxs(yR,{children:[W.jsx(Jp,{path:"/",element:W.jsx(P9,{})}),W.jsx(Jp,{path:"/adjudicacion2026",element:W.jsx(F9,{})})]})})}ip.createRoot(document.getElementById("root")).render(W.jsx(Ka.StrictMode,{children:W.jsx(b9,{})}));
